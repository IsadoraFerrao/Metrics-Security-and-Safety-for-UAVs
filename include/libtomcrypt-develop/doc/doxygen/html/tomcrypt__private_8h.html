<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.15"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>LibTomCrypt: M:/Office/!Doutorado/0. RepositorioSVN/HAMSTER_Prototype/branches/JINT2018/include/libtomcrypt-develop/src/headers/tomcrypt_private.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(initResizable);
/* @license-end */</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="libtomsm.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">LibTomCrypt
   &#160;<span id="projectnumber">1.18.2-develop</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.15 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('tomcrypt__private_8h.html','');});
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#define-members">Macros</a> &#124;
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#enum-members">Enumerations</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">tomcrypt_private.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &quot;<a class="el" href="tomcrypt_8h_source.html">tomcrypt.h</a>&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for tomcrypt_private.h:</div>
<div class="dyncontent">
<div class="center"><img src="tomcrypt__private_8h__incl.png" border="0" usemap="#M_1_2Office_2_9Doutorado_20_8_01RepositorioSVN_2HAMSTER__Prototype_2branches_2JINT2018_2include_2libtomcrypt-develop_2src_2headers_2tomcrypt__private_8h" alt=""/></div>
<!-- MAP 0 -->
</div>
</div><div class="textblock"><div class="dynheader">
This graph shows which files directly or indirectly include this file:</div>
<div class="dyncontent">
<div class="center"><img src="tomcrypt__private_8h__dep__incl.png" border="0" usemap="#M_1_2Office_2_9Doutorado_20_8_01RepositorioSVN_2HAMSTER__Prototype_2branches_2JINT2018_2include_2libtomcrypt-develop_2src_2headers_2tomcrypt__private_8hdep" alt=""/></div>
<!-- MAP 1 -->
</div>
</div>
<p><a href="tomcrypt__private_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structltc__dh__set__type.html">ltc_dh_set_type</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structpbes__properties.html">pbes_properties</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structpbes__arg.html">pbes_arg</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a2b8e12593fe11f8eaeace6ce0fcc7566"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tomcrypt__private_8h.html#a2b8e12593fe11f8eaeace6ce0fcc7566">LTC_PAD_MASK</a>&#160;&#160;&#160;(0xF000U)</td></tr>
<tr class="separator:a2b8e12593fe11f8eaeace6ce0fcc7566"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae7c734d30e56dd5f0306f54246d47c2b"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tomcrypt__private_8h.html#ae7c734d30e56dd5f0306f54246d47c2b">HASH_PROCESS</a>(func_name,  compress_name,  state_var,  block_size)</td></tr>
<tr class="separator:ae7c734d30e56dd5f0306f54246d47c2b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab8e25bc0c3ace6218c5c7d49198405c9"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tomcrypt__private_8h.html#ab8e25bc0c3ace6218c5c7d49198405c9">MP_DIGIT_BIT</a>&#160;&#160;&#160;ltc_mp.bits_per_digit</td></tr>
<tr class="separator:ab8e25bc0c3ace6218c5c7d49198405c9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aff03c4f22c68d651747055048c509cf3"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tomcrypt__private_8h.html#aff03c4f22c68d651747055048c509cf3">mp_init</a>(a)&#160;&#160;&#160;<a class="el" href="tfm__desc_8c.html#a4f8948d7c94899bf8ddee4721114d593">ltc_mp.init</a>(a)</td></tr>
<tr class="separator:aff03c4f22c68d651747055048c509cf3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adb6322247b1a4f0347219acab3120bd3"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tomcrypt__private_8h.html#adb6322247b1a4f0347219acab3120bd3">mp_init_multi</a>&#160;&#160;&#160;<a class="el" href="multi_8c.html#a327161b10428b234d74713b8a08acb2a">ltc_init_multi</a></td></tr>
<tr class="separator:adb6322247b1a4f0347219acab3120bd3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab05b6b59fa182b81f5f990d5621229f6"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tomcrypt__private_8h.html#ab05b6b59fa182b81f5f990d5621229f6">mp_clear</a>(a)&#160;&#160;&#160;<a class="el" href="tfm__desc_8c.html#a9626887f45edba884c412234edf7d1d6">ltc_mp.deinit</a>(a)</td></tr>
<tr class="separator:ab05b6b59fa182b81f5f990d5621229f6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aad5c8a3112b3e4613f9efc86692c43cb"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tomcrypt__private_8h.html#aad5c8a3112b3e4613f9efc86692c43cb">mp_clear_multi</a>&#160;&#160;&#160;<a class="el" href="multi_8c.html#abcb92ed327d5fcf9bf9bcff2a6a3107a">ltc_deinit_multi</a></td></tr>
<tr class="separator:aad5c8a3112b3e4613f9efc86692c43cb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad0d492c0676e4944383a7ae9e9ebd63b"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tomcrypt__private_8h.html#ad0d492c0676e4944383a7ae9e9ebd63b">mp_cleanup_multi</a>&#160;&#160;&#160;<a class="el" href="multi_8c.html#a53eb69feb3f6ec63778a845a07771762">ltc_cleanup_multi</a></td></tr>
<tr class="separator:ad0d492c0676e4944383a7ae9e9ebd63b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad2f4da76a1604a39a01d9366dc0ea892"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tomcrypt__private_8h.html#ad2f4da76a1604a39a01d9366dc0ea892">mp_init_copy</a>(a,  b)&#160;&#160;&#160;<a class="el" href="tfm__desc_8c.html#a9c0dddd7edf258f69ca346540f3da61a">ltc_mp.init_copy</a>(a, b)</td></tr>
<tr class="separator:ad2f4da76a1604a39a01d9366dc0ea892"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0a85470068985d2c10a4df85ca54a7d0"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tomcrypt__private_8h.html#a0a85470068985d2c10a4df85ca54a7d0">mp_neg</a>(a,  b)&#160;&#160;&#160;<a class="el" href="tfm__desc_8c.html#adc67bac9fd8e42c930369ddabaa5f2db">ltc_mp.neg</a>(a, b)</td></tr>
<tr class="separator:a0a85470068985d2c10a4df85ca54a7d0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afbb35bc8f920448d169ddc83a4308840"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tomcrypt__private_8h.html#afbb35bc8f920448d169ddc83a4308840">mp_copy</a>(a,  b)&#160;&#160;&#160;<a class="el" href="tfm__desc_8c.html#ad88f68a4e6f0c7334e93eebf7ddbb2d3">ltc_mp.copy</a>(a, b)</td></tr>
<tr class="separator:afbb35bc8f920448d169ddc83a4308840"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a000b0542ef4ecf639ff69895490fdb8f"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tomcrypt__private_8h.html#a000b0542ef4ecf639ff69895490fdb8f">mp_set</a>(a,  b)&#160;&#160;&#160;<a class="el" href="tfm__desc_8c.html#a0b4961498876dba1898ece1416698b10">ltc_mp.set_int</a>(a, b)</td></tr>
<tr class="separator:a000b0542ef4ecf639ff69895490fdb8f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab06bc6503c4faab10b7ce60bef365d65"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tomcrypt__private_8h.html#ab06bc6503c4faab10b7ce60bef365d65">mp_set_int</a>(a,  b)&#160;&#160;&#160;<a class="el" href="tfm__desc_8c.html#a0b4961498876dba1898ece1416698b10">ltc_mp.set_int</a>(a, b)</td></tr>
<tr class="separator:ab06bc6503c4faab10b7ce60bef365d65"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4e68c807adc159c7553da37ce38196b2"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tomcrypt__private_8h.html#a4e68c807adc159c7553da37ce38196b2">mp_get_int</a>(a)&#160;&#160;&#160;<a class="el" href="tfm__desc_8c.html#ac31838ab831d4094fe109d327019548c">ltc_mp.get_int</a>(a)</td></tr>
<tr class="separator:a4e68c807adc159c7553da37ce38196b2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a62267879327e26468c45bbd83f7f2669"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tomcrypt__private_8h.html#a62267879327e26468c45bbd83f7f2669">mp_get_digit</a>(a,  n)&#160;&#160;&#160;<a class="el" href="tfm__desc_8c.html#a6171f32e40e45f55caf4a7cb475e866c">ltc_mp.get_digit</a>(a, n)</td></tr>
<tr class="separator:a62267879327e26468c45bbd83f7f2669"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae51a279d51ab72f09d9f97335b8be6c9"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tomcrypt__private_8h.html#ae51a279d51ab72f09d9f97335b8be6c9">mp_get_digit_count</a>(a)&#160;&#160;&#160;<a class="el" href="tfm__desc_8c.html#a10c8ab52ee86746d3389aa2400c88ac2">ltc_mp.get_digit_count</a>(a)</td></tr>
<tr class="separator:ae51a279d51ab72f09d9f97335b8be6c9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a62ea02fbe7dd2d456e49520264d775ee"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tomcrypt__private_8h.html#a62ea02fbe7dd2d456e49520264d775ee">mp_cmp</a>(a,  b)&#160;&#160;&#160;<a class="el" href="tfm__desc_8c.html#aecfc62c80bd6acc7a95d1391ad8252f7">ltc_mp.compare</a>(a, b)</td></tr>
<tr class="separator:a62ea02fbe7dd2d456e49520264d775ee"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6ce44f2e6f872565a468b67d9a93dc28"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tomcrypt__private_8h.html#a6ce44f2e6f872565a468b67d9a93dc28">mp_cmp_d</a>(a,  b)&#160;&#160;&#160;<a class="el" href="tfm__desc_8c.html#aee3f861609cd9406655be85087a7bb06">ltc_mp.compare_d</a>(a, b)</td></tr>
<tr class="separator:a6ce44f2e6f872565a468b67d9a93dc28"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afa1671e20e699f66319ed2e8d9119e7e"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tomcrypt__private_8h.html#afa1671e20e699f66319ed2e8d9119e7e">mp_count_bits</a>(a)&#160;&#160;&#160;<a class="el" href="tfm__desc_8c.html#a55e39d3b1adb176ed84c1211a7123071">ltc_mp.count_bits</a>(a)</td></tr>
<tr class="separator:afa1671e20e699f66319ed2e8d9119e7e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a566a41699158970f4d7a0554081706dd"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tomcrypt__private_8h.html#a566a41699158970f4d7a0554081706dd">mp_cnt_lsb</a>(a)&#160;&#160;&#160;<a class="el" href="tfm__desc_8c.html#a2506b220df2c67f8b9969f6c627c84a1">ltc_mp.count_lsb_bits</a>(a)</td></tr>
<tr class="separator:a566a41699158970f4d7a0554081706dd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abeb03f01d3819863d5de470797c629de"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tomcrypt__private_8h.html#abeb03f01d3819863d5de470797c629de">mp_2expt</a>(a,  b)&#160;&#160;&#160;<a class="el" href="tfm__desc_8c.html#a4f1673caee67fa1b6f8b745661a68eb1">ltc_mp.twoexpt</a>(a, b)</td></tr>
<tr class="separator:abeb03f01d3819863d5de470797c629de"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a12263d4d7da068c2a630d2ffc0c8bc1b"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tomcrypt__private_8h.html#a12263d4d7da068c2a630d2ffc0c8bc1b">mp_read_radix</a>(a,  b,  <a class="el" href="khazad_8c.html#a86ea50de5a3e0ae87762f4298d35284c">c</a>)&#160;&#160;&#160;<a class="el" href="tfm__desc_8c.html#af84d5b7caaf005f40f924afd8ada2380">ltc_mp.read_radix</a>(a, b, <a class="el" href="khazad_8c.html#a86ea50de5a3e0ae87762f4298d35284c">c</a>)</td></tr>
<tr class="separator:a12263d4d7da068c2a630d2ffc0c8bc1b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a560fd673c15ccf143fdfdcb2b21764e3"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tomcrypt__private_8h.html#a560fd673c15ccf143fdfdcb2b21764e3">mp_toradix</a>(a,  b,  <a class="el" href="khazad_8c.html#a86ea50de5a3e0ae87762f4298d35284c">c</a>)&#160;&#160;&#160;<a class="el" href="tfm__desc_8c.html#aa40161a29cddd18172c7a64a18b6dc2c">ltc_mp.write_radix</a>(a, b, <a class="el" href="khazad_8c.html#a86ea50de5a3e0ae87762f4298d35284c">c</a>)</td></tr>
<tr class="separator:a560fd673c15ccf143fdfdcb2b21764e3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad301148bb24f43a8c7003a6976dfaa5a"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tomcrypt__private_8h.html#ad301148bb24f43a8c7003a6976dfaa5a">mp_unsigned_bin_size</a>(a)&#160;&#160;&#160;<a class="el" href="tfm__desc_8c.html#adb7e3791a36546ca7550e34344e2cb47">ltc_mp.unsigned_size</a>(a)</td></tr>
<tr class="separator:ad301148bb24f43a8c7003a6976dfaa5a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a376a4d31dcfeb65c069db0485b9602f8"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tomcrypt__private_8h.html#a376a4d31dcfeb65c069db0485b9602f8">mp_to_unsigned_bin</a>(a,  b)&#160;&#160;&#160;<a class="el" href="tfm__desc_8c.html#a0f1b2cd32964ecad0001b7169b53f1d1">ltc_mp.unsigned_write</a>(a, b)</td></tr>
<tr class="separator:a376a4d31dcfeb65c069db0485b9602f8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9e20e2044bb5a279e27512d1e1b65754"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tomcrypt__private_8h.html#a9e20e2044bb5a279e27512d1e1b65754">mp_read_unsigned_bin</a>(a,  b,  <a class="el" href="khazad_8c.html#a86ea50de5a3e0ae87762f4298d35284c">c</a>)&#160;&#160;&#160;<a class="el" href="tfm__desc_8c.html#a39cf7045cbd39dc7ee5ecdf59dbe3313">ltc_mp.unsigned_read</a>(a, b, <a class="el" href="khazad_8c.html#a86ea50de5a3e0ae87762f4298d35284c">c</a>)</td></tr>
<tr class="separator:a9e20e2044bb5a279e27512d1e1b65754"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a175d04f8aeaa1c3895fe14de6cc0d2db"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tomcrypt__private_8h.html#a175d04f8aeaa1c3895fe14de6cc0d2db">mp_add</a>(a,  b,  <a class="el" href="khazad_8c.html#a86ea50de5a3e0ae87762f4298d35284c">c</a>)&#160;&#160;&#160;<a class="el" href="tfm__desc_8c.html#a274c97efa9f26a6d22ca17dbcb52e58b">ltc_mp.add</a>(a, b, <a class="el" href="khazad_8c.html#a86ea50de5a3e0ae87762f4298d35284c">c</a>)</td></tr>
<tr class="separator:a175d04f8aeaa1c3895fe14de6cc0d2db"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a69f09e7351d696b635ffbc9912684ab4"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tomcrypt__private_8h.html#a69f09e7351d696b635ffbc9912684ab4">mp_add_d</a>(a,  b,  <a class="el" href="khazad_8c.html#a86ea50de5a3e0ae87762f4298d35284c">c</a>)&#160;&#160;&#160;<a class="el" href="tfm__desc_8c.html#a9cce188374e60ab500e0e658738eb0ce">ltc_mp.addi</a>(a, b, <a class="el" href="khazad_8c.html#a86ea50de5a3e0ae87762f4298d35284c">c</a>)</td></tr>
<tr class="separator:a69f09e7351d696b635ffbc9912684ab4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab8d0882c3b58263b638b41fbf110fde8"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tomcrypt__private_8h.html#ab8d0882c3b58263b638b41fbf110fde8">mp_sub</a>(a,  b,  <a class="el" href="khazad_8c.html#a86ea50de5a3e0ae87762f4298d35284c">c</a>)&#160;&#160;&#160;<a class="el" href="tfm__desc_8c.html#ac1994aaeae47e7ef1b1b6fe723898be0">ltc_mp.sub</a>(a, b, <a class="el" href="khazad_8c.html#a86ea50de5a3e0ae87762f4298d35284c">c</a>)</td></tr>
<tr class="separator:ab8d0882c3b58263b638b41fbf110fde8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4215ff0d6838acb3d959d3e68c923de7"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tomcrypt__private_8h.html#a4215ff0d6838acb3d959d3e68c923de7">mp_sub_d</a>(a,  b,  <a class="el" href="khazad_8c.html#a86ea50de5a3e0ae87762f4298d35284c">c</a>)&#160;&#160;&#160;<a class="el" href="tfm__desc_8c.html#afa8ec5f7da0f83c1ea1f3da29e9be588">ltc_mp.subi</a>(a, b, <a class="el" href="khazad_8c.html#a86ea50de5a3e0ae87762f4298d35284c">c</a>)</td></tr>
<tr class="separator:a4215ff0d6838acb3d959d3e68c923de7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7606d2423856b32b09245a2fa1ef34ee"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tomcrypt__private_8h.html#a7606d2423856b32b09245a2fa1ef34ee">mp_mul</a>(a,  b,  <a class="el" href="khazad_8c.html#a86ea50de5a3e0ae87762f4298d35284c">c</a>)&#160;&#160;&#160;<a class="el" href="tfm__desc_8c.html#a7050c53d3ede33130b5137ee21872390">ltc_mp.mul</a>(a, b, <a class="el" href="khazad_8c.html#a86ea50de5a3e0ae87762f4298d35284c">c</a>)</td></tr>
<tr class="separator:a7606d2423856b32b09245a2fa1ef34ee"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6732f5faae69c8d1305898ca8e2943d5"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tomcrypt__private_8h.html#a6732f5faae69c8d1305898ca8e2943d5">mp_mul_d</a>(a,  b,  <a class="el" href="khazad_8c.html#a86ea50de5a3e0ae87762f4298d35284c">c</a>)&#160;&#160;&#160;<a class="el" href="tfm__desc_8c.html#a1bde65678f43510d80f8851860e15e34">ltc_mp.muli</a>(a, b, <a class="el" href="khazad_8c.html#a86ea50de5a3e0ae87762f4298d35284c">c</a>)</td></tr>
<tr class="separator:a6732f5faae69c8d1305898ca8e2943d5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aea81d79b5462e99068908d80edb8bd1a"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tomcrypt__private_8h.html#aea81d79b5462e99068908d80edb8bd1a">mp_sqr</a>(a,  b)&#160;&#160;&#160;<a class="el" href="tfm__desc_8c.html#acb23c57b2c947a4345287b337fa78764">ltc_mp.sqr</a>(a, b)</td></tr>
<tr class="separator:aea81d79b5462e99068908d80edb8bd1a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af1a090c9979e328596fa37512f519a09"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tomcrypt__private_8h.html#af1a090c9979e328596fa37512f519a09">mp_sqrtmod_prime</a>(a,  b,  <a class="el" href="khazad_8c.html#a86ea50de5a3e0ae87762f4298d35284c">c</a>)&#160;&#160;&#160;<a class="el" href="ltm__desc_8c.html#aec55b2d137e8b50b343f2d9986db1843">ltc_mp.sqrtmod_prime</a>(a, b, <a class="el" href="khazad_8c.html#a86ea50de5a3e0ae87762f4298d35284c">c</a>)</td></tr>
<tr class="separator:af1a090c9979e328596fa37512f519a09"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a861721ee02d3b5d84328090f3058f7c3"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tomcrypt__private_8h.html#a861721ee02d3b5d84328090f3058f7c3">mp_div</a>(a,  b,  <a class="el" href="khazad_8c.html#a86ea50de5a3e0ae87762f4298d35284c">c</a>,  d)&#160;&#160;&#160;ltc_mp.mpdiv(a, b, <a class="el" href="khazad_8c.html#a86ea50de5a3e0ae87762f4298d35284c">c</a>, d)</td></tr>
<tr class="separator:a861721ee02d3b5d84328090f3058f7c3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aec841464b436981f5758a49c561f39fe"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tomcrypt__private_8h.html#aec841464b436981f5758a49c561f39fe">mp_div_2</a>(a,  b)&#160;&#160;&#160;<a class="el" href="tfm__desc_8c.html#a38e564335cd5493b0e02969fda1c73a0">ltc_mp.div_2</a>(a, b)</td></tr>
<tr class="separator:aec841464b436981f5758a49c561f39fe"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac7deed6f00e289706070b16f98c430fe"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tomcrypt__private_8h.html#ac7deed6f00e289706070b16f98c430fe">mp_mod</a>(a,  b,  <a class="el" href="khazad_8c.html#a86ea50de5a3e0ae87762f4298d35284c">c</a>)&#160;&#160;&#160;ltc_mp.mpdiv(a, b, NULL, <a class="el" href="khazad_8c.html#a86ea50de5a3e0ae87762f4298d35284c">c</a>)</td></tr>
<tr class="separator:ac7deed6f00e289706070b16f98c430fe"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afd41c0725f692174823db3e939b3ac1e"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tomcrypt__private_8h.html#afd41c0725f692174823db3e939b3ac1e">mp_mod_d</a>(a,  b,  <a class="el" href="khazad_8c.html#a86ea50de5a3e0ae87762f4298d35284c">c</a>)&#160;&#160;&#160;<a class="el" href="tfm__desc_8c.html#a825311b5e56f780acb119b19a3cbdca0">ltc_mp.modi</a>(a, b, <a class="el" href="khazad_8c.html#a86ea50de5a3e0ae87762f4298d35284c">c</a>)</td></tr>
<tr class="separator:afd41c0725f692174823db3e939b3ac1e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad9deb5f35c296a1cd7ae37f4e4e210f4"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tomcrypt__private_8h.html#ad9deb5f35c296a1cd7ae37f4e4e210f4">mp_gcd</a>(a,  b,  <a class="el" href="khazad_8c.html#a86ea50de5a3e0ae87762f4298d35284c">c</a>)&#160;&#160;&#160;<a class="el" href="tfm__desc_8c.html#afb49bbeaad5528b5afd96667e06c19ef">ltc_mp.gcd</a>(a, b, <a class="el" href="khazad_8c.html#a86ea50de5a3e0ae87762f4298d35284c">c</a>)</td></tr>
<tr class="separator:ad9deb5f35c296a1cd7ae37f4e4e210f4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a42ca6ad7676c236e06ee8b53e278a1a2"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tomcrypt__private_8h.html#a42ca6ad7676c236e06ee8b53e278a1a2">mp_lcm</a>(a,  b,  <a class="el" href="khazad_8c.html#a86ea50de5a3e0ae87762f4298d35284c">c</a>)&#160;&#160;&#160;<a class="el" href="tfm__desc_8c.html#ade2a62ec3e6aa65016ad994bdae98424">ltc_mp.lcm</a>(a, b, <a class="el" href="khazad_8c.html#a86ea50de5a3e0ae87762f4298d35284c">c</a>)</td></tr>
<tr class="separator:a42ca6ad7676c236e06ee8b53e278a1a2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3cc86fdd66c67023afe490b3534d459b"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tomcrypt__private_8h.html#a3cc86fdd66c67023afe490b3534d459b">mp_addmod</a>(a,  b,  <a class="el" href="khazad_8c.html#a86ea50de5a3e0ae87762f4298d35284c">c</a>,  d)&#160;&#160;&#160;<a class="el" href="tfm__desc_8c.html#a1197b0ad15639bfc3fc66314c2ce8527">ltc_mp.addmod</a>(a, b, <a class="el" href="khazad_8c.html#a86ea50de5a3e0ae87762f4298d35284c">c</a>, d)</td></tr>
<tr class="separator:a3cc86fdd66c67023afe490b3534d459b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a15e2f6c11b3fcebe885ecc14d759ac01"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tomcrypt__private_8h.html#a15e2f6c11b3fcebe885ecc14d759ac01">mp_submod</a>(a,  b,  <a class="el" href="khazad_8c.html#a86ea50de5a3e0ae87762f4298d35284c">c</a>,  d)&#160;&#160;&#160;<a class="el" href="tfm__desc_8c.html#ac6a3bdd2a041584938590017969f9f76">ltc_mp.submod</a>(a, b, <a class="el" href="khazad_8c.html#a86ea50de5a3e0ae87762f4298d35284c">c</a>, d)</td></tr>
<tr class="separator:a15e2f6c11b3fcebe885ecc14d759ac01"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0c32b20b84951870c7b09f5b6f2679c9"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tomcrypt__private_8h.html#a0c32b20b84951870c7b09f5b6f2679c9">mp_mulmod</a>(a,  b,  <a class="el" href="khazad_8c.html#a86ea50de5a3e0ae87762f4298d35284c">c</a>,  d)&#160;&#160;&#160;<a class="el" href="tfm__desc_8c.html#a4c6702198a33b0c56f0a886d7c2206c5">ltc_mp.mulmod</a>(a, b, <a class="el" href="khazad_8c.html#a86ea50de5a3e0ae87762f4298d35284c">c</a>, d)</td></tr>
<tr class="separator:a0c32b20b84951870c7b09f5b6f2679c9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6542bece10f5cf20b6c754646c20fcb4"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tomcrypt__private_8h.html#a6542bece10f5cf20b6c754646c20fcb4">mp_sqrmod</a>(a,  b,  <a class="el" href="khazad_8c.html#a86ea50de5a3e0ae87762f4298d35284c">c</a>)&#160;&#160;&#160;<a class="el" href="tfm__desc_8c.html#a2a2ed54ac95cb81e7a744b060eeb34af">ltc_mp.sqrmod</a>(a, b, <a class="el" href="khazad_8c.html#a86ea50de5a3e0ae87762f4298d35284c">c</a>)</td></tr>
<tr class="separator:a6542bece10f5cf20b6c754646c20fcb4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8be707236375351ab194f908c8ba9233"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tomcrypt__private_8h.html#a8be707236375351ab194f908c8ba9233">mp_invmod</a>(a,  b,  <a class="el" href="khazad_8c.html#a86ea50de5a3e0ae87762f4298d35284c">c</a>)&#160;&#160;&#160;<a class="el" href="tfm__desc_8c.html#ac982ab06185a4919fdd77d7ab0fd8093">ltc_mp.invmod</a>(a, b, <a class="el" href="khazad_8c.html#a86ea50de5a3e0ae87762f4298d35284c">c</a>)</td></tr>
<tr class="separator:a8be707236375351ab194f908c8ba9233"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a42560b136f9c3cf1411a82a8cae6d954"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tomcrypt__private_8h.html#a42560b136f9c3cf1411a82a8cae6d954">mp_montgomery_setup</a>(a,  b)&#160;&#160;&#160;<a class="el" href="tfm__desc_8c.html#a771ef8a9d5b1b2633613bfad28b282c2">ltc_mp.montgomery_setup</a>(a, b)</td></tr>
<tr class="separator:a42560b136f9c3cf1411a82a8cae6d954"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8e30da64ace4410ca56cb110a6fedd19"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tomcrypt__private_8h.html#a8e30da64ace4410ca56cb110a6fedd19">mp_montgomery_normalization</a>(a,  b)&#160;&#160;&#160;<a class="el" href="tfm__desc_8c.html#aa047d6197825069c90f4f89a59f5ed6d">ltc_mp.montgomery_normalization</a>(a, b)</td></tr>
<tr class="separator:a8e30da64ace4410ca56cb110a6fedd19"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4201ed2dbae154496e1a2ae9ba8aa7a8"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tomcrypt__private_8h.html#a4201ed2dbae154496e1a2ae9ba8aa7a8">mp_montgomery_reduce</a>(a,  b,  <a class="el" href="khazad_8c.html#a86ea50de5a3e0ae87762f4298d35284c">c</a>)&#160;&#160;&#160;<a class="el" href="tfm__desc_8c.html#a109a8d07cc14bf2f0bd604a773d7e02c">ltc_mp.montgomery_reduce</a>(a, b, <a class="el" href="khazad_8c.html#a86ea50de5a3e0ae87762f4298d35284c">c</a>)</td></tr>
<tr class="separator:a4201ed2dbae154496e1a2ae9ba8aa7a8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac1935719c005c8bffb7590628e84c024"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tomcrypt__private_8h.html#ac1935719c005c8bffb7590628e84c024">mp_montgomery_free</a>(a)&#160;&#160;&#160;<a class="el" href="tfm__desc_8c.html#a8d6035f0021cfaf5936a3c37d2cb2427">ltc_mp.montgomery_deinit</a>(a)</td></tr>
<tr class="separator:ac1935719c005c8bffb7590628e84c024"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4fb1221fbef91bf8163390e3cfb82085"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tomcrypt__private_8h.html#a4fb1221fbef91bf8163390e3cfb82085">mp_exptmod</a>(a,  b,  <a class="el" href="khazad_8c.html#a86ea50de5a3e0ae87762f4298d35284c">c</a>,  d)&#160;&#160;&#160;<a class="el" href="tfm__desc_8c.html#a251a26828a3c68dff4bbe01f54470275">ltc_mp.exptmod</a>(a,b,<a class="el" href="khazad_8c.html#a86ea50de5a3e0ae87762f4298d35284c">c</a>,d)</td></tr>
<tr class="separator:a4fb1221fbef91bf8163390e3cfb82085"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab3681f96d55cf707b92d6254f58ea3de"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tomcrypt__private_8h.html#ab3681f96d55cf707b92d6254f58ea3de">mp_prime_is_prime</a>(a,  b,  <a class="el" href="khazad_8c.html#a86ea50de5a3e0ae87762f4298d35284c">c</a>)&#160;&#160;&#160;<a class="el" href="tfm__desc_8c.html#a48fb4f337851176a7ee5b0836e77d7df">ltc_mp.isprime</a>(a, b, <a class="el" href="khazad_8c.html#a86ea50de5a3e0ae87762f4298d35284c">c</a>)</td></tr>
<tr class="separator:ab3681f96d55cf707b92d6254f58ea3de"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a910040068490f9f6e5185c970ab869c9"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tomcrypt__private_8h.html#a910040068490f9f6e5185c970ab869c9">mp_iszero</a>(a)&#160;&#160;&#160;(<a class="el" href="tomcrypt__private_8h.html#a6ce44f2e6f872565a468b67d9a93dc28">mp_cmp_d</a>(a, 0) == <a class="el" href="tomcrypt__math_8h.html#a035a31bde4f31419eb259e36e5776607">LTC_MP_EQ</a> ? <a class="el" href="tomcrypt__math_8h.html#acc2da047f8fb30a3e2b2403aac617fe0">LTC_MP_YES</a> : <a class="el" href="tomcrypt__math_8h.html#a40f1119339954fb273ecb35e48c1d569">LTC_MP_NO</a>)</td></tr>
<tr class="separator:a910040068490f9f6e5185c970ab869c9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a93ed39c257831509afc74f2b6da66ae7"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tomcrypt__private_8h.html#a93ed39c257831509afc74f2b6da66ae7">mp_isodd</a>(a)&#160;&#160;&#160;(<a class="el" href="tomcrypt__private_8h.html#ae51a279d51ab72f09d9f97335b8be6c9">mp_get_digit_count</a>(a) &gt; 0 ? (<a class="el" href="tomcrypt__private_8h.html#a62267879327e26468c45bbd83f7f2669">mp_get_digit</a>(a, 0) &amp; 1 ? <a class="el" href="tomcrypt__math_8h.html#acc2da047f8fb30a3e2b2403aac617fe0">LTC_MP_YES</a> : <a class="el" href="tomcrypt__math_8h.html#a40f1119339954fb273ecb35e48c1d569">LTC_MP_NO</a>) : <a class="el" href="tomcrypt__math_8h.html#a40f1119339954fb273ecb35e48c1d569">LTC_MP_NO</a>)</td></tr>
<tr class="separator:a93ed39c257831509afc74f2b6da66ae7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a16c03b9a12fc6832ae878eabb57e13cc"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tomcrypt__private_8h.html#a16c03b9a12fc6832ae878eabb57e13cc">mp_exch</a>(a,  b)&#160;&#160;&#160;do { void *ABC__tmp = a; a = b; b = ABC__tmp; } while(0)</td></tr>
<tr class="separator:a16c03b9a12fc6832ae878eabb57e13cc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4b9ad86294c22251f11369ed62f236b9"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tomcrypt__private_8h.html#a4b9ad86294c22251f11369ed62f236b9">mp_tohex</a>(a,  b)&#160;&#160;&#160;<a class="el" href="tomcrypt__private_8h.html#a560fd673c15ccf143fdfdcb2b21764e3">mp_toradix</a>(a, b, 16)</td></tr>
<tr class="separator:a4b9ad86294c22251f11369ed62f236b9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9a1503b0adb58db297bc6bfd784b3945"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tomcrypt__private_8h.html#a9a1503b0adb58db297bc6bfd784b3945">mp_rand</a>(a,  b)&#160;&#160;&#160;ltc_mp.rand(a, b)</td></tr>
<tr class="separator:a9a1503b0adb58db297bc6bfd784b3945"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a896c8b07a35ff2799061855f08a8325a"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tomcrypt__private_8h.html#a896c8b07a35ff2799061855f08a8325a">LTC_ASN1_IS_TYPE</a>(e,  t)&#160;&#160;&#160;(((e) != NULL) &amp;&amp; ((e)-&gt;type == (t)))</td></tr>
<tr class="separator:a896c8b07a35ff2799061855f08a8325a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae463e0ea9b84288e301f114d43ef3e9a"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tomcrypt__private_8h.html#ae463e0ea9b84288e301f114d43ef3e9a">_LTC_PRNG_EXPORT</a>(which)</td></tr>
<tr class="separator:ae463e0ea9b84288e301f114d43ef3e9a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a319cb143574102827d3b0055ded27533"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tomcrypt__private_8h.html#a319cb143574102827d3b0055ded27533">LTC_BYTE</a>(x,  n)&#160;&#160;&#160;(((x) &gt;&gt; (8 * (n))) &amp; 255)</td></tr>
<tr class="separator:a319cb143574102827d3b0055ded27533"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:a056acfa9f8dfc66d7ebbe1315389f3b2"><td class="memItemLeft" align="right" valign="top">typedef int(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tomcrypt__private_8h.html#a056acfa9f8dfc66d7ebbe1315389f3b2">fn_kdf_t</a>) (const unsigned char *password, unsigned long password_len, const unsigned char *salt, unsigned long salt_len, int iteration_count, int hash_idx, unsigned char *out, unsigned long *outlen)</td></tr>
<tr class="separator:a056acfa9f8dfc66d7ebbe1315389f3b2"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="enum-members"></a>
Enumerations</h2></td></tr>
<tr class="memitem:a981c610adcaa77d61adb80dde41a044b"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tomcrypt__private_8h.html#a981c610adcaa77d61adb80dde41a044b">ltc_oid_id</a> { <br />
&#160;&#160;<a class="el" href="tomcrypt__private_8h.html#a981c610adcaa77d61adb80dde41a044ba40273a1f176419e8c4638e0efb15854f">PKA_RSA</a>, 
<br />
&#160;&#160;<a class="el" href="tomcrypt__private_8h.html#a981c610adcaa77d61adb80dde41a044babe5d329be6c70ca6a43ba1099a69386d">PKA_DSA</a>, 
<br />
&#160;&#160;<a class="el" href="tomcrypt__private_8h.html#a981c610adcaa77d61adb80dde41a044bafe7642b8f160f5b4e79903c13bf39a4e">PKA_EC</a>, 
<br />
&#160;&#160;<a class="el" href="tomcrypt__private_8h.html#a981c610adcaa77d61adb80dde41a044bad815f93f03c91dcfaa47330dcf8a397a">PKA_EC_PRIMEF</a>
<br />
 }</td></tr>
<tr class="separator:a981c610adcaa77d61adb80dde41a044b"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ac4af92f890be670e795a758ec452b402"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tomcrypt__private_8h.html#ac4af92f890be670e795a758ec452b402">ocb3_int_ntz</a> (unsigned long x)</td></tr>
<tr class="memdesc:ac4af92f890be670e795a758ec452b402"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns the number of leading zero bits [from lsb up] (internal function)  <a href="#ac4af92f890be670e795a758ec452b402">More...</a><br /></td></tr>
<tr class="separator:ac4af92f890be670e795a758ec452b402"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5bf6caa4615657cdfd8f8941620a987c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tomcrypt__private_8h.html#a5bf6caa4615657cdfd8f8941620a987c">ocb3_int_xor_blocks</a> (unsigned char *out, const unsigned char *block_a, const unsigned char *block_b, unsigned long block_len)</td></tr>
<tr class="memdesc:a5bf6caa4615657cdfd8f8941620a987c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute xor for two blocks of bytes 'out = block_a XOR block_b' (internal function)  <a href="#a5bf6caa4615657cdfd8f8941620a987c">More...</a><br /></td></tr>
<tr class="separator:a5bf6caa4615657cdfd8f8941620a987c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a669fada75ab21a80b652dfbc2b54e346"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tomcrypt__private_8h.html#a669fada75ab21a80b652dfbc2b54e346">copy_or_zeromem</a> (const unsigned char *src, unsigned char *dest, unsigned long <a class="el" href="pmac__init_8c.html#afed088663f8704004425cdae2120b9b3">len</a>, int coz)</td></tr>
<tr class="memdesc:a669fada75ab21a80b652dfbc2b54e346"><td class="mdescLeft">&#160;</td><td class="mdescRight">Either copy or zero a block of memory in constant time.  <a href="#a669fada75ab21a80b652dfbc2b54e346">More...</a><br /></td></tr>
<tr class="separator:a669fada75ab21a80b652dfbc2b54e346"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7df0f8ba7d5d6b9752a7bb9c5e3f7081"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tomcrypt__private_8h.html#a7df0f8ba7d5d6b9752a7bb9c5e3f7081">pbes_decrypt</a> (const <a class="el" href="structpbes__arg.html">pbes_arg</a> *arg, unsigned char *dec_data, unsigned long *dec_size)</td></tr>
<tr class="memdesc:a7df0f8ba7d5d6b9752a7bb9c5e3f7081"><td class="mdescLeft">&#160;</td><td class="mdescRight">Decrypt Data encrypted via either PBES1 or PBES2.  <a href="#a7df0f8ba7d5d6b9752a7bb9c5e3f7081">More...</a><br /></td></tr>
<tr class="separator:a7df0f8ba7d5d6b9752a7bb9c5e3f7081"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3573423ba7eb454bb5f969ee9b580024"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tomcrypt__private_8h.html#a3573423ba7eb454bb5f969ee9b580024">pbes1_extract</a> (const ltc_asn1_list *s, <a class="el" href="structpbes__arg.html">pbes_arg</a> *res)</td></tr>
<tr class="memdesc:a3573423ba7eb454bb5f969ee9b580024"><td class="mdescLeft">&#160;</td><td class="mdescRight">Extract PBES1 parameters.  <a href="#a3573423ba7eb454bb5f969ee9b580024">More...</a><br /></td></tr>
<tr class="separator:a3573423ba7eb454bb5f969ee9b580024"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a741f04fef81b90c03eeba79d1d680273"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tomcrypt__private_8h.html#a741f04fef81b90c03eeba79d1d680273">pbes2_extract</a> (const ltc_asn1_list *s, <a class="el" href="structpbes__arg.html">pbes_arg</a> *res)</td></tr>
<tr class="memdesc:a741f04fef81b90c03eeba79d1d680273"><td class="mdescLeft">&#160;</td><td class="mdescRight">Extract PBES2 parameters.  <a href="#a741f04fef81b90c03eeba79d1d680273">More...</a><br /></td></tr>
<tr class="separator:a741f04fef81b90c03eeba79d1d680273"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5a58a92a44e093e5b35960f7b92a6eb9"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tomcrypt__private_8h.html#a5a58a92a44e093e5b35960f7b92a6eb9">rand_bn_bits</a> (void *<a class="el" href="sober128__stream_8c.html#a0240ac851181b84ac374872dc5434ee4">N</a>, int bits, <a class="el" href="structprng__state.html">prng_state</a> *prng, int wprng)</td></tr>
<tr class="memdesc:a5a58a92a44e093e5b35960f7b92a6eb9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Generate a random number N with given bitlength (note: MSB can be 0)  <a href="#a5a58a92a44e093e5b35960f7b92a6eb9">More...</a><br /></td></tr>
<tr class="separator:a5a58a92a44e093e5b35960f7b92a6eb9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8050acf530841fb2da3b667204039856"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tomcrypt__private_8h.html#a8050acf530841fb2da3b667204039856">rand_bn_upto</a> (void *<a class="el" href="sober128__stream_8c.html#a0240ac851181b84ac374872dc5434ee4">N</a>, void *limit, <a class="el" href="structprng__state.html">prng_state</a> *prng, int wprng)</td></tr>
<tr class="memdesc:a8050acf530841fb2da3b667204039856"><td class="mdescLeft">&#160;</td><td class="mdescRight">Generate a random number N in a range: 1 &lt;= N &lt; limit.  <a href="#a8050acf530841fb2da3b667204039856">More...</a><br /></td></tr>
<tr class="separator:a8050acf530841fb2da3b667204039856"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acff5b3d0c6e1145e07d1a3ff53fadce5"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tomcrypt__private_8h.html#acff5b3d0c6e1145e07d1a3ff53fadce5">pk_get_oid</a> (enum <a class="el" href="tomcrypt__private_8h.html#a981c610adcaa77d61adb80dde41a044b">ltc_oid_id</a> id, const char **st)</td></tr>
<tr class="separator:acff5b3d0c6e1145e07d1a3ff53fadce5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad99c87d19f50f703708d36a931fe5df6"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tomcrypt__private_8h.html#ad99c87d19f50f703708d36a931fe5df6">pk_oid_str_to_num</a> (const char *<a class="el" href="ecc__find__curve_8c.html#a3b9aae9990e63034f7d199729f025b23">OID</a>, unsigned long *oid, unsigned long *oidlen)</td></tr>
<tr class="separator:ad99c87d19f50f703708d36a931fe5df6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5ead1435fcad3d1f1842a6419079f036"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tomcrypt__private_8h.html#a5ead1435fcad3d1f1842a6419079f036">pk_oid_num_to_str</a> (const unsigned long *oid, unsigned long oidlen, char *<a class="el" href="ecc__find__curve_8c.html#a3b9aae9990e63034f7d199729f025b23">OID</a>, unsigned long *outlen)</td></tr>
<tr class="separator:a5ead1435fcad3d1f1842a6419079f036"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a88fc16c33e95216e30eae5beb8e92da1"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tomcrypt__private_8h.html#a88fc16c33e95216e30eae5beb8e92da1">dh_check_pubkey</a> (const dh_key *key)</td></tr>
<tr class="memdesc:a88fc16c33e95216e30eae5beb8e92da1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check DH public key (INTERNAL ONLY, not part of public API)  <a href="#a88fc16c33e95216e30eae5beb8e92da1">More...</a><br /></td></tr>
<tr class="separator:a88fc16c33e95216e30eae5beb8e92da1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5058c67d67d65a00c30b08ee3c0149f1"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tomcrypt__private_8h.html#a5058c67d67d65a00c30b08ee3c0149f1">ecc_set_curve_from_mpis</a> (void *a, void *b, void *prime, void *order, void *gx, void *gy, unsigned long cofactor, ecc_key *key)</td></tr>
<tr class="separator:a5058c67d67d65a00c30b08ee3c0149f1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa65ad9426232274db6f50ae2ba05a600"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tomcrypt__private_8h.html#aa65ad9426232274db6f50ae2ba05a600">ecc_copy_curve</a> (const ecc_key *srckey, ecc_key *key)</td></tr>
<tr class="separator:aa65ad9426232274db6f50ae2ba05a600"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae380263c82c1fe0cde8dc08e89f7940c"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tomcrypt__private_8h.html#ae380263c82c1fe0cde8dc08e89f7940c">ecc_set_curve_by_size</a> (int size, ecc_key *key)</td></tr>
<tr class="separator:ae380263c82c1fe0cde8dc08e89f7940c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6e24f3e6a3975c4d9e261a6031cab7b5"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tomcrypt__private_8h.html#a6e24f3e6a3975c4d9e261a6031cab7b5">ecc_import_subject_public_key_info</a> (const unsigned char *in, unsigned long inlen, ecc_key *key)</td></tr>
<tr class="separator:a6e24f3e6a3975c4d9e261a6031cab7b5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5921e9a5a19d09bc948281baf09ea128"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tomcrypt__private_8h.html#a5921e9a5a19d09bc948281baf09ea128">ecc_ssh_ecdsa_encode_name</a> (char *buffer, unsigned long *buflen, const ecc_key *key)</td></tr>
<tr class="memdesc:a5921e9a5a19d09bc948281baf09ea128"><td class="mdescLeft">&#160;</td><td class="mdescRight">Curve/OID to SSH+ECDSA name string mapping.  <a href="#a5921e9a5a19d09bc948281baf09ea128">More...</a><br /></td></tr>
<tr class="separator:a5921e9a5a19d09bc948281baf09ea128"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a532af6ef2d0f6d1d8cd79e5f81e87cf8"><td class="memItemLeft" align="right" valign="top"><a class="el" href="tomcrypt__math_8h.html#a2a6efaeaa795aa54274d7c4fd66b018a">ecc_point</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tomcrypt__private_8h.html#a532af6ef2d0f6d1d8cd79e5f81e87cf8">ltc_ecc_new_point</a> (void)</td></tr>
<tr class="memdesc:a532af6ef2d0f6d1d8cd79e5f81e87cf8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Allocate a new ECC point.  <a href="#a532af6ef2d0f6d1d8cd79e5f81e87cf8">More...</a><br /></td></tr>
<tr class="separator:a532af6ef2d0f6d1d8cd79e5f81e87cf8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4cef83a7c070c94ff78d4df10a7b624f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tomcrypt__private_8h.html#a4cef83a7c070c94ff78d4df10a7b624f">ltc_ecc_del_point</a> (<a class="el" href="tomcrypt__math_8h.html#a2a6efaeaa795aa54274d7c4fd66b018a">ecc_point</a> *p)</td></tr>
<tr class="memdesc:a4cef83a7c070c94ff78d4df10a7b624f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Free an ECC point from memory.  <a href="#a4cef83a7c070c94ff78d4df10a7b624f">More...</a><br /></td></tr>
<tr class="separator:a4cef83a7c070c94ff78d4df10a7b624f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adc0366a4a0c272b7594bcea0d8fe7ccb"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tomcrypt__private_8h.html#adc0366a4a0c272b7594bcea0d8fe7ccb">ltc_ecc_set_point_xyz</a> (<a class="el" href="tomcrypt__cfg_8h.html#a4e98fa26a5de0ac87e06af901bad57c4">ltc_mp_digit</a> x, <a class="el" href="tomcrypt__cfg_8h.html#a4e98fa26a5de0ac87e06af901bad57c4">ltc_mp_digit</a> y, <a class="el" href="tomcrypt__cfg_8h.html#a4e98fa26a5de0ac87e06af901bad57c4">ltc_mp_digit</a> z, <a class="el" href="tomcrypt__math_8h.html#a2a6efaeaa795aa54274d7c4fd66b018a">ecc_point</a> *p)</td></tr>
<tr class="separator:adc0366a4a0c272b7594bcea0d8fe7ccb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4b36b54e30a0a87aff57a936b386df7f"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tomcrypt__private_8h.html#a4b36b54e30a0a87aff57a936b386df7f">ltc_ecc_copy_point</a> (const <a class="el" href="tomcrypt__math_8h.html#a2a6efaeaa795aa54274d7c4fd66b018a">ecc_point</a> *src, <a class="el" href="tomcrypt__math_8h.html#a2a6efaeaa795aa54274d7c4fd66b018a">ecc_point</a> *dst)</td></tr>
<tr class="separator:a4b36b54e30a0a87aff57a936b386df7f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:affd37f56571ffc28d2c2687a76014b11"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tomcrypt__private_8h.html#affd37f56571ffc28d2c2687a76014b11">ltc_ecc_is_point</a> (const ltc_ecc_dp *dp, void *x, void *y)</td></tr>
<tr class="memdesc:affd37f56571ffc28d2c2687a76014b11"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns whether [x,y] is a point on curve defined by dp.  <a href="#affd37f56571ffc28d2c2687a76014b11">More...</a><br /></td></tr>
<tr class="separator:affd37f56571ffc28d2c2687a76014b11"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a54a2d7d30af25ef341a8aca09269177d"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tomcrypt__private_8h.html#a54a2d7d30af25ef341a8aca09269177d">ltc_ecc_is_point_at_infinity</a> (const <a class="el" href="tomcrypt__math_8h.html#a2a6efaeaa795aa54274d7c4fd66b018a">ecc_point</a> *P, void *modulus, int *retval)</td></tr>
<tr class="separator:a54a2d7d30af25ef341a8aca09269177d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa63889eb69cecc42e44b7dfa9ad9d473"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tomcrypt__private_8h.html#aa63889eb69cecc42e44b7dfa9ad9d473">ltc_ecc_import_point</a> (const unsigned char *in, unsigned long inlen, void *prime, void *a, void *b, void *x, void *y)</td></tr>
<tr class="separator:aa63889eb69cecc42e44b7dfa9ad9d473"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae647d3ad2082ac1e6fc81e857c5922b4"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tomcrypt__private_8h.html#ae647d3ad2082ac1e6fc81e857c5922b4">ltc_ecc_export_point</a> (unsigned char *out, unsigned long *outlen, void *x, void *y, unsigned long size, int compressed)</td></tr>
<tr class="separator:ae647d3ad2082ac1e6fc81e857c5922b4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac0dfaf009d9b0101291727341a20bb40"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tomcrypt__private_8h.html#ac0dfaf009d9b0101291727341a20bb40">ltc_ecc_verify_key</a> (const ecc_key *key)</td></tr>
<tr class="memdesc:ac0dfaf009d9b0101291727341a20bb40"><td class="mdescLeft">&#160;</td><td class="mdescRight">Verify a key according to ANSI spec.  <a href="#ac0dfaf009d9b0101291727341a20bb40">More...</a><br /></td></tr>
<tr class="separator:ac0dfaf009d9b0101291727341a20bb40"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af9bdd0d8d602ef3b300b11d19d7bc33a"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tomcrypt__private_8h.html#af9bdd0d8d602ef3b300b11d19d7bc33a">ltc_ecc_projective_dbl_point</a> (const <a class="el" href="tomcrypt__math_8h.html#a2a6efaeaa795aa54274d7c4fd66b018a">ecc_point</a> *P, <a class="el" href="tomcrypt__math_8h.html#a2a6efaeaa795aa54274d7c4fd66b018a">ecc_point</a> *<a class="el" href="sha512_8c.html#a8fb1dfc3ad6dd07bc99c1962e6583087">R</a>, void *ma, void *modulus, void *mp)</td></tr>
<tr class="memdesc:af9bdd0d8d602ef3b300b11d19d7bc33a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Double an ECC point.  <a href="#af9bdd0d8d602ef3b300b11d19d7bc33a">More...</a><br /></td></tr>
<tr class="separator:af9bdd0d8d602ef3b300b11d19d7bc33a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a16f3ff8dd19aa2ccc2aab4024927bc93"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tomcrypt__private_8h.html#a16f3ff8dd19aa2ccc2aab4024927bc93">ltc_ecc_projective_add_point</a> (const <a class="el" href="tomcrypt__math_8h.html#a2a6efaeaa795aa54274d7c4fd66b018a">ecc_point</a> *P, const <a class="el" href="tomcrypt__math_8h.html#a2a6efaeaa795aa54274d7c4fd66b018a">ecc_point</a> *Q, <a class="el" href="tomcrypt__math_8h.html#a2a6efaeaa795aa54274d7c4fd66b018a">ecc_point</a> *<a class="el" href="sha512_8c.html#a8fb1dfc3ad6dd07bc99c1962e6583087">R</a>, void *ma, void *modulus, void *mp)</td></tr>
<tr class="memdesc:a16f3ff8dd19aa2ccc2aab4024927bc93"><td class="mdescLeft">&#160;</td><td class="mdescRight">Add two ECC points.  <a href="#a16f3ff8dd19aa2ccc2aab4024927bc93">More...</a><br /></td></tr>
<tr class="separator:a16f3ff8dd19aa2ccc2aab4024927bc93"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a818e5e4135d8aa58cf09e502e98ccc90"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tomcrypt__private_8h.html#a818e5e4135d8aa58cf09e502e98ccc90">ltc_ecc_mulmod</a> (void *k, const <a class="el" href="tomcrypt__math_8h.html#a2a6efaeaa795aa54274d7c4fd66b018a">ecc_point</a> *<a class="el" href="rmd320_8c.html#ad96b7cf3182ce2ba85e5a7a93b12c441">G</a>, <a class="el" href="tomcrypt__math_8h.html#a2a6efaeaa795aa54274d7c4fd66b018a">ecc_point</a> *<a class="el" href="sha512_8c.html#a8fb1dfc3ad6dd07bc99c1962e6583087">R</a>, void *a, void *modulus, int map)</td></tr>
<tr class="memdesc:a818e5e4135d8aa58cf09e502e98ccc90"><td class="mdescLeft">&#160;</td><td class="mdescRight">Perform a point multiplication (timing resistant)  <a href="#a818e5e4135d8aa58cf09e502e98ccc90">More...</a><br /></td></tr>
<tr class="separator:a818e5e4135d8aa58cf09e502e98ccc90"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4aaa757939c4f4b54a3db21afc6aef9f"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tomcrypt__private_8h.html#a4aaa757939c4f4b54a3db21afc6aef9f">ltc_ecc_mul2add</a> (const <a class="el" href="tomcrypt__math_8h.html#a2a6efaeaa795aa54274d7c4fd66b018a">ecc_point</a> *A, void *kA, const <a class="el" href="tomcrypt__math_8h.html#a2a6efaeaa795aa54274d7c4fd66b018a">ecc_point</a> *B, void *kB, <a class="el" href="tomcrypt__math_8h.html#a2a6efaeaa795aa54274d7c4fd66b018a">ecc_point</a> *C, void *ma, void *modulus)</td></tr>
<tr class="memdesc:a4aaa757939c4f4b54a3db21afc6aef9f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Computes kA*A + kB*B = C using Shamir's Trick.  <a href="#a4aaa757939c4f4b54a3db21afc6aef9f">More...</a><br /></td></tr>
<tr class="separator:a4aaa757939c4f4b54a3db21afc6aef9f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af9f9d49f05241e41e2f8660afdaf7dac"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tomcrypt__private_8h.html#af9f9d49f05241e41e2f8660afdaf7dac">ltc_ecc_map</a> (<a class="el" href="tomcrypt__math_8h.html#a2a6efaeaa795aa54274d7c4fd66b018a">ecc_point</a> *P, void *modulus, void *mp)</td></tr>
<tr class="memdesc:af9f9d49f05241e41e2f8660afdaf7dac"><td class="mdescLeft">&#160;</td><td class="mdescRight">Map a projective jacbobian point back to affine space.  <a href="#af9f9d49f05241e41e2f8660afdaf7dac">More...</a><br /></td></tr>
<tr class="separator:af9f9d49f05241e41e2f8660afdaf7dac"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa5b2d573863af50ed2f38a00998a1274"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tomcrypt__private_8h.html#aa5b2d573863af50ed2f38a00998a1274">dsa_int_validate_xy</a> (const dsa_key *key, int *stat)</td></tr>
<tr class="memdesc:aa5b2d573863af50ed2f38a00998a1274"><td class="mdescLeft">&#160;</td><td class="mdescRight">Validation of a DSA key (x and y values)  <a href="#aa5b2d573863af50ed2f38a00998a1274">More...</a><br /></td></tr>
<tr class="separator:aa5b2d573863af50ed2f38a00998a1274"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a78787aeedd134c0e586d4a42a83c89c2"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tomcrypt__private_8h.html#a78787aeedd134c0e586d4a42a83c89c2">dsa_int_validate_pqg</a> (const dsa_key *key, int *stat)</td></tr>
<tr class="memdesc:a78787aeedd134c0e586d4a42a83c89c2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Non-complex part (no primality testing) of the validation of DSA params (p, q, g)  <a href="#a78787aeedd134c0e586d4a42a83c89c2">More...</a><br /></td></tr>
<tr class="separator:a78787aeedd134c0e586d4a42a83c89c2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abdc76d05886a02727e901ad26f2f3e81"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tomcrypt__private_8h.html#abdc76d05886a02727e901ad26f2f3e81">dsa_int_validate_primes</a> (const dsa_key *key, int *stat)</td></tr>
<tr class="memdesc:abdc76d05886a02727e901ad26f2f3e81"><td class="mdescLeft">&#160;</td><td class="mdescRight">Primality testing of DSA params p and q.  <a href="#abdc76d05886a02727e901ad26f2f3e81">More...</a><br /></td></tr>
<tr class="separator:abdc76d05886a02727e901ad26f2f3e81"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaa3acc13042e5d9244ac279a354775fe"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tomcrypt__private_8h.html#aaa3acc13042e5d9244ac279a354775fe">der_decode_custom_type_ex</a> (const unsigned char *in, unsigned long inlen, ltc_asn1_list *root, ltc_asn1_list *list, unsigned long outlen, unsigned int flags)</td></tr>
<tr class="memdesc:aaa3acc13042e5d9244ac279a354775fe"><td class="mdescLeft">&#160;</td><td class="mdescRight">Extended-decode a Custom type.  <a href="#aaa3acc13042e5d9244ac279a354775fe">More...</a><br /></td></tr>
<tr class="separator:aaa3acc13042e5d9244ac279a354775fe"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a093815c0cc44624723a3d668992b3008"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tomcrypt__private_8h.html#a093815c0cc44624723a3d668992b3008">der_encode_asn1_identifier</a> (const ltc_asn1_list *id, unsigned char *out, unsigned long *outlen)</td></tr>
<tr class="memdesc:a093815c0cc44624723a3d668992b3008"><td class="mdescLeft">&#160;</td><td class="mdescRight">Encode the ASN.1 Identifier.  <a href="#a093815c0cc44624723a3d668992b3008">More...</a><br /></td></tr>
<tr class="separator:a093815c0cc44624723a3d668992b3008"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a651ad7c1f5a930476bb10b9d61555346"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tomcrypt__private_8h.html#a651ad7c1f5a930476bb10b9d61555346">der_decode_asn1_identifier</a> (const unsigned char *in, unsigned long *inlen, ltc_asn1_list *id)</td></tr>
<tr class="memdesc:a651ad7c1f5a930476bb10b9d61555346"><td class="mdescLeft">&#160;</td><td class="mdescRight">Decode the ASN.1 Identifier.  <a href="#a651ad7c1f5a930476bb10b9d61555346">More...</a><br /></td></tr>
<tr class="separator:a651ad7c1f5a930476bb10b9d61555346"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a12ee6e955851d0daff84581e3770a807"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tomcrypt__private_8h.html#a12ee6e955851d0daff84581e3770a807">der_length_asn1_identifier</a> (const ltc_asn1_list *id, unsigned long *idlen)</td></tr>
<tr class="memdesc:a12ee6e955851d0daff84581e3770a807"><td class="mdescLeft">&#160;</td><td class="mdescRight">Determine the length required when encoding the ASN.1 Identifier.  <a href="#a12ee6e955851d0daff84581e3770a807">More...</a><br /></td></tr>
<tr class="separator:a12ee6e955851d0daff84581e3770a807"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae0b6c1f1188a5aa201aa84de9a659550"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tomcrypt__private_8h.html#ae0b6c1f1188a5aa201aa84de9a659550">der_encode_asn1_length</a> (unsigned long <a class="el" href="pmac__init_8c.html#afed088663f8704004425cdae2120b9b3">len</a>, unsigned char *out, unsigned long *outlen)</td></tr>
<tr class="memdesc:ae0b6c1f1188a5aa201aa84de9a659550"><td class="mdescLeft">&#160;</td><td class="mdescRight">Encode the ASN.1 length field.  <a href="#ae0b6c1f1188a5aa201aa84de9a659550">More...</a><br /></td></tr>
<tr class="separator:ae0b6c1f1188a5aa201aa84de9a659550"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af90423764098b8876368d0984d96053a"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tomcrypt__private_8h.html#af90423764098b8876368d0984d96053a">der_decode_asn1_length</a> (const unsigned char *in, unsigned long *inlen, unsigned long *outlen)</td></tr>
<tr class="memdesc:af90423764098b8876368d0984d96053a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Decode the ASN.1 Length field.  <a href="#af90423764098b8876368d0984d96053a">More...</a><br /></td></tr>
<tr class="separator:af90423764098b8876368d0984d96053a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8999e23c66cda0d777570e54f3a5c795"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tomcrypt__private_8h.html#a8999e23c66cda0d777570e54f3a5c795">der_length_asn1_length</a> (unsigned long <a class="el" href="pmac__init_8c.html#afed088663f8704004425cdae2120b9b3">len</a>, unsigned long *outlen)</td></tr>
<tr class="memdesc:a8999e23c66cda0d777570e54f3a5c795"><td class="mdescLeft">&#160;</td><td class="mdescRight">Determine the length required to encode len in the ASN.1 length field.  <a href="#a8999e23c66cda0d777570e54f3a5c795">More...</a><br /></td></tr>
<tr class="separator:a8999e23c66cda0d777570e54f3a5c795"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad3804ae56675e41a9d142c62d6c3bb2d"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tomcrypt__private_8h.html#ad3804ae56675e41a9d142c62d6c3bb2d">der_length_sequence_ex</a> (const ltc_asn1_list *list, unsigned long inlen, unsigned long *outlen, unsigned long *payloadlen)</td></tr>
<tr class="separator:ad3804ae56675e41a9d142c62d6c3bb2d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab5141cf36663054d9ec6e46ed6909fce"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tomcrypt__private_8h.html#ab5141cf36663054d9ec6e46ed6909fce">der_decode_sequence_multi_ex</a> (const unsigned char *in, unsigned long inlen, unsigned int flags,...)</td></tr>
<tr class="memdesc:ab5141cf36663054d9ec6e46ed6909fce"><td class="mdescLeft">&#160;</td><td class="mdescRight">Decode a SEQUENCE type using a VA list.  <a href="#ab5141cf36663054d9ec6e46ed6909fce">More...</a><br /></td></tr>
<tr class="separator:ab5141cf36663054d9ec6e46ed6909fce"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae8e05b29e9cd248f6a81450eefd22163"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tomcrypt__private_8h.html#ae8e05b29e9cd248f6a81450eefd22163">der_teletex_char_encode</a> (int <a class="el" href="khazad_8c.html#a86ea50de5a3e0ae87762f4298d35284c">c</a>)</td></tr>
<tr class="separator:ae8e05b29e9cd248f6a81450eefd22163"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab300884b978bd66022a4003ef5a1f2a1"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tomcrypt__private_8h.html#ab300884b978bd66022a4003ef5a1f2a1">der_teletex_value_decode</a> (int v)</td></tr>
<tr class="separator:ab300884b978bd66022a4003ef5a1f2a1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a400ea59efe4834eac94e65230dd59822"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tomcrypt__private_8h.html#a400ea59efe4834eac94e65230dd59822">der_utf8_valid_char</a> (const wchar_t <a class="el" href="khazad_8c.html#a86ea50de5a3e0ae87762f4298d35284c">c</a>)</td></tr>
<tr class="memdesc:a400ea59efe4834eac94e65230dd59822"><td class="mdescLeft">&#160;</td><td class="mdescRight">Test whether the given code point is valid character.  <a href="#a400ea59efe4834eac94e65230dd59822">More...</a><br /></td></tr>
<tr class="separator:a400ea59efe4834eac94e65230dd59822"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a69644f00dd0825d15c8c799c46ef6ece"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tomcrypt__private_8h.html#a69644f00dd0825d15c8c799c46ef6ece">x509_encode_subject_public_key_info</a> (unsigned char *out, unsigned long *outlen, unsigned int algorithm, const void *public_key, unsigned long public_key_len, ltc_asn1_type parameters_type, ltc_asn1_list *parameters, unsigned long parameters_len)</td></tr>
<tr class="memdesc:a69644f00dd0825d15c8c799c46ef6ece"><td class="mdescLeft">&#160;</td><td class="mdescRight">Encode a SubjectPublicKeyInfo.  <a href="#a69644f00dd0825d15c8c799c46ef6ece">More...</a><br /></td></tr>
<tr class="separator:a69644f00dd0825d15c8c799c46ef6ece"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aec241d5f502a71d5a72188a42d6be5f0"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tomcrypt__private_8h.html#aec241d5f502a71d5a72188a42d6be5f0">x509_decode_subject_public_key_info</a> (const unsigned char *in, unsigned long inlen, unsigned int algorithm, void *public_key, unsigned long *public_key_len, ltc_asn1_type parameters_type, ltc_asn1_list *parameters, unsigned long *parameters_len)</td></tr>
<tr class="memdesc:aec241d5f502a71d5a72188a42d6be5f0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Decode a SubjectPublicKeyInfo.  <a href="#aec241d5f502a71d5a72188a42d6be5f0">More...</a><br /></td></tr>
<tr class="separator:aec241d5f502a71d5a72188a42d6be5f0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4283c0cfa77d37ab8add0b7c531d3d6f"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tomcrypt__private_8h.html#a4283c0cfa77d37ab8add0b7c531d3d6f">pk_oid_cmp_with_ulong</a> (const char *o1, const unsigned long *o2, unsigned long o2size)</td></tr>
<tr class="separator:a4283c0cfa77d37ab8add0b7c531d3d6f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaa860b1fbc776e0760df8934a6aa245a"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tomcrypt__private_8h.html#aaa860b1fbc776e0760df8934a6aa245a">pk_oid_cmp_with_asn1</a> (const char *o1, const ltc_asn1_list *o2)</td></tr>
<tr class="separator:aaa860b1fbc776e0760df8934a6aa245a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1b0d8fcf234d94638b2554ccea725003"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tomcrypt__private_8h.html#a1b0d8fcf234d94638b2554ccea725003">pkcs8_decode_flexi</a> (const unsigned char *in, unsigned long inlen, const void *pwd, unsigned long pwdlen, ltc_asn1_list **decoded_list)</td></tr>
<tr class="memdesc:a1b0d8fcf234d94638b2554ccea725003"><td class="mdescLeft">&#160;</td><td class="mdescRight">PKCS#8 decrypt if necessary &amp; flexi-decode.  <a href="#a1b0d8fcf234d94638b2554ccea725003">More...</a><br /></td></tr>
<tr class="separator:a1b0d8fcf234d94638b2554ccea725003"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af7de8585646f421393f3c744654ae587"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tomcrypt__private_8h.html#af7de8585646f421393f3c744654ae587">pkcs12_utf8_to_utf16</a> (const unsigned char *in, unsigned long inlen, unsigned char *out, unsigned long *outlen)</td></tr>
<tr class="separator:af7de8585646f421393f3c744654ae587"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a362c9fba9251fa6d35445f4ccae24fe8"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tomcrypt__private_8h.html#a362c9fba9251fa6d35445f4ccae24fe8">pkcs12_kdf</a> (int hash_id, const unsigned char *pw, unsigned long pwlen, const unsigned char *salt, unsigned long saltlen, unsigned int iterations, unsigned char purpose, unsigned char *out, unsigned long outlen)</td></tr>
<tr class="separator:a362c9fba9251fa6d35445f4ccae24fe8"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a45c19266abadb7a8a27dc330b000cfc4"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="structltc__dh__set__type.html">ltc_dh_set_type</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tomcrypt__private_8h.html#a45c19266abadb7a8a27dc330b000cfc4">ltc_dh_sets</a> []</td></tr>
<tr class="separator:a45c19266abadb7a8a27dc330b000cfc4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a411f77ba949e37dca9c1ef1e43127cb1"><td class="memItemLeft" align="right" valign="top">const ltc_asn1_type&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tomcrypt__private_8h.html#a411f77ba949e37dca9c1ef1e43127cb1">der_asn1_tag_to_type_map</a> []</td></tr>
<tr class="memdesc:a411f77ba949e37dca9c1ef1e43127cb1"><td class="mdescLeft">&#160;</td><td class="mdescRight">A Map from ASN.1 Tags to ltc_asn1_type.  <a href="#a411f77ba949e37dca9c1ef1e43127cb1">More...</a><br /></td></tr>
<tr class="separator:a411f77ba949e37dca9c1ef1e43127cb1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6ad32891f744af2b205041ad6dc5bce0"><td class="memItemLeft" align="right" valign="top">const unsigned long&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tomcrypt__private_8h.html#a6ad32891f744af2b205041ad6dc5bce0">der_asn1_tag_to_type_map_sz</a></td></tr>
<tr class="separator:a6ad32891f744af2b205041ad6dc5bce0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6306ca88074facac89ee0f6c04cbf2f2"><td class="memItemLeft" align="right" valign="top">const int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tomcrypt__private_8h.html#a6306ca88074facac89ee0f6c04cbf2f2">der_asn1_type_to_identifier_map</a> []</td></tr>
<tr class="memdesc:a6306ca88074facac89ee0f6c04cbf2f2"><td class="mdescLeft">&#160;</td><td class="mdescRight">A Map from ltc_asn1_type to the regularly used ASN.1 identifier.  <a href="#a6306ca88074facac89ee0f6c04cbf2f2">More...</a><br /></td></tr>
<tr class="separator:a6306ca88074facac89ee0f6c04cbf2f2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae8d2a220c8f5b51d2db97b0382a9f206"><td class="memItemLeft" align="right" valign="top">const unsigned long&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tomcrypt__private_8h.html#ae8d2a220c8f5b51d2db97b0382a9f206">der_asn1_type_to_identifier_map_sz</a></td></tr>
<tr class="separator:ae8d2a220c8f5b51d2db97b0382a9f206"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Macro Definition Documentation</h2>
<a id="ae463e0ea9b84288e301f114d43ef3e9a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae463e0ea9b84288e301f114d43ef3e9a">&#9670;&nbsp;</a></span>_LTC_PRNG_EXPORT</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define _LTC_PRNG_EXPORT</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">which</td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line"><span class="keywordtype">int</span> which ## _export(<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *out, <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> *outlen, <a class="code" href="structprng__state.html">prng_state</a> *prng)      \</div><div class="line">{                                                                                      \</div><div class="line">   unsigned <span class="keywordtype">long</span> <a class="code" href="ocb__init_8c.html#afed088663f8704004425cdae2120b9b3">len</a> = which ## _desc.export_size;                                     <a class="code" href="tomcrypt__argchk_8h.html#a683da3e041e49f196318b6ea951414ba">\</a></div><div class="line"><a class="code" href="tomcrypt__argchk_8h.html#a683da3e041e49f196318b6ea951414ba">                                                                                       \</a></div><div class="line"><a class="code" href="tomcrypt__argchk_8h.html#a683da3e041e49f196318b6ea951414ba">   LTC_ARGCHK</a>(prng   != NULL);                                                         \</div><div class="line">   LTC_ARGCHK(out    != NULL);                                                         \</div><div class="line">   LTC_ARGCHK(outlen != NULL);                                                         \</div><div class="line">                                                                                       \</div><div class="line">   if (*outlen &lt; <a class="code" href="ocb__init_8c.html#afed088663f8704004425cdae2120b9b3">len</a>) {                                                                \</div><div class="line">      *outlen = <a class="code" href="ocb__init_8c.html#afed088663f8704004425cdae2120b9b3">len</a>;                                                                   \</div><div class="line">      return <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06caccd878f5599f3036ffe759dbe1a1ac16">CRYPT_BUFFER_OVERFLOW</a>;                                                    \</div><div class="line">   }                                                                                   \</div><div class="line">                                                                                       \</div><div class="line">   if (which ## _read(out, <a class="code" href="ocb__init_8c.html#afed088663f8704004425cdae2120b9b3">len</a>, prng) != <a class="code" href="ocb__init_8c.html#afed088663f8704004425cdae2120b9b3">len</a>) {                                        \</div><div class="line">      return <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06ca68eea82b3b71f23031cd94b10c920bf3">CRYPT_ERROR_READPRNG</a>;                                                     \</div><div class="line">   }                                                                                   \</div><div class="line">                                                                                       \</div><div class="line">   *outlen = <a class="code" href="ocb__init_8c.html#afed088663f8704004425cdae2120b9b3">len</a>;                                                                      \</div><div class="line">   return <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>;                                                                    \</div><div class="line">}</div><div class="ttc" id="tomcrypt_8h_html_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334"><div class="ttname"><a href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a></div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt_8h_source.html#l00042">tomcrypt.h:42</a></div></div>
<div class="ttc" id="tomcrypt__argchk_8h_html_a683da3e041e49f196318b6ea951414ba"><div class="ttname"><a href="tomcrypt__argchk_8h.html#a683da3e041e49f196318b6ea951414ba">LTC_ARGCHK</a></div><div class="ttdeci">#define LTC_ARGCHK(x)</div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt__argchk_8h_source.html#l00019">tomcrypt_argchk.h:19</a></div></div>
<div class="ttc" id="ocb__init_8c_html_afed088663f8704004425cdae2120b9b3"><div class="ttname"><a href="ocb__init_8c.html#afed088663f8704004425cdae2120b9b3">len</a></div><div class="ttdeci">int len</div><div class="ttdef"><b>Definition:</b> <a href="ocb__init_8c_source.html#l00019">ocb_init.c:19</a></div></div>
<div class="ttc" id="structprng__state_html"><div class="ttname"><a href="structprng__state.html">prng_state</a></div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt__prng_8h_source.html#l00057">tomcrypt_prng.h:57</a></div></div>
<div class="ttc" id="tomcrypt_8h_html_adc29c2ff13d900c2f185ee95427fb06caccd878f5599f3036ffe759dbe1a1ac16"><div class="ttname"><a href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06caccd878f5599f3036ffe759dbe1a1ac16">CRYPT_BUFFER_OVERFLOW</a></div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt_8h_source.html#l00050">tomcrypt.h:50</a></div></div>
<div class="ttc" id="tomcrypt_8h_html_adc29c2ff13d900c2f185ee95427fb06ca68eea82b3b71f23031cd94b10c920bf3"><div class="ttname"><a href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06ca68eea82b3b71f23031cd94b10c920bf3">CRYPT_ERROR_READPRNG</a></div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt_8h_source.html#l00054">tomcrypt.h:54</a></div></div>
</div><!-- fragment -->
<p class="definition">Definition at line <a class="el" href="tomcrypt__private_8h_source.html#l00373">373</a> of file <a class="el" href="tomcrypt__private_8h_source.html">tomcrypt_private.h</a>.</p>

</div>
</div>
<a id="ae7c734d30e56dd5f0306f54246d47c2b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae7c734d30e56dd5f0306f54246d47c2b">&#9670;&nbsp;</a></span>HASH_PROCESS</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define HASH_PROCESS</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">func_name, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">compress_name, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">state_var, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">block_size&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="tomcrypt__private_8h_source.html#l00076">76</a> of file <a class="el" href="tomcrypt__private_8h_source.html">tomcrypt_private.h</a>.</p>

</div>
</div>
<a id="a896c8b07a35ff2799061855f08a8325a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a896c8b07a35ff2799061855f08a8325a">&#9670;&nbsp;</a></span>LTC_ASN1_IS_TYPE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define LTC_ASN1_IS_TYPE</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">e, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">t&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td>&#160;&#160;&#160;(((e) != NULL) &amp;&amp; ((e)-&gt;type == (t)))</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="tomcrypt__private_8h_source.html#l00302">302</a> of file <a class="el" href="tomcrypt__private_8h_source.html">tomcrypt_private.h</a>.</p>

</div>
</div>
<a id="a319cb143574102827d3b0055ded27533"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a319cb143574102827d3b0055ded27533">&#9670;&nbsp;</a></span>LTC_BYTE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define LTC_BYTE</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">x, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">n&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td>&#160;&#160;&#160;(((x) &gt;&gt; (8 * (n))) &amp; 255)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="tomcrypt__private_8h_source.html#l00399">399</a> of file <a class="el" href="tomcrypt__private_8h_source.html">tomcrypt_private.h</a>.</p>

</div>
</div>
<a id="a2b8e12593fe11f8eaeace6ce0fcc7566"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2b8e12593fe11f8eaeace6ce0fcc7566">&#9670;&nbsp;</a></span>LTC_PAD_MASK</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define LTC_PAD_MASK&#160;&#160;&#160;(0xF000U)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="tomcrypt__private_8h_source.html#l00016">16</a> of file <a class="el" href="tomcrypt__private_8h_source.html">tomcrypt_private.h</a>.</p>

</div>
</div>
<a id="abeb03f01d3819863d5de470797c629de"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abeb03f01d3819863d5de470797c629de">&#9670;&nbsp;</a></span>mp_2expt</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define mp_2expt</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">a, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">b&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td>&#160;&#160;&#160;<a class="el" href="tfm__desc_8c.html#a4f1673caee67fa1b6f8b745661a68eb1">ltc_mp.twoexpt</a>(a, b)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="tomcrypt__private_8h_source.html#l00148">148</a> of file <a class="el" href="tomcrypt__private_8h_source.html">tomcrypt_private.h</a>.</p>

</div>
</div>
<a id="a175d04f8aeaa1c3895fe14de6cc0d2db"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a175d04f8aeaa1c3895fe14de6cc0d2db">&#9670;&nbsp;</a></span>mp_add</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define mp_add</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">a, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">b, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><a class="el" href="khazad_8c.html#a86ea50de5a3e0ae87762f4298d35284c">c</a>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td>&#160;&#160;&#160;<a class="el" href="tfm__desc_8c.html#a274c97efa9f26a6d22ca17dbcb52e58b">ltc_mp.add</a>(a, b, <a class="el" href="khazad_8c.html#a86ea50de5a3e0ae87762f4298d35284c">c</a>)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="tomcrypt__private_8h_source.html#l00156">156</a> of file <a class="el" href="tomcrypt__private_8h_source.html">tomcrypt_private.h</a>.</p>

</div>
</div>
<a id="a69f09e7351d696b635ffbc9912684ab4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a69f09e7351d696b635ffbc9912684ab4">&#9670;&nbsp;</a></span>mp_add_d</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define mp_add_d</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">a, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">b, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><a class="el" href="khazad_8c.html#a86ea50de5a3e0ae87762f4298d35284c">c</a>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td>&#160;&#160;&#160;<a class="el" href="tfm__desc_8c.html#a9cce188374e60ab500e0e658738eb0ce">ltc_mp.addi</a>(a, b, <a class="el" href="khazad_8c.html#a86ea50de5a3e0ae87762f4298d35284c">c</a>)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="tomcrypt__private_8h_source.html#l00157">157</a> of file <a class="el" href="tomcrypt__private_8h_source.html">tomcrypt_private.h</a>.</p>

</div>
</div>
<a id="a3cc86fdd66c67023afe490b3534d459b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3cc86fdd66c67023afe490b3534d459b">&#9670;&nbsp;</a></span>mp_addmod</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define mp_addmod</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">a, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">b, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><a class="el" href="khazad_8c.html#a86ea50de5a3e0ae87762f4298d35284c">c</a>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">d&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td>&#160;&#160;&#160;<a class="el" href="tfm__desc_8c.html#a1197b0ad15639bfc3fc66314c2ce8527">ltc_mp.addmod</a>(a, b, <a class="el" href="khazad_8c.html#a86ea50de5a3e0ae87762f4298d35284c">c</a>, d)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="tomcrypt__private_8h_source.html#l00171">171</a> of file <a class="el" href="tomcrypt__private_8h_source.html">tomcrypt_private.h</a>.</p>

</div>
</div>
<a id="ad0d492c0676e4944383a7ae9e9ebd63b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad0d492c0676e4944383a7ae9e9ebd63b">&#9670;&nbsp;</a></span>mp_cleanup_multi</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define mp_cleanup_multi&#160;&#160;&#160;<a class="el" href="multi_8c.html#a53eb69feb3f6ec63778a845a07771762">ltc_cleanup_multi</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="tomcrypt__private_8h_source.html#l00133">133</a> of file <a class="el" href="tomcrypt__private_8h_source.html">tomcrypt_private.h</a>.</p>

</div>
</div>
<a id="ab05b6b59fa182b81f5f990d5621229f6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab05b6b59fa182b81f5f990d5621229f6">&#9670;&nbsp;</a></span>mp_clear</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define mp_clear</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">a</td><td>)</td>
          <td>&#160;&#160;&#160;<a class="el" href="tfm__desc_8c.html#a9626887f45edba884c412234edf7d1d6">ltc_mp.deinit</a>(a)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="tomcrypt__private_8h_source.html#l00131">131</a> of file <a class="el" href="tomcrypt__private_8h_source.html">tomcrypt_private.h</a>.</p>

</div>
</div>
<a id="aad5c8a3112b3e4613f9efc86692c43cb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aad5c8a3112b3e4613f9efc86692c43cb">&#9670;&nbsp;</a></span>mp_clear_multi</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define mp_clear_multi&#160;&#160;&#160;<a class="el" href="multi_8c.html#abcb92ed327d5fcf9bf9bcff2a6a3107a">ltc_deinit_multi</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="tomcrypt__private_8h_source.html#l00132">132</a> of file <a class="el" href="tomcrypt__private_8h_source.html">tomcrypt_private.h</a>.</p>

</div>
</div>
<a id="a62ea02fbe7dd2d456e49520264d775ee"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a62ea02fbe7dd2d456e49520264d775ee">&#9670;&nbsp;</a></span>mp_cmp</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define mp_cmp</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">a, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">b&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td>&#160;&#160;&#160;<a class="el" href="tfm__desc_8c.html#aecfc62c80bd6acc7a95d1391ad8252f7">ltc_mp.compare</a>(a, b)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="tomcrypt__private_8h_source.html#l00144">144</a> of file <a class="el" href="tomcrypt__private_8h_source.html">tomcrypt_private.h</a>.</p>

</div>
</div>
<a id="a6ce44f2e6f872565a468b67d9a93dc28"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6ce44f2e6f872565a468b67d9a93dc28">&#9670;&nbsp;</a></span>mp_cmp_d</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define mp_cmp_d</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">a, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">b&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td>&#160;&#160;&#160;<a class="el" href="tfm__desc_8c.html#aee3f861609cd9406655be85087a7bb06">ltc_mp.compare_d</a>(a, b)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="tomcrypt__private_8h_source.html#l00145">145</a> of file <a class="el" href="tomcrypt__private_8h_source.html">tomcrypt_private.h</a>.</p>

</div>
</div>
<a id="a566a41699158970f4d7a0554081706dd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a566a41699158970f4d7a0554081706dd">&#9670;&nbsp;</a></span>mp_cnt_lsb</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define mp_cnt_lsb</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">a</td><td>)</td>
          <td>&#160;&#160;&#160;<a class="el" href="tfm__desc_8c.html#a2506b220df2c67f8b9969f6c627c84a1">ltc_mp.count_lsb_bits</a>(a)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="tomcrypt__private_8h_source.html#l00147">147</a> of file <a class="el" href="tomcrypt__private_8h_source.html">tomcrypt_private.h</a>.</p>

</div>
</div>
<a id="afbb35bc8f920448d169ddc83a4308840"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afbb35bc8f920448d169ddc83a4308840">&#9670;&nbsp;</a></span>mp_copy</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define mp_copy</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">a, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">b&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td>&#160;&#160;&#160;<a class="el" href="tfm__desc_8c.html#ad88f68a4e6f0c7334e93eebf7ddbb2d3">ltc_mp.copy</a>(a, b)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="tomcrypt__private_8h_source.html#l00137">137</a> of file <a class="el" href="tomcrypt__private_8h_source.html">tomcrypt_private.h</a>.</p>

</div>
</div>
<a id="afa1671e20e699f66319ed2e8d9119e7e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afa1671e20e699f66319ed2e8d9119e7e">&#9670;&nbsp;</a></span>mp_count_bits</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define mp_count_bits</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">a</td><td>)</td>
          <td>&#160;&#160;&#160;<a class="el" href="tfm__desc_8c.html#a55e39d3b1adb176ed84c1211a7123071">ltc_mp.count_bits</a>(a)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="tomcrypt__private_8h_source.html#l00146">146</a> of file <a class="el" href="tomcrypt__private_8h_source.html">tomcrypt_private.h</a>.</p>

</div>
</div>
<a id="ab8e25bc0c3ace6218c5c7d49198405c9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab8e25bc0c3ace6218c5c7d49198405c9">&#9670;&nbsp;</a></span>MP_DIGIT_BIT</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MP_DIGIT_BIT&#160;&#160;&#160;ltc_mp.bits_per_digit</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="tomcrypt__private_8h_source.html#l00126">126</a> of file <a class="el" href="tomcrypt__private_8h_source.html">tomcrypt_private.h</a>.</p>

</div>
</div>
<a id="a861721ee02d3b5d84328090f3058f7c3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a861721ee02d3b5d84328090f3058f7c3">&#9670;&nbsp;</a></span>mp_div</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define mp_div</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">a, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">b, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><a class="el" href="khazad_8c.html#a86ea50de5a3e0ae87762f4298d35284c">c</a>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">d&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td>&#160;&#160;&#160;ltc_mp.mpdiv(a, b, <a class="el" href="khazad_8c.html#a86ea50de5a3e0ae87762f4298d35284c">c</a>, d)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="tomcrypt__private_8h_source.html#l00164">164</a> of file <a class="el" href="tomcrypt__private_8h_source.html">tomcrypt_private.h</a>.</p>

</div>
</div>
<a id="aec841464b436981f5758a49c561f39fe"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aec841464b436981f5758a49c561f39fe">&#9670;&nbsp;</a></span>mp_div_2</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define mp_div_2</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">a, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">b&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td>&#160;&#160;&#160;<a class="el" href="tfm__desc_8c.html#a38e564335cd5493b0e02969fda1c73a0">ltc_mp.div_2</a>(a, b)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="tomcrypt__private_8h_source.html#l00165">165</a> of file <a class="el" href="tomcrypt__private_8h_source.html">tomcrypt_private.h</a>.</p>

</div>
</div>
<a id="a16c03b9a12fc6832ae878eabb57e13cc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a16c03b9a12fc6832ae878eabb57e13cc">&#9670;&nbsp;</a></span>mp_exch</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define mp_exch</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">a, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">b&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td>&#160;&#160;&#160;do { void *ABC__tmp = a; a = b; b = ABC__tmp; } while(0)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="tomcrypt__private_8h_source.html#l00187">187</a> of file <a class="el" href="tomcrypt__private_8h_source.html">tomcrypt_private.h</a>.</p>

</div>
</div>
<a id="a4fb1221fbef91bf8163390e3cfb82085"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4fb1221fbef91bf8163390e3cfb82085">&#9670;&nbsp;</a></span>mp_exptmod</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define mp_exptmod</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">a, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">b, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><a class="el" href="khazad_8c.html#a86ea50de5a3e0ae87762f4298d35284c">c</a>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">d&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td>&#160;&#160;&#160;<a class="el" href="tfm__desc_8c.html#a251a26828a3c68dff4bbe01f54470275">ltc_mp.exptmod</a>(a,b,<a class="el" href="khazad_8c.html#a86ea50de5a3e0ae87762f4298d35284c">c</a>,d)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="tomcrypt__private_8h_source.html#l00182">182</a> of file <a class="el" href="tomcrypt__private_8h_source.html">tomcrypt_private.h</a>.</p>

</div>
</div>
<a id="ad9deb5f35c296a1cd7ae37f4e4e210f4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad9deb5f35c296a1cd7ae37f4e4e210f4">&#9670;&nbsp;</a></span>mp_gcd</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define mp_gcd</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">a, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">b, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><a class="el" href="khazad_8c.html#a86ea50de5a3e0ae87762f4298d35284c">c</a>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td>&#160;&#160;&#160;<a class="el" href="tfm__desc_8c.html#afb49bbeaad5528b5afd96667e06c19ef">ltc_mp.gcd</a>(a, b, <a class="el" href="khazad_8c.html#a86ea50de5a3e0ae87762f4298d35284c">c</a>)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="tomcrypt__private_8h_source.html#l00168">168</a> of file <a class="el" href="tomcrypt__private_8h_source.html">tomcrypt_private.h</a>.</p>

</div>
</div>
<a id="a62267879327e26468c45bbd83f7f2669"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a62267879327e26468c45bbd83f7f2669">&#9670;&nbsp;</a></span>mp_get_digit</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define mp_get_digit</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">a, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">n&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td>&#160;&#160;&#160;<a class="el" href="tfm__desc_8c.html#a6171f32e40e45f55caf4a7cb475e866c">ltc_mp.get_digit</a>(a, n)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="tomcrypt__private_8h_source.html#l00142">142</a> of file <a class="el" href="tomcrypt__private_8h_source.html">tomcrypt_private.h</a>.</p>

</div>
</div>
<a id="ae51a279d51ab72f09d9f97335b8be6c9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae51a279d51ab72f09d9f97335b8be6c9">&#9670;&nbsp;</a></span>mp_get_digit_count</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define mp_get_digit_count</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">a</td><td>)</td>
          <td>&#160;&#160;&#160;<a class="el" href="tfm__desc_8c.html#a10c8ab52ee86746d3389aa2400c88ac2">ltc_mp.get_digit_count</a>(a)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="tomcrypt__private_8h_source.html#l00143">143</a> of file <a class="el" href="tomcrypt__private_8h_source.html">tomcrypt_private.h</a>.</p>

</div>
</div>
<a id="a4e68c807adc159c7553da37ce38196b2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4e68c807adc159c7553da37ce38196b2">&#9670;&nbsp;</a></span>mp_get_int</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define mp_get_int</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">a</td><td>)</td>
          <td>&#160;&#160;&#160;<a class="el" href="tfm__desc_8c.html#ac31838ab831d4094fe109d327019548c">ltc_mp.get_int</a>(a)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="tomcrypt__private_8h_source.html#l00141">141</a> of file <a class="el" href="tomcrypt__private_8h_source.html">tomcrypt_private.h</a>.</p>

</div>
</div>
<a id="aff03c4f22c68d651747055048c509cf3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aff03c4f22c68d651747055048c509cf3">&#9670;&nbsp;</a></span>mp_init</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define mp_init</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">a</td><td>)</td>
          <td>&#160;&#160;&#160;<a class="el" href="tfm__desc_8c.html#a4f8948d7c94899bf8ddee4721114d593">ltc_mp.init</a>(a)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="tomcrypt__private_8h_source.html#l00129">129</a> of file <a class="el" href="tomcrypt__private_8h_source.html">tomcrypt_private.h</a>.</p>

</div>
</div>
<a id="ad2f4da76a1604a39a01d9366dc0ea892"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad2f4da76a1604a39a01d9366dc0ea892">&#9670;&nbsp;</a></span>mp_init_copy</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define mp_init_copy</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">a, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">b&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td>&#160;&#160;&#160;<a class="el" href="tfm__desc_8c.html#a9c0dddd7edf258f69ca346540f3da61a">ltc_mp.init_copy</a>(a, b)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="tomcrypt__private_8h_source.html#l00134">134</a> of file <a class="el" href="tomcrypt__private_8h_source.html">tomcrypt_private.h</a>.</p>

</div>
</div>
<a id="adb6322247b1a4f0347219acab3120bd3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adb6322247b1a4f0347219acab3120bd3">&#9670;&nbsp;</a></span>mp_init_multi</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define mp_init_multi&#160;&#160;&#160;<a class="el" href="multi_8c.html#a327161b10428b234d74713b8a08acb2a">ltc_init_multi</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="tomcrypt__private_8h_source.html#l00130">130</a> of file <a class="el" href="tomcrypt__private_8h_source.html">tomcrypt_private.h</a>.</p>

</div>
</div>
<a id="a8be707236375351ab194f908c8ba9233"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8be707236375351ab194f908c8ba9233">&#9670;&nbsp;</a></span>mp_invmod</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define mp_invmod</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">a, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">b, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><a class="el" href="khazad_8c.html#a86ea50de5a3e0ae87762f4298d35284c">c</a>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td>&#160;&#160;&#160;<a class="el" href="tfm__desc_8c.html#ac982ab06185a4919fdd77d7ab0fd8093">ltc_mp.invmod</a>(a, b, <a class="el" href="khazad_8c.html#a86ea50de5a3e0ae87762f4298d35284c">c</a>)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="tomcrypt__private_8h_source.html#l00175">175</a> of file <a class="el" href="tomcrypt__private_8h_source.html">tomcrypt_private.h</a>.</p>

</div>
</div>
<a id="a93ed39c257831509afc74f2b6da66ae7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a93ed39c257831509afc74f2b6da66ae7">&#9670;&nbsp;</a></span>mp_isodd</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define mp_isodd</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">a</td><td>)</td>
          <td>&#160;&#160;&#160;(<a class="el" href="tomcrypt__private_8h.html#ae51a279d51ab72f09d9f97335b8be6c9">mp_get_digit_count</a>(a) &gt; 0 ? (<a class="el" href="tomcrypt__private_8h.html#a62267879327e26468c45bbd83f7f2669">mp_get_digit</a>(a, 0) &amp; 1 ? <a class="el" href="tomcrypt__math_8h.html#acc2da047f8fb30a3e2b2403aac617fe0">LTC_MP_YES</a> : <a class="el" href="tomcrypt__math_8h.html#a40f1119339954fb273ecb35e48c1d569">LTC_MP_NO</a>) : <a class="el" href="tomcrypt__math_8h.html#a40f1119339954fb273ecb35e48c1d569">LTC_MP_NO</a>)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="tomcrypt__private_8h_source.html#l00186">186</a> of file <a class="el" href="tomcrypt__private_8h_source.html">tomcrypt_private.h</a>.</p>

</div>
</div>
<a id="a910040068490f9f6e5185c970ab869c9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a910040068490f9f6e5185c970ab869c9">&#9670;&nbsp;</a></span>mp_iszero</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define mp_iszero</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">a</td><td>)</td>
          <td>&#160;&#160;&#160;(<a class="el" href="tomcrypt__private_8h.html#a6ce44f2e6f872565a468b67d9a93dc28">mp_cmp_d</a>(a, 0) == <a class="el" href="tomcrypt__math_8h.html#a035a31bde4f31419eb259e36e5776607">LTC_MP_EQ</a> ? <a class="el" href="tomcrypt__math_8h.html#acc2da047f8fb30a3e2b2403aac617fe0">LTC_MP_YES</a> : <a class="el" href="tomcrypt__math_8h.html#a40f1119339954fb273ecb35e48c1d569">LTC_MP_NO</a>)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="tomcrypt__private_8h_source.html#l00185">185</a> of file <a class="el" href="tomcrypt__private_8h_source.html">tomcrypt_private.h</a>.</p>

</div>
</div>
<a id="a42ca6ad7676c236e06ee8b53e278a1a2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a42ca6ad7676c236e06ee8b53e278a1a2">&#9670;&nbsp;</a></span>mp_lcm</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define mp_lcm</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">a, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">b, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><a class="el" href="khazad_8c.html#a86ea50de5a3e0ae87762f4298d35284c">c</a>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td>&#160;&#160;&#160;<a class="el" href="tfm__desc_8c.html#ade2a62ec3e6aa65016ad994bdae98424">ltc_mp.lcm</a>(a, b, <a class="el" href="khazad_8c.html#a86ea50de5a3e0ae87762f4298d35284c">c</a>)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="tomcrypt__private_8h_source.html#l00169">169</a> of file <a class="el" href="tomcrypt__private_8h_source.html">tomcrypt_private.h</a>.</p>

</div>
</div>
<a id="ac7deed6f00e289706070b16f98c430fe"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac7deed6f00e289706070b16f98c430fe">&#9670;&nbsp;</a></span>mp_mod</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define mp_mod</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">a, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">b, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><a class="el" href="khazad_8c.html#a86ea50de5a3e0ae87762f4298d35284c">c</a>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td>&#160;&#160;&#160;ltc_mp.mpdiv(a, b, NULL, <a class="el" href="khazad_8c.html#a86ea50de5a3e0ae87762f4298d35284c">c</a>)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="tomcrypt__private_8h_source.html#l00166">166</a> of file <a class="el" href="tomcrypt__private_8h_source.html">tomcrypt_private.h</a>.</p>

</div>
</div>
<a id="afd41c0725f692174823db3e939b3ac1e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afd41c0725f692174823db3e939b3ac1e">&#9670;&nbsp;</a></span>mp_mod_d</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define mp_mod_d</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">a, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">b, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><a class="el" href="khazad_8c.html#a86ea50de5a3e0ae87762f4298d35284c">c</a>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td>&#160;&#160;&#160;<a class="el" href="tfm__desc_8c.html#a825311b5e56f780acb119b19a3cbdca0">ltc_mp.modi</a>(a, b, <a class="el" href="khazad_8c.html#a86ea50de5a3e0ae87762f4298d35284c">c</a>)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="tomcrypt__private_8h_source.html#l00167">167</a> of file <a class="el" href="tomcrypt__private_8h_source.html">tomcrypt_private.h</a>.</p>

</div>
</div>
<a id="ac1935719c005c8bffb7590628e84c024"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac1935719c005c8bffb7590628e84c024">&#9670;&nbsp;</a></span>mp_montgomery_free</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define mp_montgomery_free</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">a</td><td>)</td>
          <td>&#160;&#160;&#160;<a class="el" href="tfm__desc_8c.html#a8d6035f0021cfaf5936a3c37d2cb2427">ltc_mp.montgomery_deinit</a>(a)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="tomcrypt__private_8h_source.html#l00180">180</a> of file <a class="el" href="tomcrypt__private_8h_source.html">tomcrypt_private.h</a>.</p>

</div>
</div>
<a id="a8e30da64ace4410ca56cb110a6fedd19"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8e30da64ace4410ca56cb110a6fedd19">&#9670;&nbsp;</a></span>mp_montgomery_normalization</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define mp_montgomery_normalization</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">a, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">b&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td>&#160;&#160;&#160;<a class="el" href="tfm__desc_8c.html#aa047d6197825069c90f4f89a59f5ed6d">ltc_mp.montgomery_normalization</a>(a, b)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="tomcrypt__private_8h_source.html#l00178">178</a> of file <a class="el" href="tomcrypt__private_8h_source.html">tomcrypt_private.h</a>.</p>

</div>
</div>
<a id="a4201ed2dbae154496e1a2ae9ba8aa7a8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4201ed2dbae154496e1a2ae9ba8aa7a8">&#9670;&nbsp;</a></span>mp_montgomery_reduce</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define mp_montgomery_reduce</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">a, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">b, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><a class="el" href="khazad_8c.html#a86ea50de5a3e0ae87762f4298d35284c">c</a>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td>&#160;&#160;&#160;<a class="el" href="tfm__desc_8c.html#a109a8d07cc14bf2f0bd604a773d7e02c">ltc_mp.montgomery_reduce</a>(a, b, <a class="el" href="khazad_8c.html#a86ea50de5a3e0ae87762f4298d35284c">c</a>)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="tomcrypt__private_8h_source.html#l00179">179</a> of file <a class="el" href="tomcrypt__private_8h_source.html">tomcrypt_private.h</a>.</p>

</div>
</div>
<a id="a42560b136f9c3cf1411a82a8cae6d954"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a42560b136f9c3cf1411a82a8cae6d954">&#9670;&nbsp;</a></span>mp_montgomery_setup</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define mp_montgomery_setup</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">a, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">b&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td>&#160;&#160;&#160;<a class="el" href="tfm__desc_8c.html#a771ef8a9d5b1b2633613bfad28b282c2">ltc_mp.montgomery_setup</a>(a, b)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="tomcrypt__private_8h_source.html#l00177">177</a> of file <a class="el" href="tomcrypt__private_8h_source.html">tomcrypt_private.h</a>.</p>

</div>
</div>
<a id="a7606d2423856b32b09245a2fa1ef34ee"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7606d2423856b32b09245a2fa1ef34ee">&#9670;&nbsp;</a></span>mp_mul</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define mp_mul</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">a, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">b, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><a class="el" href="khazad_8c.html#a86ea50de5a3e0ae87762f4298d35284c">c</a>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td>&#160;&#160;&#160;<a class="el" href="tfm__desc_8c.html#a7050c53d3ede33130b5137ee21872390">ltc_mp.mul</a>(a, b, <a class="el" href="khazad_8c.html#a86ea50de5a3e0ae87762f4298d35284c">c</a>)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="tomcrypt__private_8h_source.html#l00160">160</a> of file <a class="el" href="tomcrypt__private_8h_source.html">tomcrypt_private.h</a>.</p>

</div>
</div>
<a id="a6732f5faae69c8d1305898ca8e2943d5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6732f5faae69c8d1305898ca8e2943d5">&#9670;&nbsp;</a></span>mp_mul_d</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define mp_mul_d</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">a, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">b, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><a class="el" href="khazad_8c.html#a86ea50de5a3e0ae87762f4298d35284c">c</a>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td>&#160;&#160;&#160;<a class="el" href="tfm__desc_8c.html#a1bde65678f43510d80f8851860e15e34">ltc_mp.muli</a>(a, b, <a class="el" href="khazad_8c.html#a86ea50de5a3e0ae87762f4298d35284c">c</a>)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="tomcrypt__private_8h_source.html#l00161">161</a> of file <a class="el" href="tomcrypt__private_8h_source.html">tomcrypt_private.h</a>.</p>

</div>
</div>
<a id="a0c32b20b84951870c7b09f5b6f2679c9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0c32b20b84951870c7b09f5b6f2679c9">&#9670;&nbsp;</a></span>mp_mulmod</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define mp_mulmod</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">a, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">b, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><a class="el" href="khazad_8c.html#a86ea50de5a3e0ae87762f4298d35284c">c</a>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">d&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td>&#160;&#160;&#160;<a class="el" href="tfm__desc_8c.html#a4c6702198a33b0c56f0a886d7c2206c5">ltc_mp.mulmod</a>(a, b, <a class="el" href="khazad_8c.html#a86ea50de5a3e0ae87762f4298d35284c">c</a>, d)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="tomcrypt__private_8h_source.html#l00173">173</a> of file <a class="el" href="tomcrypt__private_8h_source.html">tomcrypt_private.h</a>.</p>

</div>
</div>
<a id="a0a85470068985d2c10a4df85ca54a7d0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0a85470068985d2c10a4df85ca54a7d0">&#9670;&nbsp;</a></span>mp_neg</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define mp_neg</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">a, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">b&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td>&#160;&#160;&#160;<a class="el" href="tfm__desc_8c.html#adc67bac9fd8e42c930369ddabaa5f2db">ltc_mp.neg</a>(a, b)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="tomcrypt__private_8h_source.html#l00136">136</a> of file <a class="el" href="tomcrypt__private_8h_source.html">tomcrypt_private.h</a>.</p>

</div>
</div>
<a id="ab3681f96d55cf707b92d6254f58ea3de"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab3681f96d55cf707b92d6254f58ea3de">&#9670;&nbsp;</a></span>mp_prime_is_prime</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define mp_prime_is_prime</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">a, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">b, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><a class="el" href="khazad_8c.html#a86ea50de5a3e0ae87762f4298d35284c">c</a>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td>&#160;&#160;&#160;<a class="el" href="tfm__desc_8c.html#a48fb4f337851176a7ee5b0836e77d7df">ltc_mp.isprime</a>(a, b, <a class="el" href="khazad_8c.html#a86ea50de5a3e0ae87762f4298d35284c">c</a>)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="tomcrypt__private_8h_source.html#l00183">183</a> of file <a class="el" href="tomcrypt__private_8h_source.html">tomcrypt_private.h</a>.</p>

</div>
</div>
<a id="a9a1503b0adb58db297bc6bfd784b3945"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9a1503b0adb58db297bc6bfd784b3945">&#9670;&nbsp;</a></span>mp_rand</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define mp_rand</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">a, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">b&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td>&#160;&#160;&#160;ltc_mp.rand(a, b)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="tomcrypt__private_8h_source.html#l00191">191</a> of file <a class="el" href="tomcrypt__private_8h_source.html">tomcrypt_private.h</a>.</p>

</div>
</div>
<a id="a12263d4d7da068c2a630d2ffc0c8bc1b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a12263d4d7da068c2a630d2ffc0c8bc1b">&#9670;&nbsp;</a></span>mp_read_radix</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define mp_read_radix</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">a, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">b, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><a class="el" href="khazad_8c.html#a86ea50de5a3e0ae87762f4298d35284c">c</a>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td>&#160;&#160;&#160;<a class="el" href="tfm__desc_8c.html#af84d5b7caaf005f40f924afd8ada2380">ltc_mp.read_radix</a>(a, b, <a class="el" href="khazad_8c.html#a86ea50de5a3e0ae87762f4298d35284c">c</a>)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="tomcrypt__private_8h_source.html#l00150">150</a> of file <a class="el" href="tomcrypt__private_8h_source.html">tomcrypt_private.h</a>.</p>

</div>
</div>
<a id="a9e20e2044bb5a279e27512d1e1b65754"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9e20e2044bb5a279e27512d1e1b65754">&#9670;&nbsp;</a></span>mp_read_unsigned_bin</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define mp_read_unsigned_bin</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">a, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">b, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><a class="el" href="khazad_8c.html#a86ea50de5a3e0ae87762f4298d35284c">c</a>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td>&#160;&#160;&#160;<a class="el" href="tfm__desc_8c.html#a39cf7045cbd39dc7ee5ecdf59dbe3313">ltc_mp.unsigned_read</a>(a, b, <a class="el" href="khazad_8c.html#a86ea50de5a3e0ae87762f4298d35284c">c</a>)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="tomcrypt__private_8h_source.html#l00154">154</a> of file <a class="el" href="tomcrypt__private_8h_source.html">tomcrypt_private.h</a>.</p>

</div>
</div>
<a id="a000b0542ef4ecf639ff69895490fdb8f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a000b0542ef4ecf639ff69895490fdb8f">&#9670;&nbsp;</a></span>mp_set</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define mp_set</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">a, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">b&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td>&#160;&#160;&#160;<a class="el" href="tfm__desc_8c.html#a0b4961498876dba1898ece1416698b10">ltc_mp.set_int</a>(a, b)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="tomcrypt__private_8h_source.html#l00139">139</a> of file <a class="el" href="tomcrypt__private_8h_source.html">tomcrypt_private.h</a>.</p>

</div>
</div>
<a id="ab06bc6503c4faab10b7ce60bef365d65"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab06bc6503c4faab10b7ce60bef365d65">&#9670;&nbsp;</a></span>mp_set_int</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define mp_set_int</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">a, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">b&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td>&#160;&#160;&#160;<a class="el" href="tfm__desc_8c.html#a0b4961498876dba1898ece1416698b10">ltc_mp.set_int</a>(a, b)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="tomcrypt__private_8h_source.html#l00140">140</a> of file <a class="el" href="tomcrypt__private_8h_source.html">tomcrypt_private.h</a>.</p>

</div>
</div>
<a id="aea81d79b5462e99068908d80edb8bd1a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aea81d79b5462e99068908d80edb8bd1a">&#9670;&nbsp;</a></span>mp_sqr</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define mp_sqr</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">a, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">b&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td>&#160;&#160;&#160;<a class="el" href="tfm__desc_8c.html#acb23c57b2c947a4345287b337fa78764">ltc_mp.sqr</a>(a, b)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="tomcrypt__private_8h_source.html#l00162">162</a> of file <a class="el" href="tomcrypt__private_8h_source.html">tomcrypt_private.h</a>.</p>

</div>
</div>
<a id="a6542bece10f5cf20b6c754646c20fcb4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6542bece10f5cf20b6c754646c20fcb4">&#9670;&nbsp;</a></span>mp_sqrmod</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define mp_sqrmod</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">a, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">b, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><a class="el" href="khazad_8c.html#a86ea50de5a3e0ae87762f4298d35284c">c</a>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td>&#160;&#160;&#160;<a class="el" href="tfm__desc_8c.html#a2a2ed54ac95cb81e7a744b060eeb34af">ltc_mp.sqrmod</a>(a, b, <a class="el" href="khazad_8c.html#a86ea50de5a3e0ae87762f4298d35284c">c</a>)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="tomcrypt__private_8h_source.html#l00174">174</a> of file <a class="el" href="tomcrypt__private_8h_source.html">tomcrypt_private.h</a>.</p>

</div>
</div>
<a id="af1a090c9979e328596fa37512f519a09"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af1a090c9979e328596fa37512f519a09">&#9670;&nbsp;</a></span>mp_sqrtmod_prime</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define mp_sqrtmod_prime</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">a, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">b, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><a class="el" href="khazad_8c.html#a86ea50de5a3e0ae87762f4298d35284c">c</a>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td>&#160;&#160;&#160;<a class="el" href="ltm__desc_8c.html#aec55b2d137e8b50b343f2d9986db1843">ltc_mp.sqrtmod_prime</a>(a, b, <a class="el" href="khazad_8c.html#a86ea50de5a3e0ae87762f4298d35284c">c</a>)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="tomcrypt__private_8h_source.html#l00163">163</a> of file <a class="el" href="tomcrypt__private_8h_source.html">tomcrypt_private.h</a>.</p>

</div>
</div>
<a id="ab8d0882c3b58263b638b41fbf110fde8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab8d0882c3b58263b638b41fbf110fde8">&#9670;&nbsp;</a></span>mp_sub</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define mp_sub</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">a, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">b, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><a class="el" href="khazad_8c.html#a86ea50de5a3e0ae87762f4298d35284c">c</a>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td>&#160;&#160;&#160;<a class="el" href="tfm__desc_8c.html#ac1994aaeae47e7ef1b1b6fe723898be0">ltc_mp.sub</a>(a, b, <a class="el" href="khazad_8c.html#a86ea50de5a3e0ae87762f4298d35284c">c</a>)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="tomcrypt__private_8h_source.html#l00158">158</a> of file <a class="el" href="tomcrypt__private_8h_source.html">tomcrypt_private.h</a>.</p>

</div>
</div>
<a id="a4215ff0d6838acb3d959d3e68c923de7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4215ff0d6838acb3d959d3e68c923de7">&#9670;&nbsp;</a></span>mp_sub_d</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define mp_sub_d</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">a, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">b, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><a class="el" href="khazad_8c.html#a86ea50de5a3e0ae87762f4298d35284c">c</a>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td>&#160;&#160;&#160;<a class="el" href="tfm__desc_8c.html#afa8ec5f7da0f83c1ea1f3da29e9be588">ltc_mp.subi</a>(a, b, <a class="el" href="khazad_8c.html#a86ea50de5a3e0ae87762f4298d35284c">c</a>)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="tomcrypt__private_8h_source.html#l00159">159</a> of file <a class="el" href="tomcrypt__private_8h_source.html">tomcrypt_private.h</a>.</p>

</div>
</div>
<a id="a15e2f6c11b3fcebe885ecc14d759ac01"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a15e2f6c11b3fcebe885ecc14d759ac01">&#9670;&nbsp;</a></span>mp_submod</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define mp_submod</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">a, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">b, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><a class="el" href="khazad_8c.html#a86ea50de5a3e0ae87762f4298d35284c">c</a>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">d&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td>&#160;&#160;&#160;<a class="el" href="tfm__desc_8c.html#ac6a3bdd2a041584938590017969f9f76">ltc_mp.submod</a>(a, b, <a class="el" href="khazad_8c.html#a86ea50de5a3e0ae87762f4298d35284c">c</a>, d)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="tomcrypt__private_8h_source.html#l00172">172</a> of file <a class="el" href="tomcrypt__private_8h_source.html">tomcrypt_private.h</a>.</p>

</div>
</div>
<a id="a376a4d31dcfeb65c069db0485b9602f8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a376a4d31dcfeb65c069db0485b9602f8">&#9670;&nbsp;</a></span>mp_to_unsigned_bin</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define mp_to_unsigned_bin</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">a, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">b&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td>&#160;&#160;&#160;<a class="el" href="tfm__desc_8c.html#a0f1b2cd32964ecad0001b7169b53f1d1">ltc_mp.unsigned_write</a>(a, b)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="tomcrypt__private_8h_source.html#l00153">153</a> of file <a class="el" href="tomcrypt__private_8h_source.html">tomcrypt_private.h</a>.</p>

</div>
</div>
<a id="a4b9ad86294c22251f11369ed62f236b9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4b9ad86294c22251f11369ed62f236b9">&#9670;&nbsp;</a></span>mp_tohex</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define mp_tohex</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">a, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">b&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td>&#160;&#160;&#160;<a class="el" href="tomcrypt__private_8h.html#a560fd673c15ccf143fdfdcb2b21764e3">mp_toradix</a>(a, b, 16)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="tomcrypt__private_8h_source.html#l00189">189</a> of file <a class="el" href="tomcrypt__private_8h_source.html">tomcrypt_private.h</a>.</p>

</div>
</div>
<a id="a560fd673c15ccf143fdfdcb2b21764e3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a560fd673c15ccf143fdfdcb2b21764e3">&#9670;&nbsp;</a></span>mp_toradix</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define mp_toradix</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">a, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">b, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><a class="el" href="khazad_8c.html#a86ea50de5a3e0ae87762f4298d35284c">c</a>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td>&#160;&#160;&#160;<a class="el" href="tfm__desc_8c.html#aa40161a29cddd18172c7a64a18b6dc2c">ltc_mp.write_radix</a>(a, b, <a class="el" href="khazad_8c.html#a86ea50de5a3e0ae87762f4298d35284c">c</a>)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="tomcrypt__private_8h_source.html#l00151">151</a> of file <a class="el" href="tomcrypt__private_8h_source.html">tomcrypt_private.h</a>.</p>

</div>
</div>
<a id="ad301148bb24f43a8c7003a6976dfaa5a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad301148bb24f43a8c7003a6976dfaa5a">&#9670;&nbsp;</a></span>mp_unsigned_bin_size</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define mp_unsigned_bin_size</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">a</td><td>)</td>
          <td>&#160;&#160;&#160;<a class="el" href="tfm__desc_8c.html#adb7e3791a36546ca7550e34344e2cb47">ltc_mp.unsigned_size</a>(a)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="tomcrypt__private_8h_source.html#l00152">152</a> of file <a class="el" href="tomcrypt__private_8h_source.html">tomcrypt_private.h</a>.</p>

</div>
</div>
<h2 class="groupheader">Typedef Documentation</h2>
<a id="a056acfa9f8dfc66d7ebbe1315389f3b2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a056acfa9f8dfc66d7ebbe1315389f3b2">&#9670;&nbsp;</a></span>fn_kdf_t</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef int(* fn_kdf_t) (const unsigned char *password, unsigned long password_len, const unsigned char *salt, unsigned long salt_len, int iteration_count, int hash_idx, unsigned char *out, unsigned long *outlen)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="tomcrypt__private_8h_source.html#l00039">39</a> of file <a class="el" href="tomcrypt__private_8h_source.html">tomcrypt_private.h</a>.</p>

</div>
</div>
<h2 class="groupheader">Enumeration Type Documentation</h2>
<a id="a981c610adcaa77d61adb80dde41a044b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a981c610adcaa77d61adb80dde41a044b">&#9670;&nbsp;</a></span>ltc_oid_id</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="tomcrypt__private_8h.html#a981c610adcaa77d61adb80dde41a044b">ltc_oid_id</a></td>
        </tr>
      </table>
</div><div class="memdoc">
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><a id="a981c610adcaa77d61adb80dde41a044ba40273a1f176419e8c4638e0efb15854f"></a>PKA_RSA&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a981c610adcaa77d61adb80dde41a044babe5d329be6c70ca6a43ba1099a69386d"></a>PKA_DSA&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a981c610adcaa77d61adb80dde41a044bafe7642b8f160f5b4e79903c13bf39a4e"></a>PKA_EC&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a981c610adcaa77d61adb80dde41a044bad815f93f03c91dcfaa47330dcf8a397a"></a>PKA_EC_PRIMEF&#160;</td><td class="fielddoc"></td></tr>
</table>

<p class="definition">Definition at line <a class="el" href="tomcrypt__private_8h_source.html#l00022">22</a> of file <a class="el" href="tomcrypt__private_8h_source.html">tomcrypt_private.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;                {</div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;   <a class="code" href="tomcrypt__private_8h.html#a981c610adcaa77d61adb80dde41a044ba40273a1f176419e8c4638e0efb15854f">PKA_RSA</a>,</div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;   <a class="code" href="tomcrypt__private_8h.html#a981c610adcaa77d61adb80dde41a044babe5d329be6c70ca6a43ba1099a69386d">PKA_DSA</a>,</div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;   <a class="code" href="tomcrypt__private_8h.html#a981c610adcaa77d61adb80dde41a044bafe7642b8f160f5b4e79903c13bf39a4e">PKA_EC</a>,</div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;   <a class="code" href="tomcrypt__private_8h.html#a981c610adcaa77d61adb80dde41a044bad815f93f03c91dcfaa47330dcf8a397a">PKA_EC_PRIMEF</a></div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;};</div><div class="ttc" id="tomcrypt__private_8h_html_a981c610adcaa77d61adb80dde41a044babe5d329be6c70ca6a43ba1099a69386d"><div class="ttname"><a href="tomcrypt__private_8h.html#a981c610adcaa77d61adb80dde41a044babe5d329be6c70ca6a43ba1099a69386d">PKA_DSA</a></div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt__private_8h_source.html#l00024">tomcrypt_private.h:24</a></div></div>
<div class="ttc" id="tomcrypt__private_8h_html_a981c610adcaa77d61adb80dde41a044bafe7642b8f160f5b4e79903c13bf39a4e"><div class="ttname"><a href="tomcrypt__private_8h.html#a981c610adcaa77d61adb80dde41a044bafe7642b8f160f5b4e79903c13bf39a4e">PKA_EC</a></div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt__private_8h_source.html#l00025">tomcrypt_private.h:25</a></div></div>
<div class="ttc" id="tomcrypt__private_8h_html_a981c610adcaa77d61adb80dde41a044ba40273a1f176419e8c4638e0efb15854f"><div class="ttname"><a href="tomcrypt__private_8h.html#a981c610adcaa77d61adb80dde41a044ba40273a1f176419e8c4638e0efb15854f">PKA_RSA</a></div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt__private_8h_source.html#l00023">tomcrypt_private.h:23</a></div></div>
<div class="ttc" id="tomcrypt__private_8h_html_a981c610adcaa77d61adb80dde41a044bad815f93f03c91dcfaa47330dcf8a397a"><div class="ttname"><a href="tomcrypt__private_8h.html#a981c610adcaa77d61adb80dde41a044bad815f93f03c91dcfaa47330dcf8a397a">PKA_EC_PRIMEF</a></div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt__private_8h_source.html#l00026">tomcrypt_private.h:26</a></div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="a669fada75ab21a80b652dfbc2b54e346"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a669fada75ab21a80b652dfbc2b54e346">&#9670;&nbsp;</a></span>copy_or_zeromem()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void copy_or_zeromem </td>
          <td>(</td>
          <td class="paramtype">const unsigned char *&#160;</td>
          <td class="paramname"><em>src</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char *&#160;</td>
          <td class="paramname"><em>dest</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned long&#160;</td>
          <td class="paramname"><em>len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>coz</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Either copy or zero a block of memory in constant time. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">src</td><td>The source where to read from </td></tr>
    <tr><td class="paramname">dest</td><td>The destination where to write to </td></tr>
    <tr><td class="paramname">len</td><td>The length of the area to process (octets) </td></tr>
    <tr><td class="paramname">coz</td><td>Copy (on 0) Or Zero (&gt; 0) </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="copy__or__zeromem_8c_source.html#l00023">23</a> of file <a class="el" href="copy__or__zeromem_8c_source.html">copy_or_zeromem.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;{</div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;   <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> y;</div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="preprocessor">#ifdef LTC_FAST</span></div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;   <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> z;</div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;   LTC_FAST_TYPE fastMask = ~(LTC_FAST_TYPE)0; <span class="comment">/* initialize fastMask at all ones */</span></div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;   <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> <a class="code" href="gcm__gf__mult_8c.html#a3a2325b458f400e186d773b14e6c1ed9">mask</a> = 0xff; <span class="comment">/* initialize mask at all ones */</span></div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;</div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;   <a class="code" href="tomcrypt__argchk_8h.html#a67a6e5d66d0c7d80ddf5c583054608bd">LTC_ARGCHKVD</a>(src  != NULL);</div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;   <a class="code" href="tomcrypt__argchk_8h.html#a67a6e5d66d0c7d80ddf5c583054608bd">LTC_ARGCHKVD</a>(dest != NULL);</div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;</div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;   <span class="keywordflow">if</span> (coz != 0) coz = 1;</div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;   y = 0;</div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;   <a class="code" href="gcm__gf__mult_8c.html#a3a2325b458f400e186d773b14e6c1ed9">mask</a> *= 1 - coz; <span class="comment">/* mask = ( coz ? 0 : 0xff ) */</span></div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="preprocessor">#ifdef LTC_FAST</span></div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;   fastMask *= 1 - coz;</div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="ocb__init_8c.html#afed088663f8704004425cdae2120b9b3">len</a> &amp; ~15) {</div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;      <span class="keywordflow">for</span> (; y &lt; (<a class="code" href="ocb__init_8c.html#afed088663f8704004425cdae2120b9b3">len</a> &amp; ~15); y += 16) {</div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;        <span class="keywordflow">for</span> (z = 0; z &lt; 16; z += <span class="keyword">sizeof</span>(LTC_FAST_TYPE)) {</div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;          *(LTC_FAST_TYPE_PTR_CAST(&amp;dest[y+z])) = *(LTC_FAST_TYPE_PTR_CAST(&amp;src[y+z])) &amp; fastMask;</div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;        }</div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;      }</div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;   }</div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;   <span class="keywordflow">for</span> (; y &lt; <a class="code" href="ocb__init_8c.html#afed088663f8704004425cdae2120b9b3">len</a>; y++) {</div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;      dest[y] = src[y] &amp; <a class="code" href="gcm__gf__mult_8c.html#a3a2325b458f400e186d773b14e6c1ed9">mask</a>;</div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;   }</div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;<span class="preprocessor">#ifdef LTC_CLEAN_STACK</span></div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;<span class="preprocessor">#ifdef LTC_FAST</span></div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;   fastMask = 0;</div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;   <a class="code" href="gcm__gf__mult_8c.html#a3a2325b458f400e186d773b14e6c1ed9">mask</a> = 0;</div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;}</div><div class="ttc" id="ocb__init_8c_html_afed088663f8704004425cdae2120b9b3"><div class="ttname"><a href="ocb__init_8c.html#afed088663f8704004425cdae2120b9b3">len</a></div><div class="ttdeci">int len</div><div class="ttdef"><b>Definition:</b> <a href="ocb__init_8c_source.html#l00019">ocb_init.c:19</a></div></div>
<div class="ttc" id="gcm__gf__mult_8c_html_a3a2325b458f400e186d773b14e6c1ed9"><div class="ttname"><a href="gcm__gf__mult_8c.html#a3a2325b458f400e186d773b14e6c1ed9">mask</a></div><div class="ttdeci">static const unsigned char mask[]</div><div class="ttdef"><b>Definition:</b> <a href="gcm__gf__mult_8c_source.html#l00071">gcm_gf_mult.c:71</a></div></div>
<div class="ttc" id="tomcrypt__argchk_8h_html_a67a6e5d66d0c7d80ddf5c583054608bd"><div class="ttname"><a href="tomcrypt__argchk_8h.html#a67a6e5d66d0c7d80ddf5c583054608bd">LTC_ARGCHKVD</a></div><div class="ttdeci">#define LTC_ARGCHKVD(x)</div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt__argchk_8h_source.html#l00020">tomcrypt_argchk.h:20</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="ocb__init_8c_source.html#l00019">len</a>, <a class="el" href="tomcrypt__argchk_8h_source.html#l00020">LTC_ARGCHKVD</a>, and <a class="el" href="gcm__gf__mult_8c_source.html#l00071">mask</a>.</p>

<p class="reference">Referenced by <a class="el" href="ccm__memory_8c_source.html#l00039">ccm_memory()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="tomcrypt__private_8h_a669fada75ab21a80b652dfbc2b54e346_icgraph.png" border="0" usemap="#tomcrypt__private_8h_a669fada75ab21a80b652dfbc2b54e346_icgraph" alt=""/></div>
<!-- MAP 2 -->
</div>

</div>
</div>
<a id="a651ad7c1f5a930476bb10b9d61555346"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a651ad7c1f5a930476bb10b9d61555346">&#9670;&nbsp;</a></span>der_decode_asn1_identifier()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int der_decode_asn1_identifier </td>
          <td>(</td>
          <td class="paramtype">const unsigned char *&#160;</td>
          <td class="paramname"><em>in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned long *&#160;</td>
          <td class="paramname"><em>inlen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">ltc_asn1_list *&#160;</td>
          <td class="paramname"><em>id</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Decode the ASN.1 Identifier. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">id</td><td>Where to store the decoded Identifier </td></tr>
    <tr><td class="paramname">in</td><td>Where to read the Identifier from </td></tr>
    <tr><td class="paramname">inlen</td><td>[in/out] The size of in available/read </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>CRYPT_OK if successful </dd></dl>

<p class="definition">Definition at line <a class="el" href="der__decode__asn1__identifier_8c_source.html#l00065">65</a> of file <a class="el" href="der__decode__asn1__identifier_8c_source.html">der_decode_asn1_identifier.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;{</div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;   <a class="code" href="tomcrypt__cfg_8h.html#ab4afaf24b39288a7be6fd03fe8345f61">ulong64</a> tmp;</div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;   <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> tag_len;</div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;   <span class="keywordtype">int</span> err;</div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;</div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;   <a class="code" href="tomcrypt__argchk_8h.html#a683da3e041e49f196318b6ea951414ba">LTC_ARGCHK</a>(<span class="keywordtype">id</span>    != NULL);</div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;   <a class="code" href="tomcrypt__argchk_8h.html#a683da3e041e49f196318b6ea951414ba">LTC_ARGCHK</a>(in    != NULL);</div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;   <a class="code" href="tomcrypt__argchk_8h.html#a683da3e041e49f196318b6ea951414ba">LTC_ARGCHK</a>(inlen != NULL);</div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;</div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;   <span class="keywordflow">if</span> (*inlen == 0) {</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06caccd878f5599f3036ffe759dbe1a1ac16">CRYPT_BUFFER_OVERFLOW</a>;</div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;   }</div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;</div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;   tag_len = 1;</div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;   <span class="keywordtype">id</span>-&gt;klass = (in[0] &gt;&gt; 6) &amp; 0x3;</div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;   <span class="keywordtype">id</span>-&gt;pc = (in[0] &gt;&gt; 5) &amp; 0x1;</div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;   <span class="keywordtype">id</span>-&gt;tag = in[0] &amp; 0x1f;</div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;</div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;   err = <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>;</div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;   <span class="keywordflow">if</span> (id-&gt;tag == 0x1f) {</div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;      <span class="keywordtype">id</span>-&gt;tag = 0;</div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;      <span class="keywordflow">do</span> {</div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;         <span class="keywordflow">if</span> (*inlen &lt; tag_len) {</div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;            <span class="comment">/* break the loop and trigger the BOF error-code */</span></div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;            tmp = 0xff;</div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;         }</div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;         <span class="keywordtype">id</span>-&gt;tag &lt;&lt;= 7;</div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;         <span class="keywordtype">id</span>-&gt;tag |= in[tag_len] &amp; 0x7f;</div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;         tmp = in[tag_len] &amp; 0x80;</div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;         tag_len++;</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;      } <span class="keywordflow">while</span> ((tmp != 0) &amp;&amp; (tag_len &lt; 10));</div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;      <span class="keywordflow">if</span> (tmp != 0) {</div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;         err = <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06caccd878f5599f3036ffe759dbe1a1ac16">CRYPT_BUFFER_OVERFLOW</a>;</div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (id-&gt;tag &lt; 0x1f) {</div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;         err = <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06ca001cb5383cce7c4581790abe472e816f">CRYPT_PK_ASN1_ERROR</a>;</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;      }</div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;   }</div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;</div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;   <span class="keywordflow">if</span> (err != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>) {</div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;      <span class="keywordtype">id</span>-&gt;pc = 0;</div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;      <span class="keywordtype">id</span>-&gt;klass = 0;</div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;      <span class="keywordtype">id</span>-&gt;tag = 0;</div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;      *inlen = tag_len;</div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;      <span class="keywordflow">if</span> ((id-&gt;klass == LTC_ASN1_CL_UNIVERSAL) &amp;&amp;</div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;            (<span class="keywordtype">id</span>-&gt;tag &lt; <a class="code" href="tomcrypt__private_8h.html#a6ad32891f744af2b205041ad6dc5bce0">der_asn1_tag_to_type_map_sz</a>) &amp;&amp;</div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;            (id-&gt;tag &lt; <a class="code" href="der__decode__asn1__identifier_8c.html#ae0c8f7d434b413a2ff67589df588cdeb">tag_constructed_map_sz</a>) &amp;&amp;</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;            (<span class="keywordtype">id</span>-&gt;pc == <a class="code" href="der__decode__asn1__identifier_8c.html#af435b696867260086b90e7ca08dc8b20">tag_constructed_map</a>[<span class="keywordtype">id</span>-&gt;tag])) {</div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;         <span class="keywordtype">id</span>-&gt;type = <a class="code" href="tomcrypt__private_8h.html#a411f77ba949e37dca9c1ef1e43127cb1">der_asn1_tag_to_type_map</a>[<span class="keywordtype">id</span>-&gt;tag];</div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;         <span class="keywordflow">if</span> ((id-&gt;klass == LTC_ASN1_CL_UNIVERSAL) &amp;&amp; (<span class="keywordtype">id</span>-&gt;tag == 0)) {</div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;            <span class="keywordtype">id</span>-&gt;type = LTC_ASN1_EOL;</div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;         } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;            <span class="keywordtype">id</span>-&gt;type = LTC_ASN1_CUSTOM_TYPE;</div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;         }</div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;      }</div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;   }</div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;</div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>;</div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;}</div><div class="ttc" id="tomcrypt_8h_html_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334"><div class="ttname"><a href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a></div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt_8h_source.html#l00042">tomcrypt.h:42</a></div></div>
<div class="ttc" id="der__decode__asn1__identifier_8c_html_ae0c8f7d434b413a2ff67589df588cdeb"><div class="ttname"><a href="der__decode__asn1__identifier_8c.html#ae0c8f7d434b413a2ff67589df588cdeb">tag_constructed_map_sz</a></div><div class="ttdeci">static const unsigned long tag_constructed_map_sz</div><div class="ttdef"><b>Definition:</b> <a href="der__decode__asn1__identifier_8c_source.html#l00056">der_decode_asn1_identifier.c:56</a></div></div>
<div class="ttc" id="tomcrypt_8h_html_adc29c2ff13d900c2f185ee95427fb06ca001cb5383cce7c4581790abe472e816f"><div class="ttname"><a href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06ca001cb5383cce7c4581790abe472e816f">CRYPT_PK_ASN1_ERROR</a></div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt_8h_source.html#l00072">tomcrypt.h:72</a></div></div>
<div class="ttc" id="tomcrypt__argchk_8h_html_a683da3e041e49f196318b6ea951414ba"><div class="ttname"><a href="tomcrypt__argchk_8h.html#a683da3e041e49f196318b6ea951414ba">LTC_ARGCHK</a></div><div class="ttdeci">#define LTC_ARGCHK(x)</div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt__argchk_8h_source.html#l00019">tomcrypt_argchk.h:19</a></div></div>
<div class="ttc" id="der__decode__asn1__identifier_8c_html_af435b696867260086b90e7ca08dc8b20"><div class="ttname"><a href="der__decode__asn1__identifier_8c.html#af435b696867260086b90e7ca08dc8b20">tag_constructed_map</a></div><div class="ttdeci">static const unsigned char tag_constructed_map[]</div><div class="ttdef"><b>Definition:</b> <a href="der__decode__asn1__identifier_8c_source.html#l00018">der_decode_asn1_identifier.c:18</a></div></div>
<div class="ttc" id="tomcrypt__private_8h_html_a411f77ba949e37dca9c1ef1e43127cb1"><div class="ttname"><a href="tomcrypt__private_8h.html#a411f77ba949e37dca9c1ef1e43127cb1">der_asn1_tag_to_type_map</a></div><div class="ttdeci">const ltc_asn1_type der_asn1_tag_to_type_map[]</div><div class="ttdoc">A Map from ASN.1 Tags to ltc_asn1_type.</div><div class="ttdef"><b>Definition:</b> <a href="der__asn1__maps_8c_source.html#l00120">der_asn1_maps.c:120</a></div></div>
<div class="ttc" id="tomcrypt__private_8h_html_a6ad32891f744af2b205041ad6dc5bce0"><div class="ttname"><a href="tomcrypt__private_8h.html#a6ad32891f744af2b205041ad6dc5bce0">der_asn1_tag_to_type_map_sz</a></div><div class="ttdeci">const unsigned long der_asn1_tag_to_type_map_sz</div><div class="ttdef"><b>Definition:</b> <a href="der__asn1__maps_8c_source.html#l00161">der_asn1_maps.c:161</a></div></div>
<div class="ttc" id="tomcrypt__cfg_8h_html_ab4afaf24b39288a7be6fd03fe8345f61"><div class="ttname"><a href="tomcrypt__cfg_8h.html#ab4afaf24b39288a7be6fd03fe8345f61">ulong64</a></div><div class="ttdeci">unsigned long long ulong64</div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt__cfg_8h_source.html#l00211">tomcrypt_cfg.h:211</a></div></div>
<div class="ttc" id="tomcrypt_8h_html_adc29c2ff13d900c2f185ee95427fb06caccd878f5599f3036ffe759dbe1a1ac16"><div class="ttname"><a href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06caccd878f5599f3036ffe759dbe1a1ac16">CRYPT_BUFFER_OVERFLOW</a></div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt_8h_source.html#l00050">tomcrypt.h:50</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="tomcrypt_8h_source.html#l00050">CRYPT_BUFFER_OVERFLOW</a>, <a class="el" href="tomcrypt_8h_source.html#l00042">CRYPT_OK</a>, <a class="el" href="tomcrypt_8h_source.html#l00072">CRYPT_PK_ASN1_ERROR</a>, <a class="el" href="der__asn1__maps_8c_source.html#l00120">der_asn1_tag_to_type_map</a>, <a class="el" href="der__asn1__maps_8c_source.html#l00161">der_asn1_tag_to_type_map_sz</a>, <a class="el" href="tomcrypt__argchk_8h_source.html#l00019">LTC_ARGCHK</a>, <a class="el" href="der__decode__asn1__identifier_8c_source.html#l00018">tag_constructed_map</a>, and <a class="el" href="der__decode__asn1__identifier_8c_source.html#l00056">tag_constructed_map_sz</a>.</p>

<p class="reference">Referenced by <a class="el" href="der__decode__custom__type_8c_source.html#l00048">der_decode_custom_type_ex()</a>, and <a class="el" href="der__decode__sequence__flexi_8c_source.html#l00044">der_decode_sequence_flexi()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="tomcrypt__private_8h_a651ad7c1f5a930476bb10b9d61555346_icgraph.png" border="0" usemap="#tomcrypt__private_8h_a651ad7c1f5a930476bb10b9d61555346_icgraph" alt=""/></div>
<!-- MAP 3 -->
</div>

</div>
</div>
<a id="af90423764098b8876368d0984d96053a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af90423764098b8876368d0984d96053a">&#9670;&nbsp;</a></span>der_decode_asn1_length()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int der_decode_asn1_length </td>
          <td>(</td>
          <td class="paramtype">const unsigned char *&#160;</td>
          <td class="paramname"><em>in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned long *&#160;</td>
          <td class="paramname"><em>inlen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned long *&#160;</td>
          <td class="paramname"><em>outlen</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Decode the ASN.1 Length field. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">in</td><td>Where to read the length field from </td></tr>
    <tr><td class="paramname">inlen</td><td>[in/out] The size of in available/read </td></tr>
    <tr><td class="paramname">outlen</td><td>[out] The decoded ASN.1 length </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>CRYPT_OK if successful </dd></dl>

<p class="definition">Definition at line <a class="el" href="der__decode__asn1__length_8c_source.html#l00024">24</a> of file <a class="el" href="der__decode__asn1__length_8c_source.html">der_decode_asn1_length.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;{</div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;   <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> real_len, decoded_len, offset, i;</div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;</div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;   <a class="code" href="tomcrypt__argchk_8h.html#a683da3e041e49f196318b6ea951414ba">LTC_ARGCHK</a>(in    != NULL);</div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;   <a class="code" href="tomcrypt__argchk_8h.html#a683da3e041e49f196318b6ea951414ba">LTC_ARGCHK</a>(inlen != NULL);</div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;</div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;   <span class="keywordflow">if</span> (*inlen &lt; 1) {</div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06caccd878f5599f3036ffe759dbe1a1ac16">CRYPT_BUFFER_OVERFLOW</a>;</div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;   }</div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;</div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;   real_len = in[0];</div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;</div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;   <span class="keywordflow">if</span> (real_len &lt; 128) {</div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;      decoded_len = real_len;</div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;      offset = 1;</div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;      real_len &amp;= 0x7F;</div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;      <span class="keywordflow">if</span> (real_len == 0) {</div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;         <span class="keywordflow">return</span> <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06ca001cb5383cce7c4581790abe472e816f">CRYPT_PK_ASN1_ERROR</a>;</div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;      }</div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;      <span class="keywordflow">if</span> (real_len &gt; <span class="keyword">sizeof</span>(decoded_len)) {</div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;         <span class="keywordflow">return</span> <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06ca3a147cc0bbea3f8779364ad00c2678b4">CRYPT_OVERFLOW</a>;</div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;      }</div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;      <span class="keywordflow">if</span> (real_len &gt; (*inlen - 1)) {</div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;         <span class="keywordflow">return</span> <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06caccd878f5599f3036ffe759dbe1a1ac16">CRYPT_BUFFER_OVERFLOW</a>;</div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;      }</div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;      decoded_len = 0;</div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;      offset = 1 + real_len;</div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;      <span class="keywordflow">for</span> (i = 0; i &lt; real_len; i++) {</div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;         decoded_len = (decoded_len &lt;&lt; 8) | in[1 + i];</div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;      }</div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;   }</div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;</div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;   <span class="keywordflow">if</span> (outlen != NULL) *outlen = decoded_len;</div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;   <span class="keywordflow">if</span> (decoded_len &gt; (*inlen - offset)) <span class="keywordflow">return</span> <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06ca3a147cc0bbea3f8779364ad00c2678b4">CRYPT_OVERFLOW</a>;</div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;   *inlen = offset;</div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;</div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>;</div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;}</div><div class="ttc" id="tomcrypt_8h_html_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334"><div class="ttname"><a href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a></div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt_8h_source.html#l00042">tomcrypt.h:42</a></div></div>
<div class="ttc" id="tomcrypt_8h_html_adc29c2ff13d900c2f185ee95427fb06ca001cb5383cce7c4581790abe472e816f"><div class="ttname"><a href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06ca001cb5383cce7c4581790abe472e816f">CRYPT_PK_ASN1_ERROR</a></div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt_8h_source.html#l00072">tomcrypt.h:72</a></div></div>
<div class="ttc" id="tomcrypt__argchk_8h_html_a683da3e041e49f196318b6ea951414ba"><div class="ttname"><a href="tomcrypt__argchk_8h.html#a683da3e041e49f196318b6ea951414ba">LTC_ARGCHK</a></div><div class="ttdeci">#define LTC_ARGCHK(x)</div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt__argchk_8h_source.html#l00019">tomcrypt_argchk.h:19</a></div></div>
<div class="ttc" id="tomcrypt_8h_html_adc29c2ff13d900c2f185ee95427fb06ca3a147cc0bbea3f8779364ad00c2678b4"><div class="ttname"><a href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06ca3a147cc0bbea3f8779364ad00c2678b4">CRYPT_OVERFLOW</a></div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt_8h_source.html#l00070">tomcrypt.h:70</a></div></div>
<div class="ttc" id="tomcrypt_8h_html_adc29c2ff13d900c2f185ee95427fb06caccd878f5599f3036ffe759dbe1a1ac16"><div class="ttname"><a href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06caccd878f5599f3036ffe759dbe1a1ac16">CRYPT_BUFFER_OVERFLOW</a></div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt_8h_source.html#l00050">tomcrypt.h:50</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="tomcrypt_8h_source.html#l00050">CRYPT_BUFFER_OVERFLOW</a>, <a class="el" href="tomcrypt_8h_source.html#l00042">CRYPT_OK</a>, <a class="el" href="tomcrypt_8h_source.html#l00070">CRYPT_OVERFLOW</a>, <a class="el" href="tomcrypt_8h_source.html#l00072">CRYPT_PK_ASN1_ERROR</a>, and <a class="el" href="tomcrypt__argchk_8h_source.html#l00019">LTC_ARGCHK</a>.</p>

<p class="reference">Referenced by <a class="el" href="der__decode__bit__string_8c_source.html#l00027">der_decode_bit_string()</a>, <a class="el" href="der__decode__custom__type_8c_source.html#l00048">der_decode_custom_type_ex()</a>, <a class="el" href="der__decode__ia5__string_8c_source.html#l00027">der_decode_ia5_string()</a>, <a class="el" href="der__decode__integer_8c_source.html#l00026">der_decode_integer()</a>, <a class="el" href="der__decode__object__identifier_8c_source.html#l00025">der_decode_object_identifier()</a>, <a class="el" href="der__decode__octet__string_8c_source.html#l00027">der_decode_octet_string()</a>, <a class="el" href="der__decode__printable__string_8c_source.html#l00027">der_decode_printable_string()</a>, <a class="el" href="der__decode__raw__bit__string_8c_source.html#l00030">der_decode_raw_bit_string()</a>, <a class="el" href="der__decode__sequence__flexi_8c_source.html#l00044">der_decode_sequence_flexi()</a>, <a class="el" href="der__decode__teletex__string_8c_source.html#l00026">der_decode_teletex_string()</a>, and <a class="el" href="der__decode__utf8__string_8c_source.html#l00027">der_decode_utf8_string()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="tomcrypt__private_8h_af90423764098b8876368d0984d96053a_icgraph.png" border="0" usemap="#tomcrypt__private_8h_af90423764098b8876368d0984d96053a_icgraph" alt=""/></div>
<!-- MAP 4 -->
</div>

</div>
</div>
<a id="aaa3acc13042e5d9244ac279a354775fe"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaa3acc13042e5d9244ac279a354775fe">&#9670;&nbsp;</a></span>der_decode_custom_type_ex()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int der_decode_custom_type_ex </td>
          <td>(</td>
          <td class="paramtype">const unsigned char *&#160;</td>
          <td class="paramname"><em>in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned long&#160;</td>
          <td class="paramname"><em>inlen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">ltc_asn1_list *&#160;</td>
          <td class="paramname"><em>root</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">ltc_asn1_list *&#160;</td>
          <td class="paramname"><em>list</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned long&#160;</td>
          <td class="paramname"><em>outlen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>flags</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Extended-decode a Custom type. </p>
<p>This function is used to decode custom types and sequences/sets For custom types root is used For sequences/sets list and outlen are used</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">in</td><td>The DER encoded input </td></tr>
    <tr><td class="paramname">inlen</td><td>The size of the input </td></tr>
    <tr><td class="paramname">root</td><td>The item that defines the custom type to decode </td></tr>
    <tr><td class="paramname">list</td><td>The list of items to decode </td></tr>
    <tr><td class="paramname">outlen</td><td>The number of items in the list </td></tr>
    <tr><td class="paramname">flags</td><td>c.f. enum ltc_der_seq </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>CRYPT_OK on success </dd></dl>

<p class="definition">Definition at line <a class="el" href="der__decode__custom__type_8c_source.html#l00048">48</a> of file <a class="el" href="der__decode__custom__type_8c_source.html">der_decode_custom_type.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;{</div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;   <span class="keywordtype">int</span>           err, seq_err, i, ordered;</div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;   ltc_asn1_type type;</div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;   ltc_asn1_list ident;</div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;   <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> size, x, y, z, blksize;</div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;   <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>* in_new = NULL;</div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;   <span class="keywordtype">void</span>          *data;</div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;</div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;   <a class="code" href="tomcrypt__argchk_8h.html#a683da3e041e49f196318b6ea951414ba">LTC_ARGCHK</a>(in   != NULL);</div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;</div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;   <span class="comment">/* get blk size */</span></div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;   <span class="keywordflow">if</span> (inlen &lt; 2) {</div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06ca980088f10ffe9009aec286038a9e79da">CRYPT_INVALID_PACKET</a>;</div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;   }</div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;   x = 0;</div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;</div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;   <span class="keywordflow">if</span> (root == NULL) {</div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;      <a class="code" href="tomcrypt__argchk_8h.html#a683da3e041e49f196318b6ea951414ba">LTC_ARGCHK</a>(list != NULL);</div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;</div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;      <span class="comment">/* sequence type? We allow 0x30 SEQUENCE and 0x31 SET since fundamentally they&#39;re the same structure */</span></div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;      <span class="keywordflow">if</span> (in[x] != 0x30 &amp;&amp; in[x] != 0x31) {</div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;         <span class="keywordflow">return</span> <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06ca980088f10ffe9009aec286038a9e79da">CRYPT_INVALID_PACKET</a>;</div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;      }</div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;      ++x;</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;      <span class="keywordflow">if</span> (root-&gt;type != LTC_ASN1_CUSTOM_TYPE) {</div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;         <span class="keywordflow">return</span> <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06ca980088f10ffe9009aec286038a9e79da">CRYPT_INVALID_PACKET</a>;</div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;      }</div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;</div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;      <span class="comment">/* Alloc a copy of the data for primitive handling. */</span></div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;      <span class="keywordflow">if</span> (root-&gt;pc == LTC_ASN1_PC_PRIMITIVE) {</div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;         in_new = <a class="code" href="tomcrypt__cfg_8h.html#af363355f38fbaacdefacf270436ae1c9">XMALLOC</a>(inlen);</div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;         <span class="keywordflow">if</span> (in_new == NULL) {</div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06ca0ce0d27adc7ea10b74b7ea904b8bfa82">CRYPT_MEM</a>;</div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;         }</div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;         <a class="code" href="tomcrypt__cfg_8h.html#a7691dd48d60d5fc6daf2fa7ec4c55e12">XMEMCPY</a>(in_new, in, inlen);</div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;         in = in_new;</div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;      }</div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;</div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;      y = inlen;</div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;      <span class="keywordflow">if</span> ((err = <a class="code" href="tomcrypt__private_8h.html#a651ad7c1f5a930476bb10b9d61555346">der_decode_asn1_identifier</a>(in, &amp;y, &amp;ident)) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>) {</div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;         <span class="keywordflow">goto</span> LBL_ERR;</div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;      }</div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;      <span class="keywordflow">if</span> ((ident.type != root-&gt;type) ||</div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;            (ident.klass != root-&gt;klass) ||</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;            (ident.pc != root-&gt;pc) ||</div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;            (ident.tag != root-&gt;tag)) {</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;         err = <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06ca980088f10ffe9009aec286038a9e79da">CRYPT_INVALID_PACKET</a>;</div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;         <span class="keywordflow">goto</span> LBL_ERR;</div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;      }</div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;      x += y;</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;</div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;      list = root-&gt;data;</div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;      outlen = root-&gt;size;</div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;   }</div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;</div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;   <span class="keywordflow">if</span> (root != NULL &amp;&amp; root-&gt;pc == LTC_ASN1_PC_PRIMITIVE) {</div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;      <span class="keywordflow">if</span> (((<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>)root-&gt;used &gt;= <a class="code" href="tomcrypt__private_8h.html#ae8d2a220c8f5b51d2db97b0382a9f206">der_asn1_type_to_identifier_map_sz</a>) ||</div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;            (<a class="code" href="tomcrypt__private_8h.html#a6306ca88074facac89ee0f6c04cbf2f2">der_asn1_type_to_identifier_map</a>[root-&gt;used] == -1)) {</div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;         err = <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06ca980088f10ffe9009aec286038a9e79da">CRYPT_INVALID_PACKET</a>;</div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;         <span class="keywordflow">goto</span> LBL_ERR;</div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;      }</div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;      root-&gt;type = (ltc_asn1_type)root-&gt;used;</div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;      list = root;</div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;      outlen = 1;</div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;</div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;      x -= 1;</div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;      in_new[x] = (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>)<a class="code" href="tomcrypt__private_8h.html#a6306ca88074facac89ee0f6c04cbf2f2">der_asn1_type_to_identifier_map</a>[list[0].type];</div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;      blksize = inlen - x;</div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;</div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;      y = inlen - x;</div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;      <span class="keywordflow">if</span> ((err = <a class="code" href="tomcrypt__private_8h.html#af90423764098b8876368d0984d96053a">der_decode_asn1_length</a>(&amp;in[x], &amp;y, &amp;blksize)) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>) {</div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;         <span class="keywordflow">goto</span> LBL_ERR;</div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;      }</div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;      x += y;</div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;   }</div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;</div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;   <span class="comment">/* would this blksize overflow? */</span></div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;   <span class="keywordflow">if</span> (blksize &gt; (inlen - x)) {</div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;      err = <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06ca980088f10ffe9009aec286038a9e79da">CRYPT_INVALID_PACKET</a>;</div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;      <span class="keywordflow">goto</span> LBL_ERR;</div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;   }</div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;</div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;   <span class="comment">/* mark all as unused */</span></div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;   <span class="keywordflow">for</span> (i = 0; i &lt; (int)outlen; i++) {</div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;       list[i].used = 0;</div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;   }</div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;   ordered = flags &amp; LTC_DER_SEQ_ORDERED;</div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;</div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;   <span class="comment">/* ok read data */</span></div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;   seq_err  = <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>;</div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;   blksize += x;</div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;   inlen   -= x;</div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;   <span class="keywordflow">for</span> (i = 0; i &lt; (int)outlen; i++) {</div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;       z    = 0;</div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;       type = list[i].type;</div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;       size = list[i].size;</div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;       data = list[i].data;</div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;       <span class="keywordflow">if</span> (!ordered &amp;&amp; list[i].used == 1) { <span class="keywordflow">continue</span>; }</div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;</div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;       <span class="keywordflow">if</span> (type == LTC_ASN1_EOL) {</div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;          <span class="keywordflow">break</span>;</div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;       }</div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;</div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;       <span class="keywordflow">if</span> (root != NULL &amp;&amp; root-&gt;pc == LTC_ASN1_PC_PRIMITIVE &amp;&amp; i != 0) {</div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;          err = <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06ca001cb5383cce7c4581790abe472e816f">CRYPT_PK_ASN1_ERROR</a>;</div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;          <span class="keywordflow">goto</span> LBL_ERR;</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;       }</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;</div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;       <span class="keywordflow">switch</span> (type) {</div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;           <span class="keywordflow">case</span> LTC_ASN1_BOOLEAN:</div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;               z = inlen;</div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;               <span class="keywordflow">if</span> ((err = <a class="code" href="der__decode__boolean_8c.html#a5c72faaf0b34b18bd92db4d95e211a9d">der_decode_boolean</a>(in + x, z, ((<span class="keywordtype">int</span> *)data))) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>) {</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;                  <span class="keywordflow">if</span> (!ordered || list[i].optional) { <span class="keywordflow">continue</span>; }</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;                  <span class="keywordflow">goto</span> LBL_ERR;</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;               }</div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;               <span class="keywordflow">if</span> ((err = <a class="code" href="der__length__boolean_8c.html#aa90c23682da0279cbe55ea64b2c3e381">der_length_boolean</a>(&amp;z)) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>) {</div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;                  <span class="keywordflow">goto</span> LBL_ERR;</div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;               }</div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;               <span class="keywordflow">break</span>;</div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;           <span class="keywordflow">case</span> LTC_ASN1_INTEGER:</div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;               z = inlen;</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;               <span class="keywordflow">if</span> ((err = <a class="code" href="der__decode__integer_8c.html#ac5b0a7020165ada29ba6278fe128599d">der_decode_integer</a>(in + x, z, data)) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>) {</div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;                  <span class="keywordflow">if</span> (!ordered || list[i].optional) { <span class="keywordflow">continue</span>; }</div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;                  <span class="keywordflow">goto</span> LBL_ERR;</div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;               }</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;               <span class="keywordflow">if</span> ((err = <a class="code" href="der__length__integer_8c.html#af27dfc46ec4a482af05a2265a9d31ca3">der_length_integer</a>(data, &amp;z)) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>) {</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;                  <span class="keywordflow">goto</span> LBL_ERR;</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;               }</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;               <span class="keywordflow">break</span>;</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;</div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;           <span class="keywordflow">case</span> LTC_ASN1_SHORT_INTEGER:</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;               z = inlen;</div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;               <span class="keywordflow">if</span> ((err = <a class="code" href="der__decode__short__integer_8c.html#a1f8c5c4ead2ebe96a1a852329c62154c">der_decode_short_integer</a>(in + x, z, data)) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>) {</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;                  <span class="keywordflow">if</span> (!ordered || list[i].optional) { <span class="keywordflow">continue</span>; }</div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;                  <span class="keywordflow">goto</span> LBL_ERR;</div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;               }</div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;               <span class="keywordflow">if</span> ((err = <a class="code" href="der__length__short__integer_8c.html#aa3bac08094cc8142ac313d818cf73fb0">der_length_short_integer</a>(((<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>*)data)[0], &amp;z)) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>) {</div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;                  <span class="keywordflow">goto</span> LBL_ERR;</div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;               }</div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;               <span class="keywordflow">break</span>;</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;           <span class="keywordflow">case</span> LTC_ASN1_BIT_STRING:</div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;               z = inlen;</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;               <span class="keywordflow">if</span> ((err = <a class="code" href="der__decode__bit__string_8c.html#a0a0c371e559e6b455cc4a052d962226f">der_decode_bit_string</a>(in + x, z, data, &amp;size)) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>) {</div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;                  <span class="keywordflow">if</span> (!ordered || list[i].optional) { <span class="keywordflow">continue</span>; }</div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;                  <span class="keywordflow">goto</span> LBL_ERR;</div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;               }</div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;               list[i].size = size;</div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;               <span class="keywordflow">if</span> ((err = <a class="code" href="der__length__bit__string_8c.html#a73416248e2f93535d54603567acc9cfd">der_length_bit_string</a>(size, &amp;z)) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>) {</div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;                  <span class="keywordflow">goto</span> LBL_ERR;</div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;               }</div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;               <span class="keywordflow">break</span>;</div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;</div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;           <span class="keywordflow">case</span> LTC_ASN1_RAW_BIT_STRING:</div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;               z = inlen;</div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;               <span class="keywordflow">if</span> ((err = <a class="code" href="der__decode__raw__bit__string_8c.html#a4e8241401c8f49b3b2dbadd1b8e0eee0">der_decode_raw_bit_string</a>(in + x, z, data, &amp;size)) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>) {</div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;                  <span class="keywordflow">if</span> (!ordered || list[i].optional) { <span class="keywordflow">continue</span>; }</div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;                  <span class="keywordflow">goto</span> LBL_ERR;</div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;               }</div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;               list[i].size = size;</div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;               <span class="keywordflow">if</span> ((err = <a class="code" href="der__length__bit__string_8c.html#a73416248e2f93535d54603567acc9cfd">der_length_bit_string</a>(size, &amp;z)) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>) {</div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;                  <span class="keywordflow">goto</span> LBL_ERR;</div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;               }</div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;               <span class="keywordflow">break</span>;</div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;</div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;           <span class="keywordflow">case</span> LTC_ASN1_OCTET_STRING:</div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;               z = inlen;</div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;               <span class="keywordflow">if</span> ((err = <a class="code" href="der__decode__octet__string_8c.html#af315ce6a951697ede7ec4c9716b5b20b">der_decode_octet_string</a>(in + x, z, data, &amp;size)) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>) {</div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;                  <span class="keywordflow">if</span> (!ordered || list[i].optional) { <span class="keywordflow">continue</span>; }</div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;                  <span class="keywordflow">goto</span> LBL_ERR;</div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;               }</div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;               list[i].size = size;</div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;               <span class="keywordflow">if</span> ((err = <a class="code" href="der__length__octet__string_8c.html#a65b2f3065d3f51608a1dfa3b284a74df">der_length_octet_string</a>(size, &amp;z)) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>) {</div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;                  <span class="keywordflow">goto</span> LBL_ERR;</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;               }</div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;               <span class="keywordflow">break</span>;</div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;</div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;           <span class="keywordflow">case</span> LTC_ASN1_NULL:</div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;               <span class="keywordflow">if</span> (inlen &lt; 2 || in[x] != 0x05 || in[x+1] != 0x00) {</div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;                  <span class="keywordflow">if</span> (!ordered || list[i].optional) { <span class="keywordflow">continue</span>; }</div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;                  err = <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06ca980088f10ffe9009aec286038a9e79da">CRYPT_INVALID_PACKET</a>;</div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;                  <span class="keywordflow">goto</span> LBL_ERR;</div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;               }</div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;               z = 2;</div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;               <span class="keywordflow">break</span>;</div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;</div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;           <span class="keywordflow">case</span> LTC_ASN1_OBJECT_IDENTIFIER:</div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;               z = inlen;</div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;               <span class="keywordflow">if</span> ((err = <a class="code" href="der__decode__object__identifier_8c.html#aee91111fe2b92dca6c83e6c7de36be8f">der_decode_object_identifier</a>(in + x, z, data, &amp;size)) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>) {</div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;                  <span class="keywordflow">if</span> (!ordered || list[i].optional) { <span class="keywordflow">continue</span>; }</div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;                  <span class="keywordflow">goto</span> LBL_ERR;</div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;               }</div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;               list[i].size = size;</div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;               <span class="keywordflow">if</span> ((err = <a class="code" href="der__length__object__identifier_8c.html#ae1fe5b2cd3f20a693cc571a2a8fc9af0">der_length_object_identifier</a>(data, size, &amp;z)) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>) {</div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;                  <span class="keywordflow">goto</span> LBL_ERR;</div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;               }</div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;               <span class="keywordflow">break</span>;</div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;</div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;           <span class="keywordflow">case</span> LTC_ASN1_TELETEX_STRING:</div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;               z = inlen;</div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;               <span class="keywordflow">if</span> ((err = <a class="code" href="der__decode__teletex__string_8c.html#a926dc4d05a1a0243569ea85ff85901b6">der_decode_teletex_string</a>(in + x, z, data, &amp;size)) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>) {</div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;                  <span class="keywordflow">if</span> (!ordered || list[i].optional) { <span class="keywordflow">continue</span>; }</div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;                  <span class="keywordflow">goto</span> LBL_ERR;</div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;               }</div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;               list[i].size = size;</div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;               <span class="keywordflow">if</span> ((err = <a class="code" href="der__length__teletex__string_8c.html#a2b3c8aa9d2c26839f9100fdc0286cd93">der_length_teletex_string</a>(data, size, &amp;z)) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>) {</div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;                  <span class="keywordflow">goto</span> LBL_ERR;</div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;               }</div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;               <span class="keywordflow">break</span>;</div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;</div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;           <span class="keywordflow">case</span> LTC_ASN1_IA5_STRING:</div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;               z = inlen;</div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;               <span class="keywordflow">if</span> ((err = <a class="code" href="der__decode__ia5__string_8c.html#ac2868573a2a8857a8463337d8411fe79">der_decode_ia5_string</a>(in + x, z, data, &amp;size)) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>) {</div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;                  <span class="keywordflow">if</span> (!ordered || list[i].optional) { <span class="keywordflow">continue</span>; }</div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;                  <span class="keywordflow">goto</span> LBL_ERR;</div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;               }</div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;               list[i].size = size;</div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;               <span class="keywordflow">if</span> ((err = <a class="code" href="der__length__ia5__string_8c.html#a37e6cf2c534040fe726a760956eade04">der_length_ia5_string</a>(data, size, &amp;z)) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>) {</div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;                  <span class="keywordflow">goto</span> LBL_ERR;</div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;               }</div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;               <span class="keywordflow">break</span>;</div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;</div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;           <span class="keywordflow">case</span> LTC_ASN1_PRINTABLE_STRING:</div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;               z = inlen;</div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;               <span class="keywordflow">if</span> ((err = <a class="code" href="der__decode__printable__string_8c.html#a0967e5db58c3ce6b0971b5c5097c0d9f">der_decode_printable_string</a>(in + x, z, data, &amp;size)) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>) {</div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;                  <span class="keywordflow">if</span> (!ordered || list[i].optional) { <span class="keywordflow">continue</span>; }</div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;                  <span class="keywordflow">goto</span> LBL_ERR;</div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;               }</div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;               list[i].size = size;</div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;               <span class="keywordflow">if</span> ((err = <a class="code" href="der__length__printable__string_8c.html#ac206210b58e1bac2342a80d26bd802db">der_length_printable_string</a>(data, size, &amp;z)) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>) {</div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;                  <span class="keywordflow">goto</span> LBL_ERR;</div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;               }</div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;               <span class="keywordflow">break</span>;</div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;</div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;           <span class="keywordflow">case</span> LTC_ASN1_UTF8_STRING:</div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;               z = inlen;</div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;               <span class="keywordflow">if</span> ((err = <a class="code" href="der__decode__utf8__string_8c.html#afc867f0f02273fac931669abded4cbb3">der_decode_utf8_string</a>(in + x, z, data, &amp;size)) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>) {</div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;                  <span class="keywordflow">if</span> (!ordered || list[i].optional) { <span class="keywordflow">continue</span>; }</div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;                  <span class="keywordflow">goto</span> LBL_ERR;</div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;               }</div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;               list[i].size = size;</div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;               <span class="keywordflow">if</span> ((err = <a class="code" href="der__length__utf8__string_8c.html#aa8b54979c2261c4d703c9464e0bb14c1">der_length_utf8_string</a>(data, size, &amp;z)) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>) {</div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;                  <span class="keywordflow">goto</span> LBL_ERR;</div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;               }</div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;               <span class="keywordflow">break</span>;</div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;</div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;           <span class="keywordflow">case</span> LTC_ASN1_UTCTIME:</div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;               z = inlen;</div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;               <span class="keywordflow">if</span> ((err = <a class="code" href="der__decode__utctime_8c.html#a228dad2e418af24965b9b16188d61aac">der_decode_utctime</a>(in + x, &amp;z, data)) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>) {</div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;                  <span class="keywordflow">if</span> (!ordered || list[i].optional) { <span class="keywordflow">continue</span>; }</div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;                  <span class="keywordflow">goto</span> LBL_ERR;</div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;               }</div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;               <span class="keywordflow">break</span>;</div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;</div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;           <span class="keywordflow">case</span> LTC_ASN1_GENERALIZEDTIME:</div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;               z = inlen;</div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;               <span class="keywordflow">if</span> ((err = <a class="code" href="der__decode__generalizedtime_8c.html#acca5d83c0dcc2bc67d724318132f66e1">der_decode_generalizedtime</a>(in + x, &amp;z, data)) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>) {</div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;                  <span class="keywordflow">if</span> (!ordered || list[i].optional) { <span class="keywordflow">continue</span>; }</div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;                  <span class="keywordflow">goto</span> LBL_ERR;</div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;               }</div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;               <span class="keywordflow">break</span>;</div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;</div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;           <span class="keywordflow">case</span> LTC_ASN1_SET:</div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;               z = inlen;</div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;               <span class="keywordflow">if</span> ((err = der_decode_set(in + x, z, data, size)) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>) {</div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;                  <span class="keywordflow">if</span> (!ordered || list[i].optional) { <span class="keywordflow">continue</span>; }</div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;                  <span class="keywordflow">goto</span> LBL_ERR;</div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;               }</div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;               <span class="keywordflow">if</span> ((err = <a class="code" href="der__length__sequence_8c.html#a46c60ff7d1e17a527913809bffe41546">der_length_sequence</a>(data, size, &amp;z)) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>) {</div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;                  <span class="keywordflow">goto</span> LBL_ERR;</div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;               }</div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;               <span class="keywordflow">break</span>;</div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;</div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;           <span class="keywordflow">case</span> LTC_ASN1_SETOF:</div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;           <span class="keywordflow">case</span> LTC_ASN1_SEQUENCE:</div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;               <span class="comment">/* detect if we have the right type */</span></div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;               <span class="keywordflow">if</span> ((type == LTC_ASN1_SETOF &amp;&amp; (in[x] &amp; 0x3F) != 0x31) || (type == LTC_ASN1_SEQUENCE &amp;&amp; (in[x] &amp; 0x3F) != 0x30)) {</div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;                  err = <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06ca980088f10ffe9009aec286038a9e79da">CRYPT_INVALID_PACKET</a>;</div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;                  <span class="keywordflow">goto</span> LBL_ERR;</div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;               }</div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;</div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;               z = inlen;</div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;               err = <a class="code" href="der__decode__sequence__ex_8c.html#a388cbc3f5c404637bc51f9dfb2d4f677">der_decode_sequence_ex</a>(in + x, z, data, size, flags);</div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;               <span class="keywordflow">if</span> (err == <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cadf938469ecf1be83eff1b661288fae7a">CRYPT_INPUT_TOO_LONG</a>) {</div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;                  seq_err = <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cadf938469ecf1be83eff1b661288fae7a">CRYPT_INPUT_TOO_LONG</a>;</div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;                  err = <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>;</div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;               }</div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;               <span class="keywordflow">if</span> (err != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>) {</div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;                  <span class="keywordflow">if</span> (!ordered || list[i].optional) { <span class="keywordflow">continue</span>; }</div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;                  <span class="keywordflow">goto</span> LBL_ERR;</div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;               }</div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;               <span class="keywordflow">if</span> ((err = <a class="code" href="der__length__sequence_8c.html#a46c60ff7d1e17a527913809bffe41546">der_length_sequence</a>(data, size, &amp;z)) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>) {</div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;                  <span class="keywordflow">goto</span> LBL_ERR;</div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;               }</div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;               <span class="keywordflow">break</span>;</div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;</div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;           <span class="keywordflow">case</span> LTC_ASN1_CUSTOM_TYPE:</div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;               z = inlen;</div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;               err = <a class="code" href="der__decode__custom__type_8c.html#a698f6c64586707819ebd6f90a14264e8">der_decode_custom_type</a>(in + x, z, &amp;list[i]);</div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;               <span class="keywordflow">if</span> (err == <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cadf938469ecf1be83eff1b661288fae7a">CRYPT_INPUT_TOO_LONG</a>) {</div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;                  seq_err = <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cadf938469ecf1be83eff1b661288fae7a">CRYPT_INPUT_TOO_LONG</a>;</div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;                  err = <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>;</div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;               }</div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;               <span class="keywordflow">if</span> (err != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>) {</div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;                  <span class="keywordflow">if</span> (!ordered || list[i].optional) { <span class="keywordflow">continue</span>; }</div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;                  <span class="keywordflow">goto</span> LBL_ERR;</div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;               }</div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;               <span class="keywordflow">if</span> ((err = <a class="code" href="der__length__custom__type_8c.html#aff691792e4f0be46252fad3b9aa4955c">der_length_custom_type</a>(&amp;list[i], &amp;z, NULL)) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>) {</div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;                  <span class="keywordflow">goto</span> LBL_ERR;</div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;               }</div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;               <span class="keywordflow">break</span>;</div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;</div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;           <span class="keywordflow">case</span> LTC_ASN1_CHOICE:</div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;               z = inlen;</div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;               <span class="keywordflow">if</span> ((err = <a class="code" href="der__decode__choice_8c.html#abbc3f8406cbf0c2d75b1c801192dcad4">der_decode_choice</a>(in + x, &amp;z, data, size)) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>) {</div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;                  <span class="keywordflow">if</span> (!ordered || list[i].optional) { <span class="keywordflow">continue</span>; }</div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;                  <span class="keywordflow">goto</span> LBL_ERR;</div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;               }</div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;               <span class="keywordflow">break</span>;</div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;</div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;           <span class="keywordflow">case</span> LTC_ASN1_EOL:</div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;               err = <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06ca92aa8bad3930f08d5a188bf72094b066">CRYPT_INVALID_ARG</a>;</div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;               <span class="keywordflow">goto</span> LBL_ERR;</div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;       }</div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;       x           += z;</div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;       inlen       -= z;</div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;       list[i].used = 1;</div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;       <span class="keywordflow">if</span> (!ordered) {</div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;          <span class="comment">/* restart the decoder */</span></div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;          i = -1;</div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;       }</div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;   }</div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;</div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;   <span class="keywordflow">for</span> (i = 0; i &lt; (int)outlen; i++) {</div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;      <span class="keywordflow">if</span> (list[i].used == 0 &amp;&amp; list[i].optional == 0) {</div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;          err = <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06ca980088f10ffe9009aec286038a9e79da">CRYPT_INVALID_PACKET</a>;</div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;          <span class="keywordflow">goto</span> LBL_ERR;</div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;      }</div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;   }</div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;</div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;   <span class="keywordflow">if</span> (blksize == x &amp;&amp; seq_err == <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a> &amp;&amp; inlen == 0) {</div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;      <span class="comment">/* everything decoded and no errors in nested sequences */</span></div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;      err = <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>;</div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (blksize == x &amp;&amp; seq_err == <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cadf938469ecf1be83eff1b661288fae7a">CRYPT_INPUT_TOO_LONG</a> &amp;&amp; inlen == 0) {</div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;      <span class="comment">/* a sequence reported too-long input, but now we&#39;ve decoded everything */</span></div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;      err = <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>;</div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (blksize != x &amp;&amp; ((flags &amp; LTC_DER_SEQ_STRICT) == LTC_DER_SEQ_STRICT)) {</div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;      err = <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06ca980088f10ffe9009aec286038a9e79da">CRYPT_INVALID_PACKET</a>;</div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;      err = <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cadf938469ecf1be83eff1b661288fae7a">CRYPT_INPUT_TOO_LONG</a>;</div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;   }</div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;</div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;LBL_ERR:</div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;   <span class="keywordflow">if</span> (in_new != NULL) {</div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;      <a class="code" href="tomcrypt__cfg_8h.html#a260d66fc0690e0502cf3bfe7b5244b75">XFREE</a>(in_new);</div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;   }</div><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;   <span class="keywordflow">return</span> err;</div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;}</div><div class="ttc" id="der__length__sequence_8c_html_a46c60ff7d1e17a527913809bffe41546"><div class="ttname"><a href="der__length__sequence_8c.html#a46c60ff7d1e17a527913809bffe41546">der_length_sequence</a></div><div class="ttdeci">int der_length_sequence(const ltc_asn1_list *list, unsigned long inlen, unsigned long *outlen)</div><div class="ttdoc">Get the length of a DER sequence.</div><div class="ttdef"><b>Definition:</b> <a href="der__length__sequence_8c_source.html#l00025">der_length_sequence.c:25</a></div></div>
<div class="ttc" id="der__length__ia5__string_8c_html_a37e6cf2c534040fe726a760956eade04"><div class="ttname"><a href="der__length__ia5__string_8c.html#a37e6cf2c534040fe726a760956eade04">der_length_ia5_string</a></div><div class="ttdeci">int der_length_ia5_string(const unsigned char *octets, unsigned long noctets, unsigned long *outlen)</div><div class="ttdoc">Gets length of DER encoding of IA5 STRING.</div><div class="ttdef"><b>Definition:</b> <a href="der__length__ia5__string_8c_source.html#l00154">der_length_ia5_string.c:154</a></div></div>
<div class="ttc" id="der__decode__boolean_8c_html_a5c72faaf0b34b18bd92db4d95e211a9d"><div class="ttname"><a href="der__decode__boolean_8c.html#a5c72faaf0b34b18bd92db4d95e211a9d">der_decode_boolean</a></div><div class="ttdeci">int der_decode_boolean(const unsigned char *in, unsigned long inlen, int *out)</div><div class="ttdoc">Read a BOOLEAN.</div><div class="ttdef"><b>Definition:</b> <a href="der__decode__boolean_8c_source.html#l00026">der_decode_boolean.c:26</a></div></div>
<div class="ttc" id="tomcrypt_8h_html_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334"><div class="ttname"><a href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a></div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt_8h_source.html#l00042">tomcrypt.h:42</a></div></div>
<div class="ttc" id="tomcrypt_8h_html_adc29c2ff13d900c2f185ee95427fb06ca001cb5383cce7c4581790abe472e816f"><div class="ttname"><a href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06ca001cb5383cce7c4581790abe472e816f">CRYPT_PK_ASN1_ERROR</a></div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt_8h_source.html#l00072">tomcrypt.h:72</a></div></div>
<div class="ttc" id="der__decode__ia5__string_8c_html_ac2868573a2a8857a8463337d8411fe79"><div class="ttname"><a href="der__decode__ia5__string_8c.html#ac2868573a2a8857a8463337d8411fe79">der_decode_ia5_string</a></div><div class="ttdeci">int der_decode_ia5_string(const unsigned char *in, unsigned long inlen, unsigned char *out, unsigned long *outlen)</div><div class="ttdoc">Store a IA5 STRING.</div><div class="ttdef"><b>Definition:</b> <a href="der__decode__ia5__string_8c_source.html#l00027">der_decode_ia5_string.c:27</a></div></div>
<div class="ttc" id="der__decode__bit__string_8c_html_a0a0c371e559e6b455cc4a052d962226f"><div class="ttname"><a href="der__decode__bit__string_8c.html#a0a0c371e559e6b455cc4a052d962226f">der_decode_bit_string</a></div><div class="ttdeci">int der_decode_bit_string(const unsigned char *in, unsigned long inlen, unsigned char *out, unsigned long *outlen)</div><div class="ttdoc">Store a BIT STRING.</div><div class="ttdef"><b>Definition:</b> <a href="der__decode__bit__string_8c_source.html#l00027">der_decode_bit_string.c:27</a></div></div>
<div class="ttc" id="tomcrypt__private_8h_html_af90423764098b8876368d0984d96053a"><div class="ttname"><a href="tomcrypt__private_8h.html#af90423764098b8876368d0984d96053a">der_decode_asn1_length</a></div><div class="ttdeci">int der_decode_asn1_length(const unsigned char *in, unsigned long *inlen, unsigned long *outlen)</div><div class="ttdoc">Decode the ASN.1 Length field.</div><div class="ttdef"><b>Definition:</b> <a href="der__decode__asn1__length_8c_source.html#l00024">der_decode_asn1_length.c:24</a></div></div>
<div class="ttc" id="der__decode__integer_8c_html_ac5b0a7020165ada29ba6278fe128599d"><div class="ttname"><a href="der__decode__integer_8c.html#ac5b0a7020165ada29ba6278fe128599d">der_decode_integer</a></div><div class="ttdeci">int der_decode_integer(const unsigned char *in, unsigned long inlen, void *num)</div><div class="ttdoc">Read a mp_int integer.</div><div class="ttdef"><b>Definition:</b> <a href="der__decode__integer_8c_source.html#l00026">der_decode_integer.c:26</a></div></div>
<div class="ttc" id="der__length__integer_8c_html_af27dfc46ec4a482af05a2265a9d31ca3"><div class="ttname"><a href="der__length__integer_8c.html#af27dfc46ec4a482af05a2265a9d31ca3">der_length_integer</a></div><div class="ttdeci">int der_length_integer(void *num, unsigned long *outlen)</div><div class="ttdoc">Gets length of DER encoding of num.</div><div class="ttdef"><b>Definition:</b> <a href="der__length__integer_8c_source.html#l00024">der_length_integer.c:24</a></div></div>
<div class="ttc" id="der__decode__sequence__ex_8c_html_a388cbc3f5c404637bc51f9dfb2d4f677"><div class="ttname"><a href="der__decode__sequence__ex_8c.html#a388cbc3f5c404637bc51f9dfb2d4f677">der_decode_sequence_ex</a></div><div class="ttdeci">int der_decode_sequence_ex(const unsigned char *in, unsigned long inlen, ltc_asn1_list *list, unsigned long outlen, unsigned int flags)</div><div class="ttdoc">Decode a SEQUENCE.</div><div class="ttdef"><b>Definition:</b> <a href="der__decode__sequence__ex_8c_source.html#l00028">der_decode_sequence_ex.c:28</a></div></div>
<div class="ttc" id="tomcrypt__cfg_8h_html_af363355f38fbaacdefacf270436ae1c9"><div class="ttname"><a href="tomcrypt__cfg_8h.html#af363355f38fbaacdefacf270436ae1c9">XMALLOC</a></div><div class="ttdeci">void * XMALLOC(size_t n)</div></div>
<div class="ttc" id="der__length__short__integer_8c_html_aa3bac08094cc8142ac313d818cf73fb0"><div class="ttname"><a href="der__length__short__integer_8c.html#aa3bac08094cc8142ac313d818cf73fb0">der_length_short_integer</a></div><div class="ttdeci">int der_length_short_integer(unsigned long num, unsigned long *outlen)</div><div class="ttdoc">Gets length of DER encoding of num.</div><div class="ttdef"><b>Definition:</b> <a href="der__length__short__integer_8c_source.html#l00024">der_length_short_integer.c:24</a></div></div>
<div class="ttc" id="tomcrypt__argchk_8h_html_a683da3e041e49f196318b6ea951414ba"><div class="ttname"><a href="tomcrypt__argchk_8h.html#a683da3e041e49f196318b6ea951414ba">LTC_ARGCHK</a></div><div class="ttdeci">#define LTC_ARGCHK(x)</div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt__argchk_8h_source.html#l00019">tomcrypt_argchk.h:19</a></div></div>
<div class="ttc" id="der__decode__printable__string_8c_html_a0967e5db58c3ce6b0971b5c5097c0d9f"><div class="ttname"><a href="der__decode__printable__string_8c.html#a0967e5db58c3ce6b0971b5c5097c0d9f">der_decode_printable_string</a></div><div class="ttdeci">int der_decode_printable_string(const unsigned char *in, unsigned long inlen, unsigned char *out, unsigned long *outlen)</div><div class="ttdoc">Store a printable STRING.</div><div class="ttdef"><b>Definition:</b> <a href="der__decode__printable__string_8c_source.html#l00027">der_decode_printable_string.c:27</a></div></div>
<div class="ttc" id="der__decode__utctime_8c_html_a228dad2e418af24965b9b16188d61aac"><div class="ttname"><a href="der__decode__utctime_8c.html#a228dad2e418af24965b9b16188d61aac">der_decode_utctime</a></div><div class="ttdeci">int der_decode_utctime(const unsigned char *in, unsigned long *inlen, ltc_utctime *out)</div><div class="ttdoc">Decodes a UTC time structure in DER format (reads all 6 valid encoding formats)</div><div class="ttdef"><b>Definition:</b> <a href="der__decode__utctime_8c_source.html#l00047">der_decode_utctime.c:47</a></div></div>
<div class="ttc" id="der__decode__teletex__string_8c_html_a926dc4d05a1a0243569ea85ff85901b6"><div class="ttname"><a href="der__decode__teletex__string_8c.html#a926dc4d05a1a0243569ea85ff85901b6">der_decode_teletex_string</a></div><div class="ttdeci">int der_decode_teletex_string(const unsigned char *in, unsigned long inlen, unsigned char *out, unsigned long *outlen)</div><div class="ttdoc">Store a teletex STRING.</div><div class="ttdef"><b>Definition:</b> <a href="der__decode__teletex__string_8c_source.html#l00026">der_decode_teletex_string.c:26</a></div></div>
<div class="ttc" id="der__decode__generalizedtime_8c_html_acca5d83c0dcc2bc67d724318132f66e1"><div class="ttname"><a href="der__decode__generalizedtime_8c.html#acca5d83c0dcc2bc67d724318132f66e1">der_decode_generalizedtime</a></div><div class="ttdeci">int der_decode_generalizedtime(const unsigned char *in, unsigned long *inlen, ltc_generalizedtime *out)</div><div class="ttdoc">Decodes a Generalized time structure in DER format (reads all 6 valid encoding formats)</div><div class="ttdef"><b>Definition:</b> <a href="der__decode__generalizedtime_8c_source.html#l00055">der_decode_generalizedtime.c:55</a></div></div>
<div class="ttc" id="tomcrypt__private_8h_html_ae8d2a220c8f5b51d2db97b0382a9f206"><div class="ttname"><a href="tomcrypt__private_8h.html#ae8d2a220c8f5b51d2db97b0382a9f206">der_asn1_type_to_identifier_map_sz</a></div><div class="ttdeci">const unsigned long der_asn1_type_to_identifier_map_sz</div><div class="ttdef"><b>Definition:</b> <a href="der__asn1__maps_8c_source.html#l00048">der_asn1_maps.c:48</a></div></div>
<div class="ttc" id="der__decode__raw__bit__string_8c_html_a4e8241401c8f49b3b2dbadd1b8e0eee0"><div class="ttname"><a href="der__decode__raw__bit__string_8c.html#a4e8241401c8f49b3b2dbadd1b8e0eee0">der_decode_raw_bit_string</a></div><div class="ttdeci">int der_decode_raw_bit_string(const unsigned char *in, unsigned long inlen, unsigned char *out, unsigned long *outlen)</div><div class="ttdoc">Store a BIT STRING.</div><div class="ttdef"><b>Definition:</b> <a href="der__decode__raw__bit__string_8c_source.html#l00030">der_decode_raw_bit_string.c:30</a></div></div>
<div class="ttc" id="tomcrypt_8h_html_adc29c2ff13d900c2f185ee95427fb06ca980088f10ffe9009aec286038a9e79da"><div class="ttname"><a href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06ca980088f10ffe9009aec286038a9e79da">CRYPT_INVALID_PACKET</a></div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt_8h_source.html#l00051">tomcrypt.h:51</a></div></div>
<div class="ttc" id="tomcrypt__private_8h_html_a651ad7c1f5a930476bb10b9d61555346"><div class="ttname"><a href="tomcrypt__private_8h.html#a651ad7c1f5a930476bb10b9d61555346">der_decode_asn1_identifier</a></div><div class="ttdeci">int der_decode_asn1_identifier(const unsigned char *in, unsigned long *inlen, ltc_asn1_list *id)</div><div class="ttdoc">Decode the ASN.1 Identifier.</div><div class="ttdef"><b>Definition:</b> <a href="der__decode__asn1__identifier_8c_source.html#l00065">der_decode_asn1_identifier.c:65</a></div></div>
<div class="ttc" id="der__decode__octet__string_8c_html_af315ce6a951697ede7ec4c9716b5b20b"><div class="ttname"><a href="der__decode__octet__string_8c.html#af315ce6a951697ede7ec4c9716b5b20b">der_decode_octet_string</a></div><div class="ttdeci">int der_decode_octet_string(const unsigned char *in, unsigned long inlen, unsigned char *out, unsigned long *outlen)</div><div class="ttdoc">Store a OCTET STRING.</div><div class="ttdef"><b>Definition:</b> <a href="der__decode__octet__string_8c_source.html#l00027">der_decode_octet_string.c:27</a></div></div>
<div class="ttc" id="der__length__teletex__string_8c_html_a2b3c8aa9d2c26839f9100fdc0286cd93"><div class="ttname"><a href="der__length__teletex__string_8c.html#a2b3c8aa9d2c26839f9100fdc0286cd93">der_length_teletex_string</a></div><div class="ttdeci">int der_length_teletex_string(const unsigned char *octets, unsigned long noctets, unsigned long *outlen)</div><div class="ttdoc">Gets length of DER encoding of teletex STRING.</div><div class="ttdef"><b>Definition:</b> <a href="der__length__teletex__string_8c_source.html#l00170">der_length_teletex_string.c:170</a></div></div>
<div class="ttc" id="tomcrypt_8h_html_adc29c2ff13d900c2f185ee95427fb06ca0ce0d27adc7ea10b74b7ea904b8bfa82"><div class="ttname"><a href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06ca0ce0d27adc7ea10b74b7ea904b8bfa82">CRYPT_MEM</a></div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt_8h_source.html#l00060">tomcrypt.h:60</a></div></div>
<div class="ttc" id="der__decode__custom__type_8c_html_a698f6c64586707819ebd6f90a14264e8"><div class="ttname"><a href="der__decode__custom__type_8c.html#a698f6c64586707819ebd6f90a14264e8">der_decode_custom_type</a></div><div class="ttdeci">int der_decode_custom_type(const unsigned char *in, unsigned long inlen, ltc_asn1_list *root)</div><div class="ttdoc">Decode a Custom type.</div><div class="ttdef"><b>Definition:</b> <a href="der__decode__custom__type_8c_source.html#l00026">der_decode_custom_type.c:26</a></div></div>
<div class="ttc" id="tomcrypt__cfg_8h_html_a260d66fc0690e0502cf3bfe7b5244b75"><div class="ttname"><a href="tomcrypt__cfg_8h.html#a260d66fc0690e0502cf3bfe7b5244b75">XFREE</a></div><div class="ttdeci">void XFREE(void *p)</div></div>
<div class="ttc" id="der__length__custom__type_8c_html_aff691792e4f0be46252fad3b9aa4955c"><div class="ttname"><a href="der__length__custom__type_8c.html#aff691792e4f0be46252fad3b9aa4955c">der_length_custom_type</a></div><div class="ttdeci">int der_length_custom_type(const ltc_asn1_list *root, unsigned long *outlen, unsigned long *payloadlen)</div><div class="ttdoc">Get the length of a DER custom type.</div><div class="ttdef"><b>Definition:</b> <a href="der__length__custom__type_8c_source.html#l00029">der_length_custom_type.c:29</a></div></div>
<div class="ttc" id="der__decode__utf8__string_8c_html_afc867f0f02273fac931669abded4cbb3"><div class="ttname"><a href="der__decode__utf8__string_8c.html#afc867f0f02273fac931669abded4cbb3">der_decode_utf8_string</a></div><div class="ttdeci">int der_decode_utf8_string(const unsigned char *in, unsigned long inlen, wchar_t *out, unsigned long *outlen)</div><div class="ttdoc">Store a UTF8 STRING.</div><div class="ttdef"><b>Definition:</b> <a href="der__decode__utf8__string_8c_source.html#l00027">der_decode_utf8_string.c:27</a></div></div>
<div class="ttc" id="tomcrypt_8h_html_adc29c2ff13d900c2f185ee95427fb06ca92aa8bad3930f08d5a188bf72094b066"><div class="ttname"><a href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06ca92aa8bad3930f08d5a188bf72094b066">CRYPT_INVALID_ARG</a></div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt_8h_source.html#l00065">tomcrypt.h:65</a></div></div>
<div class="ttc" id="der__length__boolean_8c_html_aa90c23682da0279cbe55ea64b2c3e381"><div class="ttname"><a href="der__length__boolean_8c.html#aa90c23682da0279cbe55ea64b2c3e381">der_length_boolean</a></div><div class="ttdeci">int der_length_boolean(unsigned long *outlen)</div><div class="ttdoc">Gets length of DER encoding of a BOOLEAN.</div><div class="ttdef"><b>Definition:</b> <a href="der__length__boolean_8c_source.html#l00022">der_length_boolean.c:22</a></div></div>
<div class="ttc" id="der__length__bit__string_8c_html_a73416248e2f93535d54603567acc9cfd"><div class="ttname"><a href="der__length__bit__string_8c.html#a73416248e2f93535d54603567acc9cfd">der_length_bit_string</a></div><div class="ttdeci">int der_length_bit_string(unsigned long nbits, unsigned long *outlen)</div><div class="ttdoc">Gets length of DER encoding of BIT STRING.</div><div class="ttdef"><b>Definition:</b> <a href="der__length__bit__string_8c_source.html#l00023">der_length_bit_string.c:23</a></div></div>
<div class="ttc" id="tomcrypt__private_8h_html_a6306ca88074facac89ee0f6c04cbf2f2"><div class="ttname"><a href="tomcrypt__private_8h.html#a6306ca88074facac89ee0f6c04cbf2f2">der_asn1_type_to_identifier_map</a></div><div class="ttdeci">const int der_asn1_type_to_identifier_map[]</div><div class="ttdoc">A Map from ltc_asn1_type to the regularly used ASN.1 identifier.</div><div class="ttdef"><b>Definition:</b> <a href="der__asn1__maps_8c_source.html#l00021">der_asn1_maps.c:21</a></div></div>
<div class="ttc" id="der__decode__choice_8c_html_abbc3f8406cbf0c2d75b1c801192dcad4"><div class="ttname"><a href="der__decode__choice_8c.html#abbc3f8406cbf0c2d75b1c801192dcad4">der_decode_choice</a></div><div class="ttdeci">int der_decode_choice(const unsigned char *in, unsigned long *inlen, ltc_asn1_list *list, unsigned long outlen)</div><div class="ttdoc">Decode a CHOICE.</div><div class="ttdef"><b>Definition:</b> <a href="der__decode__choice_8c_source.html#l00026">der_decode_choice.c:26</a></div></div>
<div class="ttc" id="der__length__octet__string_8c_html_a65b2f3065d3f51608a1dfa3b284a74df"><div class="ttname"><a href="der__length__octet__string_8c.html#a65b2f3065d3f51608a1dfa3b284a74df">der_length_octet_string</a></div><div class="ttdeci">int der_length_octet_string(unsigned long noctets, unsigned long *outlen)</div><div class="ttdoc">Gets length of DER encoding of OCTET STRING.</div><div class="ttdef"><b>Definition:</b> <a href="der__length__octet__string_8c_source.html#l00023">der_length_octet_string.c:23</a></div></div>
<div class="ttc" id="der__length__printable__string_8c_html_ac206210b58e1bac2342a80d26bd802db"><div class="ttname"><a href="der__length__printable__string_8c.html#ac206210b58e1bac2342a80d26bd802db">der_length_printable_string</a></div><div class="ttdeci">int der_length_printable_string(const unsigned char *octets, unsigned long noctets, unsigned long *outlen)</div><div class="ttdoc">Gets length of DER encoding of Printable STRING.</div><div class="ttdef"><b>Definition:</b> <a href="der__length__printable__string_8c_source.html#l00126">der_length_printable_string.c:126</a></div></div>
<div class="ttc" id="der__length__object__identifier_8c_html_ae1fe5b2cd3f20a693cc571a2a8fc9af0"><div class="ttname"><a href="der__length__object__identifier_8c.html#ae1fe5b2cd3f20a693cc571a2a8fc9af0">der_length_object_identifier</a></div><div class="ttdeci">int der_length_object_identifier(const unsigned long *words, unsigned long nwords, unsigned long *outlen)</div><div class="ttdoc">Gets length of DER encoding of Object Identifier.</div><div class="ttdef"><b>Definition:</b> <a href="der__length__object__identifier_8c_source.html#l00038">der_length_object_identifier.c:38</a></div></div>
<div class="ttc" id="der__decode__short__integer_8c_html_a1f8c5c4ead2ebe96a1a852329c62154c"><div class="ttname"><a href="der__decode__short__integer_8c.html#a1f8c5c4ead2ebe96a1a852329c62154c">der_decode_short_integer</a></div><div class="ttdeci">int der_decode_short_integer(const unsigned char *in, unsigned long inlen, unsigned long *num)</div><div class="ttdoc">Read a short integer.</div><div class="ttdef"><b>Definition:</b> <a href="der__decode__short__integer_8c_source.html#l00026">der_decode_short_integer.c:26</a></div></div>
<div class="ttc" id="tomcrypt__cfg_8h_html_a7691dd48d60d5fc6daf2fa7ec4c55e12"><div class="ttname"><a href="tomcrypt__cfg_8h.html#a7691dd48d60d5fc6daf2fa7ec4c55e12">XMEMCPY</a></div><div class="ttdeci">void * XMEMCPY(void *dest, const void *src, size_t n)</div></div>
<div class="ttc" id="der__length__utf8__string_8c_html_aa8b54979c2261c4d703c9464e0bb14c1"><div class="ttname"><a href="der__length__utf8__string_8c.html#aa8b54979c2261c4d703c9464e0bb14c1">der_length_utf8_string</a></div><div class="ttdeci">int der_length_utf8_string(const wchar_t *in, unsigned long noctets, unsigned long *outlen)</div><div class="ttdoc">Gets length of DER encoding of UTF8 STRING.</div><div class="ttdef"><b>Definition:</b> <a href="der__length__utf8__string_8c_source.html#l00064">der_length_utf8_string.c:64</a></div></div>
<div class="ttc" id="tomcrypt_8h_html_adc29c2ff13d900c2f185ee95427fb06cadf938469ecf1be83eff1b661288fae7a"><div class="ttname"><a href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cadf938469ecf1be83eff1b661288fae7a">CRYPT_INPUT_TOO_LONG</a></div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt_8h_source.html#l00074">tomcrypt.h:74</a></div></div>
<div class="ttc" id="der__decode__object__identifier_8c_html_aee91111fe2b92dca6c83e6c7de36be8f"><div class="ttname"><a href="der__decode__object__identifier_8c.html#aee91111fe2b92dca6c83e6c7de36be8f">der_decode_object_identifier</a></div><div class="ttdeci">int der_decode_object_identifier(const unsigned char *in, unsigned long inlen, unsigned long *words, unsigned long *outlen)</div><div class="ttdoc">Decode OID data and store the array of integers in words.</div><div class="ttdef"><b>Definition:</b> <a href="der__decode__object__identifier_8c_source.html#l00025">der_decode_object_identifier.c:25</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="tomcrypt_8h_source.html#l00074">CRYPT_INPUT_TOO_LONG</a>, <a class="el" href="tomcrypt_8h_source.html#l00065">CRYPT_INVALID_ARG</a>, <a class="el" href="tomcrypt_8h_source.html#l00051">CRYPT_INVALID_PACKET</a>, <a class="el" href="tomcrypt_8h_source.html#l00060">CRYPT_MEM</a>, <a class="el" href="tomcrypt_8h_source.html#l00042">CRYPT_OK</a>, <a class="el" href="tomcrypt_8h_source.html#l00072">CRYPT_PK_ASN1_ERROR</a>, <a class="el" href="der__asn1__maps_8c_source.html#l00021">der_asn1_type_to_identifier_map</a>, <a class="el" href="der__asn1__maps_8c_source.html#l00048">der_asn1_type_to_identifier_map_sz</a>, <a class="el" href="der__decode__asn1__identifier_8c_source.html#l00065">der_decode_asn1_identifier()</a>, <a class="el" href="der__decode__asn1__length_8c_source.html#l00024">der_decode_asn1_length()</a>, <a class="el" href="der__decode__bit__string_8c_source.html#l00027">der_decode_bit_string()</a>, <a class="el" href="der__decode__boolean_8c_source.html#l00026">der_decode_boolean()</a>, <a class="el" href="der__decode__choice_8c_source.html#l00026">der_decode_choice()</a>, <a class="el" href="der__decode__custom__type_8c_source.html#l00026">der_decode_custom_type()</a>, <a class="el" href="der__decode__generalizedtime_8c_source.html#l00055">der_decode_generalizedtime()</a>, <a class="el" href="der__decode__ia5__string_8c_source.html#l00027">der_decode_ia5_string()</a>, <a class="el" href="der__decode__integer_8c_source.html#l00026">der_decode_integer()</a>, <a class="el" href="der__decode__object__identifier_8c_source.html#l00025">der_decode_object_identifier()</a>, <a class="el" href="der__decode__octet__string_8c_source.html#l00027">der_decode_octet_string()</a>, <a class="el" href="der__decode__printable__string_8c_source.html#l00027">der_decode_printable_string()</a>, <a class="el" href="der__decode__raw__bit__string_8c_source.html#l00030">der_decode_raw_bit_string()</a>, <a class="el" href="der__decode__sequence__ex_8c_source.html#l00028">der_decode_sequence_ex()</a>, <a class="el" href="der__decode__short__integer_8c_source.html#l00026">der_decode_short_integer()</a>, <a class="el" href="der__decode__teletex__string_8c_source.html#l00026">der_decode_teletex_string()</a>, <a class="el" href="der__decode__utctime_8c_source.html#l00047">der_decode_utctime()</a>, <a class="el" href="der__decode__utf8__string_8c_source.html#l00027">der_decode_utf8_string()</a>, <a class="el" href="der__length__bit__string_8c_source.html#l00023">der_length_bit_string()</a>, <a class="el" href="der__length__boolean_8c_source.html#l00022">der_length_boolean()</a>, <a class="el" href="der__length__custom__type_8c_source.html#l00029">der_length_custom_type()</a>, <a class="el" href="der__length__ia5__string_8c_source.html#l00154">der_length_ia5_string()</a>, <a class="el" href="der__length__integer_8c_source.html#l00024">der_length_integer()</a>, <a class="el" href="der__length__object__identifier_8c_source.html#l00038">der_length_object_identifier()</a>, <a class="el" href="der__length__octet__string_8c_source.html#l00023">der_length_octet_string()</a>, <a class="el" href="der__length__printable__string_8c_source.html#l00126">der_length_printable_string()</a>, <a class="el" href="der__length__sequence_8c_source.html#l00025">der_length_sequence()</a>, <a class="el" href="der__length__short__integer_8c_source.html#l00024">der_length_short_integer()</a>, <a class="el" href="der__length__teletex__string_8c_source.html#l00170">der_length_teletex_string()</a>, <a class="el" href="der__length__utf8__string_8c_source.html#l00064">der_length_utf8_string()</a>, <a class="el" href="tomcrypt__argchk_8h_source.html#l00019">LTC_ARGCHK</a>, <a class="el" href="tomcrypt__cfg_8h.html#a260d66fc0690e0502cf3bfe7b5244b75">XFREE()</a>, <a class="el" href="tomcrypt__cfg_8h.html#af363355f38fbaacdefacf270436ae1c9">XMALLOC()</a>, and <a class="el" href="tomcrypt__cfg_8h.html#a7691dd48d60d5fc6daf2fa7ec4c55e12">XMEMCPY()</a>.</p>

<p class="reference">Referenced by <a class="el" href="der__decode__custom__type_8c_source.html#l00026">der_decode_custom_type()</a>, and <a class="el" href="der__decode__sequence__ex_8c_source.html#l00028">der_decode_sequence_ex()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="tomcrypt__private_8h_aaa3acc13042e5d9244ac279a354775fe_cgraph.png" border="0" usemap="#tomcrypt__private_8h_aaa3acc13042e5d9244ac279a354775fe_cgraph" alt=""/></div>
<!-- MAP 5 -->
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="tomcrypt__private_8h_aaa3acc13042e5d9244ac279a354775fe_icgraph.png" border="0" usemap="#tomcrypt__private_8h_aaa3acc13042e5d9244ac279a354775fe_icgraph" alt=""/></div>
<!-- MAP 6 -->
</div>

</div>
</div>
<a id="ab5141cf36663054d9ec6e46ed6909fce"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab5141cf36663054d9ec6e46ed6909fce">&#9670;&nbsp;</a></span>der_decode_sequence_multi_ex()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int der_decode_sequence_multi_ex </td>
          <td>(</td>
          <td class="paramtype">const unsigned char *&#160;</td>
          <td class="paramname"><em>in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned long&#160;</td>
          <td class="paramname"><em>inlen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>flags</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>...</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Decode a SEQUENCE type using a VA list. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">in</td><td>Input buffer </td></tr>
    <tr><td class="paramname">inlen</td><td>Length of input in octets </td></tr>
    <tr><td class="paramname">flags</td><td>c.f. enum ltc_der_seq </td></tr>
  </table>
  </dd>
</dl>
<dl class="section remark"><dt>Remarks</dt><dd>&lt;...&gt; is of the form &lt;type, size, data&gt; (int, unsigned long, void*) </dd></dl>
<dl class="section return"><dt>Returns</dt><dd>CRYPT_OK on success </dd></dl>

<p class="definition">Definition at line <a class="el" href="der__decode__sequence__multi_8c_source.html#l00167">167</a> of file <a class="el" href="der__decode__sequence__multi_8c_source.html">der_decode_sequence_multi.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;{</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;   va_list       a1, a2;</div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;   <span class="keywordtype">int</span> err;</div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;</div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;   <a class="code" href="tomcrypt__argchk_8h.html#a683da3e041e49f196318b6ea951414ba">LTC_ARGCHK</a>(in    != NULL);</div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;</div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;   va_start(a1, flags);</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;   va_start(a2, flags);</div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;   err = <a class="code" href="der__decode__sequence__multi_8c.html#a1c505b541a0ed6ddcdccc8ddcef9ed9e">_der_decode_sequence_va</a>(in, inlen, a1, a2, flags);</div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;</div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;   va_end(a2);</div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;   va_end(a1);</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;   <span class="keywordflow">return</span> err;</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;}</div><div class="ttc" id="tomcrypt__argchk_8h_html_a683da3e041e49f196318b6ea951414ba"><div class="ttname"><a href="tomcrypt__argchk_8h.html#a683da3e041e49f196318b6ea951414ba">LTC_ARGCHK</a></div><div class="ttdeci">#define LTC_ARGCHK(x)</div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt__argchk_8h_source.html#l00019">tomcrypt_argchk.h:19</a></div></div>
<div class="ttc" id="der__decode__sequence__multi_8c_html_a1c505b541a0ed6ddcdccc8ddcef9ed9e"><div class="ttname"><a href="der__decode__sequence__multi_8c.html#a1c505b541a0ed6ddcdccc8ddcef9ed9e">_der_decode_sequence_va</a></div><div class="ttdeci">static int _der_decode_sequence_va(const unsigned char *in, unsigned long inlen, va_list a1, va_list a2, unsigned int flags)</div><div class="ttdoc">Decode a SEQUENCE type using a VA list.</div><div class="ttdef"><b>Definition:</b> <a href="der__decode__sequence__multi_8c_source.html#l00029">der_decode_sequence_multi.c:29</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="der__decode__sequence__multi_8c_source.html#l00029">_der_decode_sequence_va()</a>, and <a class="el" href="tomcrypt__argchk_8h_source.html#l00019">LTC_ARGCHK</a>.</p>

<p class="reference">Referenced by <a class="el" href="ecc__recover__key_8c_source.html#l00032">ecc_recover_key()</a>, and <a class="el" href="ecc__verify__hash_8c_source.html#l00030">ecc_verify_hash_ex()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="tomcrypt__private_8h_ab5141cf36663054d9ec6e46ed6909fce_cgraph.png" border="0" usemap="#tomcrypt__private_8h_ab5141cf36663054d9ec6e46ed6909fce_cgraph" alt=""/></div>
<!-- MAP 7 -->
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="tomcrypt__private_8h_ab5141cf36663054d9ec6e46ed6909fce_icgraph.png" border="0" usemap="#tomcrypt__private_8h_ab5141cf36663054d9ec6e46ed6909fce_icgraph" alt=""/></div>
<!-- MAP 8 -->
</div>

</div>
</div>
<a id="a093815c0cc44624723a3d668992b3008"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a093815c0cc44624723a3d668992b3008">&#9670;&nbsp;</a></span>der_encode_asn1_identifier()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int der_encode_asn1_identifier </td>
          <td>(</td>
          <td class="paramtype">const ltc_asn1_list *&#160;</td>
          <td class="paramname"><em>id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char *&#160;</td>
          <td class="paramname"><em>out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned long *&#160;</td>
          <td class="paramname"><em>outlen</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Encode the ASN.1 Identifier. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">id</td><td>The ASN.1 Identifer to encode </td></tr>
    <tr><td class="paramname">out</td><td>Where to write the identifier to </td></tr>
    <tr><td class="paramname">outlen</td><td>[in/out] The size of out available/written </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>CRYPT_OK if successful </dd></dl>

<p class="definition">Definition at line <a class="el" href="der__encode__asn1__identifier_8c_source.html#l00024">24</a> of file <a class="el" href="der__encode__asn1__identifier_8c_source.html">der_encode_asn1_identifier.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;{</div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;   <a class="code" href="tomcrypt__cfg_8h.html#ab4afaf24b39288a7be6fd03fe8345f61">ulong64</a> tmp;</div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;   <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> tag_len;</div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;</div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;   <a class="code" href="tomcrypt__argchk_8h.html#a683da3e041e49f196318b6ea951414ba">LTC_ARGCHK</a>(<span class="keywordtype">id</span>  != NULL);</div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;   <a class="code" href="tomcrypt__argchk_8h.html#a683da3e041e49f196318b6ea951414ba">LTC_ARGCHK</a>(outlen != NULL);</div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;</div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;   <span class="keywordflow">if</span> (id-&gt;type != LTC_ASN1_CUSTOM_TYPE) {</div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;      <span class="keywordflow">if</span> ((<span class="keywordtype">unsigned</span>)id-&gt;type &gt;= <a class="code" href="tomcrypt__private_8h.html#ae8d2a220c8f5b51d2db97b0382a9f206">der_asn1_type_to_identifier_map_sz</a>) {</div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;         <span class="keywordflow">return</span> <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06ca92aa8bad3930f08d5a188bf72094b066">CRYPT_INVALID_ARG</a>;</div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;      }</div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="tomcrypt__private_8h.html#a6306ca88074facac89ee0f6c04cbf2f2">der_asn1_type_to_identifier_map</a>[id-&gt;type] == -1) {</div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;         <span class="keywordflow">return</span> <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06ca92aa8bad3930f08d5a188bf72094b066">CRYPT_INVALID_ARG</a>;</div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;      }</div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;      <span class="keywordflow">if</span> (out != NULL) {</div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;         *out = <a class="code" href="tomcrypt__private_8h.html#a6306ca88074facac89ee0f6c04cbf2f2">der_asn1_type_to_identifier_map</a>[<span class="keywordtype">id</span>-&gt;type];</div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;      }</div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;      *outlen = 1;</div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>;</div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;   }</div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;   <span class="keywordflow">if</span> (id-&gt;klass &lt; LTC_ASN1_CL_UNIVERSAL || id-&gt;klass &gt; LTC_ASN1_CL_PRIVATE) {</div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06ca92aa8bad3930f08d5a188bf72094b066">CRYPT_INVALID_ARG</a>;</div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;   }</div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;   <span class="keywordflow">if</span> (id-&gt;pc &lt; LTC_ASN1_PC_PRIMITIVE || id-&gt;pc &gt; LTC_ASN1_PC_CONSTRUCTED) {</div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06ca92aa8bad3930f08d5a188bf72094b066">CRYPT_INVALID_ARG</a>;</div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;   }</div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;   <span class="keywordflow">if</span> (id-&gt;tag &gt; (ULONG_MAX &gt;&gt; (8 + 7))) {</div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06ca92aa8bad3930f08d5a188bf72094b066">CRYPT_INVALID_ARG</a>;</div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;   }</div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;</div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;   <span class="keywordflow">if</span> (out != NULL) {</div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;      <span class="keywordflow">if</span> (*outlen &lt; 1) {</div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;         <span class="keywordflow">return</span> <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06caccd878f5599f3036ffe759dbe1a1ac16">CRYPT_BUFFER_OVERFLOW</a>;</div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;      }</div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;</div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;      out[0] = <span class="keywordtype">id</span>-&gt;klass &lt;&lt; 6 | <span class="keywordtype">id</span>-&gt;pc &lt;&lt; 5;</div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;   }</div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;</div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;   <span class="keywordflow">if</span> (id-&gt;tag &lt; 0x1f) {</div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;      <span class="keywordflow">if</span> (out != NULL) {</div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;         out[0] |= <span class="keywordtype">id</span>-&gt;tag &amp; 0x1f;</div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;      }</div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;      *outlen = 1;</div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;      tag_len = 0;</div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;      tmp = <span class="keywordtype">id</span>-&gt;tag;</div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;      <span class="keywordflow">do</span> {</div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;         tag_len++;</div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;         tmp &gt;&gt;= 7;</div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;      } <span class="keywordflow">while</span> (tmp);</div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;      <span class="keywordflow">if</span> (out != NULL) {</div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;         <span class="keywordflow">if</span> (*outlen &lt; tag_len + 1) {</div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06caccd878f5599f3036ffe759dbe1a1ac16">CRYPT_BUFFER_OVERFLOW</a>;</div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;         }</div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;         out[0] |= 0x1f;</div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;         <span class="keywordflow">for</span> (tmp = 1; tmp &lt;= tag_len; ++tmp) {</div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;            out[tmp] = ((<span class="keywordtype">id</span>-&gt;tag &gt;&gt; (7 * (tag_len - tmp))) &amp; 0x7f) | 0x80;</div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;         }</div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;         out[tag_len] &amp;= ~0x80;</div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;      }</div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;      *outlen = tag_len + 1;</div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;   }</div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;</div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>;</div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;}</div><div class="ttc" id="tomcrypt_8h_html_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334"><div class="ttname"><a href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a></div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt_8h_source.html#l00042">tomcrypt.h:42</a></div></div>
<div class="ttc" id="tomcrypt__argchk_8h_html_a683da3e041e49f196318b6ea951414ba"><div class="ttname"><a href="tomcrypt__argchk_8h.html#a683da3e041e49f196318b6ea951414ba">LTC_ARGCHK</a></div><div class="ttdeci">#define LTC_ARGCHK(x)</div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt__argchk_8h_source.html#l00019">tomcrypt_argchk.h:19</a></div></div>
<div class="ttc" id="tomcrypt__private_8h_html_ae8d2a220c8f5b51d2db97b0382a9f206"><div class="ttname"><a href="tomcrypt__private_8h.html#ae8d2a220c8f5b51d2db97b0382a9f206">der_asn1_type_to_identifier_map_sz</a></div><div class="ttdeci">const unsigned long der_asn1_type_to_identifier_map_sz</div><div class="ttdef"><b>Definition:</b> <a href="der__asn1__maps_8c_source.html#l00048">der_asn1_maps.c:48</a></div></div>
<div class="ttc" id="tomcrypt_8h_html_adc29c2ff13d900c2f185ee95427fb06ca92aa8bad3930f08d5a188bf72094b066"><div class="ttname"><a href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06ca92aa8bad3930f08d5a188bf72094b066">CRYPT_INVALID_ARG</a></div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt_8h_source.html#l00065">tomcrypt.h:65</a></div></div>
<div class="ttc" id="tomcrypt__private_8h_html_a6306ca88074facac89ee0f6c04cbf2f2"><div class="ttname"><a href="tomcrypt__private_8h.html#a6306ca88074facac89ee0f6c04cbf2f2">der_asn1_type_to_identifier_map</a></div><div class="ttdeci">const int der_asn1_type_to_identifier_map[]</div><div class="ttdoc">A Map from ltc_asn1_type to the regularly used ASN.1 identifier.</div><div class="ttdef"><b>Definition:</b> <a href="der__asn1__maps_8c_source.html#l00021">der_asn1_maps.c:21</a></div></div>
<div class="ttc" id="tomcrypt__cfg_8h_html_ab4afaf24b39288a7be6fd03fe8345f61"><div class="ttname"><a href="tomcrypt__cfg_8h.html#ab4afaf24b39288a7be6fd03fe8345f61">ulong64</a></div><div class="ttdeci">unsigned long long ulong64</div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt__cfg_8h_source.html#l00211">tomcrypt_cfg.h:211</a></div></div>
<div class="ttc" id="tomcrypt_8h_html_adc29c2ff13d900c2f185ee95427fb06caccd878f5599f3036ffe759dbe1a1ac16"><div class="ttname"><a href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06caccd878f5599f3036ffe759dbe1a1ac16">CRYPT_BUFFER_OVERFLOW</a></div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt_8h_source.html#l00050">tomcrypt.h:50</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="tomcrypt_8h_source.html#l00050">CRYPT_BUFFER_OVERFLOW</a>, <a class="el" href="tomcrypt_8h_source.html#l00065">CRYPT_INVALID_ARG</a>, <a class="el" href="tomcrypt_8h_source.html#l00042">CRYPT_OK</a>, <a class="el" href="der__asn1__maps_8c_source.html#l00021">der_asn1_type_to_identifier_map</a>, <a class="el" href="der__asn1__maps_8c_source.html#l00048">der_asn1_type_to_identifier_map_sz</a>, and <a class="el" href="tomcrypt__argchk_8h_source.html#l00019">LTC_ARGCHK</a>.</p>

<p class="reference">Referenced by <a class="el" href="der__encode__custom__type_8c_source.html#l00030">der_encode_custom_type()</a>, and <a class="el" href="der__length__asn1__identifier_8c_source.html#l00024">der_length_asn1_identifier()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="tomcrypt__private_8h_a093815c0cc44624723a3d668992b3008_icgraph.png" border="0" usemap="#tomcrypt__private_8h_a093815c0cc44624723a3d668992b3008_icgraph" alt=""/></div>
<!-- MAP 9 -->
</div>

</div>
</div>
<a id="ae0b6c1f1188a5aa201aa84de9a659550"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae0b6c1f1188a5aa201aa84de9a659550">&#9670;&nbsp;</a></span>der_encode_asn1_length()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int der_encode_asn1_length </td>
          <td>(</td>
          <td class="paramtype">unsigned long&#160;</td>
          <td class="paramname"><em>len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char *&#160;</td>
          <td class="paramname"><em>out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned long *&#160;</td>
          <td class="paramname"><em>outlen</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Encode the ASN.1 length field. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">len</td><td>The length to encode </td></tr>
    <tr><td class="paramname">out</td><td>Where to write the length field to </td></tr>
    <tr><td class="paramname">outlen</td><td>[in/out] The size of out available/written </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>CRYPT_OK if successful </dd></dl>

<p class="definition">Definition at line <a class="el" href="der__encode__asn1__length_8c_source.html#l00024">24</a> of file <a class="el" href="der__encode__asn1__length_8c_source.html">der_encode_asn1_length.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;{</div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;   <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> x, y;</div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;</div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;   <a class="code" href="tomcrypt__argchk_8h.html#a683da3e041e49f196318b6ea951414ba">LTC_ARGCHK</a>(outlen != NULL);</div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;</div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;   x = <a class="code" href="ocb__init_8c.html#afed088663f8704004425cdae2120b9b3">len</a>;</div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;   y = 0;</div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;</div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;   <span class="keywordflow">while</span>(x != 0) {</div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;      y++;</div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;      x &gt;&gt;= 8;</div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;   }</div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;   <span class="keywordflow">if</span> (y == 0) {</div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06ca001cb5383cce7c4581790abe472e816f">CRYPT_PK_ASN1_ERROR</a>;</div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;   }</div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;</div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;   <span class="keywordflow">if</span> (out == NULL) {</div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="ocb__init_8c.html#afed088663f8704004425cdae2120b9b3">len</a> &lt; 128) {</div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;         x = y;</div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;         x = y + 1;</div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;      }</div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;      <span class="keywordflow">if</span> (*outlen &lt; y) {</div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;         <span class="keywordflow">return</span> <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06caccd878f5599f3036ffe759dbe1a1ac16">CRYPT_BUFFER_OVERFLOW</a>;</div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;      }</div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;      x = 0;</div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="ocb__init_8c.html#afed088663f8704004425cdae2120b9b3">len</a> &lt; 128) {</div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;         out[x++] = (<span class="keywordtype">unsigned</span> char)<a class="code" href="ocb__init_8c.html#afed088663f8704004425cdae2120b9b3">len</a>;</div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="ocb__init_8c.html#afed088663f8704004425cdae2120b9b3">len</a> &lt;= 0xffUL) {</div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;         out[x++] = 0x81;</div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;         out[x++] = (<span class="keywordtype">unsigned</span> char)<a class="code" href="ocb__init_8c.html#afed088663f8704004425cdae2120b9b3">len</a>;</div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="ocb__init_8c.html#afed088663f8704004425cdae2120b9b3">len</a> &lt;= 0xffffUL) {</div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;         out[x++] = 0x82;</div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;         out[x++] = (<span class="keywordtype">unsigned</span> char)((<a class="code" href="ocb__init_8c.html#afed088663f8704004425cdae2120b9b3">len</a>&gt;&gt;8UL)&amp;255);</div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;         out[x++] = (<span class="keywordtype">unsigned</span> char)(<a class="code" href="ocb__init_8c.html#afed088663f8704004425cdae2120b9b3">len</a>&amp;255);</div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="ocb__init_8c.html#afed088663f8704004425cdae2120b9b3">len</a> &lt;= 0xffffffUL) {</div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;         out[x++] = 0x83;</div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;         out[x++] = (<span class="keywordtype">unsigned</span> char)((<a class="code" href="ocb__init_8c.html#afed088663f8704004425cdae2120b9b3">len</a>&gt;&gt;16UL)&amp;255);</div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;         out[x++] = (<span class="keywordtype">unsigned</span> char)((<a class="code" href="ocb__init_8c.html#afed088663f8704004425cdae2120b9b3">len</a>&gt;&gt;8UL)&amp;255);</div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;         out[x++] = (<span class="keywordtype">unsigned</span> char)(<a class="code" href="ocb__init_8c.html#afed088663f8704004425cdae2120b9b3">len</a>&amp;255);</div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;<span class="preprocessor">      #if ULONG_MAX != ULLONG_MAX</span></div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;         out[x++] = 0x84;</div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;         out[x++] = (<span class="keywordtype">unsigned</span> char)((<a class="code" href="ocb__init_8c.html#afed088663f8704004425cdae2120b9b3">len</a>&gt;&gt;24UL)&amp;255);</div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;         out[x++] = (<span class="keywordtype">unsigned</span> char)((<a class="code" href="ocb__init_8c.html#afed088663f8704004425cdae2120b9b3">len</a>&gt;&gt;16UL)&amp;255);</div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;         out[x++] = (<span class="keywordtype">unsigned</span> char)((<a class="code" href="ocb__init_8c.html#afed088663f8704004425cdae2120b9b3">len</a>&gt;&gt;8UL)&amp;255);</div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;         out[x++] = (<span class="keywordtype">unsigned</span> char)(<a class="code" href="ocb__init_8c.html#afed088663f8704004425cdae2120b9b3">len</a>&amp;255);</div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;      }</div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;<span class="preprocessor">      #else</span></div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="ocb__init_8c.html#afed088663f8704004425cdae2120b9b3">len</a> &lt;= 0xffffffffUL) {</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;         out[x++] = 0x84;</div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;         out[x++] = (<span class="keywordtype">unsigned</span> char)((<a class="code" href="ocb__init_8c.html#afed088663f8704004425cdae2120b9b3">len</a>&gt;&gt;24UL)&amp;255);</div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;         out[x++] = (<span class="keywordtype">unsigned</span> char)((<a class="code" href="ocb__init_8c.html#afed088663f8704004425cdae2120b9b3">len</a>&gt;&gt;16UL)&amp;255);</div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;         out[x++] = (<span class="keywordtype">unsigned</span> char)((<a class="code" href="ocb__init_8c.html#afed088663f8704004425cdae2120b9b3">len</a>&gt;&gt;8UL)&amp;255);</div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;         out[x++] = (<span class="keywordtype">unsigned</span> char)(<a class="code" href="ocb__init_8c.html#afed088663f8704004425cdae2120b9b3">len</a>&amp;255);</div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="ocb__init_8c.html#afed088663f8704004425cdae2120b9b3">len</a> &lt;= 0xffffffffffULL) {</div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;         out[x++] = 0x85;</div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;         out[x++] = (<span class="keywordtype">unsigned</span> char)((<a class="code" href="ocb__init_8c.html#afed088663f8704004425cdae2120b9b3">len</a>&gt;&gt;32ULL)&amp;255);</div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;         out[x++] = (<span class="keywordtype">unsigned</span> char)((<a class="code" href="ocb__init_8c.html#afed088663f8704004425cdae2120b9b3">len</a>&gt;&gt;24ULL)&amp;255);</div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;         out[x++] = (<span class="keywordtype">unsigned</span> char)((<a class="code" href="ocb__init_8c.html#afed088663f8704004425cdae2120b9b3">len</a>&gt;&gt;16ULL)&amp;255);</div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;         out[x++] = (<span class="keywordtype">unsigned</span> char)((<a class="code" href="ocb__init_8c.html#afed088663f8704004425cdae2120b9b3">len</a>&gt;&gt;8ULL)&amp;255);</div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;         out[x++] = (<span class="keywordtype">unsigned</span> char)(<a class="code" href="ocb__init_8c.html#afed088663f8704004425cdae2120b9b3">len</a>&amp;255);</div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="ocb__init_8c.html#afed088663f8704004425cdae2120b9b3">len</a> &lt;= 0xffffffffffffULL) {</div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;         out[x++] = 0x86;</div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;         out[x++] = (<span class="keywordtype">unsigned</span> char)((<a class="code" href="ocb__init_8c.html#afed088663f8704004425cdae2120b9b3">len</a>&gt;&gt;40ULL)&amp;255);</div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;         out[x++] = (<span class="keywordtype">unsigned</span> char)((<a class="code" href="ocb__init_8c.html#afed088663f8704004425cdae2120b9b3">len</a>&gt;&gt;32ULL)&amp;255);</div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;         out[x++] = (<span class="keywordtype">unsigned</span> char)((<a class="code" href="ocb__init_8c.html#afed088663f8704004425cdae2120b9b3">len</a>&gt;&gt;24ULL)&amp;255);</div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;         out[x++] = (<span class="keywordtype">unsigned</span> char)((<a class="code" href="ocb__init_8c.html#afed088663f8704004425cdae2120b9b3">len</a>&gt;&gt;16ULL)&amp;255);</div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;         out[x++] = (<span class="keywordtype">unsigned</span> char)((<a class="code" href="ocb__init_8c.html#afed088663f8704004425cdae2120b9b3">len</a>&gt;&gt;8ULL)&amp;255);</div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;         out[x++] = (<span class="keywordtype">unsigned</span> char)(<a class="code" href="ocb__init_8c.html#afed088663f8704004425cdae2120b9b3">len</a>&amp;255);</div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="ocb__init_8c.html#afed088663f8704004425cdae2120b9b3">len</a> &lt;= 0xffffffffffffffULL) {</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;         out[x++] = 0x87;</div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;         out[x++] = (<span class="keywordtype">unsigned</span> char)((<a class="code" href="ocb__init_8c.html#afed088663f8704004425cdae2120b9b3">len</a>&gt;&gt;48ULL)&amp;255);</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;         out[x++] = (<span class="keywordtype">unsigned</span> char)((<a class="code" href="ocb__init_8c.html#afed088663f8704004425cdae2120b9b3">len</a>&gt;&gt;40ULL)&amp;255);</div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;         out[x++] = (<span class="keywordtype">unsigned</span> char)((<a class="code" href="ocb__init_8c.html#afed088663f8704004425cdae2120b9b3">len</a>&gt;&gt;32ULL)&amp;255);</div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;         out[x++] = (<span class="keywordtype">unsigned</span> char)((<a class="code" href="ocb__init_8c.html#afed088663f8704004425cdae2120b9b3">len</a>&gt;&gt;24ULL)&amp;255);</div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;         out[x++] = (<span class="keywordtype">unsigned</span> char)((<a class="code" href="ocb__init_8c.html#afed088663f8704004425cdae2120b9b3">len</a>&gt;&gt;16ULL)&amp;255);</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;         out[x++] = (<span class="keywordtype">unsigned</span> char)((<a class="code" href="ocb__init_8c.html#afed088663f8704004425cdae2120b9b3">len</a>&gt;&gt;8ULL)&amp;255);</div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;         out[x++] = (<span class="keywordtype">unsigned</span> char)(<a class="code" href="ocb__init_8c.html#afed088663f8704004425cdae2120b9b3">len</a>&amp;255);</div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;         out[x++] = 0x88;</div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;         out[x++] = (<span class="keywordtype">unsigned</span> char)((<a class="code" href="ocb__init_8c.html#afed088663f8704004425cdae2120b9b3">len</a>&gt;&gt;56ULL)&amp;255);</div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;         out[x++] = (<span class="keywordtype">unsigned</span> char)((<a class="code" href="ocb__init_8c.html#afed088663f8704004425cdae2120b9b3">len</a>&gt;&gt;48ULL)&amp;255);</div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;         out[x++] = (<span class="keywordtype">unsigned</span> char)((<a class="code" href="ocb__init_8c.html#afed088663f8704004425cdae2120b9b3">len</a>&gt;&gt;40ULL)&amp;255);</div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;         out[x++] = (<span class="keywordtype">unsigned</span> char)((<a class="code" href="ocb__init_8c.html#afed088663f8704004425cdae2120b9b3">len</a>&gt;&gt;32ULL)&amp;255);</div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;         out[x++] = (<span class="keywordtype">unsigned</span> char)((<a class="code" href="ocb__init_8c.html#afed088663f8704004425cdae2120b9b3">len</a>&gt;&gt;24ULL)&amp;255);</div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;         out[x++] = (<span class="keywordtype">unsigned</span> char)((<a class="code" href="ocb__init_8c.html#afed088663f8704004425cdae2120b9b3">len</a>&gt;&gt;16ULL)&amp;255);</div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;         out[x++] = (<span class="keywordtype">unsigned</span> char)((<a class="code" href="ocb__init_8c.html#afed088663f8704004425cdae2120b9b3">len</a>&gt;&gt;8ULL)&amp;255);</div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;         out[x++] = (<span class="keywordtype">unsigned</span> char)(<a class="code" href="ocb__init_8c.html#afed088663f8704004425cdae2120b9b3">len</a>&amp;255);</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;      }</div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;<span class="preprocessor">      #endif</span></div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;   }</div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;   *outlen = x;</div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;</div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>;</div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;}</div><div class="ttc" id="tomcrypt_8h_html_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334"><div class="ttname"><a href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a></div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt_8h_source.html#l00042">tomcrypt.h:42</a></div></div>
<div class="ttc" id="tomcrypt_8h_html_adc29c2ff13d900c2f185ee95427fb06ca001cb5383cce7c4581790abe472e816f"><div class="ttname"><a href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06ca001cb5383cce7c4581790abe472e816f">CRYPT_PK_ASN1_ERROR</a></div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt_8h_source.html#l00072">tomcrypt.h:72</a></div></div>
<div class="ttc" id="tomcrypt__argchk_8h_html_a683da3e041e49f196318b6ea951414ba"><div class="ttname"><a href="tomcrypt__argchk_8h.html#a683da3e041e49f196318b6ea951414ba">LTC_ARGCHK</a></div><div class="ttdeci">#define LTC_ARGCHK(x)</div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt__argchk_8h_source.html#l00019">tomcrypt_argchk.h:19</a></div></div>
<div class="ttc" id="ocb__init_8c_html_afed088663f8704004425cdae2120b9b3"><div class="ttname"><a href="ocb__init_8c.html#afed088663f8704004425cdae2120b9b3">len</a></div><div class="ttdeci">int len</div><div class="ttdef"><b>Definition:</b> <a href="ocb__init_8c_source.html#l00019">ocb_init.c:19</a></div></div>
<div class="ttc" id="tomcrypt_8h_html_adc29c2ff13d900c2f185ee95427fb06caccd878f5599f3036ffe759dbe1a1ac16"><div class="ttname"><a href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06caccd878f5599f3036ffe759dbe1a1ac16">CRYPT_BUFFER_OVERFLOW</a></div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt_8h_source.html#l00050">tomcrypt.h:50</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="tomcrypt_8h_source.html#l00050">CRYPT_BUFFER_OVERFLOW</a>, <a class="el" href="tomcrypt_8h_source.html#l00072">CRYPT_PK_ASN1_ERROR</a>, <a class="el" href="ocb__init_8c_source.html#l00019">len</a>, and <a class="el" href="tomcrypt__argchk_8h_source.html#l00019">LTC_ARGCHK</a>.</p>

<p class="reference">Referenced by <a class="el" href="der__encode__bit__string_8c_source.html#l00027">der_encode_bit_string()</a>, <a class="el" href="der__encode__custom__type_8c_source.html#l00030">der_encode_custom_type()</a>, <a class="el" href="der__encode__ia5__string_8c_source.html#l00026">der_encode_ia5_string()</a>, <a class="el" href="der__encode__integer_8c_source.html#l00027">der_encode_integer()</a>, <a class="el" href="der__encode__object__identifier_8c_source.html#l00025">der_encode_object_identifier()</a>, <a class="el" href="der__encode__octet__string_8c_source.html#l00027">der_encode_octet_string()</a>, <a class="el" href="der__encode__printable__string_8c_source.html#l00026">der_encode_printable_string()</a>, <a class="el" href="der__encode__raw__bit__string_8c_source.html#l00029">der_encode_raw_bit_string()</a>, <a class="el" href="der__encode__sequence__ex_8c_source.html#l00028">der_encode_sequence_ex()</a>, <a class="el" href="der__encode__utf8__string_8c_source.html#l00027">der_encode_utf8_string()</a>, and <a class="el" href="der__length__asn1__length_8c_source.html#l00023">der_length_asn1_length()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="tomcrypt__private_8h_ae0b6c1f1188a5aa201aa84de9a659550_icgraph.png" border="0" usemap="#tomcrypt__private_8h_ae0b6c1f1188a5aa201aa84de9a659550_icgraph" alt=""/></div>
<!-- MAP 10 -->
</div>

</div>
</div>
<a id="a12ee6e955851d0daff84581e3770a807"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a12ee6e955851d0daff84581e3770a807">&#9670;&nbsp;</a></span>der_length_asn1_identifier()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int der_length_asn1_identifier </td>
          <td>(</td>
          <td class="paramtype">const ltc_asn1_list *&#160;</td>
          <td class="paramname"><em>id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned long *&#160;</td>
          <td class="paramname"><em>idlen</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Determine the length required when encoding the ASN.1 Identifier. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">id</td><td>The ASN.1 identifier to encode </td></tr>
    <tr><td class="paramname">idlen</td><td>[out] The required length to encode list </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>CRYPT_OK if successful </dd></dl>

<p class="definition">Definition at line <a class="el" href="der__length__asn1__identifier_8c_source.html#l00024">24</a> of file <a class="el" href="der__length__asn1__identifier_8c_source.html">der_length_asn1_identifier.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;{</div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="tomcrypt__private_8h.html#a093815c0cc44624723a3d668992b3008">der_encode_asn1_identifier</a>(<span class="keywordtype">id</span>, NULL, idlen);</div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;}</div><div class="ttc" id="tomcrypt__private_8h_html_a093815c0cc44624723a3d668992b3008"><div class="ttname"><a href="tomcrypt__private_8h.html#a093815c0cc44624723a3d668992b3008">der_encode_asn1_identifier</a></div><div class="ttdeci">int der_encode_asn1_identifier(const ltc_asn1_list *id, unsigned char *out, unsigned long *outlen)</div><div class="ttdoc">Encode the ASN.1 Identifier.</div><div class="ttdef"><b>Definition:</b> <a href="der__encode__asn1__identifier_8c_source.html#l00024">der_encode_asn1_identifier.c:24</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="der__encode__asn1__identifier_8c_source.html#l00024">der_encode_asn1_identifier()</a>.</p>

<p class="reference">Referenced by <a class="el" href="der__encode__custom__type_8c_source.html#l00030">der_encode_custom_type()</a>, and <a class="el" href="der__length__custom__type_8c_source.html#l00029">der_length_custom_type()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="tomcrypt__private_8h_a12ee6e955851d0daff84581e3770a807_cgraph.png" border="0" usemap="#tomcrypt__private_8h_a12ee6e955851d0daff84581e3770a807_cgraph" alt=""/></div>
<!-- MAP 11 -->
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="tomcrypt__private_8h_a12ee6e955851d0daff84581e3770a807_icgraph.png" border="0" usemap="#tomcrypt__private_8h_a12ee6e955851d0daff84581e3770a807_icgraph" alt=""/></div>
<!-- MAP 12 -->
</div>

</div>
</div>
<a id="a8999e23c66cda0d777570e54f3a5c795"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8999e23c66cda0d777570e54f3a5c795">&#9670;&nbsp;</a></span>der_length_asn1_length()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int der_length_asn1_length </td>
          <td>(</td>
          <td class="paramtype">unsigned long&#160;</td>
          <td class="paramname"><em>len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned long *&#160;</td>
          <td class="paramname"><em>outlen</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Determine the length required to encode len in the ASN.1 length field. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">len</td><td>The length to encode </td></tr>
    <tr><td class="paramname">outlen</td><td>[out] The length that's required to store len </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>CRYPT_OK if successful </dd></dl>

<p class="definition">Definition at line <a class="el" href="der__length__asn1__length_8c_source.html#l00023">23</a> of file <a class="el" href="der__length__asn1__length_8c_source.html">der_length_asn1_length.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;{</div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="tomcrypt__private_8h.html#ae0b6c1f1188a5aa201aa84de9a659550">der_encode_asn1_length</a>(<a class="code" href="ocb__init_8c.html#afed088663f8704004425cdae2120b9b3">len</a>, NULL, outlen);</div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;}</div><div class="ttc" id="ocb__init_8c_html_afed088663f8704004425cdae2120b9b3"><div class="ttname"><a href="ocb__init_8c.html#afed088663f8704004425cdae2120b9b3">len</a></div><div class="ttdeci">int len</div><div class="ttdef"><b>Definition:</b> <a href="ocb__init_8c_source.html#l00019">ocb_init.c:19</a></div></div>
<div class="ttc" id="tomcrypt__private_8h_html_ae0b6c1f1188a5aa201aa84de9a659550"><div class="ttname"><a href="tomcrypt__private_8h.html#ae0b6c1f1188a5aa201aa84de9a659550">der_encode_asn1_length</a></div><div class="ttdeci">int der_encode_asn1_length(unsigned long len, unsigned char *out, unsigned long *outlen)</div><div class="ttdoc">Encode the ASN.1 length field.</div><div class="ttdef"><b>Definition:</b> <a href="der__encode__asn1__length_8c_source.html#l00024">der_encode_asn1_length.c:24</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="der__encode__asn1__length_8c_source.html#l00024">der_encode_asn1_length()</a>, and <a class="el" href="ocb__init_8c_source.html#l00019">len</a>.</p>

<p class="reference">Referenced by <a class="el" href="der__encode__utf8__string_8c_source.html#l00027">der_encode_utf8_string()</a>, <a class="el" href="der__length__bit__string_8c_source.html#l00023">der_length_bit_string()</a>, <a class="el" href="der__length__custom__type_8c_source.html#l00029">der_length_custom_type()</a>, <a class="el" href="der__length__ia5__string_8c_source.html#l00154">der_length_ia5_string()</a>, <a class="el" href="der__length__integer_8c_source.html#l00024">der_length_integer()</a>, <a class="el" href="der__length__octet__string_8c_source.html#l00023">der_length_octet_string()</a>, <a class="el" href="der__length__printable__string_8c_source.html#l00126">der_length_printable_string()</a>, <a class="el" href="der__length__sequence_8c_source.html#l00031">der_length_sequence_ex()</a>, <a class="el" href="der__length__short__integer_8c_source.html#l00024">der_length_short_integer()</a>, <a class="el" href="der__length__teletex__string_8c_source.html#l00170">der_length_teletex_string()</a>, and <a class="el" href="der__length__utf8__string_8c_source.html#l00064">der_length_utf8_string()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="tomcrypt__private_8h_a8999e23c66cda0d777570e54f3a5c795_cgraph.png" border="0" usemap="#tomcrypt__private_8h_a8999e23c66cda0d777570e54f3a5c795_cgraph" alt=""/></div>
<!-- MAP 13 -->
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="tomcrypt__private_8h_a8999e23c66cda0d777570e54f3a5c795_icgraph.png" border="0" usemap="#tomcrypt__private_8h_a8999e23c66cda0d777570e54f3a5c795_icgraph" alt=""/></div>
<!-- MAP 14 -->
</div>

</div>
</div>
<a id="ad3804ae56675e41a9d142c62d6c3bb2d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad3804ae56675e41a9d142c62d6c3bb2d">&#9670;&nbsp;</a></span>der_length_sequence_ex()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int der_length_sequence_ex </td>
          <td>(</td>
          <td class="paramtype">const ltc_asn1_list *&#160;</td>
          <td class="paramname"><em>list</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned long&#160;</td>
          <td class="paramname"><em>inlen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned long *&#160;</td>
          <td class="paramname"><em>outlen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned long *&#160;</td>
          <td class="paramname"><em>payloadlen</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="der__length__sequence_8c_source.html#l00031">31</a> of file <a class="el" href="der__length__sequence_8c_source.html">der_length_sequence.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;{</div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;   <span class="keywordtype">int</span>           err;</div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;   ltc_asn1_type type;</div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;   <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> size, x, y, i;</div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;   <span class="keywordtype">void</span>          *data;</div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;</div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;   <a class="code" href="tomcrypt__argchk_8h.html#a683da3e041e49f196318b6ea951414ba">LTC_ARGCHK</a>(list    != NULL);</div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;   <a class="code" href="tomcrypt__argchk_8h.html#a683da3e041e49f196318b6ea951414ba">LTC_ARGCHK</a>(outlen  != NULL);</div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;</div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;   <span class="comment">/* get size of output that will be required */</span></div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;   y = 0;</div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;   <span class="keywordflow">for</span> (i = 0; i &lt; inlen; i++) {</div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;       type = list[i].type;</div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;       size = list[i].size;</div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;       data = list[i].data;</div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;</div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;       <span class="keywordflow">if</span> (type == LTC_ASN1_EOL) {</div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;          <span class="keywordflow">break</span>;</div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;       }</div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;</div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;       <span class="comment">/* some items may be optional during import */</span></div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;       <span class="keywordflow">if</span> (!list[i].used &amp;&amp; list[i].optional) <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;</div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;       <span class="keywordflow">switch</span> (type) {</div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;           <span class="keywordflow">case</span> LTC_ASN1_BOOLEAN:</div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;              <span class="keywordflow">if</span> ((err = <a class="code" href="der__length__boolean_8c.html#aa90c23682da0279cbe55ea64b2c3e381">der_length_boolean</a>(&amp;x)) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>) {</div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;                 <span class="keywordflow">goto</span> LBL_ERR;</div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;              }</div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;              y += x;</div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;              <span class="keywordflow">break</span>;</div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;</div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;           <span class="keywordflow">case</span> LTC_ASN1_INTEGER:</div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;               <span class="keywordflow">if</span> ((err = <a class="code" href="der__length__integer_8c.html#af27dfc46ec4a482af05a2265a9d31ca3">der_length_integer</a>(data, &amp;x)) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>) {</div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;                  <span class="keywordflow">goto</span> LBL_ERR;</div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;               }</div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;               y += x;</div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;               <span class="keywordflow">break</span>;</div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;</div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;           <span class="keywordflow">case</span> LTC_ASN1_SHORT_INTEGER:</div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;               <span class="keywordflow">if</span> ((err = <a class="code" href="der__length__short__integer_8c.html#aa3bac08094cc8142ac313d818cf73fb0">der_length_short_integer</a>(*((<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> *)data), &amp;x)) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>) {</div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;                  <span class="keywordflow">goto</span> LBL_ERR;</div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;               }</div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;               y += x;</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;               <span class="keywordflow">break</span>;</div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;</div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;           <span class="keywordflow">case</span> LTC_ASN1_BIT_STRING:</div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;           <span class="keywordflow">case</span> LTC_ASN1_RAW_BIT_STRING:</div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;               <span class="keywordflow">if</span> ((err = <a class="code" href="der__length__bit__string_8c.html#a73416248e2f93535d54603567acc9cfd">der_length_bit_string</a>(size, &amp;x)) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>) {</div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;                  <span class="keywordflow">goto</span> LBL_ERR;</div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;               }</div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;               y += x;</div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;               <span class="keywordflow">break</span>;</div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;</div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;           <span class="keywordflow">case</span> LTC_ASN1_OCTET_STRING:</div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;               <span class="keywordflow">if</span> ((err = <a class="code" href="der__length__octet__string_8c.html#a65b2f3065d3f51608a1dfa3b284a74df">der_length_octet_string</a>(size, &amp;x)) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>) {</div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;                  <span class="keywordflow">goto</span> LBL_ERR;</div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;               }</div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;               y += x;</div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;               <span class="keywordflow">break</span>;</div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;</div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;           <span class="keywordflow">case</span> LTC_ASN1_NULL:</div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;               y += 2;</div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;               <span class="keywordflow">break</span>;</div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;           <span class="keywordflow">case</span> LTC_ASN1_OBJECT_IDENTIFIER:</div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;               <span class="keywordflow">if</span> ((err = <a class="code" href="der__length__object__identifier_8c.html#ae1fe5b2cd3f20a693cc571a2a8fc9af0">der_length_object_identifier</a>(data, size, &amp;x)) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>) {</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;                  <span class="keywordflow">goto</span> LBL_ERR;</div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;               }</div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;               y += x;</div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;               <span class="keywordflow">break</span>;</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;</div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;           <span class="keywordflow">case</span> LTC_ASN1_IA5_STRING:</div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;               <span class="keywordflow">if</span> ((err = <a class="code" href="der__length__ia5__string_8c.html#a37e6cf2c534040fe726a760956eade04">der_length_ia5_string</a>(data, size, &amp;x)) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>) {</div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;                  <span class="keywordflow">goto</span> LBL_ERR;</div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;               }</div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;               y += x;</div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;               <span class="keywordflow">break</span>;</div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;</div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;           <span class="keywordflow">case</span> LTC_ASN1_TELETEX_STRING:</div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;               <span class="keywordflow">if</span> ((err = <a class="code" href="der__length__teletex__string_8c.html#a2b3c8aa9d2c26839f9100fdc0286cd93">der_length_teletex_string</a>(data, size, &amp;x)) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>) {</div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;                  <span class="keywordflow">goto</span> LBL_ERR;</div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;               }</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;               y += x;</div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;               <span class="keywordflow">break</span>;</div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;</div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;           <span class="keywordflow">case</span> LTC_ASN1_PRINTABLE_STRING:</div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;               <span class="keywordflow">if</span> ((err = <a class="code" href="der__length__printable__string_8c.html#ac206210b58e1bac2342a80d26bd802db">der_length_printable_string</a>(data, size, &amp;x)) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>) {</div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;                  <span class="keywordflow">goto</span> LBL_ERR;</div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;               }</div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;               y += x;</div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;               <span class="keywordflow">break</span>;</div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;</div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;           <span class="keywordflow">case</span> LTC_ASN1_UTCTIME:</div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;               <span class="keywordflow">if</span> ((err = <a class="code" href="der__length__utctime_8c.html#a666e7656df6985a9eb25794b878ec4e7">der_length_utctime</a>(data, &amp;x)) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>) {</div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;                  <span class="keywordflow">goto</span> LBL_ERR;</div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;               }</div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;               y += x;</div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;               <span class="keywordflow">break</span>;</div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;</div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;           <span class="keywordflow">case</span> LTC_ASN1_GENERALIZEDTIME:</div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;               <span class="keywordflow">if</span> ((err = <a class="code" href="der__length__generalizedtime_8c.html#a63bd3379e9d6aa710a6ddcea3d836754">der_length_generalizedtime</a>(data, &amp;x)) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>) {</div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;                  <span class="keywordflow">goto</span> LBL_ERR;</div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;               }</div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;               y += x;</div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;               <span class="keywordflow">break</span>;</div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;</div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;           <span class="keywordflow">case</span> LTC_ASN1_UTF8_STRING:</div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;               <span class="keywordflow">if</span> ((err = <a class="code" href="der__length__utf8__string_8c.html#aa8b54979c2261c4d703c9464e0bb14c1">der_length_utf8_string</a>(data, size, &amp;x)) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>) {</div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;                  <span class="keywordflow">goto</span> LBL_ERR;</div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;               }</div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;               y += x;</div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;               <span class="keywordflow">break</span>;</div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;</div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;           <span class="keywordflow">case</span> LTC_ASN1_CUSTOM_TYPE:</div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;               <span class="keywordflow">if</span> ((err = <a class="code" href="der__length__custom__type_8c.html#aff691792e4f0be46252fad3b9aa4955c">der_length_custom_type</a>(&amp;list[i], &amp;x, NULL)) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>) {</div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;                  <span class="keywordflow">goto</span> LBL_ERR;</div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;               }</div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;               y += x;</div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;               <span class="keywordflow">break</span>;</div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;</div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;           <span class="keywordflow">case</span> LTC_ASN1_SET:</div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;           <span class="keywordflow">case</span> LTC_ASN1_SETOF:</div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;           <span class="keywordflow">case</span> LTC_ASN1_SEQUENCE:</div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;               <span class="keywordflow">if</span> ((err = <a class="code" href="der__length__sequence_8c.html#a46c60ff7d1e17a527913809bffe41546">der_length_sequence</a>(data, size, &amp;x)) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>) {</div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;                  <span class="keywordflow">goto</span> LBL_ERR;</div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;               }</div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;               y += x;</div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;               <span class="keywordflow">break</span>;</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;           <span class="keywordflow">case</span> LTC_ASN1_CHOICE:</div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;           <span class="keywordflow">case</span> LTC_ASN1_EOL:</div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;               err = <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06ca92aa8bad3930f08d5a188bf72094b066">CRYPT_INVALID_ARG</a>;</div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;               <span class="keywordflow">goto</span> LBL_ERR;</div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;       }</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;   }</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;   <span class="keywordflow">if</span> ((err = <a class="code" href="tomcrypt__private_8h.html#a8999e23c66cda0d777570e54f3a5c795">der_length_asn1_length</a>(y, &amp;x)) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>) {</div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;      <span class="keywordflow">goto</span> LBL_ERR;</div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;   }</div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;</div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;   <span class="keywordflow">if</span> (payloadlen != NULL) {</div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;      *payloadlen = y;</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;   }</div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;   <span class="comment">/* store size */</span></div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;   *outlen = y + x + 1;</div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;   err     = <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>;</div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;LBL_ERR:</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;   <span class="keywordflow">return</span> err;</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;}</div><div class="ttc" id="der__length__sequence_8c_html_a46c60ff7d1e17a527913809bffe41546"><div class="ttname"><a href="der__length__sequence_8c.html#a46c60ff7d1e17a527913809bffe41546">der_length_sequence</a></div><div class="ttdeci">int der_length_sequence(const ltc_asn1_list *list, unsigned long inlen, unsigned long *outlen)</div><div class="ttdoc">Get the length of a DER sequence.</div><div class="ttdef"><b>Definition:</b> <a href="der__length__sequence_8c_source.html#l00025">der_length_sequence.c:25</a></div></div>
<div class="ttc" id="der__length__ia5__string_8c_html_a37e6cf2c534040fe726a760956eade04"><div class="ttname"><a href="der__length__ia5__string_8c.html#a37e6cf2c534040fe726a760956eade04">der_length_ia5_string</a></div><div class="ttdeci">int der_length_ia5_string(const unsigned char *octets, unsigned long noctets, unsigned long *outlen)</div><div class="ttdoc">Gets length of DER encoding of IA5 STRING.</div><div class="ttdef"><b>Definition:</b> <a href="der__length__ia5__string_8c_source.html#l00154">der_length_ia5_string.c:154</a></div></div>
<div class="ttc" id="tomcrypt_8h_html_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334"><div class="ttname"><a href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a></div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt_8h_source.html#l00042">tomcrypt.h:42</a></div></div>
<div class="ttc" id="der__length__integer_8c_html_af27dfc46ec4a482af05a2265a9d31ca3"><div class="ttname"><a href="der__length__integer_8c.html#af27dfc46ec4a482af05a2265a9d31ca3">der_length_integer</a></div><div class="ttdeci">int der_length_integer(void *num, unsigned long *outlen)</div><div class="ttdoc">Gets length of DER encoding of num.</div><div class="ttdef"><b>Definition:</b> <a href="der__length__integer_8c_source.html#l00024">der_length_integer.c:24</a></div></div>
<div class="ttc" id="der__length__short__integer_8c_html_aa3bac08094cc8142ac313d818cf73fb0"><div class="ttname"><a href="der__length__short__integer_8c.html#aa3bac08094cc8142ac313d818cf73fb0">der_length_short_integer</a></div><div class="ttdeci">int der_length_short_integer(unsigned long num, unsigned long *outlen)</div><div class="ttdoc">Gets length of DER encoding of num.</div><div class="ttdef"><b>Definition:</b> <a href="der__length__short__integer_8c_source.html#l00024">der_length_short_integer.c:24</a></div></div>
<div class="ttc" id="tomcrypt__argchk_8h_html_a683da3e041e49f196318b6ea951414ba"><div class="ttname"><a href="tomcrypt__argchk_8h.html#a683da3e041e49f196318b6ea951414ba">LTC_ARGCHK</a></div><div class="ttdeci">#define LTC_ARGCHK(x)</div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt__argchk_8h_source.html#l00019">tomcrypt_argchk.h:19</a></div></div>
<div class="ttc" id="der__length__teletex__string_8c_html_a2b3c8aa9d2c26839f9100fdc0286cd93"><div class="ttname"><a href="der__length__teletex__string_8c.html#a2b3c8aa9d2c26839f9100fdc0286cd93">der_length_teletex_string</a></div><div class="ttdeci">int der_length_teletex_string(const unsigned char *octets, unsigned long noctets, unsigned long *outlen)</div><div class="ttdoc">Gets length of DER encoding of teletex STRING.</div><div class="ttdef"><b>Definition:</b> <a href="der__length__teletex__string_8c_source.html#l00170">der_length_teletex_string.c:170</a></div></div>
<div class="ttc" id="der__length__generalizedtime_8c_html_a63bd3379e9d6aa710a6ddcea3d836754"><div class="ttname"><a href="der__length__generalizedtime_8c.html#a63bd3379e9d6aa710a6ddcea3d836754">der_length_generalizedtime</a></div><div class="ttdeci">int der_length_generalizedtime(const ltc_generalizedtime *gtime, unsigned long *outlen)</div><div class="ttdoc">Gets length of DER encoding of GeneralizedTime.</div><div class="ttdef"><b>Definition:</b> <a href="der__length__generalizedtime_8c_source.html#l00025">der_length_generalizedtime.c:25</a></div></div>
<div class="ttc" id="der__length__custom__type_8c_html_aff691792e4f0be46252fad3b9aa4955c"><div class="ttname"><a href="der__length__custom__type_8c.html#aff691792e4f0be46252fad3b9aa4955c">der_length_custom_type</a></div><div class="ttdeci">int der_length_custom_type(const ltc_asn1_list *root, unsigned long *outlen, unsigned long *payloadlen)</div><div class="ttdoc">Get the length of a DER custom type.</div><div class="ttdef"><b>Definition:</b> <a href="der__length__custom__type_8c_source.html#l00029">der_length_custom_type.c:29</a></div></div>
<div class="ttc" id="tomcrypt_8h_html_adc29c2ff13d900c2f185ee95427fb06ca92aa8bad3930f08d5a188bf72094b066"><div class="ttname"><a href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06ca92aa8bad3930f08d5a188bf72094b066">CRYPT_INVALID_ARG</a></div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt_8h_source.html#l00065">tomcrypt.h:65</a></div></div>
<div class="ttc" id="der__length__boolean_8c_html_aa90c23682da0279cbe55ea64b2c3e381"><div class="ttname"><a href="der__length__boolean_8c.html#aa90c23682da0279cbe55ea64b2c3e381">der_length_boolean</a></div><div class="ttdeci">int der_length_boolean(unsigned long *outlen)</div><div class="ttdoc">Gets length of DER encoding of a BOOLEAN.</div><div class="ttdef"><b>Definition:</b> <a href="der__length__boolean_8c_source.html#l00022">der_length_boolean.c:22</a></div></div>
<div class="ttc" id="der__length__bit__string_8c_html_a73416248e2f93535d54603567acc9cfd"><div class="ttname"><a href="der__length__bit__string_8c.html#a73416248e2f93535d54603567acc9cfd">der_length_bit_string</a></div><div class="ttdeci">int der_length_bit_string(unsigned long nbits, unsigned long *outlen)</div><div class="ttdoc">Gets length of DER encoding of BIT STRING.</div><div class="ttdef"><b>Definition:</b> <a href="der__length__bit__string_8c_source.html#l00023">der_length_bit_string.c:23</a></div></div>
<div class="ttc" id="der__length__utctime_8c_html_a666e7656df6985a9eb25794b878ec4e7"><div class="ttname"><a href="der__length__utctime_8c.html#a666e7656df6985a9eb25794b878ec4e7">der_length_utctime</a></div><div class="ttdeci">int der_length_utctime(const ltc_utctime *utctime, unsigned long *outlen)</div><div class="ttdoc">Gets length of DER encoding of UTCTIME.</div><div class="ttdef"><b>Definition:</b> <a href="der__length__utctime_8c_source.html#l00024">der_length_utctime.c:24</a></div></div>
<div class="ttc" id="tomcrypt__private_8h_html_a8999e23c66cda0d777570e54f3a5c795"><div class="ttname"><a href="tomcrypt__private_8h.html#a8999e23c66cda0d777570e54f3a5c795">der_length_asn1_length</a></div><div class="ttdeci">int der_length_asn1_length(unsigned long len, unsigned long *outlen)</div><div class="ttdoc">Determine the length required to encode len in the ASN.1 length field.</div><div class="ttdef"><b>Definition:</b> <a href="der__length__asn1__length_8c_source.html#l00023">der_length_asn1_length.c:23</a></div></div>
<div class="ttc" id="der__length__octet__string_8c_html_a65b2f3065d3f51608a1dfa3b284a74df"><div class="ttname"><a href="der__length__octet__string_8c.html#a65b2f3065d3f51608a1dfa3b284a74df">der_length_octet_string</a></div><div class="ttdeci">int der_length_octet_string(unsigned long noctets, unsigned long *outlen)</div><div class="ttdoc">Gets length of DER encoding of OCTET STRING.</div><div class="ttdef"><b>Definition:</b> <a href="der__length__octet__string_8c_source.html#l00023">der_length_octet_string.c:23</a></div></div>
<div class="ttc" id="der__length__printable__string_8c_html_ac206210b58e1bac2342a80d26bd802db"><div class="ttname"><a href="der__length__printable__string_8c.html#ac206210b58e1bac2342a80d26bd802db">der_length_printable_string</a></div><div class="ttdeci">int der_length_printable_string(const unsigned char *octets, unsigned long noctets, unsigned long *outlen)</div><div class="ttdoc">Gets length of DER encoding of Printable STRING.</div><div class="ttdef"><b>Definition:</b> <a href="der__length__printable__string_8c_source.html#l00126">der_length_printable_string.c:126</a></div></div>
<div class="ttc" id="der__length__object__identifier_8c_html_ae1fe5b2cd3f20a693cc571a2a8fc9af0"><div class="ttname"><a href="der__length__object__identifier_8c.html#ae1fe5b2cd3f20a693cc571a2a8fc9af0">der_length_object_identifier</a></div><div class="ttdeci">int der_length_object_identifier(const unsigned long *words, unsigned long nwords, unsigned long *outlen)</div><div class="ttdoc">Gets length of DER encoding of Object Identifier.</div><div class="ttdef"><b>Definition:</b> <a href="der__length__object__identifier_8c_source.html#l00038">der_length_object_identifier.c:38</a></div></div>
<div class="ttc" id="der__length__utf8__string_8c_html_aa8b54979c2261c4d703c9464e0bb14c1"><div class="ttname"><a href="der__length__utf8__string_8c.html#aa8b54979c2261c4d703c9464e0bb14c1">der_length_utf8_string</a></div><div class="ttdeci">int der_length_utf8_string(const wchar_t *in, unsigned long noctets, unsigned long *outlen)</div><div class="ttdoc">Gets length of DER encoding of UTF8 STRING.</div><div class="ttdef"><b>Definition:</b> <a href="der__length__utf8__string_8c_source.html#l00064">der_length_utf8_string.c:64</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="tomcrypt_8h_source.html#l00065">CRYPT_INVALID_ARG</a>, <a class="el" href="tomcrypt_8h_source.html#l00042">CRYPT_OK</a>, <a class="el" href="der__length__asn1__length_8c_source.html#l00023">der_length_asn1_length()</a>, <a class="el" href="der__length__bit__string_8c_source.html#l00023">der_length_bit_string()</a>, <a class="el" href="der__length__boolean_8c_source.html#l00022">der_length_boolean()</a>, <a class="el" href="der__length__custom__type_8c_source.html#l00029">der_length_custom_type()</a>, <a class="el" href="der__length__generalizedtime_8c_source.html#l00025">der_length_generalizedtime()</a>, <a class="el" href="der__length__ia5__string_8c_source.html#l00154">der_length_ia5_string()</a>, <a class="el" href="der__length__integer_8c_source.html#l00024">der_length_integer()</a>, <a class="el" href="der__length__object__identifier_8c_source.html#l00038">der_length_object_identifier()</a>, <a class="el" href="der__length__octet__string_8c_source.html#l00023">der_length_octet_string()</a>, <a class="el" href="der__length__printable__string_8c_source.html#l00126">der_length_printable_string()</a>, <a class="el" href="der__length__sequence_8c_source.html#l00025">der_length_sequence()</a>, <a class="el" href="der__length__short__integer_8c_source.html#l00024">der_length_short_integer()</a>, <a class="el" href="der__length__teletex__string_8c_source.html#l00170">der_length_teletex_string()</a>, <a class="el" href="der__length__utctime_8c_source.html#l00024">der_length_utctime()</a>, <a class="el" href="der__length__utf8__string_8c_source.html#l00064">der_length_utf8_string()</a>, and <a class="el" href="tomcrypt__argchk_8h_source.html#l00019">LTC_ARGCHK</a>.</p>

<p class="reference">Referenced by <a class="el" href="der__encode__sequence__ex_8c_source.html#l00028">der_encode_sequence_ex()</a>, and <a class="el" href="der__length__sequence_8c_source.html#l00025">der_length_sequence()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="tomcrypt__private_8h_ad3804ae56675e41a9d142c62d6c3bb2d_cgraph.png" border="0" usemap="#tomcrypt__private_8h_ad3804ae56675e41a9d142c62d6c3bb2d_cgraph" alt=""/></div>
<!-- MAP 15 -->
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="tomcrypt__private_8h_ad3804ae56675e41a9d142c62d6c3bb2d_icgraph.png" border="0" usemap="#tomcrypt__private_8h_ad3804ae56675e41a9d142c62d6c3bb2d_icgraph" alt=""/></div>
<!-- MAP 16 -->
</div>

</div>
</div>
<a id="ae8e05b29e9cd248f6a81450eefd22163"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae8e05b29e9cd248f6a81450eefd22163">&#9670;&nbsp;</a></span>der_teletex_char_encode()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int der_teletex_char_encode </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>c</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="der__length__teletex__string_8c_source.html#l00141">141</a> of file <a class="el" href="der__length__teletex__string_8c_source.html">der_length_teletex_string.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;{</div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;   <span class="keywordtype">int</span> x;</div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;   <span class="keywordflow">for</span> (x = 0; x &lt; (int)(<span class="keyword">sizeof</span>(<a class="code" href="der__length__teletex__string_8c.html#a997fea032cb14c722ed96f405c3447ff">teletex_table</a>)/<span class="keyword">sizeof</span>(<a class="code" href="der__length__teletex__string_8c.html#a997fea032cb14c722ed96f405c3447ff">teletex_table</a>[0])); x++) {</div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;       <span class="keywordflow">if</span> (<a class="code" href="der__length__teletex__string_8c.html#a997fea032cb14c722ed96f405c3447ff">teletex_table</a>[x].<a class="code" href="der__length__teletex__string_8c.html#a45a5b7c00a796a23f01673cef1dbe0a9">code</a> == <a class="code" href="khazad_8c.html#a86ea50de5a3e0ae87762f4298d35284c">c</a>) {</div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;          <span class="keywordflow">return</span> <a class="code" href="der__length__teletex__string_8c.html#a997fea032cb14c722ed96f405c3447ff">teletex_table</a>[x].value;</div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;       }</div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;   }</div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;   <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;}</div><div class="ttc" id="der__length__teletex__string_8c_html_a997fea032cb14c722ed96f405c3447ff"><div class="ttname"><a href="der__length__teletex__string_8c.html#a997fea032cb14c722ed96f405c3447ff">teletex_table</a></div><div class="ttdeci">static const struct @12 teletex_table[]</div></div>
<div class="ttc" id="der__length__teletex__string_8c_html_a45a5b7c00a796a23f01673cef1dbe0a9"><div class="ttname"><a href="der__length__teletex__string_8c.html#a45a5b7c00a796a23f01673cef1dbe0a9">code</a></div><div class="ttdeci">int code</div><div class="ttdef"><b>Definition:</b> <a href="der__length__teletex__string_8c_source.html#l00019">der_length_teletex_string.c:19</a></div></div>
<div class="ttc" id="khazad_8c_html_a86ea50de5a3e0ae87762f4298d35284c"><div class="ttname"><a href="khazad_8c.html#a86ea50de5a3e0ae87762f4298d35284c">c</a></div><div class="ttdeci">static const ulong64 c[8+1]</div><div class="ttdef"><b>Definition:</b> <a href="khazad_8c_source.html#l00570">khazad.c:570</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="khazad_8c_source.html#l00570">c</a>, <a class="el" href="der__length__teletex__string_8c_source.html#l00019">code</a>, and <a class="el" href="der__length__teletex__string_8c.html#a997fea032cb14c722ed96f405c3447ff">teletex_table</a>.</p>

<p class="reference">Referenced by <a class="el" href="der__length__teletex__string_8c_source.html#l00170">der_length_teletex_string()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="tomcrypt__private_8h_ae8e05b29e9cd248f6a81450eefd22163_icgraph.png" border="0" usemap="#tomcrypt__private_8h_ae8e05b29e9cd248f6a81450eefd22163_icgraph" alt=""/></div>
<!-- MAP 17 -->
</div>

</div>
</div>
<a id="ab300884b978bd66022a4003ef5a1f2a1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab300884b978bd66022a4003ef5a1f2a1">&#9670;&nbsp;</a></span>der_teletex_value_decode()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int der_teletex_value_decode </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>v</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="der__length__teletex__string_8c_source.html#l00152">152</a> of file <a class="el" href="der__length__teletex__string_8c_source.html">der_length_teletex_string.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;{</div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;   <span class="keywordtype">int</span> x;</div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;   <span class="keywordflow">for</span> (x = 0; x &lt; (int)(<span class="keyword">sizeof</span>(<a class="code" href="der__length__teletex__string_8c.html#a997fea032cb14c722ed96f405c3447ff">teletex_table</a>)/<span class="keyword">sizeof</span>(<a class="code" href="der__length__teletex__string_8c.html#a997fea032cb14c722ed96f405c3447ff">teletex_table</a>[0])); x++) {</div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;       <span class="keywordflow">if</span> (<a class="code" href="der__length__teletex__string_8c.html#a997fea032cb14c722ed96f405c3447ff">teletex_table</a>[x].<a class="code" href="der__length__teletex__string_8c.html#ac4f474c82e82cbb89ca7c36dd52be0ed">value</a> == v) {</div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;          <span class="keywordflow">return</span> <a class="code" href="der__length__teletex__string_8c.html#a997fea032cb14c722ed96f405c3447ff">teletex_table</a>[x].code;</div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;       }</div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;   }</div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;   <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;}</div><div class="ttc" id="der__length__teletex__string_8c_html_a997fea032cb14c722ed96f405c3447ff"><div class="ttname"><a href="der__length__teletex__string_8c.html#a997fea032cb14c722ed96f405c3447ff">teletex_table</a></div><div class="ttdeci">static const struct @12 teletex_table[]</div></div>
<div class="ttc" id="der__length__teletex__string_8c_html_ac4f474c82e82cbb89ca7c36dd52be0ed"><div class="ttname"><a href="der__length__teletex__string_8c.html#ac4f474c82e82cbb89ca7c36dd52be0ed">value</a></div><div class="ttdeci">int value</div><div class="ttdef"><b>Definition:</b> <a href="der__length__teletex__string_8c_source.html#l00019">der_length_teletex_string.c:19</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="der__length__teletex__string_8c.html#a997fea032cb14c722ed96f405c3447ff">teletex_table</a>, and <a class="el" href="der__length__teletex__string_8c_source.html#l00019">value</a>.</p>

<p class="reference">Referenced by <a class="el" href="der__decode__teletex__string_8c_source.html#l00026">der_decode_teletex_string()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="tomcrypt__private_8h_ab300884b978bd66022a4003ef5a1f2a1_icgraph.png" border="0" usemap="#tomcrypt__private_8h_ab300884b978bd66022a4003ef5a1f2a1_icgraph" alt=""/></div>
<!-- MAP 18 -->
</div>

</div>
</div>
<a id="a400ea59efe4834eac94e65230dd59822"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a400ea59efe4834eac94e65230dd59822">&#9670;&nbsp;</a></span>der_utf8_valid_char()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int der_utf8_valid_char </td>
          <td>(</td>
          <td class="paramtype">const wchar_t&#160;</td>
          <td class="paramname"><em>c</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Test whether the given code point is valid character. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">c</td><td>The UTF-8 character to test </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>1 - valid, 0 - invalid </dd></dl>

<p class="definition">Definition at line <a class="el" href="der__length__utf8__string_8c_source.html#l00045">45</a> of file <a class="el" href="der__length__utf8__string_8c_source.html">der_length_utf8_string.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;{</div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;   <a class="code" href="tomcrypt__macros_8h.html#accde4b007facd646a8327f8e64b2d1e0">LTC_UNUSED_PARAM</a>(<a class="code" href="khazad_8c.html#a86ea50de5a3e0ae87762f4298d35284c">c</a>);</div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;<span class="preprocessor">#if !defined(LTC_WCHAR_MAX) || LTC_WCHAR_MAX &gt; 0xFFFF</span></div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="khazad_8c.html#a86ea50de5a3e0ae87762f4298d35284c">c</a> &gt; 0x10FFFF) <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;<span class="preprocessor">#if LTC_WCHAR_MAX != 0xFFFF &amp;&amp; LTC_WCHAR_MAX != 0xFFFFFFFF</span></div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="khazad_8c.html#a86ea50de5a3e0ae87762f4298d35284c">c</a> &lt; 0) <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;   <span class="keywordflow">return</span> 1;</div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;}</div><div class="ttc" id="khazad_8c_html_a86ea50de5a3e0ae87762f4298d35284c"><div class="ttname"><a href="khazad_8c.html#a86ea50de5a3e0ae87762f4298d35284c">c</a></div><div class="ttdeci">static const ulong64 c[8+1]</div><div class="ttdef"><b>Definition:</b> <a href="khazad_8c_source.html#l00570">khazad.c:570</a></div></div>
<div class="ttc" id="tomcrypt__macros_8h_html_accde4b007facd646a8327f8e64b2d1e0"><div class="ttname"><a href="tomcrypt__macros_8h.html#accde4b007facd646a8327f8e64b2d1e0">LTC_UNUSED_PARAM</a></div><div class="ttdeci">#define LTC_UNUSED_PARAM(x)</div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt__macros_8h_source.html#l00429">tomcrypt_macros.h:429</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="khazad_8c_source.html#l00570">c</a>, and <a class="el" href="tomcrypt__macros_8h_source.html#l00429">LTC_UNUSED_PARAM</a>.</p>

<p class="reference">Referenced by <a class="el" href="der__encode__utf8__string_8c_source.html#l00027">der_encode_utf8_string()</a>, and <a class="el" href="der__length__utf8__string_8c_source.html#l00064">der_length_utf8_string()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="tomcrypt__private_8h_a400ea59efe4834eac94e65230dd59822_icgraph.png" border="0" usemap="#tomcrypt__private_8h_a400ea59efe4834eac94e65230dd59822_icgraph" alt=""/></div>
<!-- MAP 19 -->
</div>

</div>
</div>
<a id="a88fc16c33e95216e30eae5beb8e92da1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a88fc16c33e95216e30eae5beb8e92da1">&#9670;&nbsp;</a></span>dh_check_pubkey()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int dh_check_pubkey </td>
          <td>(</td>
          <td class="paramtype">const dh_key *&#160;</td>
          <td class="paramname"><em>key</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Check DH public key (INTERNAL ONLY, not part of public API) </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">key</td><td>The key you wish to test </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>CRYPT_OK if successful </dd></dl>

<p class="definition">Definition at line <a class="el" href="dh__check__pubkey_8c_source.html#l00019">19</a> of file <a class="el" href="dh__check__pubkey_8c_source.html">dh_check_pubkey.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;{</div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;   <span class="keywordtype">void</span> *p_minus1;</div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;   <a class="code" href="tomcrypt__cfg_8h.html#a4e98fa26a5de0ac87e06af901bad57c4">ltc_mp_digit</a> digit;</div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;   <span class="keywordtype">int</span> i, digit_count, bits_set = 0, err;</div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;</div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;   <a class="code" href="tomcrypt__argchk_8h.html#a683da3e041e49f196318b6ea951414ba">LTC_ARGCHK</a>(key != NULL);</div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;</div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;   <span class="keywordflow">if</span> ((err = <a class="code" href="tomcrypt__private_8h.html#aff03c4f22c68d651747055048c509cf3">mp_init</a>(&amp;p_minus1)) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>) {</div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;      <span class="keywordflow">return</span> err;</div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;   }</div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;</div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;   <span class="comment">/* avoid: y &lt;= 1 OR y &gt;= p-1 */</span></div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;   <span class="keywordflow">if</span> ((err = <a class="code" href="tomcrypt__private_8h.html#a4215ff0d6838acb3d959d3e68c923de7">mp_sub_d</a>(key-&gt;prime, 1, p_minus1)) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>) {</div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;      <span class="keywordflow">goto</span> error;</div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;   }</div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="tomcrypt__private_8h.html#a62ea02fbe7dd2d456e49520264d775ee">mp_cmp</a>(key-&gt;y, p_minus1) != <a class="code" href="tomcrypt__math_8h.html#a42d0c7d4c09793df79660774d3436db2">LTC_MP_LT</a> || <a class="code" href="tomcrypt__private_8h.html#a6ce44f2e6f872565a468b67d9a93dc28">mp_cmp_d</a>(key-&gt;y, 1) != <a class="code" href="tomcrypt__math_8h.html#adff156a960d44f0f5b67b75ef1f1c29b">LTC_MP_GT</a>) {</div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;      err = <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06ca92aa8bad3930f08d5a188bf72094b066">CRYPT_INVALID_ARG</a>;</div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;      <span class="keywordflow">goto</span> error;</div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;   }</div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;</div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;   <span class="comment">/* public key must have more than one bit set */</span></div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;   digit_count = <a class="code" href="tomcrypt__private_8h.html#ae51a279d51ab72f09d9f97335b8be6c9">mp_get_digit_count</a>(key-&gt;y);</div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;   <span class="keywordflow">for</span> (i = 0; i &lt; digit_count &amp;&amp; bits_set &lt; 2; i++) {</div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;      digit = <a class="code" href="tomcrypt__private_8h.html#a62267879327e26468c45bbd83f7f2669">mp_get_digit</a>(key-&gt;y, i);</div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;      <span class="keywordflow">while</span> (digit &gt; 0) {</div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;         <span class="keywordflow">if</span> (digit &amp; 1) bits_set++;</div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;         digit &gt;&gt;= 1;</div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;      }</div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;   }</div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;   <span class="keywordflow">if</span> (bits_set &gt; 1) {</div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;      err = <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>;</div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;   }</div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;   <span class="keywordflow">else</span> {</div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;      err = <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06ca92aa8bad3930f08d5a188bf72094b066">CRYPT_INVALID_ARG</a>;</div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;   }</div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;</div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;error:</div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;   <a class="code" href="tomcrypt__private_8h.html#ab05b6b59fa182b81f5f990d5621229f6">mp_clear</a>(p_minus1);</div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;   <span class="keywordflow">return</span> err;</div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;}</div><div class="ttc" id="tomcrypt_8h_html_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334"><div class="ttname"><a href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a></div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt_8h_source.html#l00042">tomcrypt.h:42</a></div></div>
<div class="ttc" id="tomcrypt__math_8h_html_a42d0c7d4c09793df79660774d3436db2"><div class="ttname"><a href="tomcrypt__math_8h.html#a42d0c7d4c09793df79660774d3436db2">LTC_MP_LT</a></div><div class="ttdeci">#define LTC_MP_LT</div><div class="ttdoc">math functions</div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt__math_8h_source.html#l00012">tomcrypt_math.h:12</a></div></div>
<div class="ttc" id="tomcrypt__argchk_8h_html_a683da3e041e49f196318b6ea951414ba"><div class="ttname"><a href="tomcrypt__argchk_8h.html#a683da3e041e49f196318b6ea951414ba">LTC_ARGCHK</a></div><div class="ttdeci">#define LTC_ARGCHK(x)</div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt__argchk_8h_source.html#l00019">tomcrypt_argchk.h:19</a></div></div>
<div class="ttc" id="tomcrypt__private_8h_html_a62267879327e26468c45bbd83f7f2669"><div class="ttname"><a href="tomcrypt__private_8h.html#a62267879327e26468c45bbd83f7f2669">mp_get_digit</a></div><div class="ttdeci">#define mp_get_digit(a, n)</div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt__private_8h_source.html#l00142">tomcrypt_private.h:142</a></div></div>
<div class="ttc" id="tomcrypt__cfg_8h_html_a4e98fa26a5de0ac87e06af901bad57c4"><div class="ttname"><a href="tomcrypt__cfg_8h.html#a4e98fa26a5de0ac87e06af901bad57c4">ltc_mp_digit</a></div><div class="ttdeci">unsigned long ltc_mp_digit</div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt__cfg_8h_source.html#l00235">tomcrypt_cfg.h:235</a></div></div>
<div class="ttc" id="tomcrypt__private_8h_html_a62ea02fbe7dd2d456e49520264d775ee"><div class="ttname"><a href="tomcrypt__private_8h.html#a62ea02fbe7dd2d456e49520264d775ee">mp_cmp</a></div><div class="ttdeci">#define mp_cmp(a, b)</div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt__private_8h_source.html#l00144">tomcrypt_private.h:144</a></div></div>
<div class="ttc" id="tomcrypt_8h_html_adc29c2ff13d900c2f185ee95427fb06ca92aa8bad3930f08d5a188bf72094b066"><div class="ttname"><a href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06ca92aa8bad3930f08d5a188bf72094b066">CRYPT_INVALID_ARG</a></div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt_8h_source.html#l00065">tomcrypt.h:65</a></div></div>
<div class="ttc" id="tomcrypt__private_8h_html_aff03c4f22c68d651747055048c509cf3"><div class="ttname"><a href="tomcrypt__private_8h.html#aff03c4f22c68d651747055048c509cf3">mp_init</a></div><div class="ttdeci">#define mp_init(a)</div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt__private_8h_source.html#l00129">tomcrypt_private.h:129</a></div></div>
<div class="ttc" id="tomcrypt__math_8h_html_adff156a960d44f0f5b67b75ef1f1c29b"><div class="ttname"><a href="tomcrypt__math_8h.html#adff156a960d44f0f5b67b75ef1f1c29b">LTC_MP_GT</a></div><div class="ttdeci">#define LTC_MP_GT</div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt__math_8h_source.html#l00014">tomcrypt_math.h:14</a></div></div>
<div class="ttc" id="tomcrypt__private_8h_html_ab05b6b59fa182b81f5f990d5621229f6"><div class="ttname"><a href="tomcrypt__private_8h.html#ab05b6b59fa182b81f5f990d5621229f6">mp_clear</a></div><div class="ttdeci">#define mp_clear(a)</div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt__private_8h_source.html#l00131">tomcrypt_private.h:131</a></div></div>
<div class="ttc" id="tomcrypt__private_8h_html_a6ce44f2e6f872565a468b67d9a93dc28"><div class="ttname"><a href="tomcrypt__private_8h.html#a6ce44f2e6f872565a468b67d9a93dc28">mp_cmp_d</a></div><div class="ttdeci">#define mp_cmp_d(a, b)</div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt__private_8h_source.html#l00145">tomcrypt_private.h:145</a></div></div>
<div class="ttc" id="tomcrypt__private_8h_html_a4215ff0d6838acb3d959d3e68c923de7"><div class="ttname"><a href="tomcrypt__private_8h.html#a4215ff0d6838acb3d959d3e68c923de7">mp_sub_d</a></div><div class="ttdeci">#define mp_sub_d(a, b, c)</div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt__private_8h_source.html#l00159">tomcrypt_private.h:159</a></div></div>
<div class="ttc" id="tomcrypt__private_8h_html_ae51a279d51ab72f09d9f97335b8be6c9"><div class="ttname"><a href="tomcrypt__private_8h.html#ae51a279d51ab72f09d9f97335b8be6c9">mp_get_digit_count</a></div><div class="ttdeci">#define mp_get_digit_count(a)</div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt__private_8h_source.html#l00143">tomcrypt_private.h:143</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="tomcrypt_8h_source.html#l00065">CRYPT_INVALID_ARG</a>, <a class="el" href="tomcrypt_8h_source.html#l00042">CRYPT_OK</a>, <a class="el" href="tomcrypt__argchk_8h_source.html#l00019">LTC_ARGCHK</a>, <a class="el" href="tomcrypt__math_8h_source.html#l00014">LTC_MP_GT</a>, <a class="el" href="tomcrypt__math_8h_source.html#l00012">LTC_MP_LT</a>, <a class="el" href="tomcrypt__private_8h_source.html#l00131">mp_clear</a>, <a class="el" href="tomcrypt__private_8h_source.html#l00144">mp_cmp</a>, <a class="el" href="tomcrypt__private_8h_source.html#l00145">mp_cmp_d</a>, <a class="el" href="tomcrypt__private_8h_source.html#l00142">mp_get_digit</a>, <a class="el" href="tomcrypt__private_8h_source.html#l00143">mp_get_digit_count</a>, <a class="el" href="tomcrypt__private_8h_source.html#l00129">mp_init</a>, and <a class="el" href="tomcrypt__private_8h_source.html#l00159">mp_sub_d</a>.</p>

<p class="reference">Referenced by <a class="el" href="dh__generate__key_8c_source.html#l00043">dh_generate_key()</a>, <a class="el" href="dh__import_8c_source.html#l00021">dh_import()</a>, <a class="el" href="dh__set_8c_source.html#l00091">dh_set_key()</a>, and <a class="el" href="dh__shared__secret_8c_source.html#l00022">dh_shared_secret()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="tomcrypt__private_8h_a88fc16c33e95216e30eae5beb8e92da1_icgraph.png" border="0" usemap="#tomcrypt__private_8h_a88fc16c33e95216e30eae5beb8e92da1_icgraph" alt=""/></div>
<!-- MAP 20 -->
</div>

</div>
</div>
<a id="a78787aeedd134c0e586d4a42a83c89c2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a78787aeedd134c0e586d4a42a83c89c2">&#9670;&nbsp;</a></span>dsa_int_validate_pqg()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int dsa_int_validate_pqg </td>
          <td>(</td>
          <td class="paramtype">const dsa_key *&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>stat</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Non-complex part (no primality testing) of the validation of DSA params (p, q, g) </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">key</td><td>The key to validate </td></tr>
    <tr><td class="paramname">stat</td><td>[out] Result of test, 1==valid, 0==invalid </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>CRYPT_OK if successful </dd></dl>

<p class="definition">Definition at line <a class="el" href="dsa__verify__key_8c_source.html#l00050">50</a> of file <a class="el" href="dsa__verify__key_8c_source.html">dsa_verify_key.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;{</div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;   <span class="keywordtype">void</span> *tmp1, *tmp2;</div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;   <span class="keywordtype">int</span>  err;</div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;</div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;   <a class="code" href="tomcrypt__argchk_8h.html#a683da3e041e49f196318b6ea951414ba">LTC_ARGCHK</a>(key  != NULL);</div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;   <a class="code" href="tomcrypt__argchk_8h.html#a683da3e041e49f196318b6ea951414ba">LTC_ARGCHK</a>(stat != NULL);</div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;   *stat = 0;</div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;</div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;   <span class="comment">/* check q-order */</span></div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;   <span class="keywordflow">if</span> ( key-&gt;qord &gt;= LTC_MDSA_MAX_GROUP || key-&gt;qord &lt;= 15 ||</div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;        (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>)key-&gt;qord &gt;= <a class="code" href="tomcrypt__private_8h.html#ad301148bb24f43a8c7003a6976dfaa5a">mp_unsigned_bin_size</a>(key-&gt;p) ||</div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;        (<a class="code" href="tomcrypt__private_8h.html#ad301148bb24f43a8c7003a6976dfaa5a">mp_unsigned_bin_size</a>(key-&gt;p) - key-&gt;qord) &gt;= LTC_MDSA_DELTA ) {</div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>;</div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;   }</div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;</div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;   <span class="comment">/* FIPS 186-4 chapter 4.1: 1 &lt; g &lt; p */</span></div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="tomcrypt__private_8h.html#a6ce44f2e6f872565a468b67d9a93dc28">mp_cmp_d</a>(key-&gt;g, 1) != <a class="code" href="tomcrypt__math_8h.html#adff156a960d44f0f5b67b75ef1f1c29b">LTC_MP_GT</a> || <a class="code" href="tomcrypt__private_8h.html#a62ea02fbe7dd2d456e49520264d775ee">mp_cmp</a>(key-&gt;g, key-&gt;p) != <a class="code" href="tomcrypt__math_8h.html#a42d0c7d4c09793df79660774d3436db2">LTC_MP_LT</a>) {</div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>;</div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;   }</div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;</div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;   <span class="keywordflow">if</span> ((err = <a class="code" href="tomcrypt__private_8h.html#adb6322247b1a4f0347219acab3120bd3">mp_init_multi</a>(&amp;tmp1, &amp;tmp2, NULL)) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>)        { <span class="keywordflow">return</span> err; }</div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;</div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;   <span class="comment">/* FIPS 186-4 chapter 4.1: q is a divisor of (p - 1) */</span></div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;   <span class="keywordflow">if</span> ((err = <a class="code" href="tomcrypt__private_8h.html#a4215ff0d6838acb3d959d3e68c923de7">mp_sub_d</a>(key-&gt;p, 1, tmp1)) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>)                { <span class="keywordflow">goto</span> error; }</div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;   <span class="keywordflow">if</span> ((err = <a class="code" href="tomcrypt__private_8h.html#a861721ee02d3b5d84328090f3058f7c3">mp_div</a>(tmp1, key-&gt;q, tmp1, tmp2)) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>)         { <span class="keywordflow">goto</span> error; }</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="tomcrypt__private_8h.html#a910040068490f9f6e5185c970ab869c9">mp_iszero</a>(tmp2) != <a class="code" href="tomcrypt__math_8h.html#acc2da047f8fb30a3e2b2403aac617fe0">LTC_MP_YES</a>) {</div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;      err = <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>;</div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;      <span class="keywordflow">goto</span> error;</div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;   }</div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;</div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;   <span class="comment">/* FIPS 186-4 chapter 4.1: g is a generator of a subgroup of order q in</span></div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;<span class="comment">    * the multiplicative group of GF(p) - so we make sure that g^q mod p = 1</span></div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;   <span class="keywordflow">if</span> ((err = <a class="code" href="tomcrypt__private_8h.html#a4fb1221fbef91bf8163390e3cfb82085">mp_exptmod</a>(key-&gt;g, key-&gt;q, key-&gt;p, tmp1)) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>) { <span class="keywordflow">goto</span> error; }</div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="tomcrypt__private_8h.html#a6ce44f2e6f872565a468b67d9a93dc28">mp_cmp_d</a>(tmp1, 1) != <a class="code" href="tomcrypt__math_8h.html#a035a31bde4f31419eb259e36e5776607">LTC_MP_EQ</a>) {</div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;      err = <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>;</div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;      <span class="keywordflow">goto</span> error;</div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;   }</div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;</div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;   err   = <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>;</div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;   *stat = 1;</div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;error:</div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;   <a class="code" href="tomcrypt__private_8h.html#aad5c8a3112b3e4613f9efc86692c43cb">mp_clear_multi</a>(tmp2, tmp1, NULL);</div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;   <span class="keywordflow">return</span> err;</div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;}</div><div class="ttc" id="tomcrypt_8h_html_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334"><div class="ttname"><a href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a></div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt_8h_source.html#l00042">tomcrypt.h:42</a></div></div>
<div class="ttc" id="tomcrypt__math_8h_html_a42d0c7d4c09793df79660774d3436db2"><div class="ttname"><a href="tomcrypt__math_8h.html#a42d0c7d4c09793df79660774d3436db2">LTC_MP_LT</a></div><div class="ttdeci">#define LTC_MP_LT</div><div class="ttdoc">math functions</div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt__math_8h_source.html#l00012">tomcrypt_math.h:12</a></div></div>
<div class="ttc" id="tomcrypt__math_8h_html_acc2da047f8fb30a3e2b2403aac617fe0"><div class="ttname"><a href="tomcrypt__math_8h.html#acc2da047f8fb30a3e2b2403aac617fe0">LTC_MP_YES</a></div><div class="ttdeci">#define LTC_MP_YES</div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt__math_8h_source.html#l00017">tomcrypt_math.h:17</a></div></div>
<div class="ttc" id="tomcrypt__argchk_8h_html_a683da3e041e49f196318b6ea951414ba"><div class="ttname"><a href="tomcrypt__argchk_8h.html#a683da3e041e49f196318b6ea951414ba">LTC_ARGCHK</a></div><div class="ttdeci">#define LTC_ARGCHK(x)</div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt__argchk_8h_source.html#l00019">tomcrypt_argchk.h:19</a></div></div>
<div class="ttc" id="tomcrypt__private_8h_html_a861721ee02d3b5d84328090f3058f7c3"><div class="ttname"><a href="tomcrypt__private_8h.html#a861721ee02d3b5d84328090f3058f7c3">mp_div</a></div><div class="ttdeci">#define mp_div(a, b, c, d)</div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt__private_8h_source.html#l00164">tomcrypt_private.h:164</a></div></div>
<div class="ttc" id="tomcrypt__private_8h_html_aad5c8a3112b3e4613f9efc86692c43cb"><div class="ttname"><a href="tomcrypt__private_8h.html#aad5c8a3112b3e4613f9efc86692c43cb">mp_clear_multi</a></div><div class="ttdeci">#define mp_clear_multi</div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt__private_8h_source.html#l00132">tomcrypt_private.h:132</a></div></div>
<div class="ttc" id="tomcrypt__private_8h_html_a62ea02fbe7dd2d456e49520264d775ee"><div class="ttname"><a href="tomcrypt__private_8h.html#a62ea02fbe7dd2d456e49520264d775ee">mp_cmp</a></div><div class="ttdeci">#define mp_cmp(a, b)</div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt__private_8h_source.html#l00144">tomcrypt_private.h:144</a></div></div>
<div class="ttc" id="tomcrypt__private_8h_html_a4fb1221fbef91bf8163390e3cfb82085"><div class="ttname"><a href="tomcrypt__private_8h.html#a4fb1221fbef91bf8163390e3cfb82085">mp_exptmod</a></div><div class="ttdeci">#define mp_exptmod(a, b, c, d)</div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt__private_8h_source.html#l00182">tomcrypt_private.h:182</a></div></div>
<div class="ttc" id="tomcrypt__math_8h_html_a035a31bde4f31419eb259e36e5776607"><div class="ttname"><a href="tomcrypt__math_8h.html#a035a31bde4f31419eb259e36e5776607">LTC_MP_EQ</a></div><div class="ttdeci">#define LTC_MP_EQ</div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt__math_8h_source.html#l00013">tomcrypt_math.h:13</a></div></div>
<div class="ttc" id="tomcrypt__private_8h_html_adb6322247b1a4f0347219acab3120bd3"><div class="ttname"><a href="tomcrypt__private_8h.html#adb6322247b1a4f0347219acab3120bd3">mp_init_multi</a></div><div class="ttdeci">#define mp_init_multi</div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt__private_8h_source.html#l00130">tomcrypt_private.h:130</a></div></div>
<div class="ttc" id="tomcrypt__math_8h_html_adff156a960d44f0f5b67b75ef1f1c29b"><div class="ttname"><a href="tomcrypt__math_8h.html#adff156a960d44f0f5b67b75ef1f1c29b">LTC_MP_GT</a></div><div class="ttdeci">#define LTC_MP_GT</div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt__math_8h_source.html#l00014">tomcrypt_math.h:14</a></div></div>
<div class="ttc" id="tomcrypt__private_8h_html_ad301148bb24f43a8c7003a6976dfaa5a"><div class="ttname"><a href="tomcrypt__private_8h.html#ad301148bb24f43a8c7003a6976dfaa5a">mp_unsigned_bin_size</a></div><div class="ttdeci">#define mp_unsigned_bin_size(a)</div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt__private_8h_source.html#l00152">tomcrypt_private.h:152</a></div></div>
<div class="ttc" id="tomcrypt__private_8h_html_a6ce44f2e6f872565a468b67d9a93dc28"><div class="ttname"><a href="tomcrypt__private_8h.html#a6ce44f2e6f872565a468b67d9a93dc28">mp_cmp_d</a></div><div class="ttdeci">#define mp_cmp_d(a, b)</div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt__private_8h_source.html#l00145">tomcrypt_private.h:145</a></div></div>
<div class="ttc" id="tomcrypt__private_8h_html_a910040068490f9f6e5185c970ab869c9"><div class="ttname"><a href="tomcrypt__private_8h.html#a910040068490f9f6e5185c970ab869c9">mp_iszero</a></div><div class="ttdeci">#define mp_iszero(a)</div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt__private_8h_source.html#l00185">tomcrypt_private.h:185</a></div></div>
<div class="ttc" id="tomcrypt__private_8h_html_a4215ff0d6838acb3d959d3e68c923de7"><div class="ttname"><a href="tomcrypt__private_8h.html#a4215ff0d6838acb3d959d3e68c923de7">mp_sub_d</a></div><div class="ttdeci">#define mp_sub_d(a, b, c)</div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt__private_8h_source.html#l00159">tomcrypt_private.h:159</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="tomcrypt_8h_source.html#l00042">CRYPT_OK</a>, <a class="el" href="tomcrypt__argchk_8h_source.html#l00019">LTC_ARGCHK</a>, <a class="el" href="tomcrypt__math_8h_source.html#l00013">LTC_MP_EQ</a>, <a class="el" href="tomcrypt__math_8h_source.html#l00014">LTC_MP_GT</a>, <a class="el" href="tomcrypt__math_8h_source.html#l00012">LTC_MP_LT</a>, <a class="el" href="tomcrypt__math_8h_source.html#l00017">LTC_MP_YES</a>, <a class="el" href="tomcrypt__private_8h_source.html#l00132">mp_clear_multi</a>, <a class="el" href="tomcrypt__private_8h_source.html#l00144">mp_cmp</a>, <a class="el" href="tomcrypt__private_8h_source.html#l00145">mp_cmp_d</a>, <a class="el" href="tomcrypt__private_8h_source.html#l00164">mp_div</a>, <a class="el" href="tomcrypt__private_8h_source.html#l00182">mp_exptmod</a>, <a class="el" href="tomcrypt__private_8h_source.html#l00130">mp_init_multi</a>, <a class="el" href="tomcrypt__private_8h_source.html#l00185">mp_iszero</a>, <a class="el" href="tomcrypt__private_8h_source.html#l00159">mp_sub_d</a>, and <a class="el" href="tomcrypt__private_8h_source.html#l00152">mp_unsigned_bin_size</a>.</p>

<p class="reference">Referenced by <a class="el" href="dsa__import_8c_source.html#l00025">dsa_import()</a>, <a class="el" href="dsa__set_8c_source.html#l00025">dsa_set_pqg()</a>, <a class="el" href="dsa__set__pqg__dsaparam_8c_source.html#l00024">dsa_set_pqg_dsaparam()</a>, and <a class="el" href="dsa__verify__key_8c_source.html#l00029">dsa_verify_key()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="tomcrypt__private_8h_a78787aeedd134c0e586d4a42a83c89c2_icgraph.png" border="0" usemap="#tomcrypt__private_8h_a78787aeedd134c0e586d4a42a83c89c2_icgraph" alt=""/></div>
<!-- MAP 21 -->
</div>

</div>
</div>
<a id="abdc76d05886a02727e901ad26f2f3e81"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abdc76d05886a02727e901ad26f2f3e81">&#9670;&nbsp;</a></span>dsa_int_validate_primes()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int dsa_int_validate_primes </td>
          <td>(</td>
          <td class="paramtype">const dsa_key *&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>stat</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Primality testing of DSA params p and q. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">key</td><td>The key to validate </td></tr>
    <tr><td class="paramname">stat</td><td>[out] Result of test, 1==valid, 0==invalid </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>CRYPT_OK if successful </dd></dl>

<p class="definition">Definition at line <a class="el" href="dsa__verify__key_8c_source.html#l00104">104</a> of file <a class="el" href="dsa__verify__key_8c_source.html">dsa_verify_key.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;{</div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;   <span class="keywordtype">int</span> err, res;</div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;</div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;   *stat = 0;</div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;   <a class="code" href="tomcrypt__argchk_8h.html#a683da3e041e49f196318b6ea951414ba">LTC_ARGCHK</a>(key  != NULL);</div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;   <a class="code" href="tomcrypt__argchk_8h.html#a683da3e041e49f196318b6ea951414ba">LTC_ARGCHK</a>(stat != NULL);</div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;</div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;   <span class="comment">/* key-&gt;q prime? */</span></div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;   <span class="keywordflow">if</span> ((err = <a class="code" href="tomcrypt__private_8h.html#ab3681f96d55cf707b92d6254f58ea3de">mp_prime_is_prime</a>(key-&gt;q, <a class="code" href="tomcrypt__math_8h.html#a65401cc14826c74ce923beb65bde5bf3">LTC_MILLER_RABIN_REPS</a>, &amp;res)) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>) {</div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;      <span class="keywordflow">return</span> err;</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;   }</div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;   <span class="keywordflow">if</span> (res == <a class="code" href="tomcrypt__math_8h.html#a40f1119339954fb273ecb35e48c1d569">LTC_MP_NO</a>) {</div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>;</div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;   }</div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;</div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;   <span class="comment">/* key-&gt;p prime? */</span></div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;   <span class="keywordflow">if</span> ((err = <a class="code" href="tomcrypt__private_8h.html#ab3681f96d55cf707b92d6254f58ea3de">mp_prime_is_prime</a>(key-&gt;p, <a class="code" href="tomcrypt__math_8h.html#a65401cc14826c74ce923beb65bde5bf3">LTC_MILLER_RABIN_REPS</a>, &amp;res)) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>) {</div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;      <span class="keywordflow">return</span> err;</div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;   }</div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;   <span class="keywordflow">if</span> (res == <a class="code" href="tomcrypt__math_8h.html#a40f1119339954fb273ecb35e48c1d569">LTC_MP_NO</a>) {</div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>;</div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;   }</div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;</div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;   *stat = 1;</div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>;</div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;}</div><div class="ttc" id="tomcrypt_8h_html_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334"><div class="ttname"><a href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a></div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt_8h_source.html#l00042">tomcrypt.h:42</a></div></div>
<div class="ttc" id="tomcrypt__argchk_8h_html_a683da3e041e49f196318b6ea951414ba"><div class="ttname"><a href="tomcrypt__argchk_8h.html#a683da3e041e49f196318b6ea951414ba">LTC_ARGCHK</a></div><div class="ttdeci">#define LTC_ARGCHK(x)</div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt__argchk_8h_source.html#l00019">tomcrypt_argchk.h:19</a></div></div>
<div class="ttc" id="tomcrypt__private_8h_html_ab3681f96d55cf707b92d6254f58ea3de"><div class="ttname"><a href="tomcrypt__private_8h.html#ab3681f96d55cf707b92d6254f58ea3de">mp_prime_is_prime</a></div><div class="ttdeci">#define mp_prime_is_prime(a, b, c)</div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt__private_8h_source.html#l00183">tomcrypt_private.h:183</a></div></div>
<div class="ttc" id="tomcrypt__math_8h_html_a65401cc14826c74ce923beb65bde5bf3"><div class="ttname"><a href="tomcrypt__math_8h.html#a65401cc14826c74ce923beb65bde5bf3">LTC_MILLER_RABIN_REPS</a></div><div class="ttdeci">#define LTC_MILLER_RABIN_REPS</div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt__math_8h_source.html#l00031">tomcrypt_math.h:31</a></div></div>
<div class="ttc" id="tomcrypt__math_8h_html_a40f1119339954fb273ecb35e48c1d569"><div class="ttname"><a href="tomcrypt__math_8h.html#a40f1119339954fb273ecb35e48c1d569">LTC_MP_NO</a></div><div class="ttdeci">#define LTC_MP_NO</div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt__math_8h_source.html#l00016">tomcrypt_math.h:16</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="tomcrypt_8h_source.html#l00042">CRYPT_OK</a>, <a class="el" href="tomcrypt__argchk_8h_source.html#l00019">LTC_ARGCHK</a>, <a class="el" href="tomcrypt__math_8h_source.html#l00031">LTC_MILLER_RABIN_REPS</a>, <a class="el" href="tomcrypt__math_8h_source.html#l00016">LTC_MP_NO</a>, and <a class="el" href="tomcrypt__private_8h_source.html#l00183">mp_prime_is_prime</a>.</p>

<p class="reference">Referenced by <a class="el" href="dsa__verify__key_8c_source.html#l00029">dsa_verify_key()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="tomcrypt__private_8h_abdc76d05886a02727e901ad26f2f3e81_icgraph.png" border="0" usemap="#tomcrypt__private_8h_abdc76d05886a02727e901ad26f2f3e81_icgraph" alt=""/></div>
<!-- MAP 22 -->
</div>

</div>
</div>
<a id="aa5b2d573863af50ed2f38a00998a1274"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa5b2d573863af50ed2f38a00998a1274">&#9670;&nbsp;</a></span>dsa_int_validate_xy()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int dsa_int_validate_xy </td>
          <td>(</td>
          <td class="paramtype">const dsa_key *&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>stat</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Validation of a DSA key (x and y values) </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">key</td><td>The key to validate </td></tr>
    <tr><td class="paramname">stat</td><td>[out] Result of test, 1==valid, 0==invalid </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>CRYPT_OK if successful </dd></dl>

<p class="definition">Definition at line <a class="el" href="dsa__verify__key_8c_source.html#l00139">139</a> of file <a class="el" href="dsa__verify__key_8c_source.html">dsa_verify_key.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;{</div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;   <span class="keywordtype">void</span> *tmp;</div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;   <span class="keywordtype">int</span>  err;</div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;</div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;   *stat = 0;</div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;   <a class="code" href="tomcrypt__argchk_8h.html#a683da3e041e49f196318b6ea951414ba">LTC_ARGCHK</a>(key  != NULL);</div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;   <a class="code" href="tomcrypt__argchk_8h.html#a683da3e041e49f196318b6ea951414ba">LTC_ARGCHK</a>(stat != NULL);</div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;</div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;   <span class="comment">/* 1 &lt; y &lt; p-1 */</span></div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;   <span class="keywordflow">if</span> ((err = <a class="code" href="tomcrypt__private_8h.html#aff03c4f22c68d651747055048c509cf3">mp_init</a>(&amp;tmp)) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>) {</div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;      <span class="keywordflow">return</span> err;</div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;   }</div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;   <span class="keywordflow">if</span> ((err = <a class="code" href="tomcrypt__private_8h.html#a4215ff0d6838acb3d959d3e68c923de7">mp_sub_d</a>(key-&gt;p, 1, tmp)) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>) {</div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;      <span class="keywordflow">goto</span> error;</div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;   }</div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="tomcrypt__private_8h.html#a6ce44f2e6f872565a468b67d9a93dc28">mp_cmp_d</a>(key-&gt;y, 1) != <a class="code" href="tomcrypt__math_8h.html#adff156a960d44f0f5b67b75ef1f1c29b">LTC_MP_GT</a> || <a class="code" href="tomcrypt__private_8h.html#a62ea02fbe7dd2d456e49520264d775ee">mp_cmp</a>(key-&gt;y, tmp) != <a class="code" href="tomcrypt__math_8h.html#a42d0c7d4c09793df79660774d3436db2">LTC_MP_LT</a>) {</div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;      err = <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>;</div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;      <span class="keywordflow">goto</span> error;</div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;   }</div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;</div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;   <span class="keywordflow">if</span> (key-&gt;type == <a class="code" href="tomcrypt__pk_8h.html#afb69d121a43f5ae8b47e6b83611d9272a7295b3dea2c5277912c6e040e1c96649">PK_PRIVATE</a>) {</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;      <span class="comment">/* FIPS 186-4 chapter 4.1: 0 &lt; x &lt; q */</span></div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="tomcrypt__private_8h.html#a6ce44f2e6f872565a468b67d9a93dc28">mp_cmp_d</a>(key-&gt;x, 0) != <a class="code" href="tomcrypt__math_8h.html#adff156a960d44f0f5b67b75ef1f1c29b">LTC_MP_GT</a> || <a class="code" href="tomcrypt__private_8h.html#a62ea02fbe7dd2d456e49520264d775ee">mp_cmp</a>(key-&gt;x, key-&gt;q) != <a class="code" href="tomcrypt__math_8h.html#a42d0c7d4c09793df79660774d3436db2">LTC_MP_LT</a>) {</div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;         err = <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>;</div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;         <span class="keywordflow">goto</span> error;</div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;      }</div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;      <span class="comment">/* FIPS 186-4 chapter 4.1: y = g^x mod p */</span></div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;      <span class="keywordflow">if</span> ((err = <a class="code" href="tomcrypt__private_8h.html#a4fb1221fbef91bf8163390e3cfb82085">mp_exptmod</a>(key-&gt;g, key-&gt;x, key-&gt;p, tmp)) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>) {</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;         <span class="keywordflow">goto</span> error;</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;      }</div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="tomcrypt__private_8h.html#a62ea02fbe7dd2d456e49520264d775ee">mp_cmp</a>(tmp, key-&gt;y) != <a class="code" href="tomcrypt__math_8h.html#a035a31bde4f31419eb259e36e5776607">LTC_MP_EQ</a>) {</div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;         err = <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>;</div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;         <span class="keywordflow">goto</span> error;</div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;      }</div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;   }</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;   <span class="keywordflow">else</span> {</div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;      <span class="comment">/* with just a public key we cannot test y = g^x mod p therefore we</span></div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;<span class="comment">       * only test that y^q mod p = 1, which makes sure y is in g^x mod p</span></div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;<span class="comment">       */</span></div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;      <span class="keywordflow">if</span> ((err = <a class="code" href="tomcrypt__private_8h.html#a4fb1221fbef91bf8163390e3cfb82085">mp_exptmod</a>(key-&gt;y, key-&gt;q, key-&gt;p, tmp)) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>) {</div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;         <span class="keywordflow">goto</span> error;</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;      }</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="tomcrypt__private_8h.html#a6ce44f2e6f872565a468b67d9a93dc28">mp_cmp_d</a>(tmp, 1) != <a class="code" href="tomcrypt__math_8h.html#a035a31bde4f31419eb259e36e5776607">LTC_MP_EQ</a>) {</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;         err = <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>;</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;         <span class="keywordflow">goto</span> error;</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;      }</div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;   }</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;</div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;   err   = <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>;</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;   *stat = 1;</div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;error:</div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;   <a class="code" href="tomcrypt__private_8h.html#ab05b6b59fa182b81f5f990d5621229f6">mp_clear</a>(tmp);</div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;   <span class="keywordflow">return</span> err;</div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;}</div><div class="ttc" id="tomcrypt_8h_html_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334"><div class="ttname"><a href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a></div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt_8h_source.html#l00042">tomcrypt.h:42</a></div></div>
<div class="ttc" id="tomcrypt__math_8h_html_a42d0c7d4c09793df79660774d3436db2"><div class="ttname"><a href="tomcrypt__math_8h.html#a42d0c7d4c09793df79660774d3436db2">LTC_MP_LT</a></div><div class="ttdeci">#define LTC_MP_LT</div><div class="ttdoc">math functions</div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt__math_8h_source.html#l00012">tomcrypt_math.h:12</a></div></div>
<div class="ttc" id="tomcrypt__argchk_8h_html_a683da3e041e49f196318b6ea951414ba"><div class="ttname"><a href="tomcrypt__argchk_8h.html#a683da3e041e49f196318b6ea951414ba">LTC_ARGCHK</a></div><div class="ttdeci">#define LTC_ARGCHK(x)</div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt__argchk_8h_source.html#l00019">tomcrypt_argchk.h:19</a></div></div>
<div class="ttc" id="tomcrypt__private_8h_html_a62ea02fbe7dd2d456e49520264d775ee"><div class="ttname"><a href="tomcrypt__private_8h.html#a62ea02fbe7dd2d456e49520264d775ee">mp_cmp</a></div><div class="ttdeci">#define mp_cmp(a, b)</div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt__private_8h_source.html#l00144">tomcrypt_private.h:144</a></div></div>
<div class="ttc" id="tomcrypt__private_8h_html_a4fb1221fbef91bf8163390e3cfb82085"><div class="ttname"><a href="tomcrypt__private_8h.html#a4fb1221fbef91bf8163390e3cfb82085">mp_exptmod</a></div><div class="ttdeci">#define mp_exptmod(a, b, c, d)</div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt__private_8h_source.html#l00182">tomcrypt_private.h:182</a></div></div>
<div class="ttc" id="tomcrypt__math_8h_html_a035a31bde4f31419eb259e36e5776607"><div class="ttname"><a href="tomcrypt__math_8h.html#a035a31bde4f31419eb259e36e5776607">LTC_MP_EQ</a></div><div class="ttdeci">#define LTC_MP_EQ</div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt__math_8h_source.html#l00013">tomcrypt_math.h:13</a></div></div>
<div class="ttc" id="tomcrypt__private_8h_html_aff03c4f22c68d651747055048c509cf3"><div class="ttname"><a href="tomcrypt__private_8h.html#aff03c4f22c68d651747055048c509cf3">mp_init</a></div><div class="ttdeci">#define mp_init(a)</div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt__private_8h_source.html#l00129">tomcrypt_private.h:129</a></div></div>
<div class="ttc" id="tomcrypt__math_8h_html_adff156a960d44f0f5b67b75ef1f1c29b"><div class="ttname"><a href="tomcrypt__math_8h.html#adff156a960d44f0f5b67b75ef1f1c29b">LTC_MP_GT</a></div><div class="ttdeci">#define LTC_MP_GT</div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt__math_8h_source.html#l00014">tomcrypt_math.h:14</a></div></div>
<div class="ttc" id="tomcrypt__private_8h_html_ab05b6b59fa182b81f5f990d5621229f6"><div class="ttname"><a href="tomcrypt__private_8h.html#ab05b6b59fa182b81f5f990d5621229f6">mp_clear</a></div><div class="ttdeci">#define mp_clear(a)</div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt__private_8h_source.html#l00131">tomcrypt_private.h:131</a></div></div>
<div class="ttc" id="tomcrypt__private_8h_html_a6ce44f2e6f872565a468b67d9a93dc28"><div class="ttname"><a href="tomcrypt__private_8h.html#a6ce44f2e6f872565a468b67d9a93dc28">mp_cmp_d</a></div><div class="ttdeci">#define mp_cmp_d(a, b)</div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt__private_8h_source.html#l00145">tomcrypt_private.h:145</a></div></div>
<div class="ttc" id="tomcrypt__pk_8h_html_afb69d121a43f5ae8b47e6b83611d9272a7295b3dea2c5277912c6e040e1c96649"><div class="ttname"><a href="tomcrypt__pk_8h.html#afb69d121a43f5ae8b47e6b83611d9272a7295b3dea2c5277912c6e040e1c96649">PK_PRIVATE</a></div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt__pk_8h_source.html#l00016">tomcrypt_pk.h:16</a></div></div>
<div class="ttc" id="tomcrypt__private_8h_html_a4215ff0d6838acb3d959d3e68c923de7"><div class="ttname"><a href="tomcrypt__private_8h.html#a4215ff0d6838acb3d959d3e68c923de7">mp_sub_d</a></div><div class="ttdeci">#define mp_sub_d(a, b, c)</div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt__private_8h_source.html#l00159">tomcrypt_private.h:159</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="tomcrypt_8h_source.html#l00042">CRYPT_OK</a>, <a class="el" href="tomcrypt__argchk_8h_source.html#l00019">LTC_ARGCHK</a>, <a class="el" href="tomcrypt__math_8h_source.html#l00013">LTC_MP_EQ</a>, <a class="el" href="tomcrypt__math_8h_source.html#l00014">LTC_MP_GT</a>, <a class="el" href="tomcrypt__math_8h_source.html#l00012">LTC_MP_LT</a>, <a class="el" href="tomcrypt__private_8h_source.html#l00131">mp_clear</a>, <a class="el" href="tomcrypt__private_8h_source.html#l00144">mp_cmp</a>, <a class="el" href="tomcrypt__private_8h_source.html#l00145">mp_cmp_d</a>, <a class="el" href="tomcrypt__private_8h_source.html#l00182">mp_exptmod</a>, <a class="el" href="tomcrypt__private_8h_source.html#l00129">mp_init</a>, <a class="el" href="tomcrypt__private_8h_source.html#l00159">mp_sub_d</a>, and <a class="el" href="tomcrypt__pk_8h_source.html#l00016">PK_PRIVATE</a>.</p>

<p class="reference">Referenced by <a class="el" href="dsa__import_8c_source.html#l00025">dsa_import()</a>, <a class="el" href="dsa__set_8c_source.html#l00073">dsa_set_key()</a>, and <a class="el" href="dsa__verify__key_8c_source.html#l00029">dsa_verify_key()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="tomcrypt__private_8h_aa5b2d573863af50ed2f38a00998a1274_icgraph.png" border="0" usemap="#tomcrypt__private_8h_aa5b2d573863af50ed2f38a00998a1274_icgraph" alt=""/></div>
<!-- MAP 23 -->
</div>

</div>
</div>
<a id="aa65ad9426232274db6f50ae2ba05a600"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa65ad9426232274db6f50ae2ba05a600">&#9670;&nbsp;</a></span>ecc_copy_curve()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ecc_copy_curve </td>
          <td>(</td>
          <td class="paramtype">const ecc_key *&#160;</td>
          <td class="paramname"><em>srckey</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">ecc_key *&#160;</td>
          <td class="paramname"><em>key</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ecc__set__curve__internal_8c_source.html#l00045">45</a> of file <a class="el" href="ecc__set__curve__internal_8c_source.html">ecc_set_curve_internal.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;{</div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;   <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> i;</div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;   <span class="keywordtype">int</span> err;</div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;</div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;   <a class="code" href="tomcrypt__argchk_8h.html#a683da3e041e49f196318b6ea951414ba">LTC_ARGCHK</a>(key != NULL);</div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;   <a class="code" href="tomcrypt__argchk_8h.html#a683da3e041e49f196318b6ea951414ba">LTC_ARGCHK</a>(srckey != NULL);</div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;</div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;   <span class="keywordflow">if</span> ((err = <a class="code" href="tomcrypt__private_8h.html#adb6322247b1a4f0347219acab3120bd3">mp_init_multi</a>(&amp;key-&gt;dp.prime, &amp;key-&gt;dp.order, &amp;key-&gt;dp.A, &amp;key-&gt;dp.B,</div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;                            &amp;key-&gt;dp.base.x, &amp;key-&gt;dp.base.y, &amp;key-&gt;dp.base.z,</div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;                            &amp;key-&gt;pubkey.x, &amp;key-&gt;pubkey.y, &amp;key-&gt;pubkey.z, &amp;key-&gt;k,</div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;                            NULL)) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>) {</div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;      <span class="keywordflow">return</span> err;</div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;   }</div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;</div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;   <span class="comment">/* A, B, order, prime, Gx, Gy */</span></div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;   <span class="keywordflow">if</span> ((err = <a class="code" href="tomcrypt__private_8h.html#afbb35bc8f920448d169ddc83a4308840">mp_copy</a>(srckey-&gt;dp.prime,  key-&gt;dp.prime )) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>) { <span class="keywordflow">goto</span> error; }</div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;   <span class="keywordflow">if</span> ((err = <a class="code" href="tomcrypt__private_8h.html#afbb35bc8f920448d169ddc83a4308840">mp_copy</a>(srckey-&gt;dp.order,  key-&gt;dp.order )) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>) { <span class="keywordflow">goto</span> error; }</div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;   <span class="keywordflow">if</span> ((err = <a class="code" href="tomcrypt__private_8h.html#afbb35bc8f920448d169ddc83a4308840">mp_copy</a>(srckey-&gt;dp.A,      key-&gt;dp.A     )) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>) { <span class="keywordflow">goto</span> error; }</div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;   <span class="keywordflow">if</span> ((err = <a class="code" href="tomcrypt__private_8h.html#afbb35bc8f920448d169ddc83a4308840">mp_copy</a>(srckey-&gt;dp.B,      key-&gt;dp.B     )) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>) { <span class="keywordflow">goto</span> error; }</div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;   <span class="keywordflow">if</span> ((err = <a class="code" href="tomcrypt__private_8h.html#a4b36b54e30a0a87aff57a936b386df7f">ltc_ecc_copy_point</a>(&amp;srckey-&gt;dp.base, &amp;key-&gt;dp.base)) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>) { <span class="keywordflow">goto</span> error; }</div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;   <span class="comment">/* cofactor &amp; size */</span></div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;   key-&gt;dp.cofactor = srckey-&gt;dp.cofactor;</div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;   key-&gt;dp.size     = srckey-&gt;dp.size;</div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;   <span class="comment">/* OID */</span></div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;   <span class="keywordflow">if</span> (srckey-&gt;dp.oidlen &gt; 0) {</div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;     key-&gt;dp.oidlen = srckey-&gt;dp.oidlen;</div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;     <span class="keywordflow">for</span> (i = 0; i &lt; key-&gt;dp.oidlen; i++) key-&gt;dp.oid[i] = srckey-&gt;dp.oid[i];</div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;   }</div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;   <span class="keywordflow">else</span> {</div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;     <a class="code" href="ecc__set__curve__internal_8c.html#a3d657756a1e38d4f275973a9a0f98fd1">_ecc_oid_lookup</a>(key); <span class="comment">/* try to find OID in ltc_ecc_curves */</span></div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;   }</div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;   <span class="comment">/* success */</span></div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>;</div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;</div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;error:</div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;   <a class="code" href="ecc__free_8c.html#a73cd81ea7d3b24f2d9ef309c4b22e3b7">ecc_free</a>(key);</div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;   <span class="keywordflow">return</span> err;</div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;}</div><div class="ttc" id="tomcrypt_8h_html_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334"><div class="ttname"><a href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a></div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt_8h_source.html#l00042">tomcrypt.h:42</a></div></div>
<div class="ttc" id="ecc__set__curve__internal_8c_html_a3d657756a1e38d4f275973a9a0f98fd1"><div class="ttname"><a href="ecc__set__curve__internal_8c.html#a3d657756a1e38d4f275973a9a0f98fd1">_ecc_oid_lookup</a></div><div class="ttdeci">static void _ecc_oid_lookup(ecc_key *key)</div><div class="ttdef"><b>Definition:</b> <a href="ecc__set__curve__internal_8c_source.html#l00021">ecc_set_curve_internal.c:21</a></div></div>
<div class="ttc" id="tomcrypt__argchk_8h_html_a683da3e041e49f196318b6ea951414ba"><div class="ttname"><a href="tomcrypt__argchk_8h.html#a683da3e041e49f196318b6ea951414ba">LTC_ARGCHK</a></div><div class="ttdeci">#define LTC_ARGCHK(x)</div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt__argchk_8h_source.html#l00019">tomcrypt_argchk.h:19</a></div></div>
<div class="ttc" id="tomcrypt__private_8h_html_a4b36b54e30a0a87aff57a936b386df7f"><div class="ttname"><a href="tomcrypt__private_8h.html#a4b36b54e30a0a87aff57a936b386df7f">ltc_ecc_copy_point</a></div><div class="ttdeci">int ltc_ecc_copy_point(const ecc_point *src, ecc_point *dst)</div><div class="ttdef"><b>Definition:</b> <a href="ltc__ecc__points_8c_source.html#l00058">ltc_ecc_points.c:58</a></div></div>
<div class="ttc" id="tomcrypt__private_8h_html_afbb35bc8f920448d169ddc83a4308840"><div class="ttname"><a href="tomcrypt__private_8h.html#afbb35bc8f920448d169ddc83a4308840">mp_copy</a></div><div class="ttdeci">#define mp_copy(a, b)</div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt__private_8h_source.html#l00137">tomcrypt_private.h:137</a></div></div>
<div class="ttc" id="ecc__free_8c_html_a73cd81ea7d3b24f2d9ef309c4b22e3b7"><div class="ttname"><a href="ecc__free_8c.html#a73cd81ea7d3b24f2d9ef309c4b22e3b7">ecc_free</a></div><div class="ttdeci">void ecc_free(ecc_key *key)</div><div class="ttdoc">Free an ECC key from memory.</div><div class="ttdef"><b>Definition:</b> <a href="ecc__free_8c_source.html#l00023">ecc_free.c:23</a></div></div>
<div class="ttc" id="tomcrypt__private_8h_html_adb6322247b1a4f0347219acab3120bd3"><div class="ttname"><a href="tomcrypt__private_8h.html#adb6322247b1a4f0347219acab3120bd3">mp_init_multi</a></div><div class="ttdeci">#define mp_init_multi</div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt__private_8h_source.html#l00130">tomcrypt_private.h:130</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="ecc__set__curve__internal_8c_source.html#l00021">_ecc_oid_lookup()</a>, <a class="el" href="tomcrypt_8h_source.html#l00042">CRYPT_OK</a>, <a class="el" href="ecc__free_8c_source.html#l00023">ecc_free()</a>, <a class="el" href="tomcrypt__argchk_8h_source.html#l00019">LTC_ARGCHK</a>, <a class="el" href="ltc__ecc__points_8c_source.html#l00058">ltc_ecc_copy_point()</a>, <a class="el" href="tomcrypt__private_8h_source.html#l00137">mp_copy</a>, and <a class="el" href="tomcrypt__private_8h_source.html#l00130">mp_init_multi</a>.</p>

<p class="reference">Referenced by <a class="el" href="ecc__decrypt__key_8c_source.html#l00028">ecc_decrypt_key()</a>, <a class="el" href="ecc__encrypt__key_8c_source.html#l00031">ecc_encrypt_key()</a>, and <a class="el" href="ecc__sign__hash_8c_source.html#l00032">ecc_sign_hash_ex()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="tomcrypt__private_8h_aa65ad9426232274db6f50ae2ba05a600_cgraph.png" border="0" usemap="#tomcrypt__private_8h_aa65ad9426232274db6f50ae2ba05a600_cgraph" alt=""/></div>
<!-- MAP 24 -->
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="tomcrypt__private_8h_aa65ad9426232274db6f50ae2ba05a600_icgraph.png" border="0" usemap="#tomcrypt__private_8h_aa65ad9426232274db6f50ae2ba05a600_icgraph" alt=""/></div>
<!-- MAP 25 -->
</div>

</div>
</div>
<a id="a6e24f3e6a3975c4d9e261a6031cab7b5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6e24f3e6a3975c4d9e261a6031cab7b5">&#9670;&nbsp;</a></span>ecc_import_subject_public_key_info()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ecc_import_subject_public_key_info </td>
          <td>(</td>
          <td class="paramtype">const unsigned char *&#160;</td>
          <td class="paramname"><em>in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned long&#160;</td>
          <td class="paramname"><em>inlen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">ecc_key *&#160;</td>
          <td class="paramname"><em>key</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ecc__import__x509_8c_source.html#l00092">92</a> of file <a class="el" href="ecc__import__x509_8c_source.html">ecc_import_x509.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;{</div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;   <span class="keywordtype">int</span> err;</div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;</div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;   <span class="keywordflow">if</span> ((err = <a class="code" href="ecc__import__x509_8c.html#a95f6b54b054138d6b43afc3876908bad">_ecc_import_x509_with_oid</a>(in, inlen, key)) == <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>) {</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;      <span class="keywordflow">goto</span> success;</div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;   }</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;</div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;   err = <a class="code" href="ecc__import__x509_8c.html#adf48b3ba468c0324055e9413a82d39f5">_ecc_import_x509_with_curve</a>(in, inlen, key);</div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;</div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;success:</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;   <span class="keywordflow">return</span> err;</div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;}</div><div class="ttc" id="tomcrypt_8h_html_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334"><div class="ttname"><a href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a></div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt_8h_source.html#l00042">tomcrypt.h:42</a></div></div>
<div class="ttc" id="ecc__import__x509_8c_html_adf48b3ba468c0324055e9413a82d39f5"><div class="ttname"><a href="ecc__import__x509_8c.html#adf48b3ba468c0324055e9413a82d39f5">_ecc_import_x509_with_curve</a></div><div class="ttdeci">static int _ecc_import_x509_with_curve(const unsigned char *in, unsigned long inlen, ecc_key *key)</div><div class="ttdef"><b>Definition:</b> <a href="ecc__import__x509_8c_source.html#l00039">ecc_import_x509.c:39</a></div></div>
<div class="ttc" id="ecc__import__x509_8c_html_a95f6b54b054138d6b43afc3876908bad"><div class="ttname"><a href="ecc__import__x509_8c.html#a95f6b54b054138d6b43afc3876908bad">_ecc_import_x509_with_oid</a></div><div class="ttdeci">static int _ecc_import_x509_with_oid(const unsigned char *in, unsigned long inlen, ecc_key *key)</div><div class="ttdef"><b>Definition:</b> <a href="ecc__import__x509_8c_source.html#l00013">ecc_import_x509.c:13</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="ecc__import__x509_8c_source.html#l00039">_ecc_import_x509_with_curve()</a>, <a class="el" href="ecc__import__x509_8c_source.html#l00013">_ecc_import_x509_with_oid()</a>, and <a class="el" href="tomcrypt_8h_source.html#l00042">CRYPT_OK</a>.</p>

<p class="reference">Referenced by <a class="el" href="ecc__import__openssl_8c_source.html#l00108">ecc_import_openssl()</a>, and <a class="el" href="ecc__import__x509_8c_source.html#l00113">ecc_import_x509()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="tomcrypt__private_8h_a6e24f3e6a3975c4d9e261a6031cab7b5_cgraph.png" border="0" usemap="#tomcrypt__private_8h_a6e24f3e6a3975c4d9e261a6031cab7b5_cgraph" alt=""/></div>
<!-- MAP 26 -->
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="tomcrypt__private_8h_a6e24f3e6a3975c4d9e261a6031cab7b5_icgraph.png" border="0" usemap="#tomcrypt__private_8h_a6e24f3e6a3975c4d9e261a6031cab7b5_icgraph" alt=""/></div>
<!-- MAP 27 -->
</div>

</div>
</div>
<a id="ae380263c82c1fe0cde8dc08e89f7940c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae380263c82c1fe0cde8dc08e89f7940c">&#9670;&nbsp;</a></span>ecc_set_curve_by_size()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ecc_set_curve_by_size </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">ecc_key *&#160;</td>
          <td class="paramname"><em>key</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ecc__set__curve_8c_source.html#l00050">50</a> of file <a class="el" href="ecc__set__curve_8c_source.html">ecc_set_curve.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;{</div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;   <span class="keyword">const</span> ltc_ecc_curve *cu = NULL;</div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;   <span class="keywordtype">int</span> err = <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06ca03c22220d7538be04455cd2aa6ddf9da">CRYPT_ERROR</a>;</div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;</div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;   <span class="comment">/* for compatibility with libtomcrypt-1.17 the sizes below must match the specific curves */</span></div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;   <span class="keywordflow">if</span> (size &lt;= 14) {</div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;      err = <a class="code" href="ecc__find__curve_8c.html#ad928083861ba212cb0c270bcf10b0403">ecc_find_curve</a>(<span class="stringliteral">&quot;SECP112R1&quot;</span>, &amp;cu);</div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;   }</div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (size &lt;= 16) {</div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;      err = <a class="code" href="ecc__find__curve_8c.html#ad928083861ba212cb0c270bcf10b0403">ecc_find_curve</a>(<span class="stringliteral">&quot;SECP128R1&quot;</span>, &amp;cu);</div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;   }</div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (size &lt;= 20) {</div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;      err = <a class="code" href="ecc__find__curve_8c.html#ad928083861ba212cb0c270bcf10b0403">ecc_find_curve</a>(<span class="stringliteral">&quot;SECP160R1&quot;</span>, &amp;cu);</div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;   }</div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (size &lt;= 24) {</div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;      err = <a class="code" href="ecc__find__curve_8c.html#ad928083861ba212cb0c270bcf10b0403">ecc_find_curve</a>(<span class="stringliteral">&quot;SECP192R1&quot;</span>, &amp;cu);</div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;   }</div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (size &lt;= 28) {</div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;      err = <a class="code" href="ecc__find__curve_8c.html#ad928083861ba212cb0c270bcf10b0403">ecc_find_curve</a>(<span class="stringliteral">&quot;SECP224R1&quot;</span>, &amp;cu);</div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;   }</div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (size &lt;= 32) {</div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;      err = <a class="code" href="ecc__find__curve_8c.html#ad928083861ba212cb0c270bcf10b0403">ecc_find_curve</a>(<span class="stringliteral">&quot;SECP256R1&quot;</span>, &amp;cu);</div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;   }</div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (size &lt;= 48) {</div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;      err = <a class="code" href="ecc__find__curve_8c.html#ad928083861ba212cb0c270bcf10b0403">ecc_find_curve</a>(<span class="stringliteral">&quot;SECP384R1&quot;</span>, &amp;cu);</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;   }</div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (size &lt;= 66) {</div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;      err = <a class="code" href="ecc__find__curve_8c.html#ad928083861ba212cb0c270bcf10b0403">ecc_find_curve</a>(<span class="stringliteral">&quot;SECP521R1&quot;</span>, &amp;cu);</div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;   }</div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;</div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;   <span class="keywordflow">if</span> (err == <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a> &amp;&amp; cu != NULL) <span class="keywordflow">return</span> <a class="code" href="ecc__set__curve_8c.html#ae59e3d6f85b87d050df0ece7c6f5c661">ecc_set_curve</a>(cu, key);</div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;</div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06ca92aa8bad3930f08d5a188bf72094b066">CRYPT_INVALID_ARG</a>;</div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;}</div><div class="ttc" id="tomcrypt_8h_html_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334"><div class="ttname"><a href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a></div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt_8h_source.html#l00042">tomcrypt.h:42</a></div></div>
<div class="ttc" id="ecc__find__curve_8c_html_ad928083861ba212cb0c270bcf10b0403"><div class="ttname"><a href="ecc__find__curve_8c.html#ad928083861ba212cb0c270bcf10b0403">ecc_find_curve</a></div><div class="ttdeci">int ecc_find_curve(const char *name_or_oid, const ltc_ecc_curve **cu)</div><div class="ttdef"><b>Definition:</b> <a href="ecc__find__curve_8c_source.html#l00215">ecc_find_curve.c:215</a></div></div>
<div class="ttc" id="tomcrypt_8h_html_adc29c2ff13d900c2f185ee95427fb06ca92aa8bad3930f08d5a188bf72094b066"><div class="ttname"><a href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06ca92aa8bad3930f08d5a188bf72094b066">CRYPT_INVALID_ARG</a></div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt_8h_source.html#l00065">tomcrypt.h:65</a></div></div>
<div class="ttc" id="ecc__set__curve_8c_html_ae59e3d6f85b87d050df0ece7c6f5c661"><div class="ttname"><a href="ecc__set__curve_8c.html#ae59e3d6f85b87d050df0ece7c6f5c661">ecc_set_curve</a></div><div class="ttdeci">int ecc_set_curve(const ltc_ecc_curve *cu, ecc_key *key)</div><div class="ttdef"><b>Definition:</b> <a href="ecc__set__curve_8c_source.html#l00014">ecc_set_curve.c:14</a></div></div>
<div class="ttc" id="tomcrypt_8h_html_adc29c2ff13d900c2f185ee95427fb06ca03c22220d7538be04455cd2aa6ddf9da"><div class="ttname"><a href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06ca03c22220d7538be04455cd2aa6ddf9da">CRYPT_ERROR</a></div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt_8h_source.html#l00043">tomcrypt.h:43</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="tomcrypt_8h_source.html#l00043">CRYPT_ERROR</a>, <a class="el" href="tomcrypt_8h_source.html#l00065">CRYPT_INVALID_ARG</a>, <a class="el" href="tomcrypt_8h_source.html#l00042">CRYPT_OK</a>, <a class="el" href="ecc__find__curve_8c_source.html#l00215">ecc_find_curve()</a>, and <a class="el" href="ecc__set__curve_8c_source.html#l00014">ecc_set_curve()</a>.</p>

<p class="reference">Referenced by <a class="el" href="ecc__ansi__x963__import_8c_source.html#l00029">ecc_ansi_x963_import_ex()</a>, <a class="el" href="ecc__import_8c_source.html#l00039">ecc_import_ex()</a>, and <a class="el" href="ecc__make__key_8c_source.html#l00027">ecc_make_key()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="tomcrypt__private_8h_ae380263c82c1fe0cde8dc08e89f7940c_cgraph.png" border="0" usemap="#tomcrypt__private_8h_ae380263c82c1fe0cde8dc08e89f7940c_cgraph" alt=""/></div>
<!-- MAP 28 -->
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="tomcrypt__private_8h_ae380263c82c1fe0cde8dc08e89f7940c_icgraph.png" border="0" usemap="#tomcrypt__private_8h_ae380263c82c1fe0cde8dc08e89f7940c_icgraph" alt=""/></div>
<!-- MAP 29 -->
</div>

</div>
</div>
<a id="a5058c67d67d65a00c30b08ee3c0149f1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5058c67d67d65a00c30b08ee3c0149f1">&#9670;&nbsp;</a></span>ecc_set_curve_from_mpis()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ecc_set_curve_from_mpis </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>b</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>prime</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>order</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>gx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>gy</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned long&#160;</td>
          <td class="paramname"><em>cofactor</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">ecc_key *&#160;</td>
          <td class="paramname"><em>key</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ecc__set__curve__internal_8c_source.html#l00085">85</a> of file <a class="el" href="ecc__set__curve__internal_8c_source.html">ecc_set_curve_internal.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;{</div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;   <span class="keywordtype">int</span> err;</div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;</div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;   <a class="code" href="tomcrypt__argchk_8h.html#a683da3e041e49f196318b6ea951414ba">LTC_ARGCHK</a>(key   != NULL);</div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;   <a class="code" href="tomcrypt__argchk_8h.html#a683da3e041e49f196318b6ea951414ba">LTC_ARGCHK</a>(a     != NULL);</div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;   <a class="code" href="tomcrypt__argchk_8h.html#a683da3e041e49f196318b6ea951414ba">LTC_ARGCHK</a>(b     != NULL);</div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;   <a class="code" href="tomcrypt__argchk_8h.html#a683da3e041e49f196318b6ea951414ba">LTC_ARGCHK</a>(prime != NULL);</div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;   <a class="code" href="tomcrypt__argchk_8h.html#a683da3e041e49f196318b6ea951414ba">LTC_ARGCHK</a>(order != NULL);</div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;   <a class="code" href="tomcrypt__argchk_8h.html#a683da3e041e49f196318b6ea951414ba">LTC_ARGCHK</a>(gx    != NULL);</div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;   <a class="code" href="tomcrypt__argchk_8h.html#a683da3e041e49f196318b6ea951414ba">LTC_ARGCHK</a>(gy    != NULL);</div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;   <span class="keywordflow">if</span> ((err = <a class="code" href="tomcrypt__private_8h.html#adb6322247b1a4f0347219acab3120bd3">mp_init_multi</a>(&amp;key-&gt;dp.prime, &amp;key-&gt;dp.order, &amp;key-&gt;dp.A, &amp;key-&gt;dp.B,</div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;                            &amp;key-&gt;dp.base.x, &amp;key-&gt;dp.base.y, &amp;key-&gt;dp.base.z,</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;                            &amp;key-&gt;pubkey.x, &amp;key-&gt;pubkey.y, &amp;key-&gt;pubkey.z, &amp;key-&gt;k,</div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;                            NULL)) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>) {</div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;      <span class="keywordflow">return</span> err;</div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;   }</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;</div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;   <span class="comment">/* A, B, order, prime, Gx, Gy */</span></div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;   <span class="keywordflow">if</span> ((err = <a class="code" href="tomcrypt__private_8h.html#afbb35bc8f920448d169ddc83a4308840">mp_copy</a>(prime, key-&gt;dp.prime )) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>) { <span class="keywordflow">goto</span> error; }</div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;   <span class="keywordflow">if</span> ((err = <a class="code" href="tomcrypt__private_8h.html#afbb35bc8f920448d169ddc83a4308840">mp_copy</a>(order, key-&gt;dp.order )) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>) { <span class="keywordflow">goto</span> error; }</div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;   <span class="keywordflow">if</span> ((err = <a class="code" href="tomcrypt__private_8h.html#afbb35bc8f920448d169ddc83a4308840">mp_copy</a>(a,     key-&gt;dp.A     )) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>) { <span class="keywordflow">goto</span> error; }</div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;   <span class="keywordflow">if</span> ((err = <a class="code" href="tomcrypt__private_8h.html#afbb35bc8f920448d169ddc83a4308840">mp_copy</a>(b,     key-&gt;dp.B     )) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>) { <span class="keywordflow">goto</span> error; }</div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;   <span class="keywordflow">if</span> ((err = <a class="code" href="tomcrypt__private_8h.html#afbb35bc8f920448d169ddc83a4308840">mp_copy</a>(gx,    key-&gt;dp.base.x)) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>) { <span class="keywordflow">goto</span> error; }</div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;   <span class="keywordflow">if</span> ((err = <a class="code" href="tomcrypt__private_8h.html#afbb35bc8f920448d169ddc83a4308840">mp_copy</a>(gy,    key-&gt;dp.base.y)) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>) { <span class="keywordflow">goto</span> error; }</div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;   <span class="keywordflow">if</span> ((err = <a class="code" href="tomcrypt__private_8h.html#a000b0542ef4ecf639ff69895490fdb8f">mp_set</a>(key-&gt;dp.base.z, 1)) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>)      { <span class="keywordflow">goto</span> error; }</div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;   <span class="comment">/* cofactor &amp; size */</span></div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;   key-&gt;dp.cofactor = cofactor;</div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;   key-&gt;dp.size = <a class="code" href="tomcrypt__private_8h.html#ad301148bb24f43a8c7003a6976dfaa5a">mp_unsigned_bin_size</a>(prime);</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;   <span class="comment">/* try to find OID in ltc_ecc_curves */</span></div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;   <a class="code" href="ecc__set__curve__internal_8c.html#a3d657756a1e38d4f275973a9a0f98fd1">_ecc_oid_lookup</a>(key);</div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;   <span class="comment">/* success */</span></div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>;</div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;</div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;error:</div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;   <a class="code" href="ecc__free_8c.html#a73cd81ea7d3b24f2d9ef309c4b22e3b7">ecc_free</a>(key);</div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;   <span class="keywordflow">return</span> err;</div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;}</div><div class="ttc" id="tomcrypt_8h_html_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334"><div class="ttname"><a href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a></div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt_8h_source.html#l00042">tomcrypt.h:42</a></div></div>
<div class="ttc" id="ecc__set__curve__internal_8c_html_a3d657756a1e38d4f275973a9a0f98fd1"><div class="ttname"><a href="ecc__set__curve__internal_8c.html#a3d657756a1e38d4f275973a9a0f98fd1">_ecc_oid_lookup</a></div><div class="ttdeci">static void _ecc_oid_lookup(ecc_key *key)</div><div class="ttdef"><b>Definition:</b> <a href="ecc__set__curve__internal_8c_source.html#l00021">ecc_set_curve_internal.c:21</a></div></div>
<div class="ttc" id="tomcrypt__argchk_8h_html_a683da3e041e49f196318b6ea951414ba"><div class="ttname"><a href="tomcrypt__argchk_8h.html#a683da3e041e49f196318b6ea951414ba">LTC_ARGCHK</a></div><div class="ttdeci">#define LTC_ARGCHK(x)</div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt__argchk_8h_source.html#l00019">tomcrypt_argchk.h:19</a></div></div>
<div class="ttc" id="tomcrypt__private_8h_html_afbb35bc8f920448d169ddc83a4308840"><div class="ttname"><a href="tomcrypt__private_8h.html#afbb35bc8f920448d169ddc83a4308840">mp_copy</a></div><div class="ttdeci">#define mp_copy(a, b)</div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt__private_8h_source.html#l00137">tomcrypt_private.h:137</a></div></div>
<div class="ttc" id="ecc__free_8c_html_a73cd81ea7d3b24f2d9ef309c4b22e3b7"><div class="ttname"><a href="ecc__free_8c.html#a73cd81ea7d3b24f2d9ef309c4b22e3b7">ecc_free</a></div><div class="ttdeci">void ecc_free(ecc_key *key)</div><div class="ttdoc">Free an ECC key from memory.</div><div class="ttdef"><b>Definition:</b> <a href="ecc__free_8c_source.html#l00023">ecc_free.c:23</a></div></div>
<div class="ttc" id="tomcrypt__private_8h_html_adb6322247b1a4f0347219acab3120bd3"><div class="ttname"><a href="tomcrypt__private_8h.html#adb6322247b1a4f0347219acab3120bd3">mp_init_multi</a></div><div class="ttdeci">#define mp_init_multi</div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt__private_8h_source.html#l00130">tomcrypt_private.h:130</a></div></div>
<div class="ttc" id="tomcrypt__private_8h_html_ad301148bb24f43a8c7003a6976dfaa5a"><div class="ttname"><a href="tomcrypt__private_8h.html#ad301148bb24f43a8c7003a6976dfaa5a">mp_unsigned_bin_size</a></div><div class="ttdeci">#define mp_unsigned_bin_size(a)</div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt__private_8h_source.html#l00152">tomcrypt_private.h:152</a></div></div>
<div class="ttc" id="tomcrypt__private_8h_html_a000b0542ef4ecf639ff69895490fdb8f"><div class="ttname"><a href="tomcrypt__private_8h.html#a000b0542ef4ecf639ff69895490fdb8f">mp_set</a></div><div class="ttdeci">#define mp_set(a, b)</div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt__private_8h_source.html#l00139">tomcrypt_private.h:139</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="ecc__set__curve__internal_8c_source.html#l00021">_ecc_oid_lookup()</a>, <a class="el" href="tomcrypt_8h_source.html#l00042">CRYPT_OK</a>, <a class="el" href="ecc__free_8c_source.html#l00023">ecc_free()</a>, <a class="el" href="tomcrypt__argchk_8h_source.html#l00019">LTC_ARGCHK</a>, <a class="el" href="tomcrypt__private_8h_source.html#l00137">mp_copy</a>, <a class="el" href="tomcrypt__private_8h_source.html#l00130">mp_init_multi</a>, <a class="el" href="tomcrypt__private_8h_source.html#l00139">mp_set</a>, and <a class="el" href="tomcrypt__private_8h_source.html#l00152">mp_unsigned_bin_size</a>.</p>

<p class="reference">Referenced by <a class="el" href="ecc__import__openssl_8c_source.html#l00048">_ecc_import_private_with_curve()</a>, <a class="el" href="ecc__import__x509_8c_source.html#l00039">_ecc_import_x509_with_curve()</a>, and <a class="el" href="ecc__import__pkcs8_8c_source.html#l00046">ecc_import_pkcs8()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="tomcrypt__private_8h_a5058c67d67d65a00c30b08ee3c0149f1_cgraph.png" border="0" usemap="#tomcrypt__private_8h_a5058c67d67d65a00c30b08ee3c0149f1_cgraph" alt=""/></div>
<!-- MAP 30 -->
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="tomcrypt__private_8h_a5058c67d67d65a00c30b08ee3c0149f1_icgraph.png" border="0" usemap="#tomcrypt__private_8h_a5058c67d67d65a00c30b08ee3c0149f1_icgraph" alt=""/></div>
<!-- MAP 31 -->
</div>

</div>
</div>
<a id="a5921e9a5a19d09bc948281baf09ea128"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5921e9a5a19d09bc948281baf09ea128">&#9670;&nbsp;</a></span>ecc_ssh_ecdsa_encode_name()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ecc_ssh_ecdsa_encode_name </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>buffer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned long *&#160;</td>
          <td class="paramname"><em>buflen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const ecc_key *&#160;</td>
          <td class="paramname"><em>key</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Curve/OID to SSH+ECDSA name string mapping. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">buffer</td><td>[out] The destination for the name </td></tr>
    <tr><td class="paramname">buflen</td><td>[in/out] The max size and resulting size (including terminator) of the name </td></tr>
    <tr><td class="paramname">key</td><td>A public or private ECC key </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>CRYPT_OK if successful </dd></dl>

<p class="definition">Definition at line <a class="el" href="ecc__ssh__ecdsa__encode__name_8c_source.html#l00024">24</a> of file <a class="el" href="ecc__ssh__ecdsa__encode__name_8c_source.html">ecc_ssh_ecdsa_encode_name.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;{</div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;   <span class="keywordtype">char</span> oidstr[64];</div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;   <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> oidlen = <span class="keyword">sizeof</span>(oidstr);</div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;   <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> size = 0;</div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;   <span class="keywordtype">int</span> err;</div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;</div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;   <a class="code" href="tomcrypt__argchk_8h.html#a683da3e041e49f196318b6ea951414ba">LTC_ARGCHK</a>(buffer != NULL);</div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;   <a class="code" href="tomcrypt__argchk_8h.html#a683da3e041e49f196318b6ea951414ba">LTC_ARGCHK</a>(buflen != NULL);</div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;   <a class="code" href="tomcrypt__argchk_8h.html#a683da3e041e49f196318b6ea951414ba">LTC_ARGCHK</a>(key != NULL);</div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;</div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;   <span class="comment">/* Get the OID of the curve */</span></div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;   <span class="keywordflow">if</span> ((err = <a class="code" href="ecc__get__oid__str_8c.html#a55d2be4c5b58f6a22c780f10063d2217">ecc_get_oid_str</a>(oidstr, &amp;oidlen, key)) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>) <span class="keywordflow">goto</span> error;</div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;</div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;   <span class="comment">/* Check for three named curves: nistp256, nistp384, nistp521 */</span></div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="tomcrypt__cfg_8h.html#a5d6e3d69e1d3f54de008b963bba3c6b3">XSTRCMP</a>(<span class="stringliteral">&quot;1.2.840.10045.3.1.7&quot;</span>, oidstr) == 0) {</div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;      <span class="comment">/* nistp256 - secp256r1 - OID 1.2.840.10045.3.1.7 */</span></div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;      size = snprintf(buffer, *buflen, <span class="stringliteral">&quot;ecdsa-sha2-nistp256&quot;</span>);</div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;   }</div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="tomcrypt__cfg_8h.html#a5d6e3d69e1d3f54de008b963bba3c6b3">XSTRCMP</a>(<span class="stringliteral">&quot;1.3.132.0.34&quot;</span>, oidstr) == 0) {</div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;      <span class="comment">/* nistp384 - secp384r1 - OID 1.3.132.0.34 */</span></div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;      size = snprintf(buffer, *buflen, <span class="stringliteral">&quot;ecdsa-sha2-nistp384&quot;</span>);</div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;   }</div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="tomcrypt__cfg_8h.html#a5d6e3d69e1d3f54de008b963bba3c6b3">XSTRCMP</a>(<span class="stringliteral">&quot;1.3.132.0.35&quot;</span>, oidstr) == 0) {</div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;      <span class="comment">/* nistp521 - secp521r1 - OID 1.3.132.0.35 */</span></div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;      size = snprintf(buffer, *buflen, <span class="stringliteral">&quot;ecdsa-sha2-nistp521&quot;</span>);</div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;      <span class="comment">/* Otherwise we use the OID... */</span></div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;      size = snprintf(buffer, *buflen, <span class="stringliteral">&quot;ecdsa-sha2-%s&quot;</span>, oidstr);</div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;   }</div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;</div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;   <span class="comment">/* snprintf returns size that would have been written, but limits to buflen-1 chars plus terminator */</span></div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;   <span class="keywordflow">if</span> (size &gt;= *buflen) {</div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;      err = <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06caccd878f5599f3036ffe759dbe1a1ac16">CRYPT_BUFFER_OVERFLOW</a>;</div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;      err = <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>;</div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;   }</div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;   *buflen = size + 1; <span class="comment">/* the string length + NUL byte */</span></div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;</div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;error:</div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;   <span class="keywordflow">return</span> err;</div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;}</div><div class="ttc" id="tomcrypt_8h_html_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334"><div class="ttname"><a href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a></div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt_8h_source.html#l00042">tomcrypt.h:42</a></div></div>
<div class="ttc" id="ecc__get__oid__str_8c_html_a55d2be4c5b58f6a22c780f10063d2217"><div class="ttname"><a href="ecc__get__oid__str_8c.html#a55d2be4c5b58f6a22c780f10063d2217">ecc_get_oid_str</a></div><div class="ttdeci">int ecc_get_oid_str(char *out, unsigned long *outlen, const ecc_key *key)</div><div class="ttdoc">Extract OID as a string from ECC key.</div><div class="ttdef"><b>Definition:</b> <a href="ecc__get__oid__str_8c_source.html#l00021">ecc_get_oid_str.c:21</a></div></div>
<div class="ttc" id="tomcrypt__argchk_8h_html_a683da3e041e49f196318b6ea951414ba"><div class="ttname"><a href="tomcrypt__argchk_8h.html#a683da3e041e49f196318b6ea951414ba">LTC_ARGCHK</a></div><div class="ttdeci">#define LTC_ARGCHK(x)</div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt__argchk_8h_source.html#l00019">tomcrypt_argchk.h:19</a></div></div>
<div class="ttc" id="tomcrypt__cfg_8h_html_a5d6e3d69e1d3f54de008b963bba3c6b3"><div class="ttname"><a href="tomcrypt__cfg_8h.html#a5d6e3d69e1d3f54de008b963bba3c6b3">XSTRCMP</a></div><div class="ttdeci">int XSTRCMP(const char *s1, const char *s2)</div></div>
<div class="ttc" id="tomcrypt_8h_html_adc29c2ff13d900c2f185ee95427fb06caccd878f5599f3036ffe759dbe1a1ac16"><div class="ttname"><a href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06caccd878f5599f3036ffe759dbe1a1ac16">CRYPT_BUFFER_OVERFLOW</a></div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt_8h_source.html#l00050">tomcrypt.h:50</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="tomcrypt_8h_source.html#l00050">CRYPT_BUFFER_OVERFLOW</a>, <a class="el" href="tomcrypt_8h_source.html#l00042">CRYPT_OK</a>, <a class="el" href="ecc__get__oid__str_8c_source.html#l00021">ecc_get_oid_str()</a>, <a class="el" href="tomcrypt__argchk_8h_source.html#l00019">LTC_ARGCHK</a>, and <a class="el" href="tomcrypt__cfg_8h.html#a5d6e3d69e1d3f54de008b963bba3c6b3">XSTRCMP()</a>.</p>

<p class="reference">Referenced by <a class="el" href="ecc__recover__key_8c_source.html#l00032">ecc_recover_key()</a>, <a class="el" href="ecc__sign__hash_8c_source.html#l00032">ecc_sign_hash_ex()</a>, and <a class="el" href="ecc__verify__hash_8c_source.html#l00030">ecc_verify_hash_ex()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="tomcrypt__private_8h_a5921e9a5a19d09bc948281baf09ea128_cgraph.png" border="0" usemap="#tomcrypt__private_8h_a5921e9a5a19d09bc948281baf09ea128_cgraph" alt=""/></div>
<!-- MAP 32 -->
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="tomcrypt__private_8h_a5921e9a5a19d09bc948281baf09ea128_icgraph.png" border="0" usemap="#tomcrypt__private_8h_a5921e9a5a19d09bc948281baf09ea128_icgraph" alt=""/></div>
<!-- MAP 33 -->
</div>

</div>
</div>
<a id="a4b36b54e30a0a87aff57a936b386df7f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4b36b54e30a0a87aff57a936b386df7f">&#9670;&nbsp;</a></span>ltc_ecc_copy_point()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ltc_ecc_copy_point </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="tomcrypt__math_8h.html#a2a6efaeaa795aa54274d7c4fd66b018a">ecc_point</a> *&#160;</td>
          <td class="paramname"><em>src</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="tomcrypt__math_8h.html#a2a6efaeaa795aa54274d7c4fd66b018a">ecc_point</a> *&#160;</td>
          <td class="paramname"><em>dst</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ltc__ecc__points_8c_source.html#l00058">58</a> of file <a class="el" href="ltc__ecc__points_8c_source.html">ltc_ecc_points.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;{</div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;   <span class="keywordtype">int</span> err;</div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;   <span class="keywordflow">if</span> ((err = <a class="code" href="tomcrypt__math_8h.html#a3d38c44518c63b7a8abd0938f3d41c65">ltc_mp</a>.<a class="code" href="structltc__math__descriptor.html#a1f4a910f2a962c70c7ef7dae0bc84eef">copy</a>(src-&gt;x, dst-&gt;x)) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>) <span class="keywordflow">return</span> err;</div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;   <span class="keywordflow">if</span> ((err = <a class="code" href="tomcrypt__math_8h.html#a3d38c44518c63b7a8abd0938f3d41c65">ltc_mp</a>.<a class="code" href="structltc__math__descriptor.html#a1f4a910f2a962c70c7ef7dae0bc84eef">copy</a>(src-&gt;y, dst-&gt;y)) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>) <span class="keywordflow">return</span> err;</div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;   <span class="keywordflow">if</span> ((err = <a class="code" href="tomcrypt__math_8h.html#a3d38c44518c63b7a8abd0938f3d41c65">ltc_mp</a>.<a class="code" href="structltc__math__descriptor.html#a1f4a910f2a962c70c7ef7dae0bc84eef">copy</a>(src-&gt;z, dst-&gt;z)) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>) <span class="keywordflow">return</span> err;</div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>;</div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;}</div><div class="ttc" id="tomcrypt_8h_html_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334"><div class="ttname"><a href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a></div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt_8h_source.html#l00042">tomcrypt.h:42</a></div></div>
<div class="ttc" id="tomcrypt__math_8h_html_a3d38c44518c63b7a8abd0938f3d41c65"><div class="ttname"><a href="tomcrypt__math_8h.html#a3d38c44518c63b7a8abd0938f3d41c65">ltc_mp</a></div><div class="ttdeci">ltc_math_descriptor ltc_mp</div><div class="ttdef"><b>Definition:</b> <a href="crypt__ltc__mp__descriptor_8c_source.html#l00012">crypt_ltc_mp_descriptor.c:12</a></div></div>
<div class="ttc" id="structltc__math__descriptor_html_a1f4a910f2a962c70c7ef7dae0bc84eef"><div class="ttname"><a href="structltc__math__descriptor.html#a1f4a910f2a962c70c7ef7dae0bc84eef">ltc_math_descriptor::copy</a></div><div class="ttdeci">int(* copy)(void *src, void *dst)</div><div class="ttdoc">copy</div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt__math_8h_source.html#l00079">tomcrypt_math.h:79</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="tomcrypt__math_8h_source.html#l00079">ltc_math_descriptor::copy</a>, <a class="el" href="tomcrypt_8h_source.html#l00042">CRYPT_OK</a>, and <a class="el" href="crypt__ltc__mp__descriptor_8c_source.html#l00012">ltc_mp</a>.</p>

<p class="reference">Referenced by <a class="el" href="ecc__set__curve__internal_8c_source.html#l00045">ecc_copy_curve()</a>, <a class="el" href="ecc__recover__key_8c_source.html#l00032">ecc_recover_key()</a>, <a class="el" href="ecc__verify__hash_8c_source.html#l00030">ecc_verify_hash_ex()</a>, <a class="el" href="ltc__ecc__mul2add_8c_source.html#l00031">ltc_ecc_mul2add()</a>, <a class="el" href="ltc__ecc__mulmod__timing_8c_source.html#l00031">ltc_ecc_mulmod()</a>, <a class="el" href="ltc__ecc__projective__add__point_8c_source.html#l00029">ltc_ecc_projective_add_point()</a>, and <a class="el" href="ltc__ecc__projective__dbl__point_8c_source.html#l00046">ltc_ecc_projective_dbl_point()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="tomcrypt__private_8h_a4b36b54e30a0a87aff57a936b386df7f_icgraph.png" border="0" usemap="#tomcrypt__private_8h_a4b36b54e30a0a87aff57a936b386df7f_icgraph" alt=""/></div>
<!-- MAP 34 -->
</div>

</div>
</div>
<a id="a4cef83a7c070c94ff78d4df10a7b624f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4cef83a7c070c94ff78d4df10a7b624f">&#9670;&nbsp;</a></span>ltc_ecc_del_point()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ltc_ecc_del_point </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="tomcrypt__math_8h.html#a2a6efaeaa795aa54274d7c4fd66b018a">ecc_point</a> *&#160;</td>
          <td class="paramname"><em>p</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Free an ECC point from memory. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">p</td><td>The point to free </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="ltc__ecc__points_8c_source.html#l00040">40</a> of file <a class="el" href="ltc__ecc__points_8c_source.html">ltc_ecc_points.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;{</div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;   <span class="comment">/* prevents free&#39;ing null arguments */</span></div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;   <span class="keywordflow">if</span> (p != NULL) {</div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;      <a class="code" href="tomcrypt__private_8h.html#aad5c8a3112b3e4613f9efc86692c43cb">mp_clear_multi</a>(p-&gt;x, p-&gt;y, p-&gt;z, NULL); <span class="comment">/* note: p-&gt;z may be NULL but that&#39;s ok with this function anyways */</span></div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;      <a class="code" href="tomcrypt__cfg_8h.html#a260d66fc0690e0502cf3bfe7b5244b75">XFREE</a>(p);</div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;   }</div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;}</div><div class="ttc" id="tomcrypt__cfg_8h_html_a260d66fc0690e0502cf3bfe7b5244b75"><div class="ttname"><a href="tomcrypt__cfg_8h.html#a260d66fc0690e0502cf3bfe7b5244b75">XFREE</a></div><div class="ttdeci">void XFREE(void *p)</div></div>
<div class="ttc" id="tomcrypt__private_8h_html_aad5c8a3112b3e4613f9efc86692c43cb"><div class="ttname"><a href="tomcrypt__private_8h.html#aad5c8a3112b3e4613f9efc86692c43cb">mp_clear_multi</a></div><div class="ttdeci">#define mp_clear_multi</div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt__private_8h_source.html#l00132">tomcrypt_private.h:132</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="tomcrypt__private_8h_source.html#l00132">mp_clear_multi</a>, and <a class="el" href="tomcrypt__cfg_8h.html#a260d66fc0690e0502cf3bfe7b5244b75">XFREE()</a>.</p>

<p class="reference">Referenced by <a class="el" href="ecc__recover__key_8c_source.html#l00032">ecc_recover_key()</a>, <a class="el" href="ecc__shared__secret_8c_source.html#l00027">ecc_shared_secret()</a>, <a class="el" href="ecc__verify__hash_8c_source.html#l00030">ecc_verify_hash_ex()</a>, <a class="el" href="ltc__ecc__mul2add_8c_source.html#l00031">ltc_ecc_mul2add()</a>, <a class="el" href="ltc__ecc__mulmod__timing_8c_source.html#l00031">ltc_ecc_mulmod()</a>, and <a class="el" href="ltc__ecc__verify__key_8c_source.html#l00022">ltc_ecc_verify_key()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="tomcrypt__private_8h_a4cef83a7c070c94ff78d4df10a7b624f_cgraph.png" border="0" usemap="#tomcrypt__private_8h_a4cef83a7c070c94ff78d4df10a7b624f_cgraph" alt=""/></div>
<!-- MAP 35 -->
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="tomcrypt__private_8h_a4cef83a7c070c94ff78d4df10a7b624f_icgraph.png" border="0" usemap="#tomcrypt__private_8h_a4cef83a7c070c94ff78d4df10a7b624f_icgraph" alt=""/></div>
<!-- MAP 36 -->
</div>

</div>
</div>
<a id="ae647d3ad2082ac1e6fc81e857c5922b4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae647d3ad2082ac1e6fc81e857c5922b4">&#9670;&nbsp;</a></span>ltc_ecc_export_point()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ltc_ecc_export_point </td>
          <td>(</td>
          <td class="paramtype">unsigned char *&#160;</td>
          <td class="paramname"><em>out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned long *&#160;</td>
          <td class="paramname"><em>outlen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned long&#160;</td>
          <td class="paramname"><em>size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>compressed</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ltc__ecc__export__point_8c_source.html#l00014">14</a> of file <a class="el" href="ltc__ecc__export__point_8c_source.html">ltc_ecc_export_point.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;{</div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;   <span class="keywordtype">int</span> err;</div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;   <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> buf[ECC_BUF_SIZE];</div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;   <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> xsize, ysize;</div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;</div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;   <span class="keywordflow">if</span> (size &gt; <span class="keyword">sizeof</span>(buf)) <span class="keywordflow">return</span> <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06caccd878f5599f3036ffe759dbe1a1ac16">CRYPT_BUFFER_OVERFLOW</a>;</div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;   <span class="keywordflow">if</span> ((xsize = <a class="code" href="tomcrypt__private_8h.html#ad301148bb24f43a8c7003a6976dfaa5a">mp_unsigned_bin_size</a>(x)) &gt; size) <span class="keywordflow">return</span> <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06caccd878f5599f3036ffe759dbe1a1ac16">CRYPT_BUFFER_OVERFLOW</a>;</div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;   <span class="keywordflow">if</span> ((ysize = <a class="code" href="tomcrypt__private_8h.html#ad301148bb24f43a8c7003a6976dfaa5a">mp_unsigned_bin_size</a>(y)) &gt; size) <span class="keywordflow">return</span> <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06caccd878f5599f3036ffe759dbe1a1ac16">CRYPT_BUFFER_OVERFLOW</a>;</div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;</div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;   <span class="keywordflow">if</span>(compressed) {</div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;      <span class="keywordflow">if</span> (*outlen &lt; (1 + size)) {</div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;         *outlen = 1 + size;</div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;         <span class="keywordflow">return</span> <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06caccd878f5599f3036ffe759dbe1a1ac16">CRYPT_BUFFER_OVERFLOW</a>;</div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;      }</div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;      <span class="comment">/* store first byte */</span></div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;      out[0] = <a class="code" href="tomcrypt__private_8h.html#a93ed39c257831509afc74f2b6da66ae7">mp_isodd</a>(y) ? 0x03 : 0x02;</div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;      <span class="comment">/* pad and store x */</span></div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;      <a class="code" href="tomcrypt__misc_8h.html#a63b6e188713790263bfd3612fe8b398f">zeromem</a>(buf, <span class="keyword">sizeof</span>(buf));</div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;      <span class="keywordflow">if</span> ((err = <a class="code" href="tomcrypt__private_8h.html#a376a4d31dcfeb65c069db0485b9602f8">mp_to_unsigned_bin</a>(x, buf + (size - xsize))) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>) <span class="keywordflow">return</span> err;</div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;      <a class="code" href="tomcrypt__cfg_8h.html#a7691dd48d60d5fc6daf2fa7ec4c55e12">XMEMCPY</a>(out+1, buf, size);</div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;      <span class="comment">/* adjust outlen */</span></div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;      *outlen = 1 + size;</div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;   }</div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;   <span class="keywordflow">else</span> {</div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;      <span class="keywordflow">if</span> (*outlen &lt; (1 + 2*size)) {</div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;         *outlen = 1 + 2*size;</div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;         <span class="keywordflow">return</span> <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06caccd878f5599f3036ffe759dbe1a1ac16">CRYPT_BUFFER_OVERFLOW</a>;</div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;      }</div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;      <span class="comment">/* store byte 0x04 */</span></div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;      out[0] = 0x04;</div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;      <span class="comment">/* pad and store x */</span></div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;      <a class="code" href="tomcrypt__misc_8h.html#a63b6e188713790263bfd3612fe8b398f">zeromem</a>(buf, <span class="keyword">sizeof</span>(buf));</div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;      <span class="keywordflow">if</span> ((err = <a class="code" href="tomcrypt__private_8h.html#a376a4d31dcfeb65c069db0485b9602f8">mp_to_unsigned_bin</a>(x, buf + (size - xsize))) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>) <span class="keywordflow">return</span> err;</div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;      <a class="code" href="tomcrypt__cfg_8h.html#a7691dd48d60d5fc6daf2fa7ec4c55e12">XMEMCPY</a>(out+1, buf, size);</div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;      <span class="comment">/* pad and store y */</span></div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;      <a class="code" href="tomcrypt__misc_8h.html#a63b6e188713790263bfd3612fe8b398f">zeromem</a>(buf, <span class="keyword">sizeof</span>(buf));</div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;      <span class="keywordflow">if</span> ((err = <a class="code" href="tomcrypt__private_8h.html#a376a4d31dcfeb65c069db0485b9602f8">mp_to_unsigned_bin</a>(y, buf + (size - ysize))) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>) <span class="keywordflow">return</span> err;</div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;      <a class="code" href="tomcrypt__cfg_8h.html#a7691dd48d60d5fc6daf2fa7ec4c55e12">XMEMCPY</a>(out+1+size, buf, size);</div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;      <span class="comment">/* adjust outlen */</span></div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;      *outlen = 1 + 2*size;</div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;   }</div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>;</div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;}</div><div class="ttc" id="tomcrypt_8h_html_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334"><div class="ttname"><a href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a></div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt_8h_source.html#l00042">tomcrypt.h:42</a></div></div>
<div class="ttc" id="tomcrypt__misc_8h_html_a63b6e188713790263bfd3612fe8b398f"><div class="ttname"><a href="tomcrypt__misc_8h.html#a63b6e188713790263bfd3612fe8b398f">zeromem</a></div><div class="ttdeci">void zeromem(volatile void *out, size_t outlen)</div><div class="ttdoc">Zero a block of memory.</div><div class="ttdef"><b>Definition:</b> <a href="zeromem_8c_source.html#l00021">zeromem.c:21</a></div></div>
<div class="ttc" id="tomcrypt__private_8h_html_a376a4d31dcfeb65c069db0485b9602f8"><div class="ttname"><a href="tomcrypt__private_8h.html#a376a4d31dcfeb65c069db0485b9602f8">mp_to_unsigned_bin</a></div><div class="ttdeci">#define mp_to_unsigned_bin(a, b)</div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt__private_8h_source.html#l00153">tomcrypt_private.h:153</a></div></div>
<div class="ttc" id="tomcrypt__private_8h_html_ad301148bb24f43a8c7003a6976dfaa5a"><div class="ttname"><a href="tomcrypt__private_8h.html#ad301148bb24f43a8c7003a6976dfaa5a">mp_unsigned_bin_size</a></div><div class="ttdeci">#define mp_unsigned_bin_size(a)</div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt__private_8h_source.html#l00152">tomcrypt_private.h:152</a></div></div>
<div class="ttc" id="tomcrypt__cfg_8h_html_a7691dd48d60d5fc6daf2fa7ec4c55e12"><div class="ttname"><a href="tomcrypt__cfg_8h.html#a7691dd48d60d5fc6daf2fa7ec4c55e12">XMEMCPY</a></div><div class="ttdeci">void * XMEMCPY(void *dest, const void *src, size_t n)</div></div>
<div class="ttc" id="tomcrypt_8h_html_adc29c2ff13d900c2f185ee95427fb06caccd878f5599f3036ffe759dbe1a1ac16"><div class="ttname"><a href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06caccd878f5599f3036ffe759dbe1a1ac16">CRYPT_BUFFER_OVERFLOW</a></div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt_8h_source.html#l00050">tomcrypt.h:50</a></div></div>
<div class="ttc" id="tomcrypt__private_8h_html_a93ed39c257831509afc74f2b6da66ae7"><div class="ttname"><a href="tomcrypt__private_8h.html#a93ed39c257831509afc74f2b6da66ae7">mp_isodd</a></div><div class="ttdeci">#define mp_isodd(a)</div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt__private_8h_source.html#l00186">tomcrypt_private.h:186</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="tomcrypt_8h_source.html#l00050">CRYPT_BUFFER_OVERFLOW</a>, <a class="el" href="tomcrypt_8h_source.html#l00042">CRYPT_OK</a>, <a class="el" href="tomcrypt__private_8h_source.html#l00186">mp_isodd</a>, <a class="el" href="tomcrypt__private_8h_source.html#l00153">mp_to_unsigned_bin</a>, <a class="el" href="tomcrypt__private_8h_source.html#l00152">mp_unsigned_bin_size</a>, <a class="el" href="tomcrypt__cfg_8h.html#a7691dd48d60d5fc6daf2fa7ec4c55e12">XMEMCPY()</a>, and <a class="el" href="zeromem_8c_source.html#l00021">zeromem()</a>.</p>

<p class="reference">Referenced by <a class="el" href="ecc__export__openssl_8c_source.html#l00023">ecc_export_openssl()</a>, and <a class="el" href="ecc__get__key_8c_source.html#l00022">ecc_get_key()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="tomcrypt__private_8h_ae647d3ad2082ac1e6fc81e857c5922b4_cgraph.png" border="0" usemap="#tomcrypt__private_8h_ae647d3ad2082ac1e6fc81e857c5922b4_cgraph" alt=""/></div>
<!-- MAP 37 -->
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="tomcrypt__private_8h_ae647d3ad2082ac1e6fc81e857c5922b4_icgraph.png" border="0" usemap="#tomcrypt__private_8h_ae647d3ad2082ac1e6fc81e857c5922b4_icgraph" alt=""/></div>
<!-- MAP 38 -->
</div>

</div>
</div>
<a id="aa63889eb69cecc42e44b7dfa9ad9d473"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa63889eb69cecc42e44b7dfa9ad9d473">&#9670;&nbsp;</a></span>ltc_ecc_import_point()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ltc_ecc_import_point </td>
          <td>(</td>
          <td class="paramtype">const unsigned char *&#160;</td>
          <td class="paramname"><em>in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned long&#160;</td>
          <td class="paramname"><em>inlen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>prime</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>b</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>y</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ltc__ecc__import__point_8c_source.html#l00014">14</a> of file <a class="el" href="ltc__ecc__import__point_8c_source.html">ltc_ecc_import_point.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;{</div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;   <span class="keywordtype">int</span> err;</div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;   <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> size;</div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;   <span class="keywordtype">void</span> *<a class="code" href="tiger_8c.html#a65f7891fccbfcf7d08964555630773b3">t1</a>, *<a class="code" href="tiger_8c.html#aa4652e2d6053d420dcbea07a113db5fe">t2</a>;</div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;</div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;   <span class="comment">/* init key + temporary numbers */</span></div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="tomcrypt__private_8h.html#adb6322247b1a4f0347219acab3120bd3">mp_init_multi</a>(&amp;<a class="code" href="tiger_8c.html#a65f7891fccbfcf7d08964555630773b3">t1</a>, &amp;<a class="code" href="tiger_8c.html#aa4652e2d6053d420dcbea07a113db5fe">t2</a>, NULL) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>) {</div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06ca0ce0d27adc7ea10b74b7ea904b8bfa82">CRYPT_MEM</a>;</div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;   }</div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;</div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;   size = <a class="code" href="tomcrypt__private_8h.html#ad301148bb24f43a8c7003a6976dfaa5a">mp_unsigned_bin_size</a>(prime);</div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;</div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;   <span class="keywordflow">if</span> (in[0] == 0x04 &amp;&amp; (inlen&amp;1) &amp;&amp; ((inlen-1)&gt;&gt;1) == size) {</div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;      <span class="comment">/* read uncompressed point */</span></div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;      <span class="comment">/* load x */</span></div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;      <span class="keywordflow">if</span> ((err = <a class="code" href="tomcrypt__private_8h.html#a9e20e2044bb5a279e27512d1e1b65754">mp_read_unsigned_bin</a>(x, (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *)in+1, size)) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>)      { <span class="keywordflow">goto</span> cleanup; }</div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;      <span class="comment">/* load y */</span></div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;      <span class="keywordflow">if</span> ((err = <a class="code" href="tomcrypt__private_8h.html#a9e20e2044bb5a279e27512d1e1b65754">mp_read_unsigned_bin</a>(y, (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *)in+1+size, size)) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>) { <span class="keywordflow">goto</span> cleanup; }</div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;   }</div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;   <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((in[0] == 0x02 || in[0] == 0x03) &amp;&amp; (inlen-1) == size &amp;&amp; <a class="code" href="tomcrypt__math_8h.html#a3d38c44518c63b7a8abd0938f3d41c65">ltc_mp</a>.<a class="code" href="structltc__math__descriptor.html#ae588937a77f227870ff809f5f8f0deb8">sqrtmod_prime</a> != NULL) {</div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;      <span class="comment">/* read compressed point - BEWARE: requires sqrtmod_prime */</span></div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;      <span class="comment">/* load x */</span></div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;      <span class="keywordflow">if</span> ((err = <a class="code" href="tomcrypt__private_8h.html#a9e20e2044bb5a279e27512d1e1b65754">mp_read_unsigned_bin</a>(x, (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *)in+1, size)) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>)      { <span class="keywordflow">goto</span> cleanup; }</div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;      <span class="comment">/* compute x^3 */</span></div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;      <span class="keywordflow">if</span> ((err = <a class="code" href="tomcrypt__private_8h.html#aea81d79b5462e99068908d80edb8bd1a">mp_sqr</a>(x, <a class="code" href="tiger_8c.html#a65f7891fccbfcf7d08964555630773b3">t1</a>)) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>)                                             { <span class="keywordflow">goto</span> cleanup; }</div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;      <span class="keywordflow">if</span> ((err = <a class="code" href="tomcrypt__private_8h.html#a0c32b20b84951870c7b09f5b6f2679c9">mp_mulmod</a>(<a class="code" href="tiger_8c.html#a65f7891fccbfcf7d08964555630773b3">t1</a>, x, prime, <a class="code" href="tiger_8c.html#a65f7891fccbfcf7d08964555630773b3">t1</a>)) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>)                               { <span class="keywordflow">goto</span> cleanup; }</div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;      <span class="comment">/* compute x^3 + a*x */</span></div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;      <span class="keywordflow">if</span> ((err = <a class="code" href="tomcrypt__private_8h.html#a0c32b20b84951870c7b09f5b6f2679c9">mp_mulmod</a>(a, x, prime, <a class="code" href="tiger_8c.html#aa4652e2d6053d420dcbea07a113db5fe">t2</a>)) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>)                                { <span class="keywordflow">goto</span> cleanup; }</div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;      <span class="keywordflow">if</span> ((err = <a class="code" href="tomcrypt__private_8h.html#a175d04f8aeaa1c3895fe14de6cc0d2db">mp_add</a>(<a class="code" href="tiger_8c.html#a65f7891fccbfcf7d08964555630773b3">t1</a>, <a class="code" href="tiger_8c.html#aa4652e2d6053d420dcbea07a113db5fe">t2</a>, <a class="code" href="tiger_8c.html#a65f7891fccbfcf7d08964555630773b3">t1</a>)) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>)                                        { <span class="keywordflow">goto</span> cleanup; }</div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;      <span class="comment">/* compute x^3 + a*x + b */</span></div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;      <span class="keywordflow">if</span> ((err = <a class="code" href="tomcrypt__private_8h.html#a175d04f8aeaa1c3895fe14de6cc0d2db">mp_add</a>(<a class="code" href="tiger_8c.html#a65f7891fccbfcf7d08964555630773b3">t1</a>, b, <a class="code" href="tiger_8c.html#a65f7891fccbfcf7d08964555630773b3">t1</a>)) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>)                                         { <span class="keywordflow">goto</span> cleanup; }</div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;      <span class="comment">/* compute sqrt(x^3 + a*x + b) */</span></div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;      <span class="keywordflow">if</span> ((err = <a class="code" href="tomcrypt__private_8h.html#af1a090c9979e328596fa37512f519a09">mp_sqrtmod_prime</a>(<a class="code" href="tiger_8c.html#a65f7891fccbfcf7d08964555630773b3">t1</a>, prime, <a class="code" href="tiger_8c.html#aa4652e2d6053d420dcbea07a113db5fe">t2</a>)) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>)                           { <span class="keywordflow">goto</span> cleanup; }</div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;      <span class="comment">/* adjust y */</span></div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;      <span class="keywordflow">if</span> ((<a class="code" href="tomcrypt__private_8h.html#a93ed39c257831509afc74f2b6da66ae7">mp_isodd</a>(<a class="code" href="tiger_8c.html#aa4652e2d6053d420dcbea07a113db5fe">t2</a>) &amp;&amp; in[0] == 0x03) || (!<a class="code" href="tomcrypt__private_8h.html#a93ed39c257831509afc74f2b6da66ae7">mp_isodd</a>(<a class="code" href="tiger_8c.html#aa4652e2d6053d420dcbea07a113db5fe">t2</a>) &amp;&amp; in[0] == 0x02)) {</div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;         <span class="keywordflow">if</span> ((err = <a class="code" href="tomcrypt__private_8h.html#ac7deed6f00e289706070b16f98c430fe">mp_mod</a>(<a class="code" href="tiger_8c.html#aa4652e2d6053d420dcbea07a113db5fe">t2</a>, prime, y)) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>)                                   { <span class="keywordflow">goto</span> cleanup; }</div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;      }</div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;      <span class="keywordflow">else</span> {</div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;         <span class="keywordflow">if</span> ((err = <a class="code" href="tomcrypt__private_8h.html#a15e2f6c11b3fcebe885ecc14d759ac01">mp_submod</a>(prime, <a class="code" href="tiger_8c.html#aa4652e2d6053d420dcbea07a113db5fe">t2</a>, prime, y)) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>)                         { <span class="keywordflow">goto</span> cleanup; }</div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;      }</div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;   }</div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;   <span class="keywordflow">else</span> {</div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;      err = <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06ca980088f10ffe9009aec286038a9e79da">CRYPT_INVALID_PACKET</a>;</div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;      <span class="keywordflow">goto</span> cleanup;</div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;   }</div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;</div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;   err = <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>;</div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;cleanup:</div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;   <a class="code" href="tomcrypt__private_8h.html#aad5c8a3112b3e4613f9efc86692c43cb">mp_clear_multi</a>(<a class="code" href="tiger_8c.html#a65f7891fccbfcf7d08964555630773b3">t1</a>, <a class="code" href="tiger_8c.html#aa4652e2d6053d420dcbea07a113db5fe">t2</a>, NULL);</div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;   <span class="keywordflow">return</span> err;</div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;}</div><div class="ttc" id="tomcrypt_8h_html_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334"><div class="ttname"><a href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a></div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt_8h_source.html#l00042">tomcrypt.h:42</a></div></div>
<div class="ttc" id="tomcrypt__math_8h_html_a3d38c44518c63b7a8abd0938f3d41c65"><div class="ttname"><a href="tomcrypt__math_8h.html#a3d38c44518c63b7a8abd0938f3d41c65">ltc_mp</a></div><div class="ttdeci">ltc_math_descriptor ltc_mp</div><div class="ttdef"><b>Definition:</b> <a href="crypt__ltc__mp__descriptor_8c_source.html#l00012">crypt_ltc_mp_descriptor.c:12</a></div></div>
<div class="ttc" id="tomcrypt__private_8h_html_af1a090c9979e328596fa37512f519a09"><div class="ttname"><a href="tomcrypt__private_8h.html#af1a090c9979e328596fa37512f519a09">mp_sqrtmod_prime</a></div><div class="ttdeci">#define mp_sqrtmod_prime(a, b, c)</div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt__private_8h_source.html#l00163">tomcrypt_private.h:163</a></div></div>
<div class="ttc" id="tomcrypt_8h_html_adc29c2ff13d900c2f185ee95427fb06ca980088f10ffe9009aec286038a9e79da"><div class="ttname"><a href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06ca980088f10ffe9009aec286038a9e79da">CRYPT_INVALID_PACKET</a></div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt_8h_source.html#l00051">tomcrypt.h:51</a></div></div>
<div class="ttc" id="tiger_8c_html_aa4652e2d6053d420dcbea07a113db5fe"><div class="ttname"><a href="tiger_8c.html#aa4652e2d6053d420dcbea07a113db5fe">t2</a></div><div class="ttdeci">#define t2</div><div class="ttdef"><b>Definition:</b> <a href="tiger_8c_source.html#l00038">tiger.c:38</a></div></div>
<div class="ttc" id="tomcrypt_8h_html_adc29c2ff13d900c2f185ee95427fb06ca0ce0d27adc7ea10b74b7ea904b8bfa82"><div class="ttname"><a href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06ca0ce0d27adc7ea10b74b7ea904b8bfa82">CRYPT_MEM</a></div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt_8h_source.html#l00060">tomcrypt.h:60</a></div></div>
<div class="ttc" id="tomcrypt__private_8h_html_a0c32b20b84951870c7b09f5b6f2679c9"><div class="ttname"><a href="tomcrypt__private_8h.html#a0c32b20b84951870c7b09f5b6f2679c9">mp_mulmod</a></div><div class="ttdeci">#define mp_mulmod(a, b, c, d)</div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt__private_8h_source.html#l00173">tomcrypt_private.h:173</a></div></div>
<div class="ttc" id="tomcrypt__private_8h_html_aea81d79b5462e99068908d80edb8bd1a"><div class="ttname"><a href="tomcrypt__private_8h.html#aea81d79b5462e99068908d80edb8bd1a">mp_sqr</a></div><div class="ttdeci">#define mp_sqr(a, b)</div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt__private_8h_source.html#l00162">tomcrypt_private.h:162</a></div></div>
<div class="ttc" id="tiger_8c_html_a65f7891fccbfcf7d08964555630773b3"><div class="ttname"><a href="tiger_8c.html#a65f7891fccbfcf7d08964555630773b3">t1</a></div><div class="ttdeci">#define t1</div><div class="ttdef"><b>Definition:</b> <a href="tiger_8c_source.html#l00037">tiger.c:37</a></div></div>
<div class="ttc" id="tomcrypt__private_8h_html_a15e2f6c11b3fcebe885ecc14d759ac01"><div class="ttname"><a href="tomcrypt__private_8h.html#a15e2f6c11b3fcebe885ecc14d759ac01">mp_submod</a></div><div class="ttdeci">#define mp_submod(a, b, c, d)</div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt__private_8h_source.html#l00172">tomcrypt_private.h:172</a></div></div>
<div class="ttc" id="tomcrypt__private_8h_html_ac7deed6f00e289706070b16f98c430fe"><div class="ttname"><a href="tomcrypt__private_8h.html#ac7deed6f00e289706070b16f98c430fe">mp_mod</a></div><div class="ttdeci">#define mp_mod(a, b, c)</div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt__private_8h_source.html#l00166">tomcrypt_private.h:166</a></div></div>
<div class="ttc" id="tomcrypt__private_8h_html_aad5c8a3112b3e4613f9efc86692c43cb"><div class="ttname"><a href="tomcrypt__private_8h.html#aad5c8a3112b3e4613f9efc86692c43cb">mp_clear_multi</a></div><div class="ttdeci">#define mp_clear_multi</div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt__private_8h_source.html#l00132">tomcrypt_private.h:132</a></div></div>
<div class="ttc" id="tomcrypt__private_8h_html_adb6322247b1a4f0347219acab3120bd3"><div class="ttname"><a href="tomcrypt__private_8h.html#adb6322247b1a4f0347219acab3120bd3">mp_init_multi</a></div><div class="ttdeci">#define mp_init_multi</div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt__private_8h_source.html#l00130">tomcrypt_private.h:130</a></div></div>
<div class="ttc" id="tomcrypt__private_8h_html_a9e20e2044bb5a279e27512d1e1b65754"><div class="ttname"><a href="tomcrypt__private_8h.html#a9e20e2044bb5a279e27512d1e1b65754">mp_read_unsigned_bin</a></div><div class="ttdeci">#define mp_read_unsigned_bin(a, b, c)</div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt__private_8h_source.html#l00154">tomcrypt_private.h:154</a></div></div>
<div class="ttc" id="tomcrypt__private_8h_html_ad301148bb24f43a8c7003a6976dfaa5a"><div class="ttname"><a href="tomcrypt__private_8h.html#ad301148bb24f43a8c7003a6976dfaa5a">mp_unsigned_bin_size</a></div><div class="ttdeci">#define mp_unsigned_bin_size(a)</div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt__private_8h_source.html#l00152">tomcrypt_private.h:152</a></div></div>
<div class="ttc" id="tomcrypt__private_8h_html_a175d04f8aeaa1c3895fe14de6cc0d2db"><div class="ttname"><a href="tomcrypt__private_8h.html#a175d04f8aeaa1c3895fe14de6cc0d2db">mp_add</a></div><div class="ttdeci">#define mp_add(a, b, c)</div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt__private_8h_source.html#l00156">tomcrypt_private.h:156</a></div></div>
<div class="ttc" id="structltc__math__descriptor_html_ae588937a77f227870ff809f5f8f0deb8"><div class="ttname"><a href="structltc__math__descriptor.html#ae588937a77f227870ff809f5f8f0deb8">ltc_math_descriptor::sqrtmod_prime</a></div><div class="ttdeci">int(* sqrtmod_prime)(void *a, void *b, void *c)</div><div class="ttdoc">Square root (mod prime)</div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt__math_8h_source.html#l00255">tomcrypt_math.h:255</a></div></div>
<div class="ttc" id="tomcrypt__private_8h_html_a93ed39c257831509afc74f2b6da66ae7"><div class="ttname"><a href="tomcrypt__private_8h.html#a93ed39c257831509afc74f2b6da66ae7">mp_isodd</a></div><div class="ttdeci">#define mp_isodd(a)</div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt__private_8h_source.html#l00186">tomcrypt_private.h:186</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="tomcrypt_8h_source.html#l00051">CRYPT_INVALID_PACKET</a>, <a class="el" href="tomcrypt_8h_source.html#l00060">CRYPT_MEM</a>, <a class="el" href="tomcrypt_8h_source.html#l00042">CRYPT_OK</a>, <a class="el" href="crypt__ltc__mp__descriptor_8c_source.html#l00012">ltc_mp</a>, <a class="el" href="tomcrypt__private_8h_source.html#l00156">mp_add</a>, <a class="el" href="tomcrypt__private_8h_source.html#l00132">mp_clear_multi</a>, <a class="el" href="tomcrypt__private_8h_source.html#l00130">mp_init_multi</a>, <a class="el" href="tomcrypt__private_8h_source.html#l00186">mp_isodd</a>, <a class="el" href="tomcrypt__private_8h_source.html#l00166">mp_mod</a>, <a class="el" href="tomcrypt__private_8h_source.html#l00173">mp_mulmod</a>, <a class="el" href="tomcrypt__private_8h_source.html#l00154">mp_read_unsigned_bin</a>, <a class="el" href="tomcrypt__private_8h_source.html#l00162">mp_sqr</a>, <a class="el" href="tomcrypt__private_8h_source.html#l00163">mp_sqrtmod_prime</a>, <a class="el" href="tomcrypt__private_8h_source.html#l00172">mp_submod</a>, <a class="el" href="tomcrypt__private_8h_source.html#l00152">mp_unsigned_bin_size</a>, <a class="el" href="tomcrypt__math_8h_source.html#l00255">ltc_math_descriptor::sqrtmod_prime</a>, <a class="el" href="tiger_8c_source.html#l00037">t1</a>, and <a class="el" href="tiger_8c_source.html#l00038">t2</a>.</p>

<p class="reference">Referenced by <a class="el" href="ecc__import__openssl_8c_source.html#l00048">_ecc_import_private_with_curve()</a>, <a class="el" href="ecc__import__x509_8c_source.html#l00039">_ecc_import_x509_with_curve()</a>, <a class="el" href="ecc__import__pkcs8_8c_source.html#l00046">ecc_import_pkcs8()</a>, and <a class="el" href="ecc__set__key_8c_source.html#l00014">ecc_set_key()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="tomcrypt__private_8h_aa63889eb69cecc42e44b7dfa9ad9d473_icgraph.png" border="0" usemap="#tomcrypt__private_8h_aa63889eb69cecc42e44b7dfa9ad9d473_icgraph" alt=""/></div>
<!-- MAP 39 -->
</div>

</div>
</div>
<a id="affd37f56571ffc28d2c2687a76014b11"></a>
<h2 class="memtitle"><span class="permalink"><a href="#affd37f56571ffc28d2c2687a76014b11">&#9670;&nbsp;</a></span>ltc_ecc_is_point()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ltc_ecc_is_point </td>
          <td>(</td>
          <td class="paramtype">const ltc_ecc_dp *&#160;</td>
          <td class="paramname"><em>dp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>y</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns whether [x,y] is a point on curve defined by dp. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">dp</td><td>curve parameters </td></tr>
    <tr><td class="paramname">x</td><td>x point coordinate </td></tr>
    <tr><td class="paramname">y</td><td>y point coordinate </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>CRYPT_OK if valid </dd></dl>

<p class="definition">Definition at line <a class="el" href="ltc__ecc__is__point_8c_source.html#l00021">21</a> of file <a class="el" href="ltc__ecc__is__point_8c_source.html">ltc_ecc_is_point.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;{</div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;  <span class="keywordtype">void</span> *prime, *a, *b, *<a class="code" href="tiger_8c.html#a65f7891fccbfcf7d08964555630773b3">t1</a>, *<a class="code" href="tiger_8c.html#aa4652e2d6053d420dcbea07a113db5fe">t2</a>;</div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;  <span class="keywordtype">int</span> err;</div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;</div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;  prime = dp-&gt;prime;</div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;  b     = dp-&gt;B;</div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;  a     = dp-&gt;A;</div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;</div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;  <span class="keywordflow">if</span> ((err = <a class="code" href="tomcrypt__private_8h.html#adb6322247b1a4f0347219acab3120bd3">mp_init_multi</a>(&amp;<a class="code" href="tiger_8c.html#a65f7891fccbfcf7d08964555630773b3">t1</a>, &amp;<a class="code" href="tiger_8c.html#aa4652e2d6053d420dcbea07a113db5fe">t2</a>, NULL)) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>)  <span class="keywordflow">return</span> err;</div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;</div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;  <span class="comment">/* compute y^2 */</span></div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;  <span class="keywordflow">if</span> ((err = <a class="code" href="tomcrypt__private_8h.html#aea81d79b5462e99068908d80edb8bd1a">mp_sqr</a>(y, <a class="code" href="tiger_8c.html#a65f7891fccbfcf7d08964555630773b3">t1</a>)) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>)                  <span class="keywordflow">goto</span> cleanup;</div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;</div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;  <span class="comment">/* compute x^3 */</span></div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;  <span class="keywordflow">if</span> ((err = <a class="code" href="tomcrypt__private_8h.html#aea81d79b5462e99068908d80edb8bd1a">mp_sqr</a>(x, <a class="code" href="tiger_8c.html#aa4652e2d6053d420dcbea07a113db5fe">t2</a>)) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>)                  <span class="keywordflow">goto</span> cleanup;</div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;  <span class="keywordflow">if</span> ((err = <a class="code" href="tomcrypt__private_8h.html#ac7deed6f00e289706070b16f98c430fe">mp_mod</a>(<a class="code" href="tiger_8c.html#aa4652e2d6053d420dcbea07a113db5fe">t2</a>, prime, <a class="code" href="tiger_8c.html#aa4652e2d6053d420dcbea07a113db5fe">t2</a>)) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>)          <span class="keywordflow">goto</span> cleanup;</div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;  <span class="keywordflow">if</span> ((err = <a class="code" href="tomcrypt__private_8h.html#a7606d2423856b32b09245a2fa1ef34ee">mp_mul</a>(x, <a class="code" href="tiger_8c.html#aa4652e2d6053d420dcbea07a113db5fe">t2</a>, <a class="code" href="tiger_8c.html#aa4652e2d6053d420dcbea07a113db5fe">t2</a>)) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>)              <span class="keywordflow">goto</span> cleanup;</div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;</div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;  <span class="comment">/* compute y^2 - x^3 */</span></div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;  <span class="keywordflow">if</span> ((err = <a class="code" href="tomcrypt__private_8h.html#ab8d0882c3b58263b638b41fbf110fde8">mp_sub</a>(<a class="code" href="tiger_8c.html#a65f7891fccbfcf7d08964555630773b3">t1</a>, <a class="code" href="tiger_8c.html#aa4652e2d6053d420dcbea07a113db5fe">t2</a>, <a class="code" href="tiger_8c.html#a65f7891fccbfcf7d08964555630773b3">t1</a>)) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>)             <span class="keywordflow">goto</span> cleanup;</div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;</div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;  <span class="comment">/* compute y^2 - x^3 - a*x */</span></div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;  <span class="keywordflow">if</span> ((err = <a class="code" href="tomcrypt__private_8h.html#a15e2f6c11b3fcebe885ecc14d759ac01">mp_submod</a>(prime, a, prime, <a class="code" href="tiger_8c.html#aa4652e2d6053d420dcbea07a113db5fe">t2</a>)) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>) <span class="keywordflow">goto</span> cleanup;</div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;  <span class="keywordflow">if</span> ((err = <a class="code" href="tomcrypt__private_8h.html#a0c32b20b84951870c7b09f5b6f2679c9">mp_mulmod</a>(<a class="code" href="tiger_8c.html#aa4652e2d6053d420dcbea07a113db5fe">t2</a>, x, prime, <a class="code" href="tiger_8c.html#aa4652e2d6053d420dcbea07a113db5fe">t2</a>)) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>)    <span class="keywordflow">goto</span> cleanup;</div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;  <span class="keywordflow">if</span> ((err = <a class="code" href="tomcrypt__private_8h.html#a3cc86fdd66c67023afe490b3534d459b">mp_addmod</a>(<a class="code" href="tiger_8c.html#a65f7891fccbfcf7d08964555630773b3">t1</a>, <a class="code" href="tiger_8c.html#aa4652e2d6053d420dcbea07a113db5fe">t2</a>, prime, <a class="code" href="tiger_8c.html#a65f7891fccbfcf7d08964555630773b3">t1</a>)) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>)   <span class="keywordflow">goto</span> cleanup;</div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;</div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;  <span class="comment">/* adjust range (0, prime) */</span></div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;  <span class="keywordflow">while</span> (<a class="code" href="tomcrypt__private_8h.html#a6ce44f2e6f872565a468b67d9a93dc28">mp_cmp_d</a>(<a class="code" href="tiger_8c.html#a65f7891fccbfcf7d08964555630773b3">t1</a>, 0) == <a class="code" href="tomcrypt__math_8h.html#a42d0c7d4c09793df79660774d3436db2">LTC_MP_LT</a>) {</div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;     <span class="keywordflow">if</span> ((err = <a class="code" href="tomcrypt__private_8h.html#a175d04f8aeaa1c3895fe14de6cc0d2db">mp_add</a>(<a class="code" href="tiger_8c.html#a65f7891fccbfcf7d08964555630773b3">t1</a>, prime, <a class="code" href="tiger_8c.html#a65f7891fccbfcf7d08964555630773b3">t1</a>)) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>)       <span class="keywordflow">goto</span> cleanup;</div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;  }</div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;  <span class="keywordflow">while</span> (<a class="code" href="tomcrypt__private_8h.html#a62ea02fbe7dd2d456e49520264d775ee">mp_cmp</a>(<a class="code" href="tiger_8c.html#a65f7891fccbfcf7d08964555630773b3">t1</a>, prime) != <a class="code" href="tomcrypt__math_8h.html#a42d0c7d4c09793df79660774d3436db2">LTC_MP_LT</a>) {</div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;     <span class="keywordflow">if</span> ((err = <a class="code" href="tomcrypt__private_8h.html#ab8d0882c3b58263b638b41fbf110fde8">mp_sub</a>(<a class="code" href="tiger_8c.html#a65f7891fccbfcf7d08964555630773b3">t1</a>, prime, <a class="code" href="tiger_8c.html#a65f7891fccbfcf7d08964555630773b3">t1</a>)) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>)       <span class="keywordflow">goto</span> cleanup;</div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;  }</div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;</div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;  <span class="comment">/* compare to b */</span></div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="tomcrypt__private_8h.html#a62ea02fbe7dd2d456e49520264d775ee">mp_cmp</a>(<a class="code" href="tiger_8c.html#a65f7891fccbfcf7d08964555630773b3">t1</a>, b) != <a class="code" href="tomcrypt__math_8h.html#a035a31bde4f31419eb259e36e5776607">LTC_MP_EQ</a>) {</div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;     err = <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06ca980088f10ffe9009aec286038a9e79da">CRYPT_INVALID_PACKET</a>;</div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;  } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;     err = <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>;</div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;  }</div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;</div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;cleanup:</div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;  <a class="code" href="tomcrypt__private_8h.html#aad5c8a3112b3e4613f9efc86692c43cb">mp_clear_multi</a>(<a class="code" href="tiger_8c.html#a65f7891fccbfcf7d08964555630773b3">t1</a>, <a class="code" href="tiger_8c.html#aa4652e2d6053d420dcbea07a113db5fe">t2</a>, NULL);</div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;  <span class="keywordflow">return</span> err;</div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;}</div><div class="ttc" id="tomcrypt_8h_html_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334"><div class="ttname"><a href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a></div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt_8h_source.html#l00042">tomcrypt.h:42</a></div></div>
<div class="ttc" id="tomcrypt__math_8h_html_a42d0c7d4c09793df79660774d3436db2"><div class="ttname"><a href="tomcrypt__math_8h.html#a42d0c7d4c09793df79660774d3436db2">LTC_MP_LT</a></div><div class="ttdeci">#define LTC_MP_LT</div><div class="ttdoc">math functions</div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt__math_8h_source.html#l00012">tomcrypt_math.h:12</a></div></div>
<div class="ttc" id="tomcrypt_8h_html_adc29c2ff13d900c2f185ee95427fb06ca980088f10ffe9009aec286038a9e79da"><div class="ttname"><a href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06ca980088f10ffe9009aec286038a9e79da">CRYPT_INVALID_PACKET</a></div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt_8h_source.html#l00051">tomcrypt.h:51</a></div></div>
<div class="ttc" id="tiger_8c_html_aa4652e2d6053d420dcbea07a113db5fe"><div class="ttname"><a href="tiger_8c.html#aa4652e2d6053d420dcbea07a113db5fe">t2</a></div><div class="ttdeci">#define t2</div><div class="ttdef"><b>Definition:</b> <a href="tiger_8c_source.html#l00038">tiger.c:38</a></div></div>
<div class="ttc" id="tomcrypt__private_8h_html_a0c32b20b84951870c7b09f5b6f2679c9"><div class="ttname"><a href="tomcrypt__private_8h.html#a0c32b20b84951870c7b09f5b6f2679c9">mp_mulmod</a></div><div class="ttdeci">#define mp_mulmod(a, b, c, d)</div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt__private_8h_source.html#l00173">tomcrypt_private.h:173</a></div></div>
<div class="ttc" id="tomcrypt__private_8h_html_aea81d79b5462e99068908d80edb8bd1a"><div class="ttname"><a href="tomcrypt__private_8h.html#aea81d79b5462e99068908d80edb8bd1a">mp_sqr</a></div><div class="ttdeci">#define mp_sqr(a, b)</div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt__private_8h_source.html#l00162">tomcrypt_private.h:162</a></div></div>
<div class="ttc" id="tiger_8c_html_a65f7891fccbfcf7d08964555630773b3"><div class="ttname"><a href="tiger_8c.html#a65f7891fccbfcf7d08964555630773b3">t1</a></div><div class="ttdeci">#define t1</div><div class="ttdef"><b>Definition:</b> <a href="tiger_8c_source.html#l00037">tiger.c:37</a></div></div>
<div class="ttc" id="tomcrypt__private_8h_html_a15e2f6c11b3fcebe885ecc14d759ac01"><div class="ttname"><a href="tomcrypt__private_8h.html#a15e2f6c11b3fcebe885ecc14d759ac01">mp_submod</a></div><div class="ttdeci">#define mp_submod(a, b, c, d)</div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt__private_8h_source.html#l00172">tomcrypt_private.h:172</a></div></div>
<div class="ttc" id="tomcrypt__private_8h_html_ac7deed6f00e289706070b16f98c430fe"><div class="ttname"><a href="tomcrypt__private_8h.html#ac7deed6f00e289706070b16f98c430fe">mp_mod</a></div><div class="ttdeci">#define mp_mod(a, b, c)</div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt__private_8h_source.html#l00166">tomcrypt_private.h:166</a></div></div>
<div class="ttc" id="tomcrypt__private_8h_html_aad5c8a3112b3e4613f9efc86692c43cb"><div class="ttname"><a href="tomcrypt__private_8h.html#aad5c8a3112b3e4613f9efc86692c43cb">mp_clear_multi</a></div><div class="ttdeci">#define mp_clear_multi</div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt__private_8h_source.html#l00132">tomcrypt_private.h:132</a></div></div>
<div class="ttc" id="tomcrypt__private_8h_html_a62ea02fbe7dd2d456e49520264d775ee"><div class="ttname"><a href="tomcrypt__private_8h.html#a62ea02fbe7dd2d456e49520264d775ee">mp_cmp</a></div><div class="ttdeci">#define mp_cmp(a, b)</div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt__private_8h_source.html#l00144">tomcrypt_private.h:144</a></div></div>
<div class="ttc" id="tomcrypt__math_8h_html_a035a31bde4f31419eb259e36e5776607"><div class="ttname"><a href="tomcrypt__math_8h.html#a035a31bde4f31419eb259e36e5776607">LTC_MP_EQ</a></div><div class="ttdeci">#define LTC_MP_EQ</div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt__math_8h_source.html#l00013">tomcrypt_math.h:13</a></div></div>
<div class="ttc" id="tomcrypt__private_8h_html_a3cc86fdd66c67023afe490b3534d459b"><div class="ttname"><a href="tomcrypt__private_8h.html#a3cc86fdd66c67023afe490b3534d459b">mp_addmod</a></div><div class="ttdeci">#define mp_addmod(a, b, c, d)</div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt__private_8h_source.html#l00171">tomcrypt_private.h:171</a></div></div>
<div class="ttc" id="tomcrypt__private_8h_html_adb6322247b1a4f0347219acab3120bd3"><div class="ttname"><a href="tomcrypt__private_8h.html#adb6322247b1a4f0347219acab3120bd3">mp_init_multi</a></div><div class="ttdeci">#define mp_init_multi</div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt__private_8h_source.html#l00130">tomcrypt_private.h:130</a></div></div>
<div class="ttc" id="tomcrypt__private_8h_html_ab8d0882c3b58263b638b41fbf110fde8"><div class="ttname"><a href="tomcrypt__private_8h.html#ab8d0882c3b58263b638b41fbf110fde8">mp_sub</a></div><div class="ttdeci">#define mp_sub(a, b, c)</div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt__private_8h_source.html#l00158">tomcrypt_private.h:158</a></div></div>
<div class="ttc" id="tomcrypt__private_8h_html_a6ce44f2e6f872565a468b67d9a93dc28"><div class="ttname"><a href="tomcrypt__private_8h.html#a6ce44f2e6f872565a468b67d9a93dc28">mp_cmp_d</a></div><div class="ttdeci">#define mp_cmp_d(a, b)</div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt__private_8h_source.html#l00145">tomcrypt_private.h:145</a></div></div>
<div class="ttc" id="tomcrypt__private_8h_html_a175d04f8aeaa1c3895fe14de6cc0d2db"><div class="ttname"><a href="tomcrypt__private_8h.html#a175d04f8aeaa1c3895fe14de6cc0d2db">mp_add</a></div><div class="ttdeci">#define mp_add(a, b, c)</div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt__private_8h_source.html#l00156">tomcrypt_private.h:156</a></div></div>
<div class="ttc" id="tomcrypt__private_8h_html_a7606d2423856b32b09245a2fa1ef34ee"><div class="ttname"><a href="tomcrypt__private_8h.html#a7606d2423856b32b09245a2fa1ef34ee">mp_mul</a></div><div class="ttdeci">#define mp_mul(a, b, c)</div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt__private_8h_source.html#l00160">tomcrypt_private.h:160</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="tomcrypt_8h_source.html#l00051">CRYPT_INVALID_PACKET</a>, <a class="el" href="tomcrypt_8h_source.html#l00042">CRYPT_OK</a>, <a class="el" href="tomcrypt__math_8h_source.html#l00013">LTC_MP_EQ</a>, <a class="el" href="tomcrypt__math_8h_source.html#l00012">LTC_MP_LT</a>, <a class="el" href="tomcrypt__private_8h_source.html#l00156">mp_add</a>, <a class="el" href="tomcrypt__private_8h_source.html#l00171">mp_addmod</a>, <a class="el" href="tomcrypt__private_8h_source.html#l00132">mp_clear_multi</a>, <a class="el" href="tomcrypt__private_8h_source.html#l00144">mp_cmp</a>, <a class="el" href="tomcrypt__private_8h_source.html#l00145">mp_cmp_d</a>, <a class="el" href="tomcrypt__private_8h_source.html#l00130">mp_init_multi</a>, <a class="el" href="tomcrypt__private_8h_source.html#l00166">mp_mod</a>, <a class="el" href="tomcrypt__private_8h_source.html#l00160">mp_mul</a>, <a class="el" href="tomcrypt__private_8h_source.html#l00173">mp_mulmod</a>, <a class="el" href="tomcrypt__private_8h_source.html#l00162">mp_sqr</a>, <a class="el" href="tomcrypt__private_8h_source.html#l00158">mp_sub</a>, <a class="el" href="tomcrypt__private_8h_source.html#l00172">mp_submod</a>, <a class="el" href="tiger_8c_source.html#l00037">t1</a>, and <a class="el" href="tiger_8c_source.html#l00038">t2</a>.</p>

<p class="reference">Referenced by <a class="el" href="ltc__ecc__verify__key_8c_source.html#l00022">ltc_ecc_verify_key()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="tomcrypt__private_8h_affd37f56571ffc28d2c2687a76014b11_icgraph.png" border="0" usemap="#tomcrypt__private_8h_affd37f56571ffc28d2c2687a76014b11_icgraph" alt=""/></div>
<!-- MAP 40 -->
</div>

</div>
</div>
<a id="a54a2d7d30af25ef341a8aca09269177d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a54a2d7d30af25ef341a8aca09269177d">&#9670;&nbsp;</a></span>ltc_ecc_is_point_at_infinity()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ltc_ecc_is_point_at_infinity </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="tomcrypt__math_8h.html#a2a6efaeaa795aa54274d7c4fd66b018a">ecc_point</a> *&#160;</td>
          <td class="paramname"><em>P</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>modulus</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>retval</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ltc__ecc__is__point__at__infinity_8c_source.html#l00018">18</a> of file <a class="el" href="ltc__ecc__is__point__at__infinity_8c_source.html">ltc_ecc_is_point_at_infinity.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;{</div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;   <span class="keywordtype">int</span> err;</div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;   <span class="keywordtype">void</span>  *x3, *y2;</div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;</div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;   <span class="comment">/* trivial case */</span></div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;   <span class="keywordflow">if</span> (!<a class="code" href="tomcrypt__private_8h.html#a910040068490f9f6e5185c970ab869c9">mp_iszero</a>(P-&gt;z)) {</div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;      *retval = 0;</div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>;</div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;   }</div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;</div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;   <span class="comment">/* point (0,0,0) is not at infinity */</span></div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="tomcrypt__private_8h.html#a910040068490f9f6e5185c970ab869c9">mp_iszero</a>(P-&gt;x) &amp;&amp; <a class="code" href="tomcrypt__private_8h.html#a910040068490f9f6e5185c970ab869c9">mp_iszero</a>(P-&gt;y)) {</div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;      *retval = 0;</div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>;</div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;   }</div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;</div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;   <span class="comment">/* initialize */</span></div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;   <span class="keywordflow">if</span> ((err = <a class="code" href="tomcrypt__private_8h.html#adb6322247b1a4f0347219acab3120bd3">mp_init_multi</a>(&amp;x3, &amp;y2, NULL))      != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>)   <span class="keywordflow">goto</span> done;</div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;</div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;   <span class="comment">/* compute y^2 */</span></div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;   <span class="keywordflow">if</span> ((err = <a class="code" href="tomcrypt__private_8h.html#a0c32b20b84951870c7b09f5b6f2679c9">mp_mulmod</a>(P-&gt;y, P-&gt;y, modulus, y2)) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>)   <span class="keywordflow">goto</span> cleanup;</div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;</div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;   <span class="comment">/* compute x^3 */</span></div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;   <span class="keywordflow">if</span> ((err = <a class="code" href="tomcrypt__private_8h.html#a0c32b20b84951870c7b09f5b6f2679c9">mp_mulmod</a>(P-&gt;x, P-&gt;x, modulus, x3)) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>)   <span class="keywordflow">goto</span> cleanup;</div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;   <span class="keywordflow">if</span> ((err = <a class="code" href="tomcrypt__private_8h.html#a0c32b20b84951870c7b09f5b6f2679c9">mp_mulmod</a>(P-&gt;x, x3, modulus, x3))   != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>)   <span class="keywordflow">goto</span> cleanup;</div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;</div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;   <span class="comment">/* test y^2 == x^3 */</span></div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;   err = <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>;</div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;   <span class="keywordflow">if</span> ((<a class="code" href="tomcrypt__private_8h.html#a62ea02fbe7dd2d456e49520264d775ee">mp_cmp</a>(x3, y2) == <a class="code" href="tomcrypt__math_8h.html#a035a31bde4f31419eb259e36e5776607">LTC_MP_EQ</a>) &amp;&amp; !<a class="code" href="tomcrypt__private_8h.html#a910040068490f9f6e5185c970ab869c9">mp_iszero</a>(y2)) {</div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;      *retval = 1;</div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;      *retval = 0;</div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;   }</div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;</div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;cleanup:</div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;   <a class="code" href="tomcrypt__private_8h.html#aad5c8a3112b3e4613f9efc86692c43cb">mp_clear_multi</a>(x3, y2, NULL);</div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;done:</div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;   <span class="keywordflow">return</span> err;</div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;}</div><div class="ttc" id="tomcrypt_8h_html_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334"><div class="ttname"><a href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a></div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt_8h_source.html#l00042">tomcrypt.h:42</a></div></div>
<div class="ttc" id="tomcrypt__private_8h_html_a0c32b20b84951870c7b09f5b6f2679c9"><div class="ttname"><a href="tomcrypt__private_8h.html#a0c32b20b84951870c7b09f5b6f2679c9">mp_mulmod</a></div><div class="ttdeci">#define mp_mulmod(a, b, c, d)</div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt__private_8h_source.html#l00173">tomcrypt_private.h:173</a></div></div>
<div class="ttc" id="tomcrypt__private_8h_html_aad5c8a3112b3e4613f9efc86692c43cb"><div class="ttname"><a href="tomcrypt__private_8h.html#aad5c8a3112b3e4613f9efc86692c43cb">mp_clear_multi</a></div><div class="ttdeci">#define mp_clear_multi</div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt__private_8h_source.html#l00132">tomcrypt_private.h:132</a></div></div>
<div class="ttc" id="tomcrypt__private_8h_html_a62ea02fbe7dd2d456e49520264d775ee"><div class="ttname"><a href="tomcrypt__private_8h.html#a62ea02fbe7dd2d456e49520264d775ee">mp_cmp</a></div><div class="ttdeci">#define mp_cmp(a, b)</div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt__private_8h_source.html#l00144">tomcrypt_private.h:144</a></div></div>
<div class="ttc" id="tomcrypt__math_8h_html_a035a31bde4f31419eb259e36e5776607"><div class="ttname"><a href="tomcrypt__math_8h.html#a035a31bde4f31419eb259e36e5776607">LTC_MP_EQ</a></div><div class="ttdeci">#define LTC_MP_EQ</div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt__math_8h_source.html#l00013">tomcrypt_math.h:13</a></div></div>
<div class="ttc" id="tomcrypt__private_8h_html_adb6322247b1a4f0347219acab3120bd3"><div class="ttname"><a href="tomcrypt__private_8h.html#adb6322247b1a4f0347219acab3120bd3">mp_init_multi</a></div><div class="ttdeci">#define mp_init_multi</div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt__private_8h_source.html#l00130">tomcrypt_private.h:130</a></div></div>
<div class="ttc" id="tomcrypt__private_8h_html_a910040068490f9f6e5185c970ab869c9"><div class="ttname"><a href="tomcrypt__private_8h.html#a910040068490f9f6e5185c970ab869c9">mp_iszero</a></div><div class="ttdeci">#define mp_iszero(a)</div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt__private_8h_source.html#l00185">tomcrypt_private.h:185</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="tomcrypt_8h_source.html#l00042">CRYPT_OK</a>, <a class="el" href="tomcrypt__math_8h_source.html#l00013">LTC_MP_EQ</a>, <a class="el" href="tomcrypt__private_8h_source.html#l00132">mp_clear_multi</a>, <a class="el" href="tomcrypt__private_8h_source.html#l00144">mp_cmp</a>, <a class="el" href="tomcrypt__private_8h_source.html#l00130">mp_init_multi</a>, <a class="el" href="tomcrypt__private_8h_source.html#l00185">mp_iszero</a>, and <a class="el" href="tomcrypt__private_8h_source.html#l00173">mp_mulmod</a>.</p>

<p class="reference">Referenced by <a class="el" href="ltc__ecc__mulmod__timing_8c_source.html#l00031">ltc_ecc_mulmod()</a>, <a class="el" href="ltc__ecc__projective__add__point_8c_source.html#l00029">ltc_ecc_projective_add_point()</a>, <a class="el" href="ltc__ecc__projective__dbl__point_8c_source.html#l00046">ltc_ecc_projective_dbl_point()</a>, <a class="el" href="ltc__ecc__verify__key_8c_source.html#l00022">ltc_ecc_verify_key()</a>, <a class="el" href="tfm__desc_8c_source.html#l00584">tfm_ecc_projective_add_point()</a>, and <a class="el" href="tfm__desc_8c_source.html#l00429">tfm_ecc_projective_dbl_point()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="tomcrypt__private_8h_a54a2d7d30af25ef341a8aca09269177d_icgraph.png" border="0" usemap="#tomcrypt__private_8h_a54a2d7d30af25ef341a8aca09269177d_icgraph" alt=""/></div>
<!-- MAP 41 -->
</div>

</div>
</div>
<a id="af9f9d49f05241e41e2f8660afdaf7dac"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af9f9d49f05241e41e2f8660afdaf7dac">&#9670;&nbsp;</a></span>ltc_ecc_map()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ltc_ecc_map </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="tomcrypt__math_8h.html#a2a6efaeaa795aa54274d7c4fd66b018a">ecc_point</a> *&#160;</td>
          <td class="paramname"><em>P</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>modulus</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>mp</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Map a projective jacbobian point back to affine space. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">P</td><td>[in/out] The point to map </td></tr>
    <tr><td class="paramname">modulus</td><td>The modulus of the field the ECC curve is in </td></tr>
    <tr><td class="paramname">mp</td><td>The "b" value from <a class="el" href="gmp__desc_8c.html#a771ef8a9d5b1b2633613bfad28b282c2">montgomery_setup()</a> </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>CRYPT_OK on success </dd></dl>

<p class="definition">Definition at line <a class="el" href="ltc__ecc__map_8c_source.html#l00026">26</a> of file <a class="el" href="ltc__ecc__map_8c_source.html">ltc_ecc_map.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;{</div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;   <span class="keywordtype">void</span> *<a class="code" href="tiger_8c.html#a65f7891fccbfcf7d08964555630773b3">t1</a>, *<a class="code" href="tiger_8c.html#aa4652e2d6053d420dcbea07a113db5fe">t2</a>;</div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;   <span class="keywordtype">int</span>   err;</div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;</div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;   <a class="code" href="tomcrypt__argchk_8h.html#a683da3e041e49f196318b6ea951414ba">LTC_ARGCHK</a>(P       != NULL);</div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;   <a class="code" href="tomcrypt__argchk_8h.html#a683da3e041e49f196318b6ea951414ba">LTC_ARGCHK</a>(modulus != NULL);</div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;   <a class="code" href="tomcrypt__argchk_8h.html#a683da3e041e49f196318b6ea951414ba">LTC_ARGCHK</a>(mp      != NULL);</div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;</div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="tomcrypt__private_8h.html#a910040068490f9f6e5185c970ab869c9">mp_iszero</a>(P-&gt;z)) {</div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="tomcrypt__private_8h.html#adc0366a4a0c272b7594bcea0d8fe7ccb">ltc_ecc_set_point_xyz</a>(0, 0, 1, P);</div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;   }</div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;</div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;   <span class="keywordflow">if</span> ((err = <a class="code" href="tomcrypt__private_8h.html#adb6322247b1a4f0347219acab3120bd3">mp_init_multi</a>(&amp;<a class="code" href="tiger_8c.html#a65f7891fccbfcf7d08964555630773b3">t1</a>, &amp;<a class="code" href="tiger_8c.html#aa4652e2d6053d420dcbea07a113db5fe">t2</a>, NULL)) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>) {</div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;      <span class="keywordflow">return</span> err;</div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;   }</div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;</div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;   <span class="comment">/* first map z back to normal */</span></div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;   <span class="keywordflow">if</span> ((err = <a class="code" href="tomcrypt__private_8h.html#a4201ed2dbae154496e1a2ae9ba8aa7a8">mp_montgomery_reduce</a>(P-&gt;z, modulus, mp)) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>)           { <span class="keywordflow">goto</span> done; }</div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;</div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;   <span class="comment">/* get 1/z */</span></div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;   <span class="keywordflow">if</span> ((err = <a class="code" href="tomcrypt__private_8h.html#a8be707236375351ab194f908c8ba9233">mp_invmod</a>(P-&gt;z, modulus, <a class="code" href="tiger_8c.html#a65f7891fccbfcf7d08964555630773b3">t1</a>)) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>)                      { <span class="keywordflow">goto</span> done; }</div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;</div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;   <span class="comment">/* get 1/z^2 and 1/z^3 */</span></div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;   <span class="keywordflow">if</span> ((err = <a class="code" href="tomcrypt__private_8h.html#aea81d79b5462e99068908d80edb8bd1a">mp_sqr</a>(<a class="code" href="tiger_8c.html#a65f7891fccbfcf7d08964555630773b3">t1</a>, <a class="code" href="tiger_8c.html#aa4652e2d6053d420dcbea07a113db5fe">t2</a>)) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>)                                    { <span class="keywordflow">goto</span> done; }</div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;   <span class="keywordflow">if</span> ((err = <a class="code" href="tomcrypt__private_8h.html#ac7deed6f00e289706070b16f98c430fe">mp_mod</a>(<a class="code" href="tiger_8c.html#aa4652e2d6053d420dcbea07a113db5fe">t2</a>, modulus, <a class="code" href="tiger_8c.html#aa4652e2d6053d420dcbea07a113db5fe">t2</a>)) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>)                           { <span class="keywordflow">goto</span> done; }</div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;   <span class="keywordflow">if</span> ((err = <a class="code" href="tomcrypt__private_8h.html#a7606d2423856b32b09245a2fa1ef34ee">mp_mul</a>(<a class="code" href="tiger_8c.html#a65f7891fccbfcf7d08964555630773b3">t1</a>, <a class="code" href="tiger_8c.html#aa4652e2d6053d420dcbea07a113db5fe">t2</a>, <a class="code" href="tiger_8c.html#a65f7891fccbfcf7d08964555630773b3">t1</a>)) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>)                                { <span class="keywordflow">goto</span> done; }</div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;   <span class="keywordflow">if</span> ((err = <a class="code" href="tomcrypt__private_8h.html#ac7deed6f00e289706070b16f98c430fe">mp_mod</a>(<a class="code" href="tiger_8c.html#a65f7891fccbfcf7d08964555630773b3">t1</a>, modulus, <a class="code" href="tiger_8c.html#a65f7891fccbfcf7d08964555630773b3">t1</a>)) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>)                           { <span class="keywordflow">goto</span> done; }</div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;</div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;   <span class="comment">/* multiply against x/y */</span></div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;   <span class="keywordflow">if</span> ((err = <a class="code" href="tomcrypt__private_8h.html#a7606d2423856b32b09245a2fa1ef34ee">mp_mul</a>(P-&gt;x, <a class="code" href="tiger_8c.html#aa4652e2d6053d420dcbea07a113db5fe">t2</a>, P-&gt;x)) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>)                            { <span class="keywordflow">goto</span> done; }</div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;   <span class="keywordflow">if</span> ((err = <a class="code" href="tomcrypt__private_8h.html#a4201ed2dbae154496e1a2ae9ba8aa7a8">mp_montgomery_reduce</a>(P-&gt;x, modulus, mp)) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>)           { <span class="keywordflow">goto</span> done; }</div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;   <span class="keywordflow">if</span> ((err = <a class="code" href="tomcrypt__private_8h.html#a7606d2423856b32b09245a2fa1ef34ee">mp_mul</a>(P-&gt;y, <a class="code" href="tiger_8c.html#a65f7891fccbfcf7d08964555630773b3">t1</a>, P-&gt;y)) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>)                            { <span class="keywordflow">goto</span> done; }</div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;   <span class="keywordflow">if</span> ((err = <a class="code" href="tomcrypt__private_8h.html#a4201ed2dbae154496e1a2ae9ba8aa7a8">mp_montgomery_reduce</a>(P-&gt;y, modulus, mp)) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>)           { <span class="keywordflow">goto</span> done; }</div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;   <span class="keywordflow">if</span> ((err = <a class="code" href="tomcrypt__private_8h.html#a000b0542ef4ecf639ff69895490fdb8f">mp_set</a>(P-&gt;z, 1)) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>)                                   { <span class="keywordflow">goto</span> done; }</div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;</div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;   err = <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>;</div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;done:</div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;   <a class="code" href="tomcrypt__private_8h.html#aad5c8a3112b3e4613f9efc86692c43cb">mp_clear_multi</a>(<a class="code" href="tiger_8c.html#a65f7891fccbfcf7d08964555630773b3">t1</a>, <a class="code" href="tiger_8c.html#aa4652e2d6053d420dcbea07a113db5fe">t2</a>, NULL);</div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;   <span class="keywordflow">return</span> err;</div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;}</div><div class="ttc" id="tomcrypt_8h_html_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334"><div class="ttname"><a href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a></div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt_8h_source.html#l00042">tomcrypt.h:42</a></div></div>
<div class="ttc" id="tomcrypt__argchk_8h_html_a683da3e041e49f196318b6ea951414ba"><div class="ttname"><a href="tomcrypt__argchk_8h.html#a683da3e041e49f196318b6ea951414ba">LTC_ARGCHK</a></div><div class="ttdeci">#define LTC_ARGCHK(x)</div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt__argchk_8h_source.html#l00019">tomcrypt_argchk.h:19</a></div></div>
<div class="ttc" id="tiger_8c_html_aa4652e2d6053d420dcbea07a113db5fe"><div class="ttname"><a href="tiger_8c.html#aa4652e2d6053d420dcbea07a113db5fe">t2</a></div><div class="ttdeci">#define t2</div><div class="ttdef"><b>Definition:</b> <a href="tiger_8c_source.html#l00038">tiger.c:38</a></div></div>
<div class="ttc" id="tomcrypt__private_8h_html_aea81d79b5462e99068908d80edb8bd1a"><div class="ttname"><a href="tomcrypt__private_8h.html#aea81d79b5462e99068908d80edb8bd1a">mp_sqr</a></div><div class="ttdeci">#define mp_sqr(a, b)</div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt__private_8h_source.html#l00162">tomcrypt_private.h:162</a></div></div>
<div class="ttc" id="tiger_8c_html_a65f7891fccbfcf7d08964555630773b3"><div class="ttname"><a href="tiger_8c.html#a65f7891fccbfcf7d08964555630773b3">t1</a></div><div class="ttdeci">#define t1</div><div class="ttdef"><b>Definition:</b> <a href="tiger_8c_source.html#l00037">tiger.c:37</a></div></div>
<div class="ttc" id="tomcrypt__private_8h_html_adc0366a4a0c272b7594bcea0d8fe7ccb"><div class="ttname"><a href="tomcrypt__private_8h.html#adc0366a4a0c272b7594bcea0d8fe7ccb">ltc_ecc_set_point_xyz</a></div><div class="ttdeci">int ltc_ecc_set_point_xyz(ltc_mp_digit x, ltc_mp_digit y, ltc_mp_digit z, ecc_point *p)</div><div class="ttdef"><b>Definition:</b> <a href="ltc__ecc__points_8c_source.html#l00049">ltc_ecc_points.c:49</a></div></div>
<div class="ttc" id="tomcrypt__private_8h_html_ac7deed6f00e289706070b16f98c430fe"><div class="ttname"><a href="tomcrypt__private_8h.html#ac7deed6f00e289706070b16f98c430fe">mp_mod</a></div><div class="ttdeci">#define mp_mod(a, b, c)</div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt__private_8h_source.html#l00166">tomcrypt_private.h:166</a></div></div>
<div class="ttc" id="tomcrypt__private_8h_html_aad5c8a3112b3e4613f9efc86692c43cb"><div class="ttname"><a href="tomcrypt__private_8h.html#aad5c8a3112b3e4613f9efc86692c43cb">mp_clear_multi</a></div><div class="ttdeci">#define mp_clear_multi</div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt__private_8h_source.html#l00132">tomcrypt_private.h:132</a></div></div>
<div class="ttc" id="tomcrypt__private_8h_html_adb6322247b1a4f0347219acab3120bd3"><div class="ttname"><a href="tomcrypt__private_8h.html#adb6322247b1a4f0347219acab3120bd3">mp_init_multi</a></div><div class="ttdeci">#define mp_init_multi</div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt__private_8h_source.html#l00130">tomcrypt_private.h:130</a></div></div>
<div class="ttc" id="tomcrypt__private_8h_html_a4201ed2dbae154496e1a2ae9ba8aa7a8"><div class="ttname"><a href="tomcrypt__private_8h.html#a4201ed2dbae154496e1a2ae9ba8aa7a8">mp_montgomery_reduce</a></div><div class="ttdeci">#define mp_montgomery_reduce(a, b, c)</div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt__private_8h_source.html#l00179">tomcrypt_private.h:179</a></div></div>
<div class="ttc" id="tomcrypt__private_8h_html_a910040068490f9f6e5185c970ab869c9"><div class="ttname"><a href="tomcrypt__private_8h.html#a910040068490f9f6e5185c970ab869c9">mp_iszero</a></div><div class="ttdeci">#define mp_iszero(a)</div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt__private_8h_source.html#l00185">tomcrypt_private.h:185</a></div></div>
<div class="ttc" id="tomcrypt__private_8h_html_a000b0542ef4ecf639ff69895490fdb8f"><div class="ttname"><a href="tomcrypt__private_8h.html#a000b0542ef4ecf639ff69895490fdb8f">mp_set</a></div><div class="ttdeci">#define mp_set(a, b)</div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt__private_8h_source.html#l00139">tomcrypt_private.h:139</a></div></div>
<div class="ttc" id="tomcrypt__private_8h_html_a7606d2423856b32b09245a2fa1ef34ee"><div class="ttname"><a href="tomcrypt__private_8h.html#a7606d2423856b32b09245a2fa1ef34ee">mp_mul</a></div><div class="ttdeci">#define mp_mul(a, b, c)</div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt__private_8h_source.html#l00160">tomcrypt_private.h:160</a></div></div>
<div class="ttc" id="tomcrypt__private_8h_html_a8be707236375351ab194f908c8ba9233"><div class="ttname"><a href="tomcrypt__private_8h.html#a8be707236375351ab194f908c8ba9233">mp_invmod</a></div><div class="ttdeci">#define mp_invmod(a, b, c)</div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt__private_8h_source.html#l00175">tomcrypt_private.h:175</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="tomcrypt_8h_source.html#l00042">CRYPT_OK</a>, <a class="el" href="tomcrypt__argchk_8h_source.html#l00019">LTC_ARGCHK</a>, <a class="el" href="ltc__ecc__points_8c_source.html#l00049">ltc_ecc_set_point_xyz()</a>, <a class="el" href="tomcrypt__private_8h_source.html#l00132">mp_clear_multi</a>, <a class="el" href="tomcrypt__private_8h_source.html#l00130">mp_init_multi</a>, <a class="el" href="tomcrypt__private_8h_source.html#l00175">mp_invmod</a>, <a class="el" href="tomcrypt__private_8h_source.html#l00185">mp_iszero</a>, <a class="el" href="tomcrypt__private_8h_source.html#l00166">mp_mod</a>, <a class="el" href="tomcrypt__private_8h_source.html#l00179">mp_montgomery_reduce</a>, <a class="el" href="tomcrypt__private_8h_source.html#l00160">mp_mul</a>, <a class="el" href="tomcrypt__private_8h_source.html#l00139">mp_set</a>, <a class="el" href="tomcrypt__private_8h_source.html#l00162">mp_sqr</a>, <a class="el" href="tiger_8c_source.html#l00037">t1</a>, and <a class="el" href="tiger_8c_source.html#l00038">t2</a>.</p>

<p class="reference">Referenced by <a class="el" href="ltc__ecc__mul2add_8c_source.html#l00031">ltc_ecc_mul2add()</a>, and <a class="el" href="ltc__ecc__mulmod__timing_8c_source.html#l00031">ltc_ecc_mulmod()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="tomcrypt__private_8h_af9f9d49f05241e41e2f8660afdaf7dac_cgraph.png" border="0" usemap="#tomcrypt__private_8h_af9f9d49f05241e41e2f8660afdaf7dac_cgraph" alt=""/></div>
<!-- MAP 42 -->
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="tomcrypt__private_8h_af9f9d49f05241e41e2f8660afdaf7dac_icgraph.png" border="0" usemap="#tomcrypt__private_8h_af9f9d49f05241e41e2f8660afdaf7dac_icgraph" alt=""/></div>
<!-- MAP 43 -->
</div>

</div>
</div>
<a id="a4aaa757939c4f4b54a3db21afc6aef9f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4aaa757939c4f4b54a3db21afc6aef9f">&#9670;&nbsp;</a></span>ltc_ecc_mul2add()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ltc_ecc_mul2add </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="tomcrypt__math_8h.html#a2a6efaeaa795aa54274d7c4fd66b018a">ecc_point</a> *&#160;</td>
          <td class="paramname"><em>A</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>kA</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="tomcrypt__math_8h.html#a2a6efaeaa795aa54274d7c4fd66b018a">ecc_point</a> *&#160;</td>
          <td class="paramname"><em>B</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>kB</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="tomcrypt__math_8h.html#a2a6efaeaa795aa54274d7c4fd66b018a">ecc_point</a> *&#160;</td>
          <td class="paramname"><em>C</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>ma</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>modulus</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Computes kA*A + kB*B = C using Shamir's Trick. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">A</td><td>First point to multiply </td></tr>
    <tr><td class="paramname">kA</td><td>What to multiple A by </td></tr>
    <tr><td class="paramname">B</td><td>Second point to multiply </td></tr>
    <tr><td class="paramname">kB</td><td>What to multiple B by </td></tr>
    <tr><td class="paramname">C</td><td>[out] Destination point (can overlap with A or B) </td></tr>
    <tr><td class="paramname">ma</td><td>ECC curve parameter a in montgomery form </td></tr>
    <tr><td class="paramname">modulus</td><td>Modulus for curve </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>CRYPT_OK on success </dd></dl>

<p class="definition">Definition at line <a class="el" href="ltc__ecc__mul2add_8c_source.html#l00031">31</a> of file <a class="el" href="ltc__ecc__mul2add_8c_source.html">ltc_ecc_mul2add.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;{</div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;  <a class="code" href="tomcrypt__math_8h.html#a2a6efaeaa795aa54274d7c4fd66b018a">ecc_point</a>     *precomp[16];</div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;  <span class="keywordtype">unsigned</span>       bitbufA, bitbufB, lenA, lenB, <a class="code" href="ocb__init_8c.html#afed088663f8704004425cdae2120b9b3">len</a>, nA, nB, nibble;</div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;  <span class="keywordtype">unsigned</span>       x, y;</div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *tA, *tB;</div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;  <span class="keywordtype">int</span>            err, first;</div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;  <span class="keywordtype">void</span>          *mp, *mu;</div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;</div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;  <span class="comment">/* argchks */</span></div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;  <a class="code" href="tomcrypt__argchk_8h.html#a683da3e041e49f196318b6ea951414ba">LTC_ARGCHK</a>(A       != NULL);</div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;  <a class="code" href="tomcrypt__argchk_8h.html#a683da3e041e49f196318b6ea951414ba">LTC_ARGCHK</a>(B       != NULL);</div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;  <a class="code" href="tomcrypt__argchk_8h.html#a683da3e041e49f196318b6ea951414ba">LTC_ARGCHK</a>(C       != NULL);</div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;  <a class="code" href="tomcrypt__argchk_8h.html#a683da3e041e49f196318b6ea951414ba">LTC_ARGCHK</a>(kA      != NULL);</div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;  <a class="code" href="tomcrypt__argchk_8h.html#a683da3e041e49f196318b6ea951414ba">LTC_ARGCHK</a>(kB      != NULL);</div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;  <a class="code" href="tomcrypt__argchk_8h.html#a683da3e041e49f196318b6ea951414ba">LTC_ARGCHK</a>(modulus != NULL);</div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;</div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;  <span class="comment">/* allocate memory */</span></div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;  tA = <a class="code" href="tomcrypt__cfg_8h.html#a151dda14cd7acae31eaf1102b0cc0685">XCALLOC</a>(1, ECC_BUF_SIZE);</div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;  <span class="keywordflow">if</span> (tA == NULL) {</div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;     <span class="keywordflow">return</span> <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06ca0ce0d27adc7ea10b74b7ea904b8bfa82">CRYPT_MEM</a>;</div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;  }</div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;  tB = <a class="code" href="tomcrypt__cfg_8h.html#a151dda14cd7acae31eaf1102b0cc0685">XCALLOC</a>(1, ECC_BUF_SIZE);</div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;  <span class="keywordflow">if</span> (tB == NULL) {</div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;     <a class="code" href="tomcrypt__cfg_8h.html#a260d66fc0690e0502cf3bfe7b5244b75">XFREE</a>(tA);</div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;     <span class="keywordflow">return</span> <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06ca0ce0d27adc7ea10b74b7ea904b8bfa82">CRYPT_MEM</a>;</div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;  }</div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;</div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;  <span class="comment">/* get sizes */</span></div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;  lenA = <a class="code" href="tomcrypt__private_8h.html#ad301148bb24f43a8c7003a6976dfaa5a">mp_unsigned_bin_size</a>(kA);</div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;  lenB = <a class="code" href="tomcrypt__private_8h.html#ad301148bb24f43a8c7003a6976dfaa5a">mp_unsigned_bin_size</a>(kB);</div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;  <a class="code" href="ocb__init_8c.html#afed088663f8704004425cdae2120b9b3">len</a>  = <a class="code" href="tomcrypt__macros_8h.html#aacc3ee1a7f283f8ef65cea31f4436a95">MAX</a>(lenA, lenB);</div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;</div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;  <span class="comment">/* sanity check */</span></div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;  <span class="keywordflow">if</span> ((lenA &gt; ECC_BUF_SIZE) || (lenB &gt; ECC_BUF_SIZE)) {</div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;     err = <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06ca92aa8bad3930f08d5a188bf72094b066">CRYPT_INVALID_ARG</a>;</div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;     <span class="keywordflow">goto</span> ERR_T;</div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;  }</div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;</div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;  <span class="comment">/* extract and justify kA */</span></div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;  <a class="code" href="tomcrypt__private_8h.html#a376a4d31dcfeb65c069db0485b9602f8">mp_to_unsigned_bin</a>(kA, (<a class="code" href="ocb__init_8c.html#afed088663f8704004425cdae2120b9b3">len</a> - lenA) + tA);</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;</div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;  <span class="comment">/* extract and justify kB */</span></div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;  <a class="code" href="tomcrypt__private_8h.html#a376a4d31dcfeb65c069db0485b9602f8">mp_to_unsigned_bin</a>(kB, (<a class="code" href="ocb__init_8c.html#afed088663f8704004425cdae2120b9b3">len</a> - lenB) + tB);</div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;</div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;  <span class="comment">/* allocate the table */</span></div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;  <span class="keywordflow">for</span> (x = 0; x &lt; 16; x++) {</div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;     precomp[x] = <a class="code" href="tomcrypt__private_8h.html#a532af6ef2d0f6d1d8cd79e5f81e87cf8">ltc_ecc_new_point</a>();</div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;     <span class="keywordflow">if</span> (precomp[x] == NULL) {</div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;         <span class="keywordflow">for</span> (y = 0; y &lt; x; ++y) {</div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;            <a class="code" href="tomcrypt__private_8h.html#a4cef83a7c070c94ff78d4df10a7b624f">ltc_ecc_del_point</a>(precomp[y]);</div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;         }</div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;         err = <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06ca0ce0d27adc7ea10b74b7ea904b8bfa82">CRYPT_MEM</a>;</div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;         <span class="keywordflow">goto</span> ERR_T;</div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;     }</div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;  }</div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;</div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;  <span class="comment">/* init montgomery reduction */</span></div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;  <span class="keywordflow">if</span> ((err = <a class="code" href="tomcrypt__private_8h.html#a42560b136f9c3cf1411a82a8cae6d954">mp_montgomery_setup</a>(modulus, &amp;mp)) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>) {</div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;      <span class="keywordflow">goto</span> ERR_P;</div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;  }</div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;  <span class="keywordflow">if</span> ((err = <a class="code" href="tomcrypt__private_8h.html#aff03c4f22c68d651747055048c509cf3">mp_init</a>(&amp;mu)) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>) {</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;      <span class="keywordflow">goto</span> ERR_MP;</div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;  }</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;  <span class="keywordflow">if</span> ((err = <a class="code" href="tomcrypt__private_8h.html#a8e30da64ace4410ca56cb110a6fedd19">mp_montgomery_normalization</a>(mu, modulus)) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>) {</div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;      <span class="keywordflow">goto</span> ERR_MU;</div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;  }</div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;  <span class="comment">/* copy ones ... */</span></div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;  <span class="keywordflow">if</span> ((err = <a class="code" href="tomcrypt__private_8h.html#a0c32b20b84951870c7b09f5b6f2679c9">mp_mulmod</a>(A-&gt;x, mu, modulus, precomp[1]-&gt;x)) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>)                                         { <span class="keywordflow">goto</span> ERR_MU; }</div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;  <span class="keywordflow">if</span> ((err = <a class="code" href="tomcrypt__private_8h.html#a0c32b20b84951870c7b09f5b6f2679c9">mp_mulmod</a>(A-&gt;y, mu, modulus, precomp[1]-&gt;y)) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>)                                         { <span class="keywordflow">goto</span> ERR_MU; }</div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;  <span class="keywordflow">if</span> ((err = <a class="code" href="tomcrypt__private_8h.html#a0c32b20b84951870c7b09f5b6f2679c9">mp_mulmod</a>(A-&gt;z, mu, modulus, precomp[1]-&gt;z)) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>)                                         { <span class="keywordflow">goto</span> ERR_MU; }</div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;</div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;  <span class="keywordflow">if</span> ((err = <a class="code" href="tomcrypt__private_8h.html#a0c32b20b84951870c7b09f5b6f2679c9">mp_mulmod</a>(B-&gt;x, mu, modulus, precomp[1&lt;&lt;2]-&gt;x)) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>)                                      { <span class="keywordflow">goto</span> ERR_MU; }</div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;  <span class="keywordflow">if</span> ((err = <a class="code" href="tomcrypt__private_8h.html#a0c32b20b84951870c7b09f5b6f2679c9">mp_mulmod</a>(B-&gt;y, mu, modulus, precomp[1&lt;&lt;2]-&gt;y)) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>)                                      { <span class="keywordflow">goto</span> ERR_MU; }</div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;  <span class="keywordflow">if</span> ((err = <a class="code" href="tomcrypt__private_8h.html#a0c32b20b84951870c7b09f5b6f2679c9">mp_mulmod</a>(B-&gt;z, mu, modulus, precomp[1&lt;&lt;2]-&gt;z)) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>)                                      { <span class="keywordflow">goto</span> ERR_MU; }</div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;</div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;  <span class="comment">/* precomp [i,0](A + B) table */</span></div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;  <span class="keywordflow">if</span> ((err = <a class="code" href="tomcrypt__math_8h.html#a3d38c44518c63b7a8abd0938f3d41c65">ltc_mp</a>.<a class="code" href="structltc__math__descriptor.html#aeb3ece135c988d56932916b57872e78c">ecc_ptdbl</a>(precomp[1], precomp[2], ma, modulus, mp)) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>)                           { <span class="keywordflow">goto</span> ERR_MU; }</div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;  <span class="keywordflow">if</span> ((err = <a class="code" href="tomcrypt__math_8h.html#a3d38c44518c63b7a8abd0938f3d41c65">ltc_mp</a>.<a class="code" href="structltc__math__descriptor.html#a20678986df75fa338c4267c94b98ae68">ecc_ptadd</a>(precomp[1], precomp[2], precomp[3], ma, modulus, mp)) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>)               { <span class="keywordflow">goto</span> ERR_MU; }</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;</div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;  <span class="comment">/* precomp [0,i](A + B) table */</span></div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;  <span class="keywordflow">if</span> ((err = <a class="code" href="tomcrypt__math_8h.html#a3d38c44518c63b7a8abd0938f3d41c65">ltc_mp</a>.<a class="code" href="structltc__math__descriptor.html#aeb3ece135c988d56932916b57872e78c">ecc_ptdbl</a>(precomp[1&lt;&lt;2], precomp[2&lt;&lt;2], ma, modulus, mp)) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>)                     { <span class="keywordflow">goto</span> ERR_MU; }</div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;  <span class="keywordflow">if</span> ((err = <a class="code" href="tomcrypt__math_8h.html#a3d38c44518c63b7a8abd0938f3d41c65">ltc_mp</a>.<a class="code" href="structltc__math__descriptor.html#a20678986df75fa338c4267c94b98ae68">ecc_ptadd</a>(precomp[1&lt;&lt;2], precomp[2&lt;&lt;2], precomp[3&lt;&lt;2], ma, modulus, mp)) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>)      { <span class="keywordflow">goto</span> ERR_MU; }</div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;</div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;  <span class="comment">/* precomp [i,j](A + B) table (i != 0, j != 0) */</span></div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;  <span class="keywordflow">for</span> (x = 1; x &lt; 4; x++) {</div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;     <span class="keywordflow">for</span> (y = 1; y &lt; 4; y++) {</div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;        <span class="keywordflow">if</span> ((err = <a class="code" href="tomcrypt__math_8h.html#a3d38c44518c63b7a8abd0938f3d41c65">ltc_mp</a>.<a class="code" href="structltc__math__descriptor.html#a20678986df75fa338c4267c94b98ae68">ecc_ptadd</a>(precomp[x], precomp[(y&lt;&lt;2)], precomp[x+(y&lt;&lt;2)], ma, modulus, mp)) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>) { <span class="keywordflow">goto</span> ERR_MU; }</div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;     }</div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;  }</div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;</div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;  nibble  = 3;</div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;  first   = 1;</div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;  bitbufA = tA[0];</div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;  bitbufB = tB[0];</div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;</div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;  <span class="comment">/* for every byte of the multiplicands */</span></div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;  <span class="keywordflow">for</span> (x = 0;; ) {</div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;     <span class="comment">/* grab a nibble */</span></div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;     <span class="keywordflow">if</span> (++nibble == 4) {</div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;        <span class="keywordflow">if</span> (x == <a class="code" href="ocb__init_8c.html#afed088663f8704004425cdae2120b9b3">len</a>) <span class="keywordflow">break</span>;</div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;        bitbufA = tA[x];</div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;        bitbufB = tB[x];</div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;        nibble  = 0;</div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;        ++x;</div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;     }</div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;</div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;     <span class="comment">/* extract two bits from both, shift/update */</span></div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;     nA = (bitbufA &gt;&gt; 6) &amp; 0x03;</div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;     nB = (bitbufB &gt;&gt; 6) &amp; 0x03;</div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;     bitbufA = (bitbufA &lt;&lt; 2) &amp; 0xFF;</div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;     bitbufB = (bitbufB &lt;&lt; 2) &amp; 0xFF;</div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;</div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;     <span class="comment">/* if both zero, if first, continue */</span></div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;     <span class="keywordflow">if</span> ((nA == 0) &amp;&amp; (nB == 0) &amp;&amp; (first == 1)) {</div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;        <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;     }</div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;</div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;     <span class="comment">/* double twice, only if this isn&#39;t the first */</span></div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;     <span class="keywordflow">if</span> (first == 0) {</div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;        <span class="comment">/* double twice */</span></div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;        <span class="keywordflow">if</span> ((err = <a class="code" href="tomcrypt__math_8h.html#a3d38c44518c63b7a8abd0938f3d41c65">ltc_mp</a>.<a class="code" href="structltc__math__descriptor.html#aeb3ece135c988d56932916b57872e78c">ecc_ptdbl</a>(C, C, ma, modulus, mp)) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>)              { <span class="keywordflow">goto</span> ERR_MU; }</div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;        <span class="keywordflow">if</span> ((err = <a class="code" href="tomcrypt__math_8h.html#a3d38c44518c63b7a8abd0938f3d41c65">ltc_mp</a>.<a class="code" href="structltc__math__descriptor.html#aeb3ece135c988d56932916b57872e78c">ecc_ptdbl</a>(C, C, ma, modulus, mp)) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>)              { <span class="keywordflow">goto</span> ERR_MU; }</div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;     }</div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;     <span class="comment">/* if not both zero */</span></div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;     <span class="keywordflow">if</span> ((nA != 0) || (nB != 0)) {</div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;        <span class="keywordflow">if</span> (first == 1) {</div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;           <span class="comment">/* if first, copy from table */</span></div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;           first = 0;</div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;           <span class="keywordflow">if</span> ((err = <a class="code" href="tomcrypt__private_8h.html#a4b36b54e30a0a87aff57a936b386df7f">ltc_ecc_copy_point</a>(precomp[nA + (nB&lt;&lt;2)], C)) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>)      { <span class="keywordflow">goto</span> ERR_MU; }</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;        } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;           <span class="comment">/* if not first, add from table */</span></div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;           <span class="keywordflow">if</span> ((err = <a class="code" href="tomcrypt__math_8h.html#a3d38c44518c63b7a8abd0938f3d41c65">ltc_mp</a>.<a class="code" href="structltc__math__descriptor.html#a20678986df75fa338c4267c94b98ae68">ecc_ptadd</a>(C, precomp[nA + (nB&lt;&lt;2)], C, ma, modulus, mp)) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>) { <span class="keywordflow">goto</span> ERR_MU; }</div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;        }</div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;     }</div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;  }</div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;</div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;  <span class="comment">/* reduce to affine */</span></div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;  err = <a class="code" href="tomcrypt__private_8h.html#af9f9d49f05241e41e2f8660afdaf7dac">ltc_ecc_map</a>(C, modulus, mp);</div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;  <span class="comment">/* clean up */</span></div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;ERR_MU:</div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;   <a class="code" href="tomcrypt__private_8h.html#ab05b6b59fa182b81f5f990d5621229f6">mp_clear</a>(mu);</div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;ERR_MP:</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;   <a class="code" href="tomcrypt__private_8h.html#ac1935719c005c8bffb7590628e84c024">mp_montgomery_free</a>(mp);</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;ERR_P:</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;   <span class="keywordflow">for</span> (x = 0; x &lt; 16; x++) {</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;       <a class="code" href="tomcrypt__private_8h.html#a4cef83a7c070c94ff78d4df10a7b624f">ltc_ecc_del_point</a>(precomp[x]);</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;   }</div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;ERR_T:</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;<span class="preprocessor">#ifdef LTC_CLEAN_STACK</span></div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;   <a class="code" href="tomcrypt__misc_8h.html#a63b6e188713790263bfd3612fe8b398f">zeromem</a>(tA, ECC_BUF_SIZE);</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;   <a class="code" href="tomcrypt__misc_8h.html#a63b6e188713790263bfd3612fe8b398f">zeromem</a>(tB, ECC_BUF_SIZE);</div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;   <a class="code" href="tomcrypt__cfg_8h.html#a260d66fc0690e0502cf3bfe7b5244b75">XFREE</a>(tA);</div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;   <a class="code" href="tomcrypt__cfg_8h.html#a260d66fc0690e0502cf3bfe7b5244b75">XFREE</a>(tB);</div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;</div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;   <span class="keywordflow">return</span> err;</div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;}</div><div class="ttc" id="tomcrypt_8h_html_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334"><div class="ttname"><a href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a></div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt_8h_source.html#l00042">tomcrypt.h:42</a></div></div>
<div class="ttc" id="tomcrypt__private_8h_html_ac1935719c005c8bffb7590628e84c024"><div class="ttname"><a href="tomcrypt__private_8h.html#ac1935719c005c8bffb7590628e84c024">mp_montgomery_free</a></div><div class="ttdeci">#define mp_montgomery_free(a)</div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt__private_8h_source.html#l00180">tomcrypt_private.h:180</a></div></div>
<div class="ttc" id="structltc__math__descriptor_html_aeb3ece135c988d56932916b57872e78c"><div class="ttname"><a href="structltc__math__descriptor.html#aeb3ece135c988d56932916b57872e78c">ltc_math_descriptor::ecc_ptdbl</a></div><div class="ttdeci">int(* ecc_ptdbl)(const ecc_point *P, ecc_point *R, void *ma, void *modulus, void *mp)</div><div class="ttdoc">ECC GF(p) point double.</div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt__math_8h_source.html#l00414">tomcrypt_math.h:414</a></div></div>
<div class="ttc" id="tomcrypt__math_8h_html_a3d38c44518c63b7a8abd0938f3d41c65"><div class="ttname"><a href="tomcrypt__math_8h.html#a3d38c44518c63b7a8abd0938f3d41c65">ltc_mp</a></div><div class="ttdeci">ltc_math_descriptor ltc_mp</div><div class="ttdef"><b>Definition:</b> <a href="crypt__ltc__mp__descriptor_8c_source.html#l00012">crypt_ltc_mp_descriptor.c:12</a></div></div>
<div class="ttc" id="tomcrypt__argchk_8h_html_a683da3e041e49f196318b6ea951414ba"><div class="ttname"><a href="tomcrypt__argchk_8h.html#a683da3e041e49f196318b6ea951414ba">LTC_ARGCHK</a></div><div class="ttdeci">#define LTC_ARGCHK(x)</div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt__argchk_8h_source.html#l00019">tomcrypt_argchk.h:19</a></div></div>
<div class="ttc" id="tomcrypt__private_8h_html_a42560b136f9c3cf1411a82a8cae6d954"><div class="ttname"><a href="tomcrypt__private_8h.html#a42560b136f9c3cf1411a82a8cae6d954">mp_montgomery_setup</a></div><div class="ttdeci">#define mp_montgomery_setup(a, b)</div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt__private_8h_source.html#l00177">tomcrypt_private.h:177</a></div></div>
<div class="ttc" id="tomcrypt__macros_8h_html_aacc3ee1a7f283f8ef65cea31f4436a95"><div class="ttname"><a href="tomcrypt__macros_8h.html#aacc3ee1a7f283f8ef65cea31f4436a95">MAX</a></div><div class="ttdeci">#define MAX(x, y)</div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt__macros_8h_source.html#l00421">tomcrypt_macros.h:421</a></div></div>
<div class="ttc" id="tomcrypt__misc_8h_html_a63b6e188713790263bfd3612fe8b398f"><div class="ttname"><a href="tomcrypt__misc_8h.html#a63b6e188713790263bfd3612fe8b398f">zeromem</a></div><div class="ttdeci">void zeromem(volatile void *out, size_t outlen)</div><div class="ttdoc">Zero a block of memory.</div><div class="ttdef"><b>Definition:</b> <a href="zeromem_8c_source.html#l00021">zeromem.c:21</a></div></div>
<div class="ttc" id="tomcrypt__private_8h_html_af9f9d49f05241e41e2f8660afdaf7dac"><div class="ttname"><a href="tomcrypt__private_8h.html#af9f9d49f05241e41e2f8660afdaf7dac">ltc_ecc_map</a></div><div class="ttdeci">int ltc_ecc_map(ecc_point *P, void *modulus, void *mp)</div><div class="ttdoc">Map a projective jacbobian point back to affine space.</div><div class="ttdef"><b>Definition:</b> <a href="ltc__ecc__map_8c_source.html#l00026">ltc_ecc_map.c:26</a></div></div>
<div class="ttc" id="tomcrypt_8h_html_adc29c2ff13d900c2f185ee95427fb06ca0ce0d27adc7ea10b74b7ea904b8bfa82"><div class="ttname"><a href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06ca0ce0d27adc7ea10b74b7ea904b8bfa82">CRYPT_MEM</a></div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt_8h_source.html#l00060">tomcrypt.h:60</a></div></div>
<div class="ttc" id="tomcrypt__private_8h_html_a0c32b20b84951870c7b09f5b6f2679c9"><div class="ttname"><a href="tomcrypt__private_8h.html#a0c32b20b84951870c7b09f5b6f2679c9">mp_mulmod</a></div><div class="ttdeci">#define mp_mulmod(a, b, c, d)</div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt__private_8h_source.html#l00173">tomcrypt_private.h:173</a></div></div>
<div class="ttc" id="ocb__init_8c_html_afed088663f8704004425cdae2120b9b3"><div class="ttname"><a href="ocb__init_8c.html#afed088663f8704004425cdae2120b9b3">len</a></div><div class="ttdeci">int len</div><div class="ttdef"><b>Definition:</b> <a href="ocb__init_8c_source.html#l00019">ocb_init.c:19</a></div></div>
<div class="ttc" id="tomcrypt__private_8h_html_a4cef83a7c070c94ff78d4df10a7b624f"><div class="ttname"><a href="tomcrypt__private_8h.html#a4cef83a7c070c94ff78d4df10a7b624f">ltc_ecc_del_point</a></div><div class="ttdeci">void ltc_ecc_del_point(ecc_point *p)</div><div class="ttdoc">Free an ECC point from memory.</div><div class="ttdef"><b>Definition:</b> <a href="ltc__ecc__points_8c_source.html#l00040">ltc_ecc_points.c:40</a></div></div>
<div class="ttc" id="tomcrypt__private_8h_html_a4b36b54e30a0a87aff57a936b386df7f"><div class="ttname"><a href="tomcrypt__private_8h.html#a4b36b54e30a0a87aff57a936b386df7f">ltc_ecc_copy_point</a></div><div class="ttdeci">int ltc_ecc_copy_point(const ecc_point *src, ecc_point *dst)</div><div class="ttdef"><b>Definition:</b> <a href="ltc__ecc__points_8c_source.html#l00058">ltc_ecc_points.c:58</a></div></div>
<div class="ttc" id="tomcrypt__cfg_8h_html_a260d66fc0690e0502cf3bfe7b5244b75"><div class="ttname"><a href="tomcrypt__cfg_8h.html#a260d66fc0690e0502cf3bfe7b5244b75">XFREE</a></div><div class="ttdeci">void XFREE(void *p)</div></div>
<div class="ttc" id="tomcrypt_8h_html_adc29c2ff13d900c2f185ee95427fb06ca92aa8bad3930f08d5a188bf72094b066"><div class="ttname"><a href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06ca92aa8bad3930f08d5a188bf72094b066">CRYPT_INVALID_ARG</a></div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt_8h_source.html#l00065">tomcrypt.h:65</a></div></div>
<div class="ttc" id="tomcrypt__private_8h_html_a376a4d31dcfeb65c069db0485b9602f8"><div class="ttname"><a href="tomcrypt__private_8h.html#a376a4d31dcfeb65c069db0485b9602f8">mp_to_unsigned_bin</a></div><div class="ttdeci">#define mp_to_unsigned_bin(a, b)</div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt__private_8h_source.html#l00153">tomcrypt_private.h:153</a></div></div>
<div class="ttc" id="tomcrypt__private_8h_html_a532af6ef2d0f6d1d8cd79e5f81e87cf8"><div class="ttname"><a href="tomcrypt__private_8h.html#a532af6ef2d0f6d1d8cd79e5f81e87cf8">ltc_ecc_new_point</a></div><div class="ttdeci">ecc_point * ltc_ecc_new_point(void)</div><div class="ttdoc">Allocate a new ECC point.</div><div class="ttdef"><b>Definition:</b> <a href="ltc__ecc__points_8c_source.html#l00023">ltc_ecc_points.c:23</a></div></div>
<div class="ttc" id="tomcrypt__private_8h_html_aff03c4f22c68d651747055048c509cf3"><div class="ttname"><a href="tomcrypt__private_8h.html#aff03c4f22c68d651747055048c509cf3">mp_init</a></div><div class="ttdeci">#define mp_init(a)</div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt__private_8h_source.html#l00129">tomcrypt_private.h:129</a></div></div>
<div class="ttc" id="tomcrypt__private_8h_html_ab05b6b59fa182b81f5f990d5621229f6"><div class="ttname"><a href="tomcrypt__private_8h.html#ab05b6b59fa182b81f5f990d5621229f6">mp_clear</a></div><div class="ttdeci">#define mp_clear(a)</div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt__private_8h_source.html#l00131">tomcrypt_private.h:131</a></div></div>
<div class="ttc" id="tomcrypt__private_8h_html_ad301148bb24f43a8c7003a6976dfaa5a"><div class="ttname"><a href="tomcrypt__private_8h.html#ad301148bb24f43a8c7003a6976dfaa5a">mp_unsigned_bin_size</a></div><div class="ttdeci">#define mp_unsigned_bin_size(a)</div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt__private_8h_source.html#l00152">tomcrypt_private.h:152</a></div></div>
<div class="ttc" id="tomcrypt__math_8h_html_a2a6efaeaa795aa54274d7c4fd66b018a"><div class="ttname"><a href="tomcrypt__math_8h.html#a2a6efaeaa795aa54274d7c4fd66b018a">ecc_point</a></div><div class="ttdeci">void ecc_point</div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt__math_8h_source.html#l00020">tomcrypt_math.h:20</a></div></div>
<div class="ttc" id="tomcrypt__private_8h_html_a8e30da64ace4410ca56cb110a6fedd19"><div class="ttname"><a href="tomcrypt__private_8h.html#a8e30da64ace4410ca56cb110a6fedd19">mp_montgomery_normalization</a></div><div class="ttdeci">#define mp_montgomery_normalization(a, b)</div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt__private_8h_source.html#l00178">tomcrypt_private.h:178</a></div></div>
<div class="ttc" id="structltc__math__descriptor_html_a20678986df75fa338c4267c94b98ae68"><div class="ttname"><a href="structltc__math__descriptor.html#a20678986df75fa338c4267c94b98ae68">ltc_math_descriptor::ecc_ptadd</a></div><div class="ttdeci">int(* ecc_ptadd)(const ecc_point *P, const ecc_point *Q, ecc_point *R, void *ma, void *modulus, void *mp)</div><div class="ttdoc">ECC GF(p) point addition.</div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt__math_8h_source.html#l00399">tomcrypt_math.h:399</a></div></div>
<div class="ttc" id="tomcrypt__cfg_8h_html_a151dda14cd7acae31eaf1102b0cc0685"><div class="ttname"><a href="tomcrypt__cfg_8h.html#a151dda14cd7acae31eaf1102b0cc0685">XCALLOC</a></div><div class="ttdeci">void * XCALLOC(size_t n, size_t s)</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="tomcrypt_8h_source.html#l00065">CRYPT_INVALID_ARG</a>, <a class="el" href="tomcrypt_8h_source.html#l00060">CRYPT_MEM</a>, <a class="el" href="tomcrypt_8h_source.html#l00042">CRYPT_OK</a>, <a class="el" href="tomcrypt__math_8h_source.html#l00399">ltc_math_descriptor::ecc_ptadd</a>, <a class="el" href="tomcrypt__math_8h_source.html#l00414">ltc_math_descriptor::ecc_ptdbl</a>, <a class="el" href="ocb__init_8c_source.html#l00019">len</a>, <a class="el" href="tomcrypt__argchk_8h_source.html#l00019">LTC_ARGCHK</a>, <a class="el" href="ltc__ecc__points_8c_source.html#l00058">ltc_ecc_copy_point()</a>, <a class="el" href="ltc__ecc__points_8c_source.html#l00040">ltc_ecc_del_point()</a>, <a class="el" href="ltc__ecc__map_8c_source.html#l00026">ltc_ecc_map()</a>, <a class="el" href="ltc__ecc__points_8c_source.html#l00023">ltc_ecc_new_point()</a>, <a class="el" href="crypt__ltc__mp__descriptor_8c_source.html#l00012">ltc_mp</a>, <a class="el" href="tomcrypt__macros_8h_source.html#l00421">MAX</a>, <a class="el" href="tomcrypt__private_8h_source.html#l00131">mp_clear</a>, <a class="el" href="tomcrypt__private_8h_source.html#l00129">mp_init</a>, <a class="el" href="tomcrypt__private_8h_source.html#l00180">mp_montgomery_free</a>, <a class="el" href="tomcrypt__private_8h_source.html#l00178">mp_montgomery_normalization</a>, <a class="el" href="tomcrypt__private_8h_source.html#l00177">mp_montgomery_setup</a>, <a class="el" href="tomcrypt__private_8h_source.html#l00173">mp_mulmod</a>, <a class="el" href="tomcrypt__private_8h_source.html#l00153">mp_to_unsigned_bin</a>, <a class="el" href="tomcrypt__private_8h_source.html#l00152">mp_unsigned_bin_size</a>, <a class="el" href="tomcrypt__cfg_8h.html#a151dda14cd7acae31eaf1102b0cc0685">XCALLOC()</a>, <a class="el" href="tomcrypt__cfg_8h.html#a260d66fc0690e0502cf3bfe7b5244b75">XFREE()</a>, and <a class="el" href="zeromem_8c_source.html#l00021">zeromem()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="tomcrypt__private_8h_a4aaa757939c4f4b54a3db21afc6aef9f_cgraph.png" border="0" usemap="#tomcrypt__private_8h_a4aaa757939c4f4b54a3db21afc6aef9f_cgraph" alt=""/></div>
<!-- MAP 44 -->
</div>

</div>
</div>
<a id="a818e5e4135d8aa58cf09e502e98ccc90"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a818e5e4135d8aa58cf09e502e98ccc90">&#9670;&nbsp;</a></span>ltc_ecc_mulmod()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ltc_ecc_mulmod </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>k</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="tomcrypt__math_8h.html#a2a6efaeaa795aa54274d7c4fd66b018a">ecc_point</a> *&#160;</td>
          <td class="paramname"><em>G</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="tomcrypt__math_8h.html#a2a6efaeaa795aa54274d7c4fd66b018a">ecc_point</a> *&#160;</td>
          <td class="paramname"><em>R</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>modulus</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>map</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Perform a point multiplication (timing resistant) </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">k</td><td>The scalar to multiply by </td></tr>
    <tr><td class="paramname">G</td><td>The base point </td></tr>
    <tr><td class="paramname">R</td><td>[out] Destination for kG </td></tr>
    <tr><td class="paramname">a</td><td>ECC curve parameter a </td></tr>
    <tr><td class="paramname">modulus</td><td>The modulus of the field the ECC curve is in </td></tr>
    <tr><td class="paramname">map</td><td>Boolean whether to map back to affine or not (1==map, 0 == leave in projective) </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>CRYPT_OK on success </dd></dl>

<p class="definition">Definition at line <a class="el" href="ltc__ecc__mulmod__timing_8c_source.html#l00031">31</a> of file <a class="el" href="ltc__ecc__mulmod__timing_8c_source.html">ltc_ecc_mulmod_timing.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;{</div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;   <a class="code" href="tomcrypt__math_8h.html#a2a6efaeaa795aa54274d7c4fd66b018a">ecc_point</a> *tG, *M[3];</div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;   <span class="keywordtype">int</span>        i, j, err, inf;</div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;   <span class="keywordtype">void</span>       *mp = NULL, *mu = NULL, *ma = NULL, *a_plus3 = NULL;</div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;   <a class="code" href="tomcrypt__cfg_8h.html#a4e98fa26a5de0ac87e06af901bad57c4">ltc_mp_digit</a> buf;</div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;   <span class="keywordtype">int</span>        bitcnt, mode, digidx;</div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;</div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;   <a class="code" href="tomcrypt__argchk_8h.html#a683da3e041e49f196318b6ea951414ba">LTC_ARGCHK</a>(k       != NULL);</div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;   <a class="code" href="tomcrypt__argchk_8h.html#a683da3e041e49f196318b6ea951414ba">LTC_ARGCHK</a>(<a class="code" href="kseed_8c.html#a542b12af0d18d79eddffd5d5cd08617d">G</a>       != NULL);</div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;   <a class="code" href="tomcrypt__argchk_8h.html#a683da3e041e49f196318b6ea951414ba">LTC_ARGCHK</a>(<a class="code" href="khazad_8c.html#a5c71a5e59a53413cd6c270266d63b031">R</a>       != NULL);</div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;   <a class="code" href="tomcrypt__argchk_8h.html#a683da3e041e49f196318b6ea951414ba">LTC_ARGCHK</a>(modulus != NULL);</div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;</div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;   <span class="keywordflow">if</span> ((err = <a class="code" href="tomcrypt__private_8h.html#a54a2d7d30af25ef341a8aca09269177d">ltc_ecc_is_point_at_infinity</a>(<a class="code" href="kseed_8c.html#a542b12af0d18d79eddffd5d5cd08617d">G</a>, modulus, &amp;inf)) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>) <span class="keywordflow">return</span> err;</div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;   <span class="keywordflow">if</span> (inf) {</div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;      <span class="comment">/* return the point at infinity */</span></div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="tomcrypt__private_8h.html#adc0366a4a0c272b7594bcea0d8fe7ccb">ltc_ecc_set_point_xyz</a>(1, 1, 0, <a class="code" href="khazad_8c.html#a5c71a5e59a53413cd6c270266d63b031">R</a>);</div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;   }</div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;</div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;   <span class="comment">/* init montgomery reduction */</span></div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;   <span class="keywordflow">if</span> ((err = <a class="code" href="tomcrypt__private_8h.html#a42560b136f9c3cf1411a82a8cae6d954">mp_montgomery_setup</a>(modulus, &amp;mp)) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>)        { <span class="keywordflow">goto</span> error; }</div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;   <span class="keywordflow">if</span> ((err = <a class="code" href="tomcrypt__private_8h.html#aff03c4f22c68d651747055048c509cf3">mp_init</a>(&amp;mu)) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>)                             { <span class="keywordflow">goto</span> error; }</div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;   <span class="keywordflow">if</span> ((err = <a class="code" href="tomcrypt__private_8h.html#a8e30da64ace4410ca56cb110a6fedd19">mp_montgomery_normalization</a>(mu, modulus)) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>) { <span class="keywordflow">goto</span> error; }</div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;</div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;   <span class="comment">/* for curves with a == -3 keep ma == NULL */</span></div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;   <span class="keywordflow">if</span> ((err = <a class="code" href="tomcrypt__private_8h.html#aff03c4f22c68d651747055048c509cf3">mp_init</a>(&amp;a_plus3)) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>)                        { <span class="keywordflow">goto</span> error; }</div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;   <span class="keywordflow">if</span> ((err = <a class="code" href="tomcrypt__private_8h.html#a69f09e7351d696b635ffbc9912684ab4">mp_add_d</a>(a, 3, a_plus3)) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>)                  { <span class="keywordflow">goto</span> error; }</div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="tomcrypt__private_8h.html#a62ea02fbe7dd2d456e49520264d775ee">mp_cmp</a>(a_plus3, modulus) != <a class="code" href="tomcrypt__math_8h.html#a035a31bde4f31419eb259e36e5776607">LTC_MP_EQ</a>) {</div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;      <span class="keywordflow">if</span> ((err = <a class="code" href="tomcrypt__private_8h.html#aff03c4f22c68d651747055048c509cf3">mp_init</a>(&amp;ma)) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>)                          { <span class="keywordflow">goto</span> error; }</div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;      <span class="keywordflow">if</span> ((err = <a class="code" href="tomcrypt__private_8h.html#a0c32b20b84951870c7b09f5b6f2679c9">mp_mulmod</a>(a, mu, modulus, ma)) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>)         { <span class="keywordflow">goto</span> error; }</div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;   }</div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;</div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;   <span class="comment">/* alloc ram for window temps */</span></div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;   <span class="keywordflow">for</span> (i = 0; i &lt; 3; i++) {</div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;      M[i] = <a class="code" href="tomcrypt__private_8h.html#a532af6ef2d0f6d1d8cd79e5f81e87cf8">ltc_ecc_new_point</a>();</div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;      <span class="keywordflow">if</span> (M[i] == NULL) {</div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;         <span class="keywordflow">for</span> (j = 0; j &lt; i; j++) {</div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;             <a class="code" href="tomcrypt__private_8h.html#a4cef83a7c070c94ff78d4df10a7b624f">ltc_ecc_del_point</a>(M[j]);</div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;         }</div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;         <a class="code" href="tomcrypt__private_8h.html#ab05b6b59fa182b81f5f990d5621229f6">mp_clear</a>(mu);</div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;         <a class="code" href="tomcrypt__private_8h.html#ac1935719c005c8bffb7590628e84c024">mp_montgomery_free</a>(mp);</div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;         <span class="keywordflow">return</span> <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06ca0ce0d27adc7ea10b74b7ea904b8bfa82">CRYPT_MEM</a>;</div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;      }</div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;   }</div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;   <span class="comment">/* make a copy of G incase R==G */</span></div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;   tG = <a class="code" href="tomcrypt__private_8h.html#a532af6ef2d0f6d1d8cd79e5f81e87cf8">ltc_ecc_new_point</a>();</div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;   <span class="keywordflow">if</span> (tG == NULL)                                                                   { err = <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06ca0ce0d27adc7ea10b74b7ea904b8bfa82">CRYPT_MEM</a>; <span class="keywordflow">goto</span> done; }</div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;</div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;   <span class="comment">/* tG = G  and convert to montgomery */</span></div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;   <span class="keywordflow">if</span> ((err = <a class="code" href="tomcrypt__private_8h.html#a0c32b20b84951870c7b09f5b6f2679c9">mp_mulmod</a>(<a class="code" href="kseed_8c.html#a542b12af0d18d79eddffd5d5cd08617d">G</a>-&gt;x, mu, modulus, tG-&gt;x)) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>)                      { <span class="keywordflow">goto</span> done; }</div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;   <span class="keywordflow">if</span> ((err = <a class="code" href="tomcrypt__private_8h.html#a0c32b20b84951870c7b09f5b6f2679c9">mp_mulmod</a>(<a class="code" href="kseed_8c.html#a542b12af0d18d79eddffd5d5cd08617d">G</a>-&gt;y, mu, modulus, tG-&gt;y)) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>)                      { <span class="keywordflow">goto</span> done; }</div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;   <span class="keywordflow">if</span> ((err = <a class="code" href="tomcrypt__private_8h.html#a0c32b20b84951870c7b09f5b6f2679c9">mp_mulmod</a>(<a class="code" href="kseed_8c.html#a542b12af0d18d79eddffd5d5cd08617d">G</a>-&gt;z, mu, modulus, tG-&gt;z)) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>)                      { <span class="keywordflow">goto</span> done; }</div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;   <a class="code" href="tomcrypt__private_8h.html#ab05b6b59fa182b81f5f990d5621229f6">mp_clear</a>(mu);</div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;   mu = NULL;</div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;</div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;   <span class="comment">/* calc the M tab */</span></div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;   <span class="comment">/* M[0] == G */</span></div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;   <span class="keywordflow">if</span> ((err = <a class="code" href="tomcrypt__private_8h.html#a4b36b54e30a0a87aff57a936b386df7f">ltc_ecc_copy_point</a>(tG, M[0])) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>)                             { <span class="keywordflow">goto</span> done; }</div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;   <span class="comment">/* M[1] == 2G */</span></div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;   <span class="keywordflow">if</span> ((err = <a class="code" href="tomcrypt__math_8h.html#a3d38c44518c63b7a8abd0938f3d41c65">ltc_mp</a>.<a class="code" href="structltc__math__descriptor.html#aeb3ece135c988d56932916b57872e78c">ecc_ptdbl</a>(tG, M[1], ma, modulus, mp)) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>)              { <span class="keywordflow">goto</span> done; }</div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;</div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;   <span class="comment">/* setup sliding window */</span></div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;   mode   = 0;</div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;   bitcnt = 1;</div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;   buf    = 0;</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;   digidx = <a class="code" href="tomcrypt__private_8h.html#ae51a279d51ab72f09d9f97335b8be6c9">mp_get_digit_count</a>(k) - 1;</div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;   <span class="comment">/* perform ops */</span></div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;   <span class="keywordflow">for</span> (;;) {</div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;     <span class="comment">/* grab next digit as required */</span></div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;      <span class="keywordflow">if</span> (--bitcnt == 0) {</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;         <span class="keywordflow">if</span> (digidx == -1) {</div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;         }</div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;         buf    = <a class="code" href="tomcrypt__private_8h.html#a62267879327e26468c45bbd83f7f2669">mp_get_digit</a>(k, digidx);</div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;         bitcnt = (int) <a class="code" href="tomcrypt__private_8h.html#ab8e25bc0c3ace6218c5c7d49198405c9">MP_DIGIT_BIT</a>;</div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;         --digidx;</div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;      }</div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;</div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;      <span class="comment">/* grab the next msb from the ltiplicand */</span></div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;      i = (int)((buf &gt;&gt; (<a class="code" href="tomcrypt__private_8h.html#ab8e25bc0c3ace6218c5c7d49198405c9">MP_DIGIT_BIT</a> - 1)) &amp; 1);</div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;      buf &lt;&lt;= 1;</div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;      <span class="keywordflow">if</span> (mode == 0 &amp;&amp; i == 0) {</div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;         <span class="comment">/* dummy operations */</span></div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;         <span class="keywordflow">if</span> ((err = <a class="code" href="tomcrypt__math_8h.html#a3d38c44518c63b7a8abd0938f3d41c65">ltc_mp</a>.<a class="code" href="structltc__math__descriptor.html#a20678986df75fa338c4267c94b98ae68">ecc_ptadd</a>(M[0], M[1], M[2], ma, modulus, mp)) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>) { <span class="keywordflow">goto</span> done; }</div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;         <span class="keywordflow">if</span> ((err = <a class="code" href="tomcrypt__math_8h.html#a3d38c44518c63b7a8abd0938f3d41c65">ltc_mp</a>.<a class="code" href="structltc__math__descriptor.html#aeb3ece135c988d56932916b57872e78c">ecc_ptdbl</a>(M[1], M[2], ma, modulus, mp)) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>)       { <span class="keywordflow">goto</span> done; }</div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;         <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;      }</div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;</div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;      <span class="keywordflow">if</span> (mode == 0 &amp;&amp; i == 1) {</div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;         mode = 1;</div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;         <span class="comment">/* dummy operations */</span></div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;         <span class="keywordflow">if</span> ((err = <a class="code" href="tomcrypt__math_8h.html#a3d38c44518c63b7a8abd0938f3d41c65">ltc_mp</a>.<a class="code" href="structltc__math__descriptor.html#a20678986df75fa338c4267c94b98ae68">ecc_ptadd</a>(M[0], M[1], M[2], ma, modulus, mp)) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>) { <span class="keywordflow">goto</span> done; }</div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;         <span class="keywordflow">if</span> ((err = <a class="code" href="tomcrypt__math_8h.html#a3d38c44518c63b7a8abd0938f3d41c65">ltc_mp</a>.<a class="code" href="structltc__math__descriptor.html#aeb3ece135c988d56932916b57872e78c">ecc_ptdbl</a>(M[1], M[2], ma, modulus, mp)) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>)       { <span class="keywordflow">goto</span> done; }</div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;         <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;      }</div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;</div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;      <span class="keywordflow">if</span> ((err = <a class="code" href="tomcrypt__math_8h.html#a3d38c44518c63b7a8abd0938f3d41c65">ltc_mp</a>.<a class="code" href="structltc__math__descriptor.html#a20678986df75fa338c4267c94b98ae68">ecc_ptadd</a>(M[0], M[1], M[i^1], ma, modulus, mp)) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>)  { <span class="keywordflow">goto</span> done; }</div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;      <span class="keywordflow">if</span> ((err = <a class="code" href="tomcrypt__math_8h.html#a3d38c44518c63b7a8abd0938f3d41c65">ltc_mp</a>.<a class="code" href="structltc__math__descriptor.html#aeb3ece135c988d56932916b57872e78c">ecc_ptdbl</a>(M[i], M[i], ma, modulus, mp)) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>)          { <span class="keywordflow">goto</span> done; }</div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;   }</div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;</div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;   <span class="comment">/* copy result out */</span></div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;   <span class="keywordflow">if</span> ((err = <a class="code" href="tomcrypt__private_8h.html#a4b36b54e30a0a87aff57a936b386df7f">ltc_ecc_copy_point</a>(M[0], <a class="code" href="khazad_8c.html#a5c71a5e59a53413cd6c270266d63b031">R</a>)) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>)                              { <span class="keywordflow">goto</span> done; }</div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;</div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;   <span class="comment">/* map R back from projective space */</span></div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;   <span class="keywordflow">if</span> (map) {</div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;      err = <a class="code" href="tomcrypt__private_8h.html#af9f9d49f05241e41e2f8660afdaf7dac">ltc_ecc_map</a>(<a class="code" href="khazad_8c.html#a5c71a5e59a53413cd6c270266d63b031">R</a>, modulus, mp);</div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;      err = <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>;</div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;   }</div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;done:</div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;   <a class="code" href="tomcrypt__private_8h.html#a4cef83a7c070c94ff78d4df10a7b624f">ltc_ecc_del_point</a>(tG);</div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;   <span class="keywordflow">for</span> (i = 0; i &lt; 3; i++) {</div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;       <a class="code" href="tomcrypt__private_8h.html#a4cef83a7c070c94ff78d4df10a7b624f">ltc_ecc_del_point</a>(M[i]);</div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;   }</div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;error:</div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;   <span class="keywordflow">if</span> (ma != NULL) <a class="code" href="tomcrypt__private_8h.html#ab05b6b59fa182b81f5f990d5621229f6">mp_clear</a>(ma);</div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;   <span class="keywordflow">if</span> (a_plus3 != NULL) <a class="code" href="tomcrypt__private_8h.html#ab05b6b59fa182b81f5f990d5621229f6">mp_clear</a>(a_plus3);</div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;   <span class="keywordflow">if</span> (mu != NULL) <a class="code" href="tomcrypt__private_8h.html#ab05b6b59fa182b81f5f990d5621229f6">mp_clear</a>(mu);</div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;   <span class="keywordflow">if</span> (mp != NULL) <a class="code" href="tomcrypt__private_8h.html#ac1935719c005c8bffb7590628e84c024">mp_montgomery_free</a>(mp);</div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;   <span class="keywordflow">return</span> err;</div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;}</div><div class="ttc" id="tomcrypt_8h_html_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334"><div class="ttname"><a href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a></div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt_8h_source.html#l00042">tomcrypt.h:42</a></div></div>
<div class="ttc" id="tomcrypt__private_8h_html_ac1935719c005c8bffb7590628e84c024"><div class="ttname"><a href="tomcrypt__private_8h.html#ac1935719c005c8bffb7590628e84c024">mp_montgomery_free</a></div><div class="ttdeci">#define mp_montgomery_free(a)</div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt__private_8h_source.html#l00180">tomcrypt_private.h:180</a></div></div>
<div class="ttc" id="structltc__math__descriptor_html_aeb3ece135c988d56932916b57872e78c"><div class="ttname"><a href="structltc__math__descriptor.html#aeb3ece135c988d56932916b57872e78c">ltc_math_descriptor::ecc_ptdbl</a></div><div class="ttdeci">int(* ecc_ptdbl)(const ecc_point *P, ecc_point *R, void *ma, void *modulus, void *mp)</div><div class="ttdoc">ECC GF(p) point double.</div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt__math_8h_source.html#l00414">tomcrypt_math.h:414</a></div></div>
<div class="ttc" id="tomcrypt__math_8h_html_a3d38c44518c63b7a8abd0938f3d41c65"><div class="ttname"><a href="tomcrypt__math_8h.html#a3d38c44518c63b7a8abd0938f3d41c65">ltc_mp</a></div><div class="ttdeci">ltc_math_descriptor ltc_mp</div><div class="ttdef"><b>Definition:</b> <a href="crypt__ltc__mp__descriptor_8c_source.html#l00012">crypt_ltc_mp_descriptor.c:12</a></div></div>
<div class="ttc" id="tomcrypt__argchk_8h_html_a683da3e041e49f196318b6ea951414ba"><div class="ttname"><a href="tomcrypt__argchk_8h.html#a683da3e041e49f196318b6ea951414ba">LTC_ARGCHK</a></div><div class="ttdeci">#define LTC_ARGCHK(x)</div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt__argchk_8h_source.html#l00019">tomcrypt_argchk.h:19</a></div></div>
<div class="ttc" id="tomcrypt__private_8h_html_a42560b136f9c3cf1411a82a8cae6d954"><div class="ttname"><a href="tomcrypt__private_8h.html#a42560b136f9c3cf1411a82a8cae6d954">mp_montgomery_setup</a></div><div class="ttdeci">#define mp_montgomery_setup(a, b)</div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt__private_8h_source.html#l00177">tomcrypt_private.h:177</a></div></div>
<div class="ttc" id="tomcrypt__private_8h_html_a54a2d7d30af25ef341a8aca09269177d"><div class="ttname"><a href="tomcrypt__private_8h.html#a54a2d7d30af25ef341a8aca09269177d">ltc_ecc_is_point_at_infinity</a></div><div class="ttdeci">int ltc_ecc_is_point_at_infinity(const ecc_point *P, void *modulus, int *retval)</div><div class="ttdef"><b>Definition:</b> <a href="ltc__ecc__is__point__at__infinity_8c_source.html#l00018">ltc_ecc_is_point_at_infinity.c:18</a></div></div>
<div class="ttc" id="tomcrypt__private_8h_html_af9f9d49f05241e41e2f8660afdaf7dac"><div class="ttname"><a href="tomcrypt__private_8h.html#af9f9d49f05241e41e2f8660afdaf7dac">ltc_ecc_map</a></div><div class="ttdeci">int ltc_ecc_map(ecc_point *P, void *modulus, void *mp)</div><div class="ttdoc">Map a projective jacbobian point back to affine space.</div><div class="ttdef"><b>Definition:</b> <a href="ltc__ecc__map_8c_source.html#l00026">ltc_ecc_map.c:26</a></div></div>
<div class="ttc" id="tomcrypt__private_8h_html_ab8e25bc0c3ace6218c5c7d49198405c9"><div class="ttname"><a href="tomcrypt__private_8h.html#ab8e25bc0c3ace6218c5c7d49198405c9">MP_DIGIT_BIT</a></div><div class="ttdeci">#define MP_DIGIT_BIT</div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt__private_8h_source.html#l00126">tomcrypt_private.h:126</a></div></div>
<div class="ttc" id="tomcrypt_8h_html_adc29c2ff13d900c2f185ee95427fb06ca0ce0d27adc7ea10b74b7ea904b8bfa82"><div class="ttname"><a href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06ca0ce0d27adc7ea10b74b7ea904b8bfa82">CRYPT_MEM</a></div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt_8h_source.html#l00060">tomcrypt.h:60</a></div></div>
<div class="ttc" id="tomcrypt__private_8h_html_a0c32b20b84951870c7b09f5b6f2679c9"><div class="ttname"><a href="tomcrypt__private_8h.html#a0c32b20b84951870c7b09f5b6f2679c9">mp_mulmod</a></div><div class="ttdeci">#define mp_mulmod(a, b, c, d)</div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt__private_8h_source.html#l00173">tomcrypt_private.h:173</a></div></div>
<div class="ttc" id="tomcrypt__private_8h_html_a4cef83a7c070c94ff78d4df10a7b624f"><div class="ttname"><a href="tomcrypt__private_8h.html#a4cef83a7c070c94ff78d4df10a7b624f">ltc_ecc_del_point</a></div><div class="ttdeci">void ltc_ecc_del_point(ecc_point *p)</div><div class="ttdoc">Free an ECC point from memory.</div><div class="ttdef"><b>Definition:</b> <a href="ltc__ecc__points_8c_source.html#l00040">ltc_ecc_points.c:40</a></div></div>
<div class="ttc" id="tomcrypt__private_8h_html_a4b36b54e30a0a87aff57a936b386df7f"><div class="ttname"><a href="tomcrypt__private_8h.html#a4b36b54e30a0a87aff57a936b386df7f">ltc_ecc_copy_point</a></div><div class="ttdeci">int ltc_ecc_copy_point(const ecc_point *src, ecc_point *dst)</div><div class="ttdef"><b>Definition:</b> <a href="ltc__ecc__points_8c_source.html#l00058">ltc_ecc_points.c:58</a></div></div>
<div class="ttc" id="tomcrypt__private_8h_html_a62267879327e26468c45bbd83f7f2669"><div class="ttname"><a href="tomcrypt__private_8h.html#a62267879327e26468c45bbd83f7f2669">mp_get_digit</a></div><div class="ttdeci">#define mp_get_digit(a, n)</div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt__private_8h_source.html#l00142">tomcrypt_private.h:142</a></div></div>
<div class="ttc" id="tomcrypt__cfg_8h_html_a4e98fa26a5de0ac87e06af901bad57c4"><div class="ttname"><a href="tomcrypt__cfg_8h.html#a4e98fa26a5de0ac87e06af901bad57c4">ltc_mp_digit</a></div><div class="ttdeci">unsigned long ltc_mp_digit</div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt__cfg_8h_source.html#l00235">tomcrypt_cfg.h:235</a></div></div>
<div class="ttc" id="tomcrypt__private_8h_html_adc0366a4a0c272b7594bcea0d8fe7ccb"><div class="ttname"><a href="tomcrypt__private_8h.html#adc0366a4a0c272b7594bcea0d8fe7ccb">ltc_ecc_set_point_xyz</a></div><div class="ttdeci">int ltc_ecc_set_point_xyz(ltc_mp_digit x, ltc_mp_digit y, ltc_mp_digit z, ecc_point *p)</div><div class="ttdef"><b>Definition:</b> <a href="ltc__ecc__points_8c_source.html#l00049">ltc_ecc_points.c:49</a></div></div>
<div class="ttc" id="tomcrypt__private_8h_html_a62ea02fbe7dd2d456e49520264d775ee"><div class="ttname"><a href="tomcrypt__private_8h.html#a62ea02fbe7dd2d456e49520264d775ee">mp_cmp</a></div><div class="ttdeci">#define mp_cmp(a, b)</div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt__private_8h_source.html#l00144">tomcrypt_private.h:144</a></div></div>
<div class="ttc" id="tomcrypt__private_8h_html_a532af6ef2d0f6d1d8cd79e5f81e87cf8"><div class="ttname"><a href="tomcrypt__private_8h.html#a532af6ef2d0f6d1d8cd79e5f81e87cf8">ltc_ecc_new_point</a></div><div class="ttdeci">ecc_point * ltc_ecc_new_point(void)</div><div class="ttdoc">Allocate a new ECC point.</div><div class="ttdef"><b>Definition:</b> <a href="ltc__ecc__points_8c_source.html#l00023">ltc_ecc_points.c:23</a></div></div>
<div class="ttc" id="tomcrypt__math_8h_html_a035a31bde4f31419eb259e36e5776607"><div class="ttname"><a href="tomcrypt__math_8h.html#a035a31bde4f31419eb259e36e5776607">LTC_MP_EQ</a></div><div class="ttdeci">#define LTC_MP_EQ</div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt__math_8h_source.html#l00013">tomcrypt_math.h:13</a></div></div>
<div class="ttc" id="kseed_8c_html_a542b12af0d18d79eddffd5d5cd08617d"><div class="ttname"><a href="kseed_8c.html#a542b12af0d18d79eddffd5d5cd08617d">G</a></div><div class="ttdeci">#define G(x)</div><div class="ttdef"><b>Definition:</b> <a href="kseed_8c_source.html#l00184">kseed.c:184</a></div></div>
<div class="ttc" id="tomcrypt__private_8h_html_aff03c4f22c68d651747055048c509cf3"><div class="ttname"><a href="tomcrypt__private_8h.html#aff03c4f22c68d651747055048c509cf3">mp_init</a></div><div class="ttdeci">#define mp_init(a)</div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt__private_8h_source.html#l00129">tomcrypt_private.h:129</a></div></div>
<div class="ttc" id="tomcrypt__private_8h_html_ab05b6b59fa182b81f5f990d5621229f6"><div class="ttname"><a href="tomcrypt__private_8h.html#ab05b6b59fa182b81f5f990d5621229f6">mp_clear</a></div><div class="ttdeci">#define mp_clear(a)</div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt__private_8h_source.html#l00131">tomcrypt_private.h:131</a></div></div>
<div class="ttc" id="tomcrypt__private_8h_html_a69f09e7351d696b635ffbc9912684ab4"><div class="ttname"><a href="tomcrypt__private_8h.html#a69f09e7351d696b635ffbc9912684ab4">mp_add_d</a></div><div class="ttdeci">#define mp_add_d(a, b, c)</div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt__private_8h_source.html#l00157">tomcrypt_private.h:157</a></div></div>
<div class="ttc" id="tomcrypt__math_8h_html_a2a6efaeaa795aa54274d7c4fd66b018a"><div class="ttname"><a href="tomcrypt__math_8h.html#a2a6efaeaa795aa54274d7c4fd66b018a">ecc_point</a></div><div class="ttdeci">void ecc_point</div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt__math_8h_source.html#l00020">tomcrypt_math.h:20</a></div></div>
<div class="ttc" id="khazad_8c_html_a5c71a5e59a53413cd6c270266d63b031"><div class="ttname"><a href="khazad_8c.html#a5c71a5e59a53413cd6c270266d63b031">R</a></div><div class="ttdeci">#define R</div><div class="ttdef"><b>Definition:</b> <a href="khazad_8c_source.html#l00032">khazad.c:32</a></div></div>
<div class="ttc" id="tomcrypt__private_8h_html_ae51a279d51ab72f09d9f97335b8be6c9"><div class="ttname"><a href="tomcrypt__private_8h.html#ae51a279d51ab72f09d9f97335b8be6c9">mp_get_digit_count</a></div><div class="ttdeci">#define mp_get_digit_count(a)</div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt__private_8h_source.html#l00143">tomcrypt_private.h:143</a></div></div>
<div class="ttc" id="tomcrypt__private_8h_html_a8e30da64ace4410ca56cb110a6fedd19"><div class="ttname"><a href="tomcrypt__private_8h.html#a8e30da64ace4410ca56cb110a6fedd19">mp_montgomery_normalization</a></div><div class="ttdeci">#define mp_montgomery_normalization(a, b)</div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt__private_8h_source.html#l00178">tomcrypt_private.h:178</a></div></div>
<div class="ttc" id="structltc__math__descriptor_html_a20678986df75fa338c4267c94b98ae68"><div class="ttname"><a href="structltc__math__descriptor.html#a20678986df75fa338c4267c94b98ae68">ltc_math_descriptor::ecc_ptadd</a></div><div class="ttdeci">int(* ecc_ptadd)(const ecc_point *P, const ecc_point *Q, ecc_point *R, void *ma, void *modulus, void *mp)</div><div class="ttdoc">ECC GF(p) point addition.</div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt__math_8h_source.html#l00399">tomcrypt_math.h:399</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="tomcrypt_8h_source.html#l00060">CRYPT_MEM</a>, <a class="el" href="tomcrypt_8h_source.html#l00042">CRYPT_OK</a>, <a class="el" href="tomcrypt__math_8h_source.html#l00399">ltc_math_descriptor::ecc_ptadd</a>, <a class="el" href="tomcrypt__math_8h_source.html#l00414">ltc_math_descriptor::ecc_ptdbl</a>, <a class="el" href="kseed_8c_source.html#l00184">G</a>, <a class="el" href="tomcrypt__argchk_8h_source.html#l00019">LTC_ARGCHK</a>, <a class="el" href="ltc__ecc__points_8c_source.html#l00058">ltc_ecc_copy_point()</a>, <a class="el" href="ltc__ecc__points_8c_source.html#l00040">ltc_ecc_del_point()</a>, <a class="el" href="ltc__ecc__is__point__at__infinity_8c_source.html#l00018">ltc_ecc_is_point_at_infinity()</a>, <a class="el" href="ltc__ecc__map_8c_source.html#l00026">ltc_ecc_map()</a>, <a class="el" href="ltc__ecc__points_8c_source.html#l00023">ltc_ecc_new_point()</a>, <a class="el" href="ltc__ecc__points_8c_source.html#l00049">ltc_ecc_set_point_xyz()</a>, <a class="el" href="crypt__ltc__mp__descriptor_8c_source.html#l00012">ltc_mp</a>, <a class="el" href="tomcrypt__math_8h_source.html#l00013">LTC_MP_EQ</a>, <a class="el" href="tomcrypt__private_8h_source.html#l00157">mp_add_d</a>, <a class="el" href="tomcrypt__private_8h_source.html#l00131">mp_clear</a>, <a class="el" href="tomcrypt__private_8h_source.html#l00144">mp_cmp</a>, <a class="el" href="tomcrypt__private_8h_source.html#l00126">MP_DIGIT_BIT</a>, <a class="el" href="tomcrypt__private_8h_source.html#l00142">mp_get_digit</a>, <a class="el" href="tomcrypt__private_8h_source.html#l00143">mp_get_digit_count</a>, <a class="el" href="tomcrypt__private_8h_source.html#l00129">mp_init</a>, <a class="el" href="tomcrypt__private_8h_source.html#l00180">mp_montgomery_free</a>, <a class="el" href="tomcrypt__private_8h_source.html#l00178">mp_montgomery_normalization</a>, <a class="el" href="tomcrypt__private_8h_source.html#l00177">mp_montgomery_setup</a>, <a class="el" href="tomcrypt__private_8h_source.html#l00173">mp_mulmod</a>, and <a class="el" href="khazad_8c_source.html#l00032">R</a>.</p>

<p class="reference">Referenced by <a class="el" href="ltc__ecc__verify__key_8c_source.html#l00022">ltc_ecc_verify_key()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="tomcrypt__private_8h_a818e5e4135d8aa58cf09e502e98ccc90_cgraph.png" border="0" usemap="#tomcrypt__private_8h_a818e5e4135d8aa58cf09e502e98ccc90_cgraph" alt=""/></div>
<!-- MAP 45 -->
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="tomcrypt__private_8h_a818e5e4135d8aa58cf09e502e98ccc90_icgraph.png" border="0" usemap="#tomcrypt__private_8h_a818e5e4135d8aa58cf09e502e98ccc90_icgraph" alt=""/></div>
<!-- MAP 46 -->
</div>

</div>
</div>
<a id="a532af6ef2d0f6d1d8cd79e5f81e87cf8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a532af6ef2d0f6d1d8cd79e5f81e87cf8">&#9670;&nbsp;</a></span>ltc_ecc_new_point()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="tomcrypt__math_8h.html#a2a6efaeaa795aa54274d7c4fd66b018a">ecc_point</a>* ltc_ecc_new_point </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Allocate a new ECC point. </p>
<dl class="section return"><dt>Returns</dt><dd>A newly allocated point or NULL on error </dd></dl>

<p class="definition">Definition at line <a class="el" href="ltc__ecc__points_8c_source.html#l00023">23</a> of file <a class="el" href="ltc__ecc__points_8c_source.html">ltc_ecc_points.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;{</div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;   <a class="code" href="tomcrypt__math_8h.html#a2a6efaeaa795aa54274d7c4fd66b018a">ecc_point</a> *p;</div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;   p = <a class="code" href="tomcrypt__cfg_8h.html#a151dda14cd7acae31eaf1102b0cc0685">XCALLOC</a>(1, <span class="keyword">sizeof</span>(*p));</div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;   <span class="keywordflow">if</span> (p == NULL) {</div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;      <span class="keywordflow">return</span> NULL;</div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;   }</div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="tomcrypt__private_8h.html#adb6322247b1a4f0347219acab3120bd3">mp_init_multi</a>(&amp;p-&gt;x, &amp;p-&gt;y, &amp;p-&gt;z, NULL) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>) {</div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;      <a class="code" href="tomcrypt__cfg_8h.html#a260d66fc0690e0502cf3bfe7b5244b75">XFREE</a>(p);</div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;      <span class="keywordflow">return</span> NULL;</div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;   }</div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;   <span class="keywordflow">return</span> p;</div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;}</div><div class="ttc" id="tomcrypt_8h_html_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334"><div class="ttname"><a href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a></div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt_8h_source.html#l00042">tomcrypt.h:42</a></div></div>
<div class="ttc" id="tomcrypt__cfg_8h_html_a260d66fc0690e0502cf3bfe7b5244b75"><div class="ttname"><a href="tomcrypt__cfg_8h.html#a260d66fc0690e0502cf3bfe7b5244b75">XFREE</a></div><div class="ttdeci">void XFREE(void *p)</div></div>
<div class="ttc" id="tomcrypt__private_8h_html_adb6322247b1a4f0347219acab3120bd3"><div class="ttname"><a href="tomcrypt__private_8h.html#adb6322247b1a4f0347219acab3120bd3">mp_init_multi</a></div><div class="ttdeci">#define mp_init_multi</div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt__private_8h_source.html#l00130">tomcrypt_private.h:130</a></div></div>
<div class="ttc" id="tomcrypt__math_8h_html_a2a6efaeaa795aa54274d7c4fd66b018a"><div class="ttname"><a href="tomcrypt__math_8h.html#a2a6efaeaa795aa54274d7c4fd66b018a">ecc_point</a></div><div class="ttdeci">void ecc_point</div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt__math_8h_source.html#l00020">tomcrypt_math.h:20</a></div></div>
<div class="ttc" id="tomcrypt__cfg_8h_html_a151dda14cd7acae31eaf1102b0cc0685"><div class="ttname"><a href="tomcrypt__cfg_8h.html#a151dda14cd7acae31eaf1102b0cc0685">XCALLOC</a></div><div class="ttdeci">void * XCALLOC(size_t n, size_t s)</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="tomcrypt_8h_source.html#l00042">CRYPT_OK</a>, <a class="el" href="tomcrypt__private_8h_source.html#l00130">mp_init_multi</a>, <a class="el" href="tomcrypt__cfg_8h.html#a151dda14cd7acae31eaf1102b0cc0685">XCALLOC()</a>, and <a class="el" href="tomcrypt__cfg_8h.html#a260d66fc0690e0502cf3bfe7b5244b75">XFREE()</a>.</p>

<p class="reference">Referenced by <a class="el" href="ecc__recover__key_8c_source.html#l00032">ecc_recover_key()</a>, <a class="el" href="ecc__shared__secret_8c_source.html#l00027">ecc_shared_secret()</a>, <a class="el" href="ecc__verify__hash_8c_source.html#l00030">ecc_verify_hash_ex()</a>, <a class="el" href="ltc__ecc__mul2add_8c_source.html#l00031">ltc_ecc_mul2add()</a>, <a class="el" href="ltc__ecc__mulmod__timing_8c_source.html#l00031">ltc_ecc_mulmod()</a>, and <a class="el" href="ltc__ecc__verify__key_8c_source.html#l00022">ltc_ecc_verify_key()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="tomcrypt__private_8h_a532af6ef2d0f6d1d8cd79e5f81e87cf8_cgraph.png" border="0" usemap="#tomcrypt__private_8h_a532af6ef2d0f6d1d8cd79e5f81e87cf8_cgraph" alt=""/></div>
<!-- MAP 47 -->
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="tomcrypt__private_8h_a532af6ef2d0f6d1d8cd79e5f81e87cf8_icgraph.png" border="0" usemap="#tomcrypt__private_8h_a532af6ef2d0f6d1d8cd79e5f81e87cf8_icgraph" alt=""/></div>
<!-- MAP 48 -->
</div>

</div>
</div>
<a id="a16f3ff8dd19aa2ccc2aab4024927bc93"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a16f3ff8dd19aa2ccc2aab4024927bc93">&#9670;&nbsp;</a></span>ltc_ecc_projective_add_point()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ltc_ecc_projective_add_point </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="tomcrypt__math_8h.html#a2a6efaeaa795aa54274d7c4fd66b018a">ecc_point</a> *&#160;</td>
          <td class="paramname"><em>P</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="tomcrypt__math_8h.html#a2a6efaeaa795aa54274d7c4fd66b018a">ecc_point</a> *&#160;</td>
          <td class="paramname"><em>Q</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="tomcrypt__math_8h.html#a2a6efaeaa795aa54274d7c4fd66b018a">ecc_point</a> *&#160;</td>
          <td class="paramname"><em>R</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>ma</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>modulus</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>mp</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Add two ECC points. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">P</td><td>The point to add </td></tr>
    <tr><td class="paramname">Q</td><td>The point to add </td></tr>
    <tr><td class="paramname">R</td><td>[out] The destination of the double </td></tr>
    <tr><td class="paramname">ma</td><td>ECC curve parameter a in montgomery form </td></tr>
    <tr><td class="paramname">modulus</td><td>The modulus of the field the ECC curve is in </td></tr>
    <tr><td class="paramname">mp</td><td>The "b" value from <a class="el" href="gmp__desc_8c.html#a771ef8a9d5b1b2633613bfad28b282c2">montgomery_setup()</a> </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>CRYPT_OK on success </dd></dl>

<p class="definition">Definition at line <a class="el" href="ltc__ecc__projective__add__point_8c_source.html#l00029">29</a> of file <a class="el" href="ltc__ecc__projective__add__point_8c_source.html">ltc_ecc_projective_add_point.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;{</div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;   <span class="keywordtype">void</span>  *<a class="code" href="tiger_8c.html#a65f7891fccbfcf7d08964555630773b3">t1</a>, *<a class="code" href="tiger_8c.html#aa4652e2d6053d420dcbea07a113db5fe">t2</a>, *x, *y, *z;</div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;   <span class="keywordtype">int</span>    err, inf;</div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;</div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;   <a class="code" href="tomcrypt__argchk_8h.html#a683da3e041e49f196318b6ea951414ba">LTC_ARGCHK</a>(P       != NULL);</div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;   <a class="code" href="tomcrypt__argchk_8h.html#a683da3e041e49f196318b6ea951414ba">LTC_ARGCHK</a>(Q       != NULL);</div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;   <a class="code" href="tomcrypt__argchk_8h.html#a683da3e041e49f196318b6ea951414ba">LTC_ARGCHK</a>(<a class="code" href="khazad_8c.html#a5c71a5e59a53413cd6c270266d63b031">R</a>       != NULL);</div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;   <a class="code" href="tomcrypt__argchk_8h.html#a683da3e041e49f196318b6ea951414ba">LTC_ARGCHK</a>(modulus != NULL);</div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;   <a class="code" href="tomcrypt__argchk_8h.html#a683da3e041e49f196318b6ea951414ba">LTC_ARGCHK</a>(mp      != NULL);</div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;</div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;   <span class="keywordflow">if</span> ((err = <a class="code" href="tomcrypt__private_8h.html#adb6322247b1a4f0347219acab3120bd3">mp_init_multi</a>(&amp;<a class="code" href="tiger_8c.html#a65f7891fccbfcf7d08964555630773b3">t1</a>, &amp;<a class="code" href="tiger_8c.html#aa4652e2d6053d420dcbea07a113db5fe">t2</a>, &amp;x, &amp;y, &amp;z, NULL)) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>) {</div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;      <span class="keywordflow">return</span> err;</div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;   }</div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;</div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;   <span class="keywordflow">if</span> ((err = <a class="code" href="tomcrypt__private_8h.html#a54a2d7d30af25ef341a8aca09269177d">ltc_ecc_is_point_at_infinity</a>(P, modulus, &amp;inf)) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>) <span class="keywordflow">return</span> err;</div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;   <span class="keywordflow">if</span> (inf) {</div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;      <span class="comment">/* P is point at infinity &gt;&gt; Result = Q */</span></div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;      err = <a class="code" href="tomcrypt__private_8h.html#a4b36b54e30a0a87aff57a936b386df7f">ltc_ecc_copy_point</a>(Q, <a class="code" href="khazad_8c.html#a5c71a5e59a53413cd6c270266d63b031">R</a>);</div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;      <span class="keywordflow">goto</span> done;</div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;   }</div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;</div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;   <span class="keywordflow">if</span> ((err = <a class="code" href="tomcrypt__private_8h.html#a54a2d7d30af25ef341a8aca09269177d">ltc_ecc_is_point_at_infinity</a>(Q, modulus, &amp;inf)) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>) <span class="keywordflow">return</span> err;</div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;   <span class="keywordflow">if</span> (inf) {</div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;      <span class="comment">/* Q is point at infinity &gt;&gt; Result = P */</span></div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;      err = <a class="code" href="tomcrypt__private_8h.html#a4b36b54e30a0a87aff57a936b386df7f">ltc_ecc_copy_point</a>(P, <a class="code" href="khazad_8c.html#a5c71a5e59a53413cd6c270266d63b031">R</a>);</div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;      <span class="keywordflow">goto</span> done;</div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;   }</div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;</div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;   <span class="keywordflow">if</span> ((<a class="code" href="tomcrypt__private_8h.html#a62ea02fbe7dd2d456e49520264d775ee">mp_cmp</a>(P-&gt;x, Q-&gt;x) == <a class="code" href="tomcrypt__math_8h.html#a035a31bde4f31419eb259e36e5776607">LTC_MP_EQ</a>) &amp;&amp; (<a class="code" href="tomcrypt__private_8h.html#a62ea02fbe7dd2d456e49520264d775ee">mp_cmp</a>(P-&gt;z, Q-&gt;z) == <a class="code" href="tomcrypt__math_8h.html#a035a31bde4f31419eb259e36e5776607">LTC_MP_EQ</a>)) {</div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="tomcrypt__private_8h.html#a62ea02fbe7dd2d456e49520264d775ee">mp_cmp</a>(P-&gt;y, Q-&gt;y) == <a class="code" href="tomcrypt__math_8h.html#a035a31bde4f31419eb259e36e5776607">LTC_MP_EQ</a>) {</div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;         <span class="comment">/* here P = Q &gt;&gt; Result = 2 * P (use doubling) */</span></div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;         <a class="code" href="tomcrypt__private_8h.html#aad5c8a3112b3e4613f9efc86692c43cb">mp_clear_multi</a>(<a class="code" href="tiger_8c.html#a65f7891fccbfcf7d08964555630773b3">t1</a>, <a class="code" href="tiger_8c.html#aa4652e2d6053d420dcbea07a113db5fe">t2</a>, x, y, z, NULL);</div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;         <span class="keywordflow">return</span> <a class="code" href="tomcrypt__private_8h.html#af9bdd0d8d602ef3b300b11d19d7bc33a">ltc_ecc_projective_dbl_point</a>(P, <a class="code" href="khazad_8c.html#a5c71a5e59a53413cd6c270266d63b031">R</a>, ma, modulus, mp);</div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;      }</div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;      <span class="keywordflow">if</span> ((err = <a class="code" href="tomcrypt__private_8h.html#ab8d0882c3b58263b638b41fbf110fde8">mp_sub</a>(modulus, Q-&gt;y, <a class="code" href="tiger_8c.html#a65f7891fccbfcf7d08964555630773b3">t1</a>)) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>)                       { <span class="keywordflow">goto</span> done; }</div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="tomcrypt__private_8h.html#a62ea02fbe7dd2d456e49520264d775ee">mp_cmp</a>(P-&gt;y, <a class="code" href="tiger_8c.html#a65f7891fccbfcf7d08964555630773b3">t1</a>) == <a class="code" href="tomcrypt__math_8h.html#a035a31bde4f31419eb259e36e5776607">LTC_MP_EQ</a>) {</div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;         <span class="comment">/* here Q = -P &gt;&gt;&gt; Result = the point at infinity */</span></div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;         err = <a class="code" href="tomcrypt__private_8h.html#adc0366a4a0c272b7594bcea0d8fe7ccb">ltc_ecc_set_point_xyz</a>(1, 1, 0, <a class="code" href="khazad_8c.html#a5c71a5e59a53413cd6c270266d63b031">R</a>);</div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;         <span class="keywordflow">goto</span> done;</div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;      }</div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;   }</div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;</div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;   <span class="keywordflow">if</span> ((err = <a class="code" href="tomcrypt__private_8h.html#afbb35bc8f920448d169ddc83a4308840">mp_copy</a>(P-&gt;x, x)) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>)                                   { <span class="keywordflow">goto</span> done; }</div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;   <span class="keywordflow">if</span> ((err = <a class="code" href="tomcrypt__private_8h.html#afbb35bc8f920448d169ddc83a4308840">mp_copy</a>(P-&gt;y, y)) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>)                                   { <span class="keywordflow">goto</span> done; }</div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;   <span class="keywordflow">if</span> ((err = <a class="code" href="tomcrypt__private_8h.html#afbb35bc8f920448d169ddc83a4308840">mp_copy</a>(P-&gt;z, z)) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>)                                   { <span class="keywordflow">goto</span> done; }</div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;   <span class="comment">/* if Z is one then these are no-operations */</span></div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;   <span class="keywordflow">if</span> (Q-&gt;z != NULL) {</div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;      <span class="comment">/* T1 = Z&#39; * Z&#39; */</span></div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;      <span class="keywordflow">if</span> ((err = <a class="code" href="tomcrypt__private_8h.html#aea81d79b5462e99068908d80edb8bd1a">mp_sqr</a>(Q-&gt;z, <a class="code" href="tiger_8c.html#a65f7891fccbfcf7d08964555630773b3">t1</a>)) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>)                                { <span class="keywordflow">goto</span> done; }</div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;      <span class="keywordflow">if</span> ((err = <a class="code" href="tomcrypt__private_8h.html#a4201ed2dbae154496e1a2ae9ba8aa7a8">mp_montgomery_reduce</a>(<a class="code" href="tiger_8c.html#a65f7891fccbfcf7d08964555630773b3">t1</a>, modulus, mp)) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>)           { <span class="keywordflow">goto</span> done; }</div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;      <span class="comment">/* X = X * T1 */</span></div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;      <span class="keywordflow">if</span> ((err = <a class="code" href="tomcrypt__private_8h.html#a7606d2423856b32b09245a2fa1ef34ee">mp_mul</a>(<a class="code" href="tiger_8c.html#a65f7891fccbfcf7d08964555630773b3">t1</a>, x, x)) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>)                                { <span class="keywordflow">goto</span> done; }</div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;      <span class="keywordflow">if</span> ((err = <a class="code" href="tomcrypt__private_8h.html#a4201ed2dbae154496e1a2ae9ba8aa7a8">mp_montgomery_reduce</a>(x, modulus, mp)) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>)            { <span class="keywordflow">goto</span> done; }</div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;      <span class="comment">/* T1 = Z&#39; * T1 */</span></div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;      <span class="keywordflow">if</span> ((err = <a class="code" href="tomcrypt__private_8h.html#a7606d2423856b32b09245a2fa1ef34ee">mp_mul</a>(Q-&gt;z, <a class="code" href="tiger_8c.html#a65f7891fccbfcf7d08964555630773b3">t1</a>, <a class="code" href="tiger_8c.html#a65f7891fccbfcf7d08964555630773b3">t1</a>)) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>)                            { <span class="keywordflow">goto</span> done; }</div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;      <span class="keywordflow">if</span> ((err = <a class="code" href="tomcrypt__private_8h.html#a4201ed2dbae154496e1a2ae9ba8aa7a8">mp_montgomery_reduce</a>(<a class="code" href="tiger_8c.html#a65f7891fccbfcf7d08964555630773b3">t1</a>, modulus, mp)) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>)           { <span class="keywordflow">goto</span> done; }</div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;      <span class="comment">/* Y = Y * T1 */</span></div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;      <span class="keywordflow">if</span> ((err = <a class="code" href="tomcrypt__private_8h.html#a7606d2423856b32b09245a2fa1ef34ee">mp_mul</a>(<a class="code" href="tiger_8c.html#a65f7891fccbfcf7d08964555630773b3">t1</a>, y, y)) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>)                                { <span class="keywordflow">goto</span> done; }</div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;      <span class="keywordflow">if</span> ((err = <a class="code" href="tomcrypt__private_8h.html#a4201ed2dbae154496e1a2ae9ba8aa7a8">mp_montgomery_reduce</a>(y, modulus, mp)) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>)            { <span class="keywordflow">goto</span> done; }</div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;   }</div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;</div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;   <span class="comment">/* T1 = Z*Z */</span></div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;   <span class="keywordflow">if</span> ((err = <a class="code" href="tomcrypt__private_8h.html#aea81d79b5462e99068908d80edb8bd1a">mp_sqr</a>(z, <a class="code" href="tiger_8c.html#a65f7891fccbfcf7d08964555630773b3">t1</a>)) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>)                                      { <span class="keywordflow">goto</span> done; }</div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;   <span class="keywordflow">if</span> ((err = <a class="code" href="tomcrypt__private_8h.html#a4201ed2dbae154496e1a2ae9ba8aa7a8">mp_montgomery_reduce</a>(<a class="code" href="tiger_8c.html#a65f7891fccbfcf7d08964555630773b3">t1</a>, modulus, mp)) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>)              { <span class="keywordflow">goto</span> done; }</div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;   <span class="comment">/* T2 = X&#39; * T1 */</span></div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;   <span class="keywordflow">if</span> ((err = <a class="code" href="tomcrypt__private_8h.html#a7606d2423856b32b09245a2fa1ef34ee">mp_mul</a>(Q-&gt;x, <a class="code" href="tiger_8c.html#a65f7891fccbfcf7d08964555630773b3">t1</a>, <a class="code" href="tiger_8c.html#aa4652e2d6053d420dcbea07a113db5fe">t2</a>)) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>)                               { <span class="keywordflow">goto</span> done; }</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;   <span class="keywordflow">if</span> ((err = <a class="code" href="tomcrypt__private_8h.html#a4201ed2dbae154496e1a2ae9ba8aa7a8">mp_montgomery_reduce</a>(<a class="code" href="tiger_8c.html#aa4652e2d6053d420dcbea07a113db5fe">t2</a>, modulus, mp)) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>)              { <span class="keywordflow">goto</span> done; }</div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;   <span class="comment">/* T1 = Z * T1 */</span></div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;   <span class="keywordflow">if</span> ((err = <a class="code" href="tomcrypt__private_8h.html#a7606d2423856b32b09245a2fa1ef34ee">mp_mul</a>(z, <a class="code" href="tiger_8c.html#a65f7891fccbfcf7d08964555630773b3">t1</a>, <a class="code" href="tiger_8c.html#a65f7891fccbfcf7d08964555630773b3">t1</a>)) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>)                                  { <span class="keywordflow">goto</span> done; }</div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;   <span class="keywordflow">if</span> ((err = <a class="code" href="tomcrypt__private_8h.html#a4201ed2dbae154496e1a2ae9ba8aa7a8">mp_montgomery_reduce</a>(<a class="code" href="tiger_8c.html#a65f7891fccbfcf7d08964555630773b3">t1</a>, modulus, mp)) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>)              { <span class="keywordflow">goto</span> done; }</div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;   <span class="comment">/* T1 = Y&#39; * T1 */</span></div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;   <span class="keywordflow">if</span> ((err = <a class="code" href="tomcrypt__private_8h.html#a7606d2423856b32b09245a2fa1ef34ee">mp_mul</a>(Q-&gt;y, <a class="code" href="tiger_8c.html#a65f7891fccbfcf7d08964555630773b3">t1</a>, <a class="code" href="tiger_8c.html#a65f7891fccbfcf7d08964555630773b3">t1</a>)) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>)                               { <span class="keywordflow">goto</span> done; }</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;   <span class="keywordflow">if</span> ((err = <a class="code" href="tomcrypt__private_8h.html#a4201ed2dbae154496e1a2ae9ba8aa7a8">mp_montgomery_reduce</a>(<a class="code" href="tiger_8c.html#a65f7891fccbfcf7d08964555630773b3">t1</a>, modulus, mp)) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>)              { <span class="keywordflow">goto</span> done; }</div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;</div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;   <span class="comment">/* Y = Y - T1 */</span></div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;   <span class="keywordflow">if</span> ((err = <a class="code" href="tomcrypt__private_8h.html#ab8d0882c3b58263b638b41fbf110fde8">mp_sub</a>(y, <a class="code" href="tiger_8c.html#a65f7891fccbfcf7d08964555630773b3">t1</a>, y)) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>)                                   { <span class="keywordflow">goto</span> done; }</div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="tomcrypt__private_8h.html#a6ce44f2e6f872565a468b67d9a93dc28">mp_cmp_d</a>(y, 0) == <a class="code" href="tomcrypt__math_8h.html#a42d0c7d4c09793df79660774d3436db2">LTC_MP_LT</a>) {</div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;      <span class="keywordflow">if</span> ((err = <a class="code" href="tomcrypt__private_8h.html#a175d04f8aeaa1c3895fe14de6cc0d2db">mp_add</a>(y, modulus, y)) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>)                           { <span class="keywordflow">goto</span> done; }</div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;   }</div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;   <span class="comment">/* T1 = 2T1 */</span></div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;   <span class="keywordflow">if</span> ((err = <a class="code" href="tomcrypt__private_8h.html#a175d04f8aeaa1c3895fe14de6cc0d2db">mp_add</a>(<a class="code" href="tiger_8c.html#a65f7891fccbfcf7d08964555630773b3">t1</a>, <a class="code" href="tiger_8c.html#a65f7891fccbfcf7d08964555630773b3">t1</a>, <a class="code" href="tiger_8c.html#a65f7891fccbfcf7d08964555630773b3">t1</a>)) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>)                                 { <span class="keywordflow">goto</span> done; }</div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="tomcrypt__private_8h.html#a62ea02fbe7dd2d456e49520264d775ee">mp_cmp</a>(<a class="code" href="tiger_8c.html#a65f7891fccbfcf7d08964555630773b3">t1</a>, modulus) != <a class="code" href="tomcrypt__math_8h.html#a42d0c7d4c09793df79660774d3436db2">LTC_MP_LT</a>) {</div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;      <span class="keywordflow">if</span> ((err = <a class="code" href="tomcrypt__private_8h.html#ab8d0882c3b58263b638b41fbf110fde8">mp_sub</a>(<a class="code" href="tiger_8c.html#a65f7891fccbfcf7d08964555630773b3">t1</a>, modulus, <a class="code" href="tiger_8c.html#a65f7891fccbfcf7d08964555630773b3">t1</a>)) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>)                         { <span class="keywordflow">goto</span> done; }</div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;   }</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;   <span class="comment">/* T1 = Y + T1 */</span></div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;   <span class="keywordflow">if</span> ((err = <a class="code" href="tomcrypt__private_8h.html#a175d04f8aeaa1c3895fe14de6cc0d2db">mp_add</a>(<a class="code" href="tiger_8c.html#a65f7891fccbfcf7d08964555630773b3">t1</a>, y, <a class="code" href="tiger_8c.html#a65f7891fccbfcf7d08964555630773b3">t1</a>)) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>)                                  { <span class="keywordflow">goto</span> done; }</div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="tomcrypt__private_8h.html#a62ea02fbe7dd2d456e49520264d775ee">mp_cmp</a>(<a class="code" href="tiger_8c.html#a65f7891fccbfcf7d08964555630773b3">t1</a>, modulus) != <a class="code" href="tomcrypt__math_8h.html#a42d0c7d4c09793df79660774d3436db2">LTC_MP_LT</a>) {</div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;      <span class="keywordflow">if</span> ((err = <a class="code" href="tomcrypt__private_8h.html#ab8d0882c3b58263b638b41fbf110fde8">mp_sub</a>(<a class="code" href="tiger_8c.html#a65f7891fccbfcf7d08964555630773b3">t1</a>, modulus, <a class="code" href="tiger_8c.html#a65f7891fccbfcf7d08964555630773b3">t1</a>)) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>)                         { <span class="keywordflow">goto</span> done; }</div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;   }</div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;   <span class="comment">/* X = X - T2 */</span></div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;   <span class="keywordflow">if</span> ((err = <a class="code" href="tomcrypt__private_8h.html#ab8d0882c3b58263b638b41fbf110fde8">mp_sub</a>(x, <a class="code" href="tiger_8c.html#aa4652e2d6053d420dcbea07a113db5fe">t2</a>, x)) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>)                                   { <span class="keywordflow">goto</span> done; }</div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="tomcrypt__private_8h.html#a6ce44f2e6f872565a468b67d9a93dc28">mp_cmp_d</a>(x, 0) == <a class="code" href="tomcrypt__math_8h.html#a42d0c7d4c09793df79660774d3436db2">LTC_MP_LT</a>) {</div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;      <span class="keywordflow">if</span> ((err = <a class="code" href="tomcrypt__private_8h.html#a175d04f8aeaa1c3895fe14de6cc0d2db">mp_add</a>(x, modulus, x)) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>)                           { <span class="keywordflow">goto</span> done; }</div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;   }</div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;   <span class="comment">/* T2 = 2T2 */</span></div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;   <span class="keywordflow">if</span> ((err = <a class="code" href="tomcrypt__private_8h.html#a175d04f8aeaa1c3895fe14de6cc0d2db">mp_add</a>(<a class="code" href="tiger_8c.html#aa4652e2d6053d420dcbea07a113db5fe">t2</a>, <a class="code" href="tiger_8c.html#aa4652e2d6053d420dcbea07a113db5fe">t2</a>, <a class="code" href="tiger_8c.html#aa4652e2d6053d420dcbea07a113db5fe">t2</a>)) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>)                                 { <span class="keywordflow">goto</span> done; }</div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="tomcrypt__private_8h.html#a62ea02fbe7dd2d456e49520264d775ee">mp_cmp</a>(<a class="code" href="tiger_8c.html#aa4652e2d6053d420dcbea07a113db5fe">t2</a>, modulus) != <a class="code" href="tomcrypt__math_8h.html#a42d0c7d4c09793df79660774d3436db2">LTC_MP_LT</a>) {</div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;      <span class="keywordflow">if</span> ((err = <a class="code" href="tomcrypt__private_8h.html#ab8d0882c3b58263b638b41fbf110fde8">mp_sub</a>(<a class="code" href="tiger_8c.html#aa4652e2d6053d420dcbea07a113db5fe">t2</a>, modulus, <a class="code" href="tiger_8c.html#aa4652e2d6053d420dcbea07a113db5fe">t2</a>)) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>)                         { <span class="keywordflow">goto</span> done; }</div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;   }</div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;   <span class="comment">/* T2 = X + T2 */</span></div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;   <span class="keywordflow">if</span> ((err = <a class="code" href="tomcrypt__private_8h.html#a175d04f8aeaa1c3895fe14de6cc0d2db">mp_add</a>(<a class="code" href="tiger_8c.html#aa4652e2d6053d420dcbea07a113db5fe">t2</a>, x, <a class="code" href="tiger_8c.html#aa4652e2d6053d420dcbea07a113db5fe">t2</a>)) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>)                                  { <span class="keywordflow">goto</span> done; }</div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="tomcrypt__private_8h.html#a62ea02fbe7dd2d456e49520264d775ee">mp_cmp</a>(<a class="code" href="tiger_8c.html#aa4652e2d6053d420dcbea07a113db5fe">t2</a>, modulus) != <a class="code" href="tomcrypt__math_8h.html#a42d0c7d4c09793df79660774d3436db2">LTC_MP_LT</a>) {</div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;      <span class="keywordflow">if</span> ((err = <a class="code" href="tomcrypt__private_8h.html#ab8d0882c3b58263b638b41fbf110fde8">mp_sub</a>(<a class="code" href="tiger_8c.html#aa4652e2d6053d420dcbea07a113db5fe">t2</a>, modulus, <a class="code" href="tiger_8c.html#aa4652e2d6053d420dcbea07a113db5fe">t2</a>)) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>)                         { <span class="keywordflow">goto</span> done; }</div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;   }</div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;</div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;   <span class="comment">/* if Z&#39; != 1 */</span></div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;   <span class="keywordflow">if</span> (Q-&gt;z != NULL) {</div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;      <span class="comment">/* Z = Z * Z&#39; */</span></div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;      <span class="keywordflow">if</span> ((err = <a class="code" href="tomcrypt__private_8h.html#a7606d2423856b32b09245a2fa1ef34ee">mp_mul</a>(z, Q-&gt;z, z)) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>)                              { <span class="keywordflow">goto</span> done; }</div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;      <span class="keywordflow">if</span> ((err = <a class="code" href="tomcrypt__private_8h.html#a4201ed2dbae154496e1a2ae9ba8aa7a8">mp_montgomery_reduce</a>(z, modulus, mp)) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>)            { <span class="keywordflow">goto</span> done; }</div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;   }</div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;</div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;   <span class="comment">/* Z = Z * X */</span></div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;   <span class="keywordflow">if</span> ((err = <a class="code" href="tomcrypt__private_8h.html#a7606d2423856b32b09245a2fa1ef34ee">mp_mul</a>(z, x, z)) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>)                                    { <span class="keywordflow">goto</span> done; }</div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;   <span class="keywordflow">if</span> ((err = <a class="code" href="tomcrypt__private_8h.html#a4201ed2dbae154496e1a2ae9ba8aa7a8">mp_montgomery_reduce</a>(z, modulus, mp)) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>)               { <span class="keywordflow">goto</span> done; }</div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;</div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;   <span class="comment">/* T1 = T1 * X  */</span></div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;   <span class="keywordflow">if</span> ((err = <a class="code" href="tomcrypt__private_8h.html#a7606d2423856b32b09245a2fa1ef34ee">mp_mul</a>(<a class="code" href="tiger_8c.html#a65f7891fccbfcf7d08964555630773b3">t1</a>, x, <a class="code" href="tiger_8c.html#a65f7891fccbfcf7d08964555630773b3">t1</a>)) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>)                                  { <span class="keywordflow">goto</span> done; }</div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;   <span class="keywordflow">if</span> ((err = <a class="code" href="tomcrypt__private_8h.html#a4201ed2dbae154496e1a2ae9ba8aa7a8">mp_montgomery_reduce</a>(<a class="code" href="tiger_8c.html#a65f7891fccbfcf7d08964555630773b3">t1</a>, modulus, mp)) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>)              { <span class="keywordflow">goto</span> done; }</div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;   <span class="comment">/* X = X * X */</span></div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;   <span class="keywordflow">if</span> ((err = <a class="code" href="tomcrypt__private_8h.html#aea81d79b5462e99068908d80edb8bd1a">mp_sqr</a>(x, x)) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>)                                       { <span class="keywordflow">goto</span> done; }</div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;   <span class="keywordflow">if</span> ((err = <a class="code" href="tomcrypt__private_8h.html#a4201ed2dbae154496e1a2ae9ba8aa7a8">mp_montgomery_reduce</a>(x, modulus, mp)) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>)               { <span class="keywordflow">goto</span> done; }</div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;   <span class="comment">/* T2 = T2 * x */</span></div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;   <span class="keywordflow">if</span> ((err = <a class="code" href="tomcrypt__private_8h.html#a7606d2423856b32b09245a2fa1ef34ee">mp_mul</a>(<a class="code" href="tiger_8c.html#aa4652e2d6053d420dcbea07a113db5fe">t2</a>, x, <a class="code" href="tiger_8c.html#aa4652e2d6053d420dcbea07a113db5fe">t2</a>)) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>)                                  { <span class="keywordflow">goto</span> done; }</div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;   <span class="keywordflow">if</span> ((err = <a class="code" href="tomcrypt__private_8h.html#a4201ed2dbae154496e1a2ae9ba8aa7a8">mp_montgomery_reduce</a>(<a class="code" href="tiger_8c.html#aa4652e2d6053d420dcbea07a113db5fe">t2</a>, modulus, mp)) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>)              { <span class="keywordflow">goto</span> done; }</div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;   <span class="comment">/* T1 = T1 * X  */</span></div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;   <span class="keywordflow">if</span> ((err = <a class="code" href="tomcrypt__private_8h.html#a7606d2423856b32b09245a2fa1ef34ee">mp_mul</a>(<a class="code" href="tiger_8c.html#a65f7891fccbfcf7d08964555630773b3">t1</a>, x, <a class="code" href="tiger_8c.html#a65f7891fccbfcf7d08964555630773b3">t1</a>)) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>)                                  { <span class="keywordflow">goto</span> done; }</div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;   <span class="keywordflow">if</span> ((err = <a class="code" href="tomcrypt__private_8h.html#a4201ed2dbae154496e1a2ae9ba8aa7a8">mp_montgomery_reduce</a>(<a class="code" href="tiger_8c.html#a65f7891fccbfcf7d08964555630773b3">t1</a>, modulus, mp)) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>)              { <span class="keywordflow">goto</span> done; }</div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;</div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;   <span class="comment">/* X = Y*Y */</span></div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;   <span class="keywordflow">if</span> ((err = <a class="code" href="tomcrypt__private_8h.html#aea81d79b5462e99068908d80edb8bd1a">mp_sqr</a>(y, x)) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>)                                       { <span class="keywordflow">goto</span> done; }</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;   <span class="keywordflow">if</span> ((err = <a class="code" href="tomcrypt__private_8h.html#a4201ed2dbae154496e1a2ae9ba8aa7a8">mp_montgomery_reduce</a>(x, modulus, mp)) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>)               { <span class="keywordflow">goto</span> done; }</div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;   <span class="comment">/* X = X - T2 */</span></div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;   <span class="keywordflow">if</span> ((err = <a class="code" href="tomcrypt__private_8h.html#ab8d0882c3b58263b638b41fbf110fde8">mp_sub</a>(x, <a class="code" href="tiger_8c.html#aa4652e2d6053d420dcbea07a113db5fe">t2</a>, x)) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>)                                   { <span class="keywordflow">goto</span> done; }</div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="tomcrypt__private_8h.html#a6ce44f2e6f872565a468b67d9a93dc28">mp_cmp_d</a>(x, 0) == <a class="code" href="tomcrypt__math_8h.html#a42d0c7d4c09793df79660774d3436db2">LTC_MP_LT</a>) {</div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;      <span class="keywordflow">if</span> ((err = <a class="code" href="tomcrypt__private_8h.html#a175d04f8aeaa1c3895fe14de6cc0d2db">mp_add</a>(x, modulus, x)) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>)                           { <span class="keywordflow">goto</span> done; }</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;   }</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;   <span class="comment">/* T2 = T2 - X */</span></div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;   <span class="keywordflow">if</span> ((err = <a class="code" href="tomcrypt__private_8h.html#ab8d0882c3b58263b638b41fbf110fde8">mp_sub</a>(<a class="code" href="tiger_8c.html#aa4652e2d6053d420dcbea07a113db5fe">t2</a>, x, <a class="code" href="tiger_8c.html#aa4652e2d6053d420dcbea07a113db5fe">t2</a>)) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>)                                  { <span class="keywordflow">goto</span> done; }</div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="tomcrypt__private_8h.html#a6ce44f2e6f872565a468b67d9a93dc28">mp_cmp_d</a>(<a class="code" href="tiger_8c.html#aa4652e2d6053d420dcbea07a113db5fe">t2</a>, 0) == <a class="code" href="tomcrypt__math_8h.html#a42d0c7d4c09793df79660774d3436db2">LTC_MP_LT</a>) {</div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;      <span class="keywordflow">if</span> ((err = <a class="code" href="tomcrypt__private_8h.html#a175d04f8aeaa1c3895fe14de6cc0d2db">mp_add</a>(<a class="code" href="tiger_8c.html#aa4652e2d6053d420dcbea07a113db5fe">t2</a>, modulus, <a class="code" href="tiger_8c.html#aa4652e2d6053d420dcbea07a113db5fe">t2</a>)) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>)                         { <span class="keywordflow">goto</span> done; }</div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;   }</div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;   <span class="comment">/* T2 = T2 - X */</span></div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;   <span class="keywordflow">if</span> ((err = <a class="code" href="tomcrypt__private_8h.html#ab8d0882c3b58263b638b41fbf110fde8">mp_sub</a>(<a class="code" href="tiger_8c.html#aa4652e2d6053d420dcbea07a113db5fe">t2</a>, x, <a class="code" href="tiger_8c.html#aa4652e2d6053d420dcbea07a113db5fe">t2</a>)) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>)                                  { <span class="keywordflow">goto</span> done; }</div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="tomcrypt__private_8h.html#a6ce44f2e6f872565a468b67d9a93dc28">mp_cmp_d</a>(<a class="code" href="tiger_8c.html#aa4652e2d6053d420dcbea07a113db5fe">t2</a>, 0) == <a class="code" href="tomcrypt__math_8h.html#a42d0c7d4c09793df79660774d3436db2">LTC_MP_LT</a>) {</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;      <span class="keywordflow">if</span> ((err = <a class="code" href="tomcrypt__private_8h.html#a175d04f8aeaa1c3895fe14de6cc0d2db">mp_add</a>(<a class="code" href="tiger_8c.html#aa4652e2d6053d420dcbea07a113db5fe">t2</a>, modulus, <a class="code" href="tiger_8c.html#aa4652e2d6053d420dcbea07a113db5fe">t2</a>)) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>)                         { <span class="keywordflow">goto</span> done; }</div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;   }</div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;   <span class="comment">/* T2 = T2 * Y */</span></div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;   <span class="keywordflow">if</span> ((err = <a class="code" href="tomcrypt__private_8h.html#a7606d2423856b32b09245a2fa1ef34ee">mp_mul</a>(<a class="code" href="tiger_8c.html#aa4652e2d6053d420dcbea07a113db5fe">t2</a>, y, <a class="code" href="tiger_8c.html#aa4652e2d6053d420dcbea07a113db5fe">t2</a>)) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>)                                  { <span class="keywordflow">goto</span> done; }</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;   <span class="keywordflow">if</span> ((err = <a class="code" href="tomcrypt__private_8h.html#a4201ed2dbae154496e1a2ae9ba8aa7a8">mp_montgomery_reduce</a>(<a class="code" href="tiger_8c.html#aa4652e2d6053d420dcbea07a113db5fe">t2</a>, modulus, mp)) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>)              { <span class="keywordflow">goto</span> done; }</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;   <span class="comment">/* Y = T2 - T1 */</span></div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;   <span class="keywordflow">if</span> ((err = <a class="code" href="tomcrypt__private_8h.html#ab8d0882c3b58263b638b41fbf110fde8">mp_sub</a>(<a class="code" href="tiger_8c.html#aa4652e2d6053d420dcbea07a113db5fe">t2</a>, <a class="code" href="tiger_8c.html#a65f7891fccbfcf7d08964555630773b3">t1</a>, y)) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>)                                  { <span class="keywordflow">goto</span> done; }</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="tomcrypt__private_8h.html#a6ce44f2e6f872565a468b67d9a93dc28">mp_cmp_d</a>(y, 0) == <a class="code" href="tomcrypt__math_8h.html#a42d0c7d4c09793df79660774d3436db2">LTC_MP_LT</a>) {</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;      <span class="keywordflow">if</span> ((err = <a class="code" href="tomcrypt__private_8h.html#a175d04f8aeaa1c3895fe14de6cc0d2db">mp_add</a>(y, modulus, y)) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>)                           { <span class="keywordflow">goto</span> done; }</div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;   }</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;   <span class="comment">/* Y = Y/2 */</span></div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="tomcrypt__private_8h.html#a93ed39c257831509afc74f2b6da66ae7">mp_isodd</a>(y)) {</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;      <span class="keywordflow">if</span> ((err = <a class="code" href="tomcrypt__private_8h.html#a175d04f8aeaa1c3895fe14de6cc0d2db">mp_add</a>(y, modulus, y)) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>)                           { <span class="keywordflow">goto</span> done; }</div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;   }</div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;   <span class="keywordflow">if</span> ((err = <a class="code" href="tomcrypt__private_8h.html#aec841464b436981f5758a49c561f39fe">mp_div_2</a>(y, y)) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>)                                     { <span class="keywordflow">goto</span> done; }</div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;</div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;   <span class="keywordflow">if</span> ((err = <a class="code" href="tomcrypt__private_8h.html#afbb35bc8f920448d169ddc83a4308840">mp_copy</a>(x, <a class="code" href="khazad_8c.html#a5c71a5e59a53413cd6c270266d63b031">R</a>-&gt;x)) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>)                                   { <span class="keywordflow">goto</span> done; }</div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;   <span class="keywordflow">if</span> ((err = <a class="code" href="tomcrypt__private_8h.html#afbb35bc8f920448d169ddc83a4308840">mp_copy</a>(y, <a class="code" href="khazad_8c.html#a5c71a5e59a53413cd6c270266d63b031">R</a>-&gt;y)) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>)                                   { <span class="keywordflow">goto</span> done; }</div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;   <span class="keywordflow">if</span> ((err = <a class="code" href="tomcrypt__private_8h.html#afbb35bc8f920448d169ddc83a4308840">mp_copy</a>(z, <a class="code" href="khazad_8c.html#a5c71a5e59a53413cd6c270266d63b031">R</a>-&gt;z)) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>)                                   { <span class="keywordflow">goto</span> done; }</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;   err = <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>;</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;done:</div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;   <a class="code" href="tomcrypt__private_8h.html#aad5c8a3112b3e4613f9efc86692c43cb">mp_clear_multi</a>(<a class="code" href="tiger_8c.html#a65f7891fccbfcf7d08964555630773b3">t1</a>, <a class="code" href="tiger_8c.html#aa4652e2d6053d420dcbea07a113db5fe">t2</a>, x, y, z, NULL);</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;   <span class="keywordflow">return</span> err;</div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;}</div><div class="ttc" id="tomcrypt_8h_html_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334"><div class="ttname"><a href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a></div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt_8h_source.html#l00042">tomcrypt.h:42</a></div></div>
<div class="ttc" id="tomcrypt__math_8h_html_a42d0c7d4c09793df79660774d3436db2"><div class="ttname"><a href="tomcrypt__math_8h.html#a42d0c7d4c09793df79660774d3436db2">LTC_MP_LT</a></div><div class="ttdeci">#define LTC_MP_LT</div><div class="ttdoc">math functions</div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt__math_8h_source.html#l00012">tomcrypt_math.h:12</a></div></div>
<div class="ttc" id="tomcrypt__private_8h_html_af9bdd0d8d602ef3b300b11d19d7bc33a"><div class="ttname"><a href="tomcrypt__private_8h.html#af9bdd0d8d602ef3b300b11d19d7bc33a">ltc_ecc_projective_dbl_point</a></div><div class="ttdeci">int ltc_ecc_projective_dbl_point(const ecc_point *P, ecc_point *R, void *ma, void *modulus, void *mp)</div><div class="ttdoc">Double an ECC point.</div><div class="ttdef"><b>Definition:</b> <a href="ltc__ecc__projective__dbl__point_8c_source.html#l00046">ltc_ecc_projective_dbl_point.c:46</a></div></div>
<div class="ttc" id="tomcrypt__argchk_8h_html_a683da3e041e49f196318b6ea951414ba"><div class="ttname"><a href="tomcrypt__argchk_8h.html#a683da3e041e49f196318b6ea951414ba">LTC_ARGCHK</a></div><div class="ttdeci">#define LTC_ARGCHK(x)</div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt__argchk_8h_source.html#l00019">tomcrypt_argchk.h:19</a></div></div>
<div class="ttc" id="tomcrypt__private_8h_html_a54a2d7d30af25ef341a8aca09269177d"><div class="ttname"><a href="tomcrypt__private_8h.html#a54a2d7d30af25ef341a8aca09269177d">ltc_ecc_is_point_at_infinity</a></div><div class="ttdeci">int ltc_ecc_is_point_at_infinity(const ecc_point *P, void *modulus, int *retval)</div><div class="ttdef"><b>Definition:</b> <a href="ltc__ecc__is__point__at__infinity_8c_source.html#l00018">ltc_ecc_is_point_at_infinity.c:18</a></div></div>
<div class="ttc" id="tiger_8c_html_aa4652e2d6053d420dcbea07a113db5fe"><div class="ttname"><a href="tiger_8c.html#aa4652e2d6053d420dcbea07a113db5fe">t2</a></div><div class="ttdeci">#define t2</div><div class="ttdef"><b>Definition:</b> <a href="tiger_8c_source.html#l00038">tiger.c:38</a></div></div>
<div class="ttc" id="tomcrypt__private_8h_html_aea81d79b5462e99068908d80edb8bd1a"><div class="ttname"><a href="tomcrypt__private_8h.html#aea81d79b5462e99068908d80edb8bd1a">mp_sqr</a></div><div class="ttdeci">#define mp_sqr(a, b)</div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt__private_8h_source.html#l00162">tomcrypt_private.h:162</a></div></div>
<div class="ttc" id="tomcrypt__private_8h_html_a4b36b54e30a0a87aff57a936b386df7f"><div class="ttname"><a href="tomcrypt__private_8h.html#a4b36b54e30a0a87aff57a936b386df7f">ltc_ecc_copy_point</a></div><div class="ttdeci">int ltc_ecc_copy_point(const ecc_point *src, ecc_point *dst)</div><div class="ttdef"><b>Definition:</b> <a href="ltc__ecc__points_8c_source.html#l00058">ltc_ecc_points.c:58</a></div></div>
<div class="ttc" id="tiger_8c_html_a65f7891fccbfcf7d08964555630773b3"><div class="ttname"><a href="tiger_8c.html#a65f7891fccbfcf7d08964555630773b3">t1</a></div><div class="ttdeci">#define t1</div><div class="ttdef"><b>Definition:</b> <a href="tiger_8c_source.html#l00037">tiger.c:37</a></div></div>
<div class="ttc" id="tomcrypt__private_8h_html_adc0366a4a0c272b7594bcea0d8fe7ccb"><div class="ttname"><a href="tomcrypt__private_8h.html#adc0366a4a0c272b7594bcea0d8fe7ccb">ltc_ecc_set_point_xyz</a></div><div class="ttdeci">int ltc_ecc_set_point_xyz(ltc_mp_digit x, ltc_mp_digit y, ltc_mp_digit z, ecc_point *p)</div><div class="ttdef"><b>Definition:</b> <a href="ltc__ecc__points_8c_source.html#l00049">ltc_ecc_points.c:49</a></div></div>
<div class="ttc" id="tomcrypt__private_8h_html_afbb35bc8f920448d169ddc83a4308840"><div class="ttname"><a href="tomcrypt__private_8h.html#afbb35bc8f920448d169ddc83a4308840">mp_copy</a></div><div class="ttdeci">#define mp_copy(a, b)</div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt__private_8h_source.html#l00137">tomcrypt_private.h:137</a></div></div>
<div class="ttc" id="tomcrypt__private_8h_html_aad5c8a3112b3e4613f9efc86692c43cb"><div class="ttname"><a href="tomcrypt__private_8h.html#aad5c8a3112b3e4613f9efc86692c43cb">mp_clear_multi</a></div><div class="ttdeci">#define mp_clear_multi</div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt__private_8h_source.html#l00132">tomcrypt_private.h:132</a></div></div>
<div class="ttc" id="tomcrypt__private_8h_html_a62ea02fbe7dd2d456e49520264d775ee"><div class="ttname"><a href="tomcrypt__private_8h.html#a62ea02fbe7dd2d456e49520264d775ee">mp_cmp</a></div><div class="ttdeci">#define mp_cmp(a, b)</div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt__private_8h_source.html#l00144">tomcrypt_private.h:144</a></div></div>
<div class="ttc" id="tomcrypt__math_8h_html_a035a31bde4f31419eb259e36e5776607"><div class="ttname"><a href="tomcrypt__math_8h.html#a035a31bde4f31419eb259e36e5776607">LTC_MP_EQ</a></div><div class="ttdeci">#define LTC_MP_EQ</div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt__math_8h_source.html#l00013">tomcrypt_math.h:13</a></div></div>
<div class="ttc" id="tomcrypt__private_8h_html_aec841464b436981f5758a49c561f39fe"><div class="ttname"><a href="tomcrypt__private_8h.html#aec841464b436981f5758a49c561f39fe">mp_div_2</a></div><div class="ttdeci">#define mp_div_2(a, b)</div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt__private_8h_source.html#l00165">tomcrypt_private.h:165</a></div></div>
<div class="ttc" id="tomcrypt__private_8h_html_adb6322247b1a4f0347219acab3120bd3"><div class="ttname"><a href="tomcrypt__private_8h.html#adb6322247b1a4f0347219acab3120bd3">mp_init_multi</a></div><div class="ttdeci">#define mp_init_multi</div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt__private_8h_source.html#l00130">tomcrypt_private.h:130</a></div></div>
<div class="ttc" id="tomcrypt__private_8h_html_a4201ed2dbae154496e1a2ae9ba8aa7a8"><div class="ttname"><a href="tomcrypt__private_8h.html#a4201ed2dbae154496e1a2ae9ba8aa7a8">mp_montgomery_reduce</a></div><div class="ttdeci">#define mp_montgomery_reduce(a, b, c)</div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt__private_8h_source.html#l00179">tomcrypt_private.h:179</a></div></div>
<div class="ttc" id="tomcrypt__private_8h_html_ab8d0882c3b58263b638b41fbf110fde8"><div class="ttname"><a href="tomcrypt__private_8h.html#ab8d0882c3b58263b638b41fbf110fde8">mp_sub</a></div><div class="ttdeci">#define mp_sub(a, b, c)</div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt__private_8h_source.html#l00158">tomcrypt_private.h:158</a></div></div>
<div class="ttc" id="tomcrypt__private_8h_html_a6ce44f2e6f872565a468b67d9a93dc28"><div class="ttname"><a href="tomcrypt__private_8h.html#a6ce44f2e6f872565a468b67d9a93dc28">mp_cmp_d</a></div><div class="ttdeci">#define mp_cmp_d(a, b)</div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt__private_8h_source.html#l00145">tomcrypt_private.h:145</a></div></div>
<div class="ttc" id="tomcrypt__private_8h_html_a175d04f8aeaa1c3895fe14de6cc0d2db"><div class="ttname"><a href="tomcrypt__private_8h.html#a175d04f8aeaa1c3895fe14de6cc0d2db">mp_add</a></div><div class="ttdeci">#define mp_add(a, b, c)</div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt__private_8h_source.html#l00156">tomcrypt_private.h:156</a></div></div>
<div class="ttc" id="khazad_8c_html_a5c71a5e59a53413cd6c270266d63b031"><div class="ttname"><a href="khazad_8c.html#a5c71a5e59a53413cd6c270266d63b031">R</a></div><div class="ttdeci">#define R</div><div class="ttdef"><b>Definition:</b> <a href="khazad_8c_source.html#l00032">khazad.c:32</a></div></div>
<div class="ttc" id="tomcrypt__private_8h_html_a7606d2423856b32b09245a2fa1ef34ee"><div class="ttname"><a href="tomcrypt__private_8h.html#a7606d2423856b32b09245a2fa1ef34ee">mp_mul</a></div><div class="ttdeci">#define mp_mul(a, b, c)</div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt__private_8h_source.html#l00160">tomcrypt_private.h:160</a></div></div>
<div class="ttc" id="tomcrypt__private_8h_html_a93ed39c257831509afc74f2b6da66ae7"><div class="ttname"><a href="tomcrypt__private_8h.html#a93ed39c257831509afc74f2b6da66ae7">mp_isodd</a></div><div class="ttdeci">#define mp_isodd(a)</div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt__private_8h_source.html#l00186">tomcrypt_private.h:186</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="tomcrypt_8h_source.html#l00042">CRYPT_OK</a>, <a class="el" href="tomcrypt__argchk_8h_source.html#l00019">LTC_ARGCHK</a>, <a class="el" href="ltc__ecc__points_8c_source.html#l00058">ltc_ecc_copy_point()</a>, <a class="el" href="ltc__ecc__is__point__at__infinity_8c_source.html#l00018">ltc_ecc_is_point_at_infinity()</a>, <a class="el" href="ltc__ecc__projective__dbl__point_8c_source.html#l00046">ltc_ecc_projective_dbl_point()</a>, <a class="el" href="ltc__ecc__points_8c_source.html#l00049">ltc_ecc_set_point_xyz()</a>, <a class="el" href="tomcrypt__math_8h_source.html#l00013">LTC_MP_EQ</a>, <a class="el" href="tomcrypt__math_8h_source.html#l00012">LTC_MP_LT</a>, <a class="el" href="tomcrypt__private_8h_source.html#l00156">mp_add</a>, <a class="el" href="tomcrypt__private_8h_source.html#l00132">mp_clear_multi</a>, <a class="el" href="tomcrypt__private_8h_source.html#l00144">mp_cmp</a>, <a class="el" href="tomcrypt__private_8h_source.html#l00145">mp_cmp_d</a>, <a class="el" href="tomcrypt__private_8h_source.html#l00137">mp_copy</a>, <a class="el" href="tomcrypt__private_8h_source.html#l00165">mp_div_2</a>, <a class="el" href="tomcrypt__private_8h_source.html#l00130">mp_init_multi</a>, <a class="el" href="tomcrypt__private_8h_source.html#l00186">mp_isodd</a>, <a class="el" href="tomcrypt__private_8h_source.html#l00179">mp_montgomery_reduce</a>, <a class="el" href="tomcrypt__private_8h_source.html#l00160">mp_mul</a>, <a class="el" href="tomcrypt__private_8h_source.html#l00162">mp_sqr</a>, <a class="el" href="tomcrypt__private_8h_source.html#l00158">mp_sub</a>, <a class="el" href="khazad_8c_source.html#l00032">R</a>, <a class="el" href="tiger_8c_source.html#l00037">t1</a>, and <a class="el" href="tiger_8c_source.html#l00038">t2</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="tomcrypt__private_8h_a16f3ff8dd19aa2ccc2aab4024927bc93_cgraph.png" border="0" usemap="#tomcrypt__private_8h_a16f3ff8dd19aa2ccc2aab4024927bc93_cgraph" alt=""/></div>
<!-- MAP 49 -->
</div>

</div>
</div>
<a id="af9bdd0d8d602ef3b300b11d19d7bc33a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af9bdd0d8d602ef3b300b11d19d7bc33a">&#9670;&nbsp;</a></span>ltc_ecc_projective_dbl_point()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ltc_ecc_projective_dbl_point </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="tomcrypt__math_8h.html#a2a6efaeaa795aa54274d7c4fd66b018a">ecc_point</a> *&#160;</td>
          <td class="paramname"><em>P</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="tomcrypt__math_8h.html#a2a6efaeaa795aa54274d7c4fd66b018a">ecc_point</a> *&#160;</td>
          <td class="paramname"><em>R</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>ma</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>modulus</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>mp</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Double an ECC point. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">P</td><td>The point to double </td></tr>
    <tr><td class="paramname">R</td><td>[out] The destination of the double </td></tr>
    <tr><td class="paramname">ma</td><td>ECC curve parameter a in montgomery form </td></tr>
    <tr><td class="paramname">modulus</td><td>The modulus of the field the ECC curve is in </td></tr>
    <tr><td class="paramname">mp</td><td>The "b" value from <a class="el" href="gmp__desc_8c.html#a771ef8a9d5b1b2633613bfad28b282c2">montgomery_setup()</a> </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>CRYPT_OK on success </dd></dl>

<p class="definition">Definition at line <a class="el" href="ltc__ecc__projective__dbl__point_8c_source.html#l00046">46</a> of file <a class="el" href="ltc__ecc__projective__dbl__point_8c_source.html">ltc_ecc_projective_dbl_point.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;{</div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;   <span class="keywordtype">void</span> *<a class="code" href="tiger_8c.html#a65f7891fccbfcf7d08964555630773b3">t1</a>, *<a class="code" href="tiger_8c.html#aa4652e2d6053d420dcbea07a113db5fe">t2</a>;</div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;   <span class="keywordtype">int</span>   err, inf;</div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;</div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;   <a class="code" href="tomcrypt__argchk_8h.html#a683da3e041e49f196318b6ea951414ba">LTC_ARGCHK</a>(P       != NULL);</div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;   <a class="code" href="tomcrypt__argchk_8h.html#a683da3e041e49f196318b6ea951414ba">LTC_ARGCHK</a>(<a class="code" href="khazad_8c.html#a5c71a5e59a53413cd6c270266d63b031">R</a>       != NULL);</div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;   <a class="code" href="tomcrypt__argchk_8h.html#a683da3e041e49f196318b6ea951414ba">LTC_ARGCHK</a>(modulus != NULL);</div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;   <a class="code" href="tomcrypt__argchk_8h.html#a683da3e041e49f196318b6ea951414ba">LTC_ARGCHK</a>(mp      != NULL);</div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;</div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;   <span class="keywordflow">if</span> ((err = <a class="code" href="tomcrypt__private_8h.html#adb6322247b1a4f0347219acab3120bd3">mp_init_multi</a>(&amp;<a class="code" href="tiger_8c.html#a65f7891fccbfcf7d08964555630773b3">t1</a>, &amp;<a class="code" href="tiger_8c.html#aa4652e2d6053d420dcbea07a113db5fe">t2</a>, NULL)) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>) {</div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;      <span class="keywordflow">return</span> err;</div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;   }</div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;</div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;   <span class="keywordflow">if</span> (P != <a class="code" href="khazad_8c.html#a5c71a5e59a53413cd6c270266d63b031">R</a>) {</div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;      <span class="keywordflow">if</span> ((err = <a class="code" href="tomcrypt__private_8h.html#a4b36b54e30a0a87aff57a936b386df7f">ltc_ecc_copy_point</a>(P, <a class="code" href="khazad_8c.html#a5c71a5e59a53413cd6c270266d63b031">R</a>)) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>)                           { <span class="keywordflow">goto</span> done; }</div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;   }</div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;</div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;   <span class="keywordflow">if</span> ((err = <a class="code" href="tomcrypt__private_8h.html#a54a2d7d30af25ef341a8aca09269177d">ltc_ecc_is_point_at_infinity</a>(P, modulus, &amp;inf)) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>) <span class="keywordflow">return</span> err;</div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;   <span class="keywordflow">if</span> (inf) {</div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;      <span class="comment">/* if P is point at infinity &gt;&gt; Result = point at infinity */</span></div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;      err = <a class="code" href="tomcrypt__private_8h.html#adc0366a4a0c272b7594bcea0d8fe7ccb">ltc_ecc_set_point_xyz</a>(1, 1, 0, <a class="code" href="khazad_8c.html#a5c71a5e59a53413cd6c270266d63b031">R</a>);</div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;      <span class="keywordflow">goto</span> done;</div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;   }</div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;</div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;   <span class="comment">/* t1 = Z * Z */</span></div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;   <span class="keywordflow">if</span> ((err = <a class="code" href="tomcrypt__private_8h.html#aea81d79b5462e99068908d80edb8bd1a">mp_sqr</a>(<a class="code" href="khazad_8c.html#a5c71a5e59a53413cd6c270266d63b031">R</a>-&gt;z, <a class="code" href="tiger_8c.html#a65f7891fccbfcf7d08964555630773b3">t1</a>)) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>)                                      { <span class="keywordflow">goto</span> done; }</div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;   <span class="keywordflow">if</span> ((err = <a class="code" href="tomcrypt__private_8h.html#a4201ed2dbae154496e1a2ae9ba8aa7a8">mp_montgomery_reduce</a>(<a class="code" href="tiger_8c.html#a65f7891fccbfcf7d08964555630773b3">t1</a>, modulus, mp)) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>)                 { <span class="keywordflow">goto</span> done; }</div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;   <span class="comment">/* Z = Y * Z */</span></div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;   <span class="keywordflow">if</span> ((err = <a class="code" href="tomcrypt__private_8h.html#a7606d2423856b32b09245a2fa1ef34ee">mp_mul</a>(<a class="code" href="khazad_8c.html#a5c71a5e59a53413cd6c270266d63b031">R</a>-&gt;z, <a class="code" href="khazad_8c.html#a5c71a5e59a53413cd6c270266d63b031">R</a>-&gt;y, <a class="code" href="khazad_8c.html#a5c71a5e59a53413cd6c270266d63b031">R</a>-&gt;z)) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>)                              { <span class="keywordflow">goto</span> done; }</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;   <span class="keywordflow">if</span> ((err = <a class="code" href="tomcrypt__private_8h.html#a4201ed2dbae154496e1a2ae9ba8aa7a8">mp_montgomery_reduce</a>(<a class="code" href="khazad_8c.html#a5c71a5e59a53413cd6c270266d63b031">R</a>-&gt;z, modulus, mp)) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>)               { <span class="keywordflow">goto</span> done; }</div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;   <span class="comment">/* Z = 2Z */</span></div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;   <span class="keywordflow">if</span> ((err = <a class="code" href="tomcrypt__private_8h.html#a175d04f8aeaa1c3895fe14de6cc0d2db">mp_add</a>(<a class="code" href="khazad_8c.html#a5c71a5e59a53413cd6c270266d63b031">R</a>-&gt;z, <a class="code" href="khazad_8c.html#a5c71a5e59a53413cd6c270266d63b031">R</a>-&gt;z, <a class="code" href="khazad_8c.html#a5c71a5e59a53413cd6c270266d63b031">R</a>-&gt;z)) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>)                              { <span class="keywordflow">goto</span> done; }</div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="tomcrypt__private_8h.html#a62ea02fbe7dd2d456e49520264d775ee">mp_cmp</a>(<a class="code" href="khazad_8c.html#a5c71a5e59a53413cd6c270266d63b031">R</a>-&gt;z, modulus) != <a class="code" href="tomcrypt__math_8h.html#a42d0c7d4c09793df79660774d3436db2">LTC_MP_LT</a>) {</div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;      <span class="keywordflow">if</span> ((err = <a class="code" href="tomcrypt__private_8h.html#ab8d0882c3b58263b638b41fbf110fde8">mp_sub</a>(<a class="code" href="khazad_8c.html#a5c71a5e59a53413cd6c270266d63b031">R</a>-&gt;z, modulus, <a class="code" href="khazad_8c.html#a5c71a5e59a53413cd6c270266d63b031">R</a>-&gt;z)) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>)                        { <span class="keywordflow">goto</span> done; }</div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;   }</div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;</div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;   <span class="keywordflow">if</span> (ma == NULL) { <span class="comment">/* special case for curves with a == -3 (10% faster than general case) */</span></div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;      <span class="comment">/* T2 = X - T1 */</span></div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;      <span class="keywordflow">if</span> ((err = <a class="code" href="tomcrypt__private_8h.html#ab8d0882c3b58263b638b41fbf110fde8">mp_sub</a>(<a class="code" href="khazad_8c.html#a5c71a5e59a53413cd6c270266d63b031">R</a>-&gt;x, <a class="code" href="tiger_8c.html#a65f7891fccbfcf7d08964555630773b3">t1</a>, <a class="code" href="tiger_8c.html#aa4652e2d6053d420dcbea07a113db5fe">t2</a>)) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>)                               { <span class="keywordflow">goto</span> done; }</div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="tomcrypt__private_8h.html#a6ce44f2e6f872565a468b67d9a93dc28">mp_cmp_d</a>(<a class="code" href="tiger_8c.html#aa4652e2d6053d420dcbea07a113db5fe">t2</a>, 0) == <a class="code" href="tomcrypt__math_8h.html#a42d0c7d4c09793df79660774d3436db2">LTC_MP_LT</a>) {</div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;         <span class="keywordflow">if</span> ((err = <a class="code" href="tomcrypt__private_8h.html#a175d04f8aeaa1c3895fe14de6cc0d2db">mp_add</a>(<a class="code" href="tiger_8c.html#aa4652e2d6053d420dcbea07a113db5fe">t2</a>, modulus, <a class="code" href="tiger_8c.html#aa4652e2d6053d420dcbea07a113db5fe">t2</a>)) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>)                         { <span class="keywordflow">goto</span> done; }</div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;      }</div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;      <span class="comment">/* T1 = X + T1 */</span></div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;      <span class="keywordflow">if</span> ((err = <a class="code" href="tomcrypt__private_8h.html#a175d04f8aeaa1c3895fe14de6cc0d2db">mp_add</a>(<a class="code" href="tiger_8c.html#a65f7891fccbfcf7d08964555630773b3">t1</a>, <a class="code" href="khazad_8c.html#a5c71a5e59a53413cd6c270266d63b031">R</a>-&gt;x, <a class="code" href="tiger_8c.html#a65f7891fccbfcf7d08964555630773b3">t1</a>)) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>)                               { <span class="keywordflow">goto</span> done; }</div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="tomcrypt__private_8h.html#a62ea02fbe7dd2d456e49520264d775ee">mp_cmp</a>(<a class="code" href="tiger_8c.html#a65f7891fccbfcf7d08964555630773b3">t1</a>, modulus) != <a class="code" href="tomcrypt__math_8h.html#a42d0c7d4c09793df79660774d3436db2">LTC_MP_LT</a>) {</div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;         <span class="keywordflow">if</span> ((err = <a class="code" href="tomcrypt__private_8h.html#ab8d0882c3b58263b638b41fbf110fde8">mp_sub</a>(<a class="code" href="tiger_8c.html#a65f7891fccbfcf7d08964555630773b3">t1</a>, modulus, <a class="code" href="tiger_8c.html#a65f7891fccbfcf7d08964555630773b3">t1</a>)) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>)                         { <span class="keywordflow">goto</span> done; }</div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;      }</div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;      <span class="comment">/* T2 = T1 * T2 */</span></div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;      <span class="keywordflow">if</span> ((err = <a class="code" href="tomcrypt__private_8h.html#a7606d2423856b32b09245a2fa1ef34ee">mp_mul</a>(<a class="code" href="tiger_8c.html#a65f7891fccbfcf7d08964555630773b3">t1</a>, <a class="code" href="tiger_8c.html#aa4652e2d6053d420dcbea07a113db5fe">t2</a>, <a class="code" href="tiger_8c.html#aa4652e2d6053d420dcbea07a113db5fe">t2</a>)) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>)                                 { <span class="keywordflow">goto</span> done; }</div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;      <span class="keywordflow">if</span> ((err = <a class="code" href="tomcrypt__private_8h.html#a4201ed2dbae154496e1a2ae9ba8aa7a8">mp_montgomery_reduce</a>(<a class="code" href="tiger_8c.html#aa4652e2d6053d420dcbea07a113db5fe">t2</a>, modulus, mp)) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>)              { <span class="keywordflow">goto</span> done; }</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;      <span class="comment">/* T1 = 2T2 */</span></div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;      <span class="keywordflow">if</span> ((err = <a class="code" href="tomcrypt__private_8h.html#a175d04f8aeaa1c3895fe14de6cc0d2db">mp_add</a>(<a class="code" href="tiger_8c.html#aa4652e2d6053d420dcbea07a113db5fe">t2</a>, <a class="code" href="tiger_8c.html#aa4652e2d6053d420dcbea07a113db5fe">t2</a>, <a class="code" href="tiger_8c.html#a65f7891fccbfcf7d08964555630773b3">t1</a>)) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>)                                 { <span class="keywordflow">goto</span> done; }</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="tomcrypt__private_8h.html#a62ea02fbe7dd2d456e49520264d775ee">mp_cmp</a>(<a class="code" href="tiger_8c.html#a65f7891fccbfcf7d08964555630773b3">t1</a>, modulus) != <a class="code" href="tomcrypt__math_8h.html#a42d0c7d4c09793df79660774d3436db2">LTC_MP_LT</a>) {</div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;         <span class="keywordflow">if</span> ((err = <a class="code" href="tomcrypt__private_8h.html#ab8d0882c3b58263b638b41fbf110fde8">mp_sub</a>(<a class="code" href="tiger_8c.html#a65f7891fccbfcf7d08964555630773b3">t1</a>, modulus, <a class="code" href="tiger_8c.html#a65f7891fccbfcf7d08964555630773b3">t1</a>)) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>)                         { <span class="keywordflow">goto</span> done; }</div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;      }</div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;      <span class="comment">/* T1 = T1 + T2 */</span></div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;      <span class="keywordflow">if</span> ((err = <a class="code" href="tomcrypt__private_8h.html#a175d04f8aeaa1c3895fe14de6cc0d2db">mp_add</a>(<a class="code" href="tiger_8c.html#a65f7891fccbfcf7d08964555630773b3">t1</a>, <a class="code" href="tiger_8c.html#aa4652e2d6053d420dcbea07a113db5fe">t2</a>, <a class="code" href="tiger_8c.html#a65f7891fccbfcf7d08964555630773b3">t1</a>)) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>)                                 { <span class="keywordflow">goto</span> done; }</div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="tomcrypt__private_8h.html#a62ea02fbe7dd2d456e49520264d775ee">mp_cmp</a>(<a class="code" href="tiger_8c.html#a65f7891fccbfcf7d08964555630773b3">t1</a>, modulus) != <a class="code" href="tomcrypt__math_8h.html#a42d0c7d4c09793df79660774d3436db2">LTC_MP_LT</a>) {</div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;         <span class="keywordflow">if</span> ((err = <a class="code" href="tomcrypt__private_8h.html#ab8d0882c3b58263b638b41fbf110fde8">mp_sub</a>(<a class="code" href="tiger_8c.html#a65f7891fccbfcf7d08964555630773b3">t1</a>, modulus, <a class="code" href="tiger_8c.html#a65f7891fccbfcf7d08964555630773b3">t1</a>)) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>)                         { <span class="keywordflow">goto</span> done; }</div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;      }</div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;   }</div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;   <span class="keywordflow">else</span> {</div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;      <span class="comment">/* T2 = T1 * T1 */</span></div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;      <span class="keywordflow">if</span> ((err = <a class="code" href="tomcrypt__private_8h.html#aea81d79b5462e99068908d80edb8bd1a">mp_sqr</a>(<a class="code" href="tiger_8c.html#a65f7891fccbfcf7d08964555630773b3">t1</a>, <a class="code" href="tiger_8c.html#aa4652e2d6053d420dcbea07a113db5fe">t2</a>)) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>)                                     { <span class="keywordflow">goto</span> done; }</div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;      <span class="keywordflow">if</span> ((err = <a class="code" href="tomcrypt__private_8h.html#a4201ed2dbae154496e1a2ae9ba8aa7a8">mp_montgomery_reduce</a>(<a class="code" href="tiger_8c.html#aa4652e2d6053d420dcbea07a113db5fe">t2</a>, modulus, mp)) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>)              { <span class="keywordflow">goto</span> done; }</div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;      <span class="comment">/* T1 = T2 * a */</span></div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;      <span class="keywordflow">if</span> ((err = <a class="code" href="tomcrypt__private_8h.html#a7606d2423856b32b09245a2fa1ef34ee">mp_mul</a>(<a class="code" href="tiger_8c.html#aa4652e2d6053d420dcbea07a113db5fe">t2</a>, ma, <a class="code" href="tiger_8c.html#a65f7891fccbfcf7d08964555630773b3">t1</a>)) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>)                                 { <span class="keywordflow">goto</span> done; }</div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;      <span class="keywordflow">if</span> ((err = <a class="code" href="tomcrypt__private_8h.html#a4201ed2dbae154496e1a2ae9ba8aa7a8">mp_montgomery_reduce</a>(<a class="code" href="tiger_8c.html#a65f7891fccbfcf7d08964555630773b3">t1</a>, modulus, mp)) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>)              { <span class="keywordflow">goto</span> done; }</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;      <span class="comment">/* T2 = X * X */</span></div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;      <span class="keywordflow">if</span> ((err = <a class="code" href="tomcrypt__private_8h.html#aea81d79b5462e99068908d80edb8bd1a">mp_sqr</a>(<a class="code" href="khazad_8c.html#a5c71a5e59a53413cd6c270266d63b031">R</a>-&gt;x, <a class="code" href="tiger_8c.html#aa4652e2d6053d420dcbea07a113db5fe">t2</a>)) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>)                                   { <span class="keywordflow">goto</span> done; }</div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;      <span class="keywordflow">if</span> ((err = <a class="code" href="tomcrypt__private_8h.html#a4201ed2dbae154496e1a2ae9ba8aa7a8">mp_montgomery_reduce</a>(<a class="code" href="tiger_8c.html#aa4652e2d6053d420dcbea07a113db5fe">t2</a>, modulus, mp)) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>)              { <span class="keywordflow">goto</span> done; }</div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;      <span class="comment">/* T1 = T2 + T1 */</span></div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;      <span class="keywordflow">if</span> ((err = <a class="code" href="tomcrypt__private_8h.html#a175d04f8aeaa1c3895fe14de6cc0d2db">mp_add</a>(<a class="code" href="tiger_8c.html#a65f7891fccbfcf7d08964555630773b3">t1</a>, <a class="code" href="tiger_8c.html#aa4652e2d6053d420dcbea07a113db5fe">t2</a>, <a class="code" href="tiger_8c.html#a65f7891fccbfcf7d08964555630773b3">t1</a>)) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>)                                 { <span class="keywordflow">goto</span> done; }</div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="tomcrypt__private_8h.html#a62ea02fbe7dd2d456e49520264d775ee">mp_cmp</a>(<a class="code" href="tiger_8c.html#a65f7891fccbfcf7d08964555630773b3">t1</a>, modulus) != <a class="code" href="tomcrypt__math_8h.html#a42d0c7d4c09793df79660774d3436db2">LTC_MP_LT</a>) {</div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;         <span class="keywordflow">if</span> ((err = <a class="code" href="tomcrypt__private_8h.html#ab8d0882c3b58263b638b41fbf110fde8">mp_sub</a>(<a class="code" href="tiger_8c.html#a65f7891fccbfcf7d08964555630773b3">t1</a>, modulus, <a class="code" href="tiger_8c.html#a65f7891fccbfcf7d08964555630773b3">t1</a>)) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>)                         { <span class="keywordflow">goto</span> done; }</div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;      }</div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;      <span class="comment">/* T1 = T2 + T1 */</span></div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;      <span class="keywordflow">if</span> ((err = <a class="code" href="tomcrypt__private_8h.html#a175d04f8aeaa1c3895fe14de6cc0d2db">mp_add</a>(<a class="code" href="tiger_8c.html#a65f7891fccbfcf7d08964555630773b3">t1</a>, <a class="code" href="tiger_8c.html#aa4652e2d6053d420dcbea07a113db5fe">t2</a>, <a class="code" href="tiger_8c.html#a65f7891fccbfcf7d08964555630773b3">t1</a>)) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>)                                 { <span class="keywordflow">goto</span> done; }</div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="tomcrypt__private_8h.html#a62ea02fbe7dd2d456e49520264d775ee">mp_cmp</a>(<a class="code" href="tiger_8c.html#a65f7891fccbfcf7d08964555630773b3">t1</a>, modulus) != <a class="code" href="tomcrypt__math_8h.html#a42d0c7d4c09793df79660774d3436db2">LTC_MP_LT</a>) {</div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;         <span class="keywordflow">if</span> ((err = <a class="code" href="tomcrypt__private_8h.html#ab8d0882c3b58263b638b41fbf110fde8">mp_sub</a>(<a class="code" href="tiger_8c.html#a65f7891fccbfcf7d08964555630773b3">t1</a>, modulus, <a class="code" href="tiger_8c.html#a65f7891fccbfcf7d08964555630773b3">t1</a>)) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>)                         { <span class="keywordflow">goto</span> done; }</div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;      }</div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;      <span class="comment">/* T1 = T2 + T1 */</span></div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;      <span class="keywordflow">if</span> ((err = <a class="code" href="tomcrypt__private_8h.html#a175d04f8aeaa1c3895fe14de6cc0d2db">mp_add</a>(<a class="code" href="tiger_8c.html#a65f7891fccbfcf7d08964555630773b3">t1</a>, <a class="code" href="tiger_8c.html#aa4652e2d6053d420dcbea07a113db5fe">t2</a>, <a class="code" href="tiger_8c.html#a65f7891fccbfcf7d08964555630773b3">t1</a>)) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>)                                 { <span class="keywordflow">goto</span> done; }</div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="tomcrypt__private_8h.html#a62ea02fbe7dd2d456e49520264d775ee">mp_cmp</a>(<a class="code" href="tiger_8c.html#a65f7891fccbfcf7d08964555630773b3">t1</a>, modulus) != <a class="code" href="tomcrypt__math_8h.html#a42d0c7d4c09793df79660774d3436db2">LTC_MP_LT</a>) {</div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;         <span class="keywordflow">if</span> ((err = <a class="code" href="tomcrypt__private_8h.html#ab8d0882c3b58263b638b41fbf110fde8">mp_sub</a>(<a class="code" href="tiger_8c.html#a65f7891fccbfcf7d08964555630773b3">t1</a>, modulus, <a class="code" href="tiger_8c.html#a65f7891fccbfcf7d08964555630773b3">t1</a>)) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>)                         { <span class="keywordflow">goto</span> done; }</div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;      }</div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;   }</div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;</div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;   <span class="comment">/* Y = 2Y */</span></div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;   <span class="keywordflow">if</span> ((err = <a class="code" href="tomcrypt__private_8h.html#a175d04f8aeaa1c3895fe14de6cc0d2db">mp_add</a>(<a class="code" href="khazad_8c.html#a5c71a5e59a53413cd6c270266d63b031">R</a>-&gt;y, <a class="code" href="khazad_8c.html#a5c71a5e59a53413cd6c270266d63b031">R</a>-&gt;y, <a class="code" href="khazad_8c.html#a5c71a5e59a53413cd6c270266d63b031">R</a>-&gt;y)) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>)                              { <span class="keywordflow">goto</span> done; }</div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="tomcrypt__private_8h.html#a62ea02fbe7dd2d456e49520264d775ee">mp_cmp</a>(<a class="code" href="khazad_8c.html#a5c71a5e59a53413cd6c270266d63b031">R</a>-&gt;y, modulus) != <a class="code" href="tomcrypt__math_8h.html#a42d0c7d4c09793df79660774d3436db2">LTC_MP_LT</a>) {</div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;      <span class="keywordflow">if</span> ((err = <a class="code" href="tomcrypt__private_8h.html#ab8d0882c3b58263b638b41fbf110fde8">mp_sub</a>(<a class="code" href="khazad_8c.html#a5c71a5e59a53413cd6c270266d63b031">R</a>-&gt;y, modulus, <a class="code" href="khazad_8c.html#a5c71a5e59a53413cd6c270266d63b031">R</a>-&gt;y)) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>)                        { <span class="keywordflow">goto</span> done; }</div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;   }</div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;   <span class="comment">/* Y = Y * Y */</span></div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;   <span class="keywordflow">if</span> ((err = <a class="code" href="tomcrypt__private_8h.html#aea81d79b5462e99068908d80edb8bd1a">mp_sqr</a>(<a class="code" href="khazad_8c.html#a5c71a5e59a53413cd6c270266d63b031">R</a>-&gt;y, <a class="code" href="khazad_8c.html#a5c71a5e59a53413cd6c270266d63b031">R</a>-&gt;y)) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>)                                    { <span class="keywordflow">goto</span> done; }</div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;   <span class="keywordflow">if</span> ((err = <a class="code" href="tomcrypt__private_8h.html#a4201ed2dbae154496e1a2ae9ba8aa7a8">mp_montgomery_reduce</a>(<a class="code" href="khazad_8c.html#a5c71a5e59a53413cd6c270266d63b031">R</a>-&gt;y, modulus, mp)) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>)               { <span class="keywordflow">goto</span> done; }</div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;   <span class="comment">/* T2 = Y * Y */</span></div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;   <span class="keywordflow">if</span> ((err = <a class="code" href="tomcrypt__private_8h.html#aea81d79b5462e99068908d80edb8bd1a">mp_sqr</a>(<a class="code" href="khazad_8c.html#a5c71a5e59a53413cd6c270266d63b031">R</a>-&gt;y, <a class="code" href="tiger_8c.html#aa4652e2d6053d420dcbea07a113db5fe">t2</a>)) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>)                                      { <span class="keywordflow">goto</span> done; }</div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;   <span class="keywordflow">if</span> ((err = <a class="code" href="tomcrypt__private_8h.html#a4201ed2dbae154496e1a2ae9ba8aa7a8">mp_montgomery_reduce</a>(<a class="code" href="tiger_8c.html#aa4652e2d6053d420dcbea07a113db5fe">t2</a>, modulus, mp)) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>)                 { <span class="keywordflow">goto</span> done; }</div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;   <span class="comment">/* T2 = T2/2 */</span></div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="tomcrypt__private_8h.html#a93ed39c257831509afc74f2b6da66ae7">mp_isodd</a>(<a class="code" href="tiger_8c.html#aa4652e2d6053d420dcbea07a113db5fe">t2</a>)) {</div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;      <span class="keywordflow">if</span> ((err = <a class="code" href="tomcrypt__private_8h.html#a175d04f8aeaa1c3895fe14de6cc0d2db">mp_add</a>(<a class="code" href="tiger_8c.html#aa4652e2d6053d420dcbea07a113db5fe">t2</a>, modulus, <a class="code" href="tiger_8c.html#aa4652e2d6053d420dcbea07a113db5fe">t2</a>)) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>)                            { <span class="keywordflow">goto</span> done; }</div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;   }</div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;   <span class="keywordflow">if</span> ((err = <a class="code" href="tomcrypt__private_8h.html#aec841464b436981f5758a49c561f39fe">mp_div_2</a>(<a class="code" href="tiger_8c.html#aa4652e2d6053d420dcbea07a113db5fe">t2</a>, <a class="code" href="tiger_8c.html#aa4652e2d6053d420dcbea07a113db5fe">t2</a>)) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>)                                      { <span class="keywordflow">goto</span> done; }</div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;   <span class="comment">/* Y = Y * X */</span></div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;   <span class="keywordflow">if</span> ((err = <a class="code" href="tomcrypt__private_8h.html#a7606d2423856b32b09245a2fa1ef34ee">mp_mul</a>(<a class="code" href="khazad_8c.html#a5c71a5e59a53413cd6c270266d63b031">R</a>-&gt;y, <a class="code" href="khazad_8c.html#a5c71a5e59a53413cd6c270266d63b031">R</a>-&gt;x, <a class="code" href="khazad_8c.html#a5c71a5e59a53413cd6c270266d63b031">R</a>-&gt;y)) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>)                              { <span class="keywordflow">goto</span> done; }</div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;   <span class="keywordflow">if</span> ((err = <a class="code" href="tomcrypt__private_8h.html#a4201ed2dbae154496e1a2ae9ba8aa7a8">mp_montgomery_reduce</a>(<a class="code" href="khazad_8c.html#a5c71a5e59a53413cd6c270266d63b031">R</a>-&gt;y, modulus, mp)) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>)               { <span class="keywordflow">goto</span> done; }</div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;</div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;   <span class="comment">/* X  = T1 * T1 */</span></div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;   <span class="keywordflow">if</span> ((err = <a class="code" href="tomcrypt__private_8h.html#aea81d79b5462e99068908d80edb8bd1a">mp_sqr</a>(<a class="code" href="tiger_8c.html#a65f7891fccbfcf7d08964555630773b3">t1</a>, <a class="code" href="khazad_8c.html#a5c71a5e59a53413cd6c270266d63b031">R</a>-&gt;x)) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>)                                      { <span class="keywordflow">goto</span> done; }</div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;   <span class="keywordflow">if</span> ((err = <a class="code" href="tomcrypt__private_8h.html#a4201ed2dbae154496e1a2ae9ba8aa7a8">mp_montgomery_reduce</a>(<a class="code" href="khazad_8c.html#a5c71a5e59a53413cd6c270266d63b031">R</a>-&gt;x, modulus, mp)) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>)               { <span class="keywordflow">goto</span> done; }</div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;   <span class="comment">/* X = X - Y */</span></div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;   <span class="keywordflow">if</span> ((err = <a class="code" href="tomcrypt__private_8h.html#ab8d0882c3b58263b638b41fbf110fde8">mp_sub</a>(<a class="code" href="khazad_8c.html#a5c71a5e59a53413cd6c270266d63b031">R</a>-&gt;x, <a class="code" href="khazad_8c.html#a5c71a5e59a53413cd6c270266d63b031">R</a>-&gt;y, <a class="code" href="khazad_8c.html#a5c71a5e59a53413cd6c270266d63b031">R</a>-&gt;x)) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>)                              { <span class="keywordflow">goto</span> done; }</div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="tomcrypt__private_8h.html#a6ce44f2e6f872565a468b67d9a93dc28">mp_cmp_d</a>(<a class="code" href="khazad_8c.html#a5c71a5e59a53413cd6c270266d63b031">R</a>-&gt;x, 0) == <a class="code" href="tomcrypt__math_8h.html#a42d0c7d4c09793df79660774d3436db2">LTC_MP_LT</a>) {</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;      <span class="keywordflow">if</span> ((err = <a class="code" href="tomcrypt__private_8h.html#a175d04f8aeaa1c3895fe14de6cc0d2db">mp_add</a>(<a class="code" href="khazad_8c.html#a5c71a5e59a53413cd6c270266d63b031">R</a>-&gt;x, modulus, <a class="code" href="khazad_8c.html#a5c71a5e59a53413cd6c270266d63b031">R</a>-&gt;x)) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>)                        { <span class="keywordflow">goto</span> done; }</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;   }</div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;   <span class="comment">/* X = X - Y */</span></div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;   <span class="keywordflow">if</span> ((err = <a class="code" href="tomcrypt__private_8h.html#ab8d0882c3b58263b638b41fbf110fde8">mp_sub</a>(<a class="code" href="khazad_8c.html#a5c71a5e59a53413cd6c270266d63b031">R</a>-&gt;x, <a class="code" href="khazad_8c.html#a5c71a5e59a53413cd6c270266d63b031">R</a>-&gt;y, <a class="code" href="khazad_8c.html#a5c71a5e59a53413cd6c270266d63b031">R</a>-&gt;x)) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>)                              { <span class="keywordflow">goto</span> done; }</div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="tomcrypt__private_8h.html#a6ce44f2e6f872565a468b67d9a93dc28">mp_cmp_d</a>(<a class="code" href="khazad_8c.html#a5c71a5e59a53413cd6c270266d63b031">R</a>-&gt;x, 0) == <a class="code" href="tomcrypt__math_8h.html#a42d0c7d4c09793df79660774d3436db2">LTC_MP_LT</a>) {</div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;      <span class="keywordflow">if</span> ((err = <a class="code" href="tomcrypt__private_8h.html#a175d04f8aeaa1c3895fe14de6cc0d2db">mp_add</a>(<a class="code" href="khazad_8c.html#a5c71a5e59a53413cd6c270266d63b031">R</a>-&gt;x, modulus, <a class="code" href="khazad_8c.html#a5c71a5e59a53413cd6c270266d63b031">R</a>-&gt;x)) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>)                        { <span class="keywordflow">goto</span> done; }</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;   }</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;   <span class="comment">/* Y = Y - X */</span></div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;   <span class="keywordflow">if</span> ((err = <a class="code" href="tomcrypt__private_8h.html#ab8d0882c3b58263b638b41fbf110fde8">mp_sub</a>(<a class="code" href="khazad_8c.html#a5c71a5e59a53413cd6c270266d63b031">R</a>-&gt;y, <a class="code" href="khazad_8c.html#a5c71a5e59a53413cd6c270266d63b031">R</a>-&gt;x, <a class="code" href="khazad_8c.html#a5c71a5e59a53413cd6c270266d63b031">R</a>-&gt;y)) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>)                              { <span class="keywordflow">goto</span> done; }</div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="tomcrypt__private_8h.html#a6ce44f2e6f872565a468b67d9a93dc28">mp_cmp_d</a>(<a class="code" href="khazad_8c.html#a5c71a5e59a53413cd6c270266d63b031">R</a>-&gt;y, 0) == <a class="code" href="tomcrypt__math_8h.html#a42d0c7d4c09793df79660774d3436db2">LTC_MP_LT</a>) {</div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;      <span class="keywordflow">if</span> ((err = <a class="code" href="tomcrypt__private_8h.html#a175d04f8aeaa1c3895fe14de6cc0d2db">mp_add</a>(<a class="code" href="khazad_8c.html#a5c71a5e59a53413cd6c270266d63b031">R</a>-&gt;y, modulus, <a class="code" href="khazad_8c.html#a5c71a5e59a53413cd6c270266d63b031">R</a>-&gt;y)) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>)                        { <span class="keywordflow">goto</span> done; }</div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;   }</div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;   <span class="comment">/* Y = Y * T1 */</span></div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;   <span class="keywordflow">if</span> ((err = <a class="code" href="tomcrypt__private_8h.html#a7606d2423856b32b09245a2fa1ef34ee">mp_mul</a>(<a class="code" href="khazad_8c.html#a5c71a5e59a53413cd6c270266d63b031">R</a>-&gt;y, <a class="code" href="tiger_8c.html#a65f7891fccbfcf7d08964555630773b3">t1</a>, <a class="code" href="khazad_8c.html#a5c71a5e59a53413cd6c270266d63b031">R</a>-&gt;y)) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>)                                { <span class="keywordflow">goto</span> done; }</div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;   <span class="keywordflow">if</span> ((err = <a class="code" href="tomcrypt__private_8h.html#a4201ed2dbae154496e1a2ae9ba8aa7a8">mp_montgomery_reduce</a>(<a class="code" href="khazad_8c.html#a5c71a5e59a53413cd6c270266d63b031">R</a>-&gt;y, modulus, mp)) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>)               { <span class="keywordflow">goto</span> done; }</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;   <span class="comment">/* Y = Y - T2 */</span></div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;   <span class="keywordflow">if</span> ((err = <a class="code" href="tomcrypt__private_8h.html#ab8d0882c3b58263b638b41fbf110fde8">mp_sub</a>(<a class="code" href="khazad_8c.html#a5c71a5e59a53413cd6c270266d63b031">R</a>-&gt;y, <a class="code" href="tiger_8c.html#aa4652e2d6053d420dcbea07a113db5fe">t2</a>, <a class="code" href="khazad_8c.html#a5c71a5e59a53413cd6c270266d63b031">R</a>-&gt;y)) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>)                                { <span class="keywordflow">goto</span> done; }</div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="tomcrypt__private_8h.html#a6ce44f2e6f872565a468b67d9a93dc28">mp_cmp_d</a>(<a class="code" href="khazad_8c.html#a5c71a5e59a53413cd6c270266d63b031">R</a>-&gt;y, 0) == <a class="code" href="tomcrypt__math_8h.html#a42d0c7d4c09793df79660774d3436db2">LTC_MP_LT</a>) {</div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;      <span class="keywordflow">if</span> ((err = <a class="code" href="tomcrypt__private_8h.html#a175d04f8aeaa1c3895fe14de6cc0d2db">mp_add</a>(<a class="code" href="khazad_8c.html#a5c71a5e59a53413cd6c270266d63b031">R</a>-&gt;y, modulus, <a class="code" href="khazad_8c.html#a5c71a5e59a53413cd6c270266d63b031">R</a>-&gt;y)) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>)                        { <span class="keywordflow">goto</span> done; }</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;   }</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;   err = <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>;</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;done:</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;   <a class="code" href="tomcrypt__private_8h.html#aad5c8a3112b3e4613f9efc86692c43cb">mp_clear_multi</a>(<a class="code" href="tiger_8c.html#aa4652e2d6053d420dcbea07a113db5fe">t2</a>, <a class="code" href="tiger_8c.html#a65f7891fccbfcf7d08964555630773b3">t1</a>, NULL);</div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;   <span class="keywordflow">return</span> err;</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;}</div><div class="ttc" id="tomcrypt_8h_html_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334"><div class="ttname"><a href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a></div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt_8h_source.html#l00042">tomcrypt.h:42</a></div></div>
<div class="ttc" id="tomcrypt__math_8h_html_a42d0c7d4c09793df79660774d3436db2"><div class="ttname"><a href="tomcrypt__math_8h.html#a42d0c7d4c09793df79660774d3436db2">LTC_MP_LT</a></div><div class="ttdeci">#define LTC_MP_LT</div><div class="ttdoc">math functions</div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt__math_8h_source.html#l00012">tomcrypt_math.h:12</a></div></div>
<div class="ttc" id="tomcrypt__argchk_8h_html_a683da3e041e49f196318b6ea951414ba"><div class="ttname"><a href="tomcrypt__argchk_8h.html#a683da3e041e49f196318b6ea951414ba">LTC_ARGCHK</a></div><div class="ttdeci">#define LTC_ARGCHK(x)</div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt__argchk_8h_source.html#l00019">tomcrypt_argchk.h:19</a></div></div>
<div class="ttc" id="tomcrypt__private_8h_html_a54a2d7d30af25ef341a8aca09269177d"><div class="ttname"><a href="tomcrypt__private_8h.html#a54a2d7d30af25ef341a8aca09269177d">ltc_ecc_is_point_at_infinity</a></div><div class="ttdeci">int ltc_ecc_is_point_at_infinity(const ecc_point *P, void *modulus, int *retval)</div><div class="ttdef"><b>Definition:</b> <a href="ltc__ecc__is__point__at__infinity_8c_source.html#l00018">ltc_ecc_is_point_at_infinity.c:18</a></div></div>
<div class="ttc" id="tiger_8c_html_aa4652e2d6053d420dcbea07a113db5fe"><div class="ttname"><a href="tiger_8c.html#aa4652e2d6053d420dcbea07a113db5fe">t2</a></div><div class="ttdeci">#define t2</div><div class="ttdef"><b>Definition:</b> <a href="tiger_8c_source.html#l00038">tiger.c:38</a></div></div>
<div class="ttc" id="tomcrypt__private_8h_html_aea81d79b5462e99068908d80edb8bd1a"><div class="ttname"><a href="tomcrypt__private_8h.html#aea81d79b5462e99068908d80edb8bd1a">mp_sqr</a></div><div class="ttdeci">#define mp_sqr(a, b)</div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt__private_8h_source.html#l00162">tomcrypt_private.h:162</a></div></div>
<div class="ttc" id="tomcrypt__private_8h_html_a4b36b54e30a0a87aff57a936b386df7f"><div class="ttname"><a href="tomcrypt__private_8h.html#a4b36b54e30a0a87aff57a936b386df7f">ltc_ecc_copy_point</a></div><div class="ttdeci">int ltc_ecc_copy_point(const ecc_point *src, ecc_point *dst)</div><div class="ttdef"><b>Definition:</b> <a href="ltc__ecc__points_8c_source.html#l00058">ltc_ecc_points.c:58</a></div></div>
<div class="ttc" id="tiger_8c_html_a65f7891fccbfcf7d08964555630773b3"><div class="ttname"><a href="tiger_8c.html#a65f7891fccbfcf7d08964555630773b3">t1</a></div><div class="ttdeci">#define t1</div><div class="ttdef"><b>Definition:</b> <a href="tiger_8c_source.html#l00037">tiger.c:37</a></div></div>
<div class="ttc" id="tomcrypt__private_8h_html_adc0366a4a0c272b7594bcea0d8fe7ccb"><div class="ttname"><a href="tomcrypt__private_8h.html#adc0366a4a0c272b7594bcea0d8fe7ccb">ltc_ecc_set_point_xyz</a></div><div class="ttdeci">int ltc_ecc_set_point_xyz(ltc_mp_digit x, ltc_mp_digit y, ltc_mp_digit z, ecc_point *p)</div><div class="ttdef"><b>Definition:</b> <a href="ltc__ecc__points_8c_source.html#l00049">ltc_ecc_points.c:49</a></div></div>
<div class="ttc" id="tomcrypt__private_8h_html_aad5c8a3112b3e4613f9efc86692c43cb"><div class="ttname"><a href="tomcrypt__private_8h.html#aad5c8a3112b3e4613f9efc86692c43cb">mp_clear_multi</a></div><div class="ttdeci">#define mp_clear_multi</div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt__private_8h_source.html#l00132">tomcrypt_private.h:132</a></div></div>
<div class="ttc" id="tomcrypt__private_8h_html_a62ea02fbe7dd2d456e49520264d775ee"><div class="ttname"><a href="tomcrypt__private_8h.html#a62ea02fbe7dd2d456e49520264d775ee">mp_cmp</a></div><div class="ttdeci">#define mp_cmp(a, b)</div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt__private_8h_source.html#l00144">tomcrypt_private.h:144</a></div></div>
<div class="ttc" id="tomcrypt__private_8h_html_aec841464b436981f5758a49c561f39fe"><div class="ttname"><a href="tomcrypt__private_8h.html#aec841464b436981f5758a49c561f39fe">mp_div_2</a></div><div class="ttdeci">#define mp_div_2(a, b)</div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt__private_8h_source.html#l00165">tomcrypt_private.h:165</a></div></div>
<div class="ttc" id="tomcrypt__private_8h_html_adb6322247b1a4f0347219acab3120bd3"><div class="ttname"><a href="tomcrypt__private_8h.html#adb6322247b1a4f0347219acab3120bd3">mp_init_multi</a></div><div class="ttdeci">#define mp_init_multi</div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt__private_8h_source.html#l00130">tomcrypt_private.h:130</a></div></div>
<div class="ttc" id="tomcrypt__private_8h_html_a4201ed2dbae154496e1a2ae9ba8aa7a8"><div class="ttname"><a href="tomcrypt__private_8h.html#a4201ed2dbae154496e1a2ae9ba8aa7a8">mp_montgomery_reduce</a></div><div class="ttdeci">#define mp_montgomery_reduce(a, b, c)</div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt__private_8h_source.html#l00179">tomcrypt_private.h:179</a></div></div>
<div class="ttc" id="tomcrypt__private_8h_html_ab8d0882c3b58263b638b41fbf110fde8"><div class="ttname"><a href="tomcrypt__private_8h.html#ab8d0882c3b58263b638b41fbf110fde8">mp_sub</a></div><div class="ttdeci">#define mp_sub(a, b, c)</div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt__private_8h_source.html#l00158">tomcrypt_private.h:158</a></div></div>
<div class="ttc" id="tomcrypt__private_8h_html_a6ce44f2e6f872565a468b67d9a93dc28"><div class="ttname"><a href="tomcrypt__private_8h.html#a6ce44f2e6f872565a468b67d9a93dc28">mp_cmp_d</a></div><div class="ttdeci">#define mp_cmp_d(a, b)</div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt__private_8h_source.html#l00145">tomcrypt_private.h:145</a></div></div>
<div class="ttc" id="tomcrypt__private_8h_html_a175d04f8aeaa1c3895fe14de6cc0d2db"><div class="ttname"><a href="tomcrypt__private_8h.html#a175d04f8aeaa1c3895fe14de6cc0d2db">mp_add</a></div><div class="ttdeci">#define mp_add(a, b, c)</div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt__private_8h_source.html#l00156">tomcrypt_private.h:156</a></div></div>
<div class="ttc" id="khazad_8c_html_a5c71a5e59a53413cd6c270266d63b031"><div class="ttname"><a href="khazad_8c.html#a5c71a5e59a53413cd6c270266d63b031">R</a></div><div class="ttdeci">#define R</div><div class="ttdef"><b>Definition:</b> <a href="khazad_8c_source.html#l00032">khazad.c:32</a></div></div>
<div class="ttc" id="tomcrypt__private_8h_html_a7606d2423856b32b09245a2fa1ef34ee"><div class="ttname"><a href="tomcrypt__private_8h.html#a7606d2423856b32b09245a2fa1ef34ee">mp_mul</a></div><div class="ttdeci">#define mp_mul(a, b, c)</div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt__private_8h_source.html#l00160">tomcrypt_private.h:160</a></div></div>
<div class="ttc" id="tomcrypt__private_8h_html_a93ed39c257831509afc74f2b6da66ae7"><div class="ttname"><a href="tomcrypt__private_8h.html#a93ed39c257831509afc74f2b6da66ae7">mp_isodd</a></div><div class="ttdeci">#define mp_isodd(a)</div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt__private_8h_source.html#l00186">tomcrypt_private.h:186</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="tomcrypt_8h_source.html#l00042">CRYPT_OK</a>, <a class="el" href="tomcrypt__argchk_8h_source.html#l00019">LTC_ARGCHK</a>, <a class="el" href="ltc__ecc__points_8c_source.html#l00058">ltc_ecc_copy_point()</a>, <a class="el" href="ltc__ecc__is__point__at__infinity_8c_source.html#l00018">ltc_ecc_is_point_at_infinity()</a>, <a class="el" href="ltc__ecc__points_8c_source.html#l00049">ltc_ecc_set_point_xyz()</a>, <a class="el" href="tomcrypt__math_8h_source.html#l00012">LTC_MP_LT</a>, <a class="el" href="tomcrypt__private_8h_source.html#l00156">mp_add</a>, <a class="el" href="tomcrypt__private_8h_source.html#l00132">mp_clear_multi</a>, <a class="el" href="tomcrypt__private_8h_source.html#l00144">mp_cmp</a>, <a class="el" href="tomcrypt__private_8h_source.html#l00145">mp_cmp_d</a>, <a class="el" href="tomcrypt__private_8h_source.html#l00165">mp_div_2</a>, <a class="el" href="tomcrypt__private_8h_source.html#l00130">mp_init_multi</a>, <a class="el" href="tomcrypt__private_8h_source.html#l00186">mp_isodd</a>, <a class="el" href="tomcrypt__private_8h_source.html#l00179">mp_montgomery_reduce</a>, <a class="el" href="tomcrypt__private_8h_source.html#l00160">mp_mul</a>, <a class="el" href="tomcrypt__private_8h_source.html#l00162">mp_sqr</a>, <a class="el" href="tomcrypt__private_8h_source.html#l00158">mp_sub</a>, <a class="el" href="khazad_8c_source.html#l00032">R</a>, <a class="el" href="tiger_8c_source.html#l00037">t1</a>, and <a class="el" href="tiger_8c_source.html#l00038">t2</a>.</p>

<p class="reference">Referenced by <a class="el" href="ltc__ecc__projective__add__point_8c_source.html#l00029">ltc_ecc_projective_add_point()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="tomcrypt__private_8h_af9bdd0d8d602ef3b300b11d19d7bc33a_cgraph.png" border="0" usemap="#tomcrypt__private_8h_af9bdd0d8d602ef3b300b11d19d7bc33a_cgraph" alt=""/></div>
<!-- MAP 50 -->
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="tomcrypt__private_8h_af9bdd0d8d602ef3b300b11d19d7bc33a_icgraph.png" border="0" usemap="#tomcrypt__private_8h_af9bdd0d8d602ef3b300b11d19d7bc33a_icgraph" alt=""/></div>
<!-- MAP 51 -->
</div>

</div>
</div>
<a id="adc0366a4a0c272b7594bcea0d8fe7ccb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adc0366a4a0c272b7594bcea0d8fe7ccb">&#9670;&nbsp;</a></span>ltc_ecc_set_point_xyz()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ltc_ecc_set_point_xyz </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="tomcrypt__cfg_8h.html#a4e98fa26a5de0ac87e06af901bad57c4">ltc_mp_digit</a>&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="tomcrypt__cfg_8h.html#a4e98fa26a5de0ac87e06af901bad57c4">ltc_mp_digit</a>&#160;</td>
          <td class="paramname"><em>y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="tomcrypt__cfg_8h.html#a4e98fa26a5de0ac87e06af901bad57c4">ltc_mp_digit</a>&#160;</td>
          <td class="paramname"><em>z</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="tomcrypt__math_8h.html#a2a6efaeaa795aa54274d7c4fd66b018a">ecc_point</a> *&#160;</td>
          <td class="paramname"><em>p</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ltc__ecc__points_8c_source.html#l00049">49</a> of file <a class="el" href="ltc__ecc__points_8c_source.html">ltc_ecc_points.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;{</div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;   <span class="keywordtype">int</span> err;</div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;   <span class="keywordflow">if</span> ((err = <a class="code" href="tomcrypt__math_8h.html#a3d38c44518c63b7a8abd0938f3d41c65">ltc_mp</a>.<a class="code" href="structltc__math__descriptor.html#ad306f25bb0a78e082f0c3baf85c4f44c">set_int</a>(p-&gt;x, x)) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>) <span class="keywordflow">return</span> err;</div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;   <span class="keywordflow">if</span> ((err = <a class="code" href="tomcrypt__math_8h.html#a3d38c44518c63b7a8abd0938f3d41c65">ltc_mp</a>.<a class="code" href="structltc__math__descriptor.html#ad306f25bb0a78e082f0c3baf85c4f44c">set_int</a>(p-&gt;y, y)) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>) <span class="keywordflow">return</span> err;</div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;   <span class="keywordflow">if</span> ((err = <a class="code" href="tomcrypt__math_8h.html#a3d38c44518c63b7a8abd0938f3d41c65">ltc_mp</a>.<a class="code" href="structltc__math__descriptor.html#ad306f25bb0a78e082f0c3baf85c4f44c">set_int</a>(p-&gt;z, z)) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>) <span class="keywordflow">return</span> err;</div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>;</div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;}</div><div class="ttc" id="tomcrypt_8h_html_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334"><div class="ttname"><a href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a></div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt_8h_source.html#l00042">tomcrypt.h:42</a></div></div>
<div class="ttc" id="tomcrypt__math_8h_html_a3d38c44518c63b7a8abd0938f3d41c65"><div class="ttname"><a href="tomcrypt__math_8h.html#a3d38c44518c63b7a8abd0938f3d41c65">ltc_mp</a></div><div class="ttdeci">ltc_math_descriptor ltc_mp</div><div class="ttdef"><b>Definition:</b> <a href="crypt__ltc__mp__descriptor_8c_source.html#l00012">crypt_ltc_mp_descriptor.c:12</a></div></div>
<div class="ttc" id="structltc__math__descriptor_html_ad306f25bb0a78e082f0c3baf85c4f44c"><div class="ttname"><a href="structltc__math__descriptor.html#ad306f25bb0a78e082f0c3baf85c4f44c">ltc_math_descriptor::set_int</a></div><div class="ttdeci">int(* set_int)(void *a, ltc_mp_digit n)</div><div class="ttdoc">set small constant</div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt__math_8h_source.html#l00088">tomcrypt_math.h:88</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="tomcrypt_8h_source.html#l00042">CRYPT_OK</a>, <a class="el" href="crypt__ltc__mp__descriptor_8c_source.html#l00012">ltc_mp</a>, and <a class="el" href="tomcrypt__math_8h_source.html#l00088">ltc_math_descriptor::set_int</a>.</p>

<p class="reference">Referenced by <a class="el" href="ltc__ecc__map_8c_source.html#l00026">ltc_ecc_map()</a>, <a class="el" href="ltc__ecc__mulmod__timing_8c_source.html#l00031">ltc_ecc_mulmod()</a>, <a class="el" href="ltc__ecc__projective__add__point_8c_source.html#l00029">ltc_ecc_projective_add_point()</a>, and <a class="el" href="ltc__ecc__projective__dbl__point_8c_source.html#l00046">ltc_ecc_projective_dbl_point()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="tomcrypt__private_8h_adc0366a4a0c272b7594bcea0d8fe7ccb_icgraph.png" border="0" usemap="#tomcrypt__private_8h_adc0366a4a0c272b7594bcea0d8fe7ccb_icgraph" alt=""/></div>
<!-- MAP 52 -->
</div>

</div>
</div>
<a id="ac0dfaf009d9b0101291727341a20bb40"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac0dfaf009d9b0101291727341a20bb40">&#9670;&nbsp;</a></span>ltc_ecc_verify_key()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ltc_ecc_verify_key </td>
          <td>(</td>
          <td class="paramtype">const ecc_key *&#160;</td>
          <td class="paramname"><em>key</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Verify a key according to ANSI spec. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">key</td><td>The key to validate </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>CRYPT_OK if successful </dd></dl>

<p class="definition">Definition at line <a class="el" href="ltc__ecc__verify__key_8c_source.html#l00022">22</a> of file <a class="el" href="ltc__ecc__verify__key_8c_source.html">ltc_ecc_verify_key.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;{</div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;   <span class="keywordtype">int</span> err, inf;</div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;   <a class="code" href="tomcrypt__math_8h.html#a2a6efaeaa795aa54274d7c4fd66b018a">ecc_point</a> *point;</div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;   <span class="keywordtype">void</span> *prime = key-&gt;dp.prime;</div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;   <span class="keywordtype">void</span> *order = key-&gt;dp.order;</div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;   <span class="keywordtype">void</span> *a     = key-&gt;dp.A;</div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;</div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;   <span class="comment">/* Test 1: Are the x and y points of the public key in the field? */</span></div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="tomcrypt__math_8h.html#a3d38c44518c63b7a8abd0938f3d41c65">ltc_mp</a>.<a class="code" href="structltc__math__descriptor.html#a5b3038e00644c477282802863619323b">compare_d</a>(key-&gt;pubkey.z, 1) == <a class="code" href="tomcrypt__math_8h.html#a035a31bde4f31419eb259e36e5776607">LTC_MP_EQ</a>) {</div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;      <span class="keywordflow">if</span> ((<a class="code" href="tomcrypt__math_8h.html#a3d38c44518c63b7a8abd0938f3d41c65">ltc_mp</a>.<a class="code" href="structltc__math__descriptor.html#afa00530838786ca9b52a21a2c00f0f57">compare</a>(key-&gt;pubkey.x, prime) != <a class="code" href="tomcrypt__math_8h.html#a42d0c7d4c09793df79660774d3436db2">LTC_MP_LT</a>) ||</div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;          (<a class="code" href="tomcrypt__math_8h.html#a3d38c44518c63b7a8abd0938f3d41c65">ltc_mp</a>.<a class="code" href="structltc__math__descriptor.html#afa00530838786ca9b52a21a2c00f0f57">compare</a>(key-&gt;pubkey.y, prime) != <a class="code" href="tomcrypt__math_8h.html#a42d0c7d4c09793df79660774d3436db2">LTC_MP_LT</a>) ||</div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;          (<a class="code" href="tomcrypt__math_8h.html#a3d38c44518c63b7a8abd0938f3d41c65">ltc_mp</a>.<a class="code" href="structltc__math__descriptor.html#a5b3038e00644c477282802863619323b">compare_d</a>(key-&gt;pubkey.x, 0) == <a class="code" href="tomcrypt__math_8h.html#a42d0c7d4c09793df79660774d3436db2">LTC_MP_LT</a>) ||</div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;          (<a class="code" href="tomcrypt__math_8h.html#a3d38c44518c63b7a8abd0938f3d41c65">ltc_mp</a>.<a class="code" href="structltc__math__descriptor.html#a5b3038e00644c477282802863619323b">compare_d</a>(key-&gt;pubkey.y, 0) == <a class="code" href="tomcrypt__math_8h.html#a42d0c7d4c09793df79660774d3436db2">LTC_MP_LT</a>) ||</div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;          (<a class="code" href="tomcrypt__private_8h.html#a910040068490f9f6e5185c970ab869c9">mp_iszero</a>(key-&gt;pubkey.x) &amp;&amp; <a class="code" href="tomcrypt__private_8h.html#a910040068490f9f6e5185c970ab869c9">mp_iszero</a>(key-&gt;pubkey.y))</div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;         )</div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;      {</div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;         err = <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06ca980088f10ffe9009aec286038a9e79da">CRYPT_INVALID_PACKET</a>;</div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;         <span class="keywordflow">goto</span> done2;</div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;      }</div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;   }</div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;</div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;   <span class="comment">/* Test 2: is the public key on the curve? */</span></div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;   <span class="keywordflow">if</span> ((err = <a class="code" href="tomcrypt__private_8h.html#affd37f56571ffc28d2c2687a76014b11">ltc_ecc_is_point</a>(&amp;key-&gt;dp, key-&gt;pubkey.x, key-&gt;pubkey.y)) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>)      { <span class="keywordflow">goto</span> done2; }</div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;</div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;   <span class="comment">/* Test 3: does nG = O? (n = order, O = point at infinity, G = public key) */</span></div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;   point = <a class="code" href="tomcrypt__private_8h.html#a532af6ef2d0f6d1d8cd79e5f81e87cf8">ltc_ecc_new_point</a>();</div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;   <span class="keywordflow">if</span> ((err = <a class="code" href="tomcrypt__private_8h.html#a818e5e4135d8aa58cf09e502e98ccc90">ltc_ecc_mulmod</a>(order, &amp;(key-&gt;pubkey), point, a, prime, 1)) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>)     { <span class="keywordflow">goto</span> done1; }</div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;</div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;   err = <a class="code" href="tomcrypt__private_8h.html#a54a2d7d30af25ef341a8aca09269177d">ltc_ecc_is_point_at_infinity</a>(point, prime, &amp;inf);</div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;   <span class="keywordflow">if</span> (err != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a> || inf) {</div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;      err = <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06ca03c22220d7538be04455cd2aa6ddf9da">CRYPT_ERROR</a>;</div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;   }</div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;   <span class="keywordflow">else</span> {</div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;      err = <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>;</div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;   }</div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;</div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;done1:</div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;   <a class="code" href="tomcrypt__private_8h.html#a4cef83a7c070c94ff78d4df10a7b624f">ltc_ecc_del_point</a>(point);</div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;done2:</div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;   <span class="keywordflow">return</span> err;</div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;}</div><div class="ttc" id="tomcrypt_8h_html_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334"><div class="ttname"><a href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a></div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt_8h_source.html#l00042">tomcrypt.h:42</a></div></div>
<div class="ttc" id="tomcrypt__math_8h_html_a42d0c7d4c09793df79660774d3436db2"><div class="ttname"><a href="tomcrypt__math_8h.html#a42d0c7d4c09793df79660774d3436db2">LTC_MP_LT</a></div><div class="ttdeci">#define LTC_MP_LT</div><div class="ttdoc">math functions</div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt__math_8h_source.html#l00012">tomcrypt_math.h:12</a></div></div>
<div class="ttc" id="tomcrypt__math_8h_html_a3d38c44518c63b7a8abd0938f3d41c65"><div class="ttname"><a href="tomcrypt__math_8h.html#a3d38c44518c63b7a8abd0938f3d41c65">ltc_mp</a></div><div class="ttdeci">ltc_math_descriptor ltc_mp</div><div class="ttdef"><b>Definition:</b> <a href="crypt__ltc__mp__descriptor_8c_source.html#l00012">crypt_ltc_mp_descriptor.c:12</a></div></div>
<div class="ttc" id="tomcrypt__private_8h_html_affd37f56571ffc28d2c2687a76014b11"><div class="ttname"><a href="tomcrypt__private_8h.html#affd37f56571ffc28d2c2687a76014b11">ltc_ecc_is_point</a></div><div class="ttdeci">int ltc_ecc_is_point(const ltc_ecc_dp *dp, void *x, void *y)</div><div class="ttdoc">Returns whether [x,y] is a point on curve defined by dp.</div><div class="ttdef"><b>Definition:</b> <a href="ltc__ecc__is__point_8c_source.html#l00021">ltc_ecc_is_point.c:21</a></div></div>
<div class="ttc" id="structltc__math__descriptor_html_afa00530838786ca9b52a21a2c00f0f57"><div class="ttname"><a href="structltc__math__descriptor.html#afa00530838786ca9b52a21a2c00f0f57">ltc_math_descriptor::compare</a></div><div class="ttdeci">int(* compare)(void *a, void *b)</div><div class="ttdoc">compare two integers</div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt__math_8h_source.html#l00117">tomcrypt_math.h:117</a></div></div>
<div class="ttc" id="tomcrypt_8h_html_adc29c2ff13d900c2f185ee95427fb06ca980088f10ffe9009aec286038a9e79da"><div class="ttname"><a href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06ca980088f10ffe9009aec286038a9e79da">CRYPT_INVALID_PACKET</a></div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt_8h_source.html#l00051">tomcrypt.h:51</a></div></div>
<div class="ttc" id="tomcrypt__private_8h_html_a54a2d7d30af25ef341a8aca09269177d"><div class="ttname"><a href="tomcrypt__private_8h.html#a54a2d7d30af25ef341a8aca09269177d">ltc_ecc_is_point_at_infinity</a></div><div class="ttdeci">int ltc_ecc_is_point_at_infinity(const ecc_point *P, void *modulus, int *retval)</div><div class="ttdef"><b>Definition:</b> <a href="ltc__ecc__is__point__at__infinity_8c_source.html#l00018">ltc_ecc_is_point_at_infinity.c:18</a></div></div>
<div class="ttc" id="structltc__math__descriptor_html_a5b3038e00644c477282802863619323b"><div class="ttname"><a href="structltc__math__descriptor.html#a5b3038e00644c477282802863619323b">ltc_math_descriptor::compare_d</a></div><div class="ttdeci">int(* compare_d)(void *a, ltc_mp_digit n)</div><div class="ttdoc">compare against int</div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt__math_8h_source.html#l00126">tomcrypt_math.h:126</a></div></div>
<div class="ttc" id="tomcrypt__private_8h_html_a4cef83a7c070c94ff78d4df10a7b624f"><div class="ttname"><a href="tomcrypt__private_8h.html#a4cef83a7c070c94ff78d4df10a7b624f">ltc_ecc_del_point</a></div><div class="ttdeci">void ltc_ecc_del_point(ecc_point *p)</div><div class="ttdoc">Free an ECC point from memory.</div><div class="ttdef"><b>Definition:</b> <a href="ltc__ecc__points_8c_source.html#l00040">ltc_ecc_points.c:40</a></div></div>
<div class="ttc" id="tomcrypt__private_8h_html_a532af6ef2d0f6d1d8cd79e5f81e87cf8"><div class="ttname"><a href="tomcrypt__private_8h.html#a532af6ef2d0f6d1d8cd79e5f81e87cf8">ltc_ecc_new_point</a></div><div class="ttdeci">ecc_point * ltc_ecc_new_point(void)</div><div class="ttdoc">Allocate a new ECC point.</div><div class="ttdef"><b>Definition:</b> <a href="ltc__ecc__points_8c_source.html#l00023">ltc_ecc_points.c:23</a></div></div>
<div class="ttc" id="tomcrypt__private_8h_html_a818e5e4135d8aa58cf09e502e98ccc90"><div class="ttname"><a href="tomcrypt__private_8h.html#a818e5e4135d8aa58cf09e502e98ccc90">ltc_ecc_mulmod</a></div><div class="ttdeci">int ltc_ecc_mulmod(void *k, const ecc_point *G, ecc_point *R, void *a, void *modulus, int map)</div><div class="ttdoc">Perform a point multiplication (timing resistant)</div><div class="ttdef"><b>Definition:</b> <a href="ltc__ecc__mulmod__timing_8c_source.html#l00031">ltc_ecc_mulmod_timing.c:31</a></div></div>
<div class="ttc" id="tomcrypt__math_8h_html_a035a31bde4f31419eb259e36e5776607"><div class="ttname"><a href="tomcrypt__math_8h.html#a035a31bde4f31419eb259e36e5776607">LTC_MP_EQ</a></div><div class="ttdeci">#define LTC_MP_EQ</div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt__math_8h_source.html#l00013">tomcrypt_math.h:13</a></div></div>
<div class="ttc" id="tomcrypt__private_8h_html_a910040068490f9f6e5185c970ab869c9"><div class="ttname"><a href="tomcrypt__private_8h.html#a910040068490f9f6e5185c970ab869c9">mp_iszero</a></div><div class="ttdeci">#define mp_iszero(a)</div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt__private_8h_source.html#l00185">tomcrypt_private.h:185</a></div></div>
<div class="ttc" id="tomcrypt__math_8h_html_a2a6efaeaa795aa54274d7c4fd66b018a"><div class="ttname"><a href="tomcrypt__math_8h.html#a2a6efaeaa795aa54274d7c4fd66b018a">ecc_point</a></div><div class="ttdeci">void ecc_point</div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt__math_8h_source.html#l00020">tomcrypt_math.h:20</a></div></div>
<div class="ttc" id="tomcrypt_8h_html_adc29c2ff13d900c2f185ee95427fb06ca03c22220d7538be04455cd2aa6ddf9da"><div class="ttname"><a href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06ca03c22220d7538be04455cd2aa6ddf9da">CRYPT_ERROR</a></div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt_8h_source.html#l00043">tomcrypt.h:43</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="tomcrypt__math_8h_source.html#l00117">ltc_math_descriptor::compare</a>, <a class="el" href="tomcrypt__math_8h_source.html#l00126">ltc_math_descriptor::compare_d</a>, <a class="el" href="tomcrypt_8h_source.html#l00043">CRYPT_ERROR</a>, <a class="el" href="tomcrypt_8h_source.html#l00051">CRYPT_INVALID_PACKET</a>, <a class="el" href="tomcrypt_8h_source.html#l00042">CRYPT_OK</a>, <a class="el" href="ltc__ecc__points_8c_source.html#l00040">ltc_ecc_del_point()</a>, <a class="el" href="ltc__ecc__is__point_8c_source.html#l00021">ltc_ecc_is_point()</a>, <a class="el" href="ltc__ecc__is__point__at__infinity_8c_source.html#l00018">ltc_ecc_is_point_at_infinity()</a>, <a class="el" href="ltc__ecc__mulmod__timing_8c_source.html#l00031">ltc_ecc_mulmod()</a>, <a class="el" href="ltc__ecc__points_8c_source.html#l00023">ltc_ecc_new_point()</a>, <a class="el" href="crypt__ltc__mp__descriptor_8c_source.html#l00012">ltc_mp</a>, <a class="el" href="tomcrypt__math_8h_source.html#l00013">LTC_MP_EQ</a>, <a class="el" href="tomcrypt__math_8h_source.html#l00012">LTC_MP_LT</a>, and <a class="el" href="tomcrypt__private_8h_source.html#l00185">mp_iszero</a>.</p>

<p class="reference">Referenced by <a class="el" href="ecc__import_8c_source.html#l00039">ecc_import_ex()</a>, <a class="el" href="ecc__recover__key_8c_source.html#l00032">ecc_recover_key()</a>, and <a class="el" href="ecc__set__key_8c_source.html#l00014">ecc_set_key()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="tomcrypt__private_8h_ac0dfaf009d9b0101291727341a20bb40_cgraph.png" border="0" usemap="#tomcrypt__private_8h_ac0dfaf009d9b0101291727341a20bb40_cgraph" alt=""/></div>
<!-- MAP 53 -->
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="tomcrypt__private_8h_ac0dfaf009d9b0101291727341a20bb40_icgraph.png" border="0" usemap="#tomcrypt__private_8h_ac0dfaf009d9b0101291727341a20bb40_icgraph" alt=""/></div>
<!-- MAP 54 -->
</div>

</div>
</div>
<a id="ac4af92f890be670e795a758ec452b402"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac4af92f890be670e795a758ec452b402">&#9670;&nbsp;</a></span>ocb3_int_ntz()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ocb3_int_ntz </td>
          <td>(</td>
          <td class="paramtype">unsigned long&#160;</td>
          <td class="paramname"><em>x</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns the number of leading zero bits [from lsb up] (internal function) </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">x</td><td>The 32-bit value to observe </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The number of bits [from the lsb up] that are zero </dd></dl>

<p class="definition">Definition at line <a class="el" href="ocb3__int__ntz_8c_source.html#l00023">23</a> of file <a class="el" href="ocb3__int__ntz_8c_source.html">ocb3_int_ntz.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;{</div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;   <span class="keywordtype">int</span> <a class="code" href="khazad_8c.html#a86ea50de5a3e0ae87762f4298d35284c">c</a>;</div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;   x &amp;= 0xFFFFFFFFUL;</div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;   <a class="code" href="khazad_8c.html#a86ea50de5a3e0ae87762f4298d35284c">c</a> = 0;</div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;   <span class="keywordflow">while</span> ((x &amp; 1) == 0) {</div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;      ++<a class="code" href="khazad_8c.html#a86ea50de5a3e0ae87762f4298d35284c">c</a>;</div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;      x &gt;&gt;= 1;</div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;   }</div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="khazad_8c.html#a86ea50de5a3e0ae87762f4298d35284c">c</a>;</div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;}</div><div class="ttc" id="khazad_8c_html_a86ea50de5a3e0ae87762f4298d35284c"><div class="ttname"><a href="khazad_8c.html#a86ea50de5a3e0ae87762f4298d35284c">c</a></div><div class="ttdeci">static const ulong64 c[8+1]</div><div class="ttdef"><b>Definition:</b> <a href="khazad_8c_source.html#l00570">khazad.c:570</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="khazad_8c_source.html#l00570">c</a>.</p>

<p class="reference">Referenced by <a class="el" href="ocb3__add__aad_8c_source.html#l00024">_ocb3_int_aad_add_block()</a>, <a class="el" href="ocb3__decrypt_8c_source.html#l00026">ocb3_decrypt()</a>, and <a class="el" href="ocb3__encrypt_8c_source.html#l00026">ocb3_encrypt()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="tomcrypt__private_8h_ac4af92f890be670e795a758ec452b402_icgraph.png" border="0" usemap="#tomcrypt__private_8h_ac4af92f890be670e795a758ec452b402_icgraph" alt=""/></div>
<!-- MAP 55 -->
</div>

</div>
</div>
<a id="a5bf6caa4615657cdfd8f8941620a987c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5bf6caa4615657cdfd8f8941620a987c">&#9670;&nbsp;</a></span>ocb3_int_xor_blocks()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ocb3_int_xor_blocks </td>
          <td>(</td>
          <td class="paramtype">unsigned char *&#160;</td>
          <td class="paramname"><em>out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned char *&#160;</td>
          <td class="paramname"><em>block_a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned char *&#160;</td>
          <td class="paramname"><em>block_b</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned long&#160;</td>
          <td class="paramname"><em>block_len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Compute xor for two blocks of bytes 'out = block_a XOR block_b' (internal function) </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">out</td><td>The block of bytes (output) </td></tr>
    <tr><td class="paramname">block_a</td><td>The block of bytes (input) </td></tr>
    <tr><td class="paramname">block_b</td><td>The block of bytes (input) </td></tr>
    <tr><td class="paramname">block_len</td><td>The size of block_a, block_b, out </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="ocb3__int__xor__blocks_8c_source.html#l00025">25</a> of file <a class="el" href="ocb3__int__xor__blocks_8c_source.html">ocb3_int_xor_blocks.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;{</div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;   <span class="keywordtype">int</span> x;</div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;   <span class="keywordflow">if</span> (out == block_a) {</div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;     <span class="keywordflow">for</span> (x = 0; x &lt; (int)block_len; x++) out[x] ^= block_b[x];</div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;   }</div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;   <span class="keywordflow">else</span> {</div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;     <span class="keywordflow">for</span> (x = 0; x &lt; (int)block_len; x++) out[x] = block_a[x] ^ block_b[x];</div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;   }</div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;}</div></div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="ocb3__add__aad_8c_source.html#l00024">_ocb3_int_aad_add_block()</a>, <a class="el" href="ocb3__decrypt_8c_source.html#l00026">ocb3_decrypt()</a>, <a class="el" href="ocb3__decrypt__last_8c_source.html#l00026">ocb3_decrypt_last()</a>, <a class="el" href="ocb3__done_8c_source.html#l00025">ocb3_done()</a>, <a class="el" href="ocb3__encrypt_8c_source.html#l00026">ocb3_encrypt()</a>, <a class="el" href="ocb3__encrypt__last_8c_source.html#l00026">ocb3_encrypt_last()</a>, and <a class="el" href="ocb3__init_8c_source.html#l00088">ocb3_init()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="tomcrypt__private_8h_a5bf6caa4615657cdfd8f8941620a987c_icgraph.png" border="0" usemap="#tomcrypt__private_8h_a5bf6caa4615657cdfd8f8941620a987c_icgraph" alt=""/></div>
<!-- MAP 56 -->
</div>

</div>
</div>
<a id="a3573423ba7eb454bb5f969ee9b580024"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3573423ba7eb454bb5f969ee9b580024">&#9670;&nbsp;</a></span>pbes1_extract()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int pbes1_extract </td>
          <td>(</td>
          <td class="paramtype">const ltc_asn1_list *&#160;</td>
          <td class="paramname"><em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structpbes__arg.html">pbes_arg</a> *&#160;</td>
          <td class="paramname"><em>res</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Extract PBES1 parameters. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">s</td><td>The start of the sequence with potential PBES1 parameters </td></tr>
    <tr><td class="paramname">res</td><td>Pointer to where the extracted parameters should be stored </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>CRYPT_OK on success </dd></dl>

<p class="definition">Definition at line <a class="el" href="pbes1_8c_source.html#l00094">94</a> of file <a class="el" href="pbes1_8c_source.html">pbes1.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;{</div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;   <span class="keywordtype">int</span> err;</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;</div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;   <a class="code" href="tomcrypt__argchk_8h.html#a683da3e041e49f196318b6ea951414ba">LTC_ARGCHK</a>(s   != NULL);</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;   <a class="code" href="tomcrypt__argchk_8h.html#a683da3e041e49f196318b6ea951414ba">LTC_ARGCHK</a>(res != NULL);</div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;</div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;   <span class="keywordflow">if</span> ((err = <a class="code" href="pbes1_8c.html#ae603bc6c7e6913beec5714350041adc6">_pbes1_from_oid</a>(s, &amp;res-&gt;<a class="code" href="structpbes__arg.html#a6879b93a34abc3b85c42fea0b0e92156">type</a>)) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>) <span class="keywordflow">return</span> err;</div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;   <span class="keywordflow">if</span> (!<a class="code" href="tomcrypt__private_8h.html#a896c8b07a35ff2799061855f08a8325a">LTC_ASN1_IS_TYPE</a>(s-&gt;next, LTC_ASN1_SEQUENCE) ||</div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;       !<a class="code" href="tomcrypt__private_8h.html#a896c8b07a35ff2799061855f08a8325a">LTC_ASN1_IS_TYPE</a>(s-&gt;next-&gt;child, LTC_ASN1_OCTET_STRING) ||</div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;       !<a class="code" href="tomcrypt__private_8h.html#a896c8b07a35ff2799061855f08a8325a">LTC_ASN1_IS_TYPE</a>(s-&gt;next-&gt;child-&gt;next, LTC_ASN1_INTEGER)) {</div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06ca980088f10ffe9009aec286038a9e79da">CRYPT_INVALID_PACKET</a>;</div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;   }</div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;   <span class="comment">/* PBES1: encrypted pkcs8 - pbeWithMD5AndDES-CBC:</span></div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;<span class="comment">    *  0:d=0  hl=4 l= 329 cons: SEQUENCE</span></div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;<span class="comment">    *  4:d=1  hl=2 l=  27 cons:   SEQUENCE</span></div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;<span class="comment">    *  6:d=2  hl=2 l=   9 prim:     OBJECT             :pbeWithMD5AndDES-CBC (== 1.2.840.113549.1.5.3) (== *s)</span></div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;<span class="comment">    * 17:d=2  hl=2 l=  14 cons:     SEQUENCE           (== *lalgparam)</span></div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;<span class="comment">    * 19:d=3  hl=2 l=   8 prim:       OCTET STRING     [HEX DUMP]:8EDF749A06CCDE51 (== salt)</span></div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;<span class="comment">    * 29:d=3  hl=2 l=   2 prim:       INTEGER          :0800  (== iterations)</span></div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;<span class="comment">    * 33:d=1  hl=4 l= 296 prim:   OCTET STRING         :bytes (== encrypted data)</span></div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;   res-&gt;<a class="code" href="structpbes__arg.html#a356304efb7c4b45d06779905fd254797">salt</a> = s-&gt;next-&gt;child;</div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;   res-&gt;<a class="code" href="structpbes__arg.html#a78b52a8d8572e6947ebe909b51490ec6">iterations</a> = <a class="code" href="tomcrypt__private_8h.html#a4e68c807adc159c7553da37ce38196b2">mp_get_int</a>(s-&gt;next-&gt;child-&gt;next-&gt;data);</div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;</div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>;</div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;}</div><div class="ttc" id="tomcrypt_8h_html_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334"><div class="ttname"><a href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a></div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt_8h_source.html#l00042">tomcrypt.h:42</a></div></div>
<div class="ttc" id="tomcrypt__argchk_8h_html_a683da3e041e49f196318b6ea951414ba"><div class="ttname"><a href="tomcrypt__argchk_8h.html#a683da3e041e49f196318b6ea951414ba">LTC_ARGCHK</a></div><div class="ttdeci">#define LTC_ARGCHK(x)</div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt__argchk_8h_source.html#l00019">tomcrypt_argchk.h:19</a></div></div>
<div class="ttc" id="tomcrypt_8h_html_adc29c2ff13d900c2f185ee95427fb06ca980088f10ffe9009aec286038a9e79da"><div class="ttname"><a href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06ca980088f10ffe9009aec286038a9e79da">CRYPT_INVALID_PACKET</a></div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt_8h_source.html#l00051">tomcrypt.h:51</a></div></div>
<div class="ttc" id="pbes1_8c_html_ae603bc6c7e6913beec5714350041adc6"><div class="ttname"><a href="pbes1_8c.html#ae603bc6c7e6913beec5714350041adc6">_pbes1_from_oid</a></div><div class="ttdeci">static int _pbes1_from_oid(const ltc_asn1_list *oid, pbes_properties *res)</div><div class="ttdef"><b>Definition:</b> <a href="pbes1_8c_source.html#l00075">pbes1.c:75</a></div></div>
<div class="ttc" id="tomcrypt__private_8h_html_a4e68c807adc159c7553da37ce38196b2"><div class="ttname"><a href="tomcrypt__private_8h.html#a4e68c807adc159c7553da37ce38196b2">mp_get_int</a></div><div class="ttdeci">#define mp_get_int(a)</div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt__private_8h_source.html#l00141">tomcrypt_private.h:141</a></div></div>
<div class="ttc" id="tomcrypt__private_8h_html_a896c8b07a35ff2799061855f08a8325a"><div class="ttname"><a href="tomcrypt__private_8h.html#a896c8b07a35ff2799061855f08a8325a">LTC_ASN1_IS_TYPE</a></div><div class="ttdeci">#define LTC_ASN1_IS_TYPE(e, t)</div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt__private_8h_source.html#l00302">tomcrypt_private.h:302</a></div></div>
<div class="ttc" id="structpbes__arg_html_a356304efb7c4b45d06779905fd254797"><div class="ttname"><a href="structpbes__arg.html#a356304efb7c4b45d06779905fd254797">pbes_arg::salt</a></div><div class="ttdeci">ltc_asn1_list * salt</div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt__private_8h_source.html#l00062">tomcrypt_private.h:62</a></div></div>
<div class="ttc" id="structpbes__arg_html_a6879b93a34abc3b85c42fea0b0e92156"><div class="ttname"><a href="structpbes__arg.html#a6879b93a34abc3b85c42fea0b0e92156">pbes_arg::type</a></div><div class="ttdeci">pbes_properties type</div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt__private_8h_source.html#l00058">tomcrypt_private.h:58</a></div></div>
<div class="ttc" id="structpbes__arg_html_a78b52a8d8572e6947ebe909b51490ec6"><div class="ttname"><a href="structpbes__arg.html#a78b52a8d8572e6947ebe909b51490ec6">pbes_arg::iterations</a></div><div class="ttdeci">unsigned long iterations</div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt__private_8h_source.html#l00064">tomcrypt_private.h:64</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="pbes1_8c_source.html#l00075">_pbes1_from_oid()</a>, <a class="el" href="tomcrypt_8h_source.html#l00051">CRYPT_INVALID_PACKET</a>, <a class="el" href="tomcrypt_8h_source.html#l00042">CRYPT_OK</a>, <a class="el" href="tomcrypt__private_8h_source.html#l00064">pbes_arg::iterations</a>, <a class="el" href="tomcrypt__argchk_8h_source.html#l00019">LTC_ARGCHK</a>, <a class="el" href="tomcrypt__private_8h_source.html#l00302">LTC_ASN1_IS_TYPE</a>, <a class="el" href="tomcrypt__private_8h_source.html#l00141">mp_get_int</a>, <a class="el" href="tomcrypt__private_8h_source.html#l00062">pbes_arg::salt</a>, and <a class="el" href="tomcrypt__private_8h_source.html#l00058">pbes_arg::type</a>.</p>

<p class="reference">Referenced by <a class="el" href="pkcs8__decode__flexi_8c_source.html#l00023">pkcs8_decode_flexi()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="tomcrypt__private_8h_a3573423ba7eb454bb5f969ee9b580024_cgraph.png" border="0" usemap="#tomcrypt__private_8h_a3573423ba7eb454bb5f969ee9b580024_cgraph" alt=""/></div>
<!-- MAP 57 -->
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="tomcrypt__private_8h_a3573423ba7eb454bb5f969ee9b580024_icgraph.png" border="0" usemap="#tomcrypt__private_8h_a3573423ba7eb454bb5f969ee9b580024_icgraph" alt=""/></div>
<!-- MAP 58 -->
</div>

</div>
</div>
<a id="a741f04fef81b90c03eeba79d1d680273"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a741f04fef81b90c03eeba79d1d680273">&#9670;&nbsp;</a></span>pbes2_extract()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int pbes2_extract </td>
          <td>(</td>
          <td class="paramtype">const ltc_asn1_list *&#160;</td>
          <td class="paramname"><em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structpbes__arg.html">pbes_arg</a> *&#160;</td>
          <td class="paramname"><em>res</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Extract PBES2 parameters. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">s</td><td>The start of the sequence with potential PBES2 parameters </td></tr>
    <tr><td class="paramname">res</td><td>Pointer to where the extracted parameters should be stored </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>CRYPT_OK on success </dd></dl>

<p class="definition">Definition at line <a class="el" href="pbes2_8c_source.html#l00084">84</a> of file <a class="el" href="pbes2_8c_source.html">pbes2.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;{</div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;   <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> klen;</div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;   ltc_asn1_list *lkdf, *lenc, *loptseq, *liter, *lhmac;</div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;   <span class="keywordtype">int</span> err;</div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;</div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;   <a class="code" href="tomcrypt__argchk_8h.html#a683da3e041e49f196318b6ea951414ba">LTC_ARGCHK</a>(s   != NULL);</div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;   <a class="code" href="tomcrypt__argchk_8h.html#a683da3e041e49f196318b6ea951414ba">LTC_ARGCHK</a>(res != NULL);</div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;</div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;   <span class="keywordflow">if</span> ((err = <a class="code" href="tomcrypt__private_8h.html#aaa860b1fbc776e0760df8934a6aa245a">pk_oid_cmp_with_asn1</a>(<a class="code" href="pbes2_8c.html#a44eda0598ba3b6bfd85a19991094dff9">_oid_pbes2</a>, s)) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>) <span class="keywordflow">return</span> err;</div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;</div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;   <span class="keywordflow">if</span> (!<a class="code" href="tomcrypt__private_8h.html#a896c8b07a35ff2799061855f08a8325a">LTC_ASN1_IS_TYPE</a>(s-&gt;next, LTC_ASN1_SEQUENCE) ||</div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;       !<a class="code" href="tomcrypt__private_8h.html#a896c8b07a35ff2799061855f08a8325a">LTC_ASN1_IS_TYPE</a>(s-&gt;next-&gt;child, LTC_ASN1_SEQUENCE) ||</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;       !<a class="code" href="tomcrypt__private_8h.html#a896c8b07a35ff2799061855f08a8325a">LTC_ASN1_IS_TYPE</a>(s-&gt;next-&gt;child-&gt;child, LTC_ASN1_OBJECT_IDENTIFIER) ||</div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;       !<a class="code" href="tomcrypt__private_8h.html#a896c8b07a35ff2799061855f08a8325a">LTC_ASN1_IS_TYPE</a>(s-&gt;next-&gt;child-&gt;child-&gt;next, LTC_ASN1_SEQUENCE) ||</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;       !<a class="code" href="tomcrypt__private_8h.html#a896c8b07a35ff2799061855f08a8325a">LTC_ASN1_IS_TYPE</a>(s-&gt;next-&gt;child-&gt;next, LTC_ASN1_SEQUENCE) ||</div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;       !<a class="code" href="tomcrypt__private_8h.html#a896c8b07a35ff2799061855f08a8325a">LTC_ASN1_IS_TYPE</a>(s-&gt;next-&gt;child-&gt;next-&gt;child, LTC_ASN1_OBJECT_IDENTIFIER)) {</div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06ca980088f10ffe9009aec286038a9e79da">CRYPT_INVALID_PACKET</a>;</div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;   }</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;   <span class="comment">/* PBES2: encrypted pkcs8 - PBES2+PBKDF2+des-ede3-cbc:</span></div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;<span class="comment">    *  0:d=0  hl=4 l= 380 cons: SEQUENCE</span></div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;<span class="comment">    *  4:d=1  hl=2 l=  78 cons:   SEQUENCE</span></div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;<span class="comment">    *  6:d=2  hl=2 l=   9 prim:     OBJECT             :PBES2 (== 1.2.840.113549.1.5.13) (== *s)</span></div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;<span class="comment">    * 17:d=2  hl=2 l=  65 cons:     SEQUENCE</span></div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;<span class="comment">    * 19:d=3  hl=2 l=  41 cons:       SEQUENCE</span></div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;<span class="comment">    * 21:d=4  hl=2 l=   9 prim:         OBJECT         :PBKDF2 (== *lkdf)</span></div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;<span class="comment">    * 32:d=4  hl=2 l=  28 cons:         SEQUENCE</span></div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;<span class="comment">    * 34:d=5  hl=2 l=   8 prim:           OCTET STRING [HEX DUMP]:28BA4ABF6AA76A3D (== res-&gt;salt)</span></div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;<span class="comment">    * 44:d=5  hl=2 l=   2 prim:           INTEGER      :0800 (== res-&gt;iterations, *liter)</span></div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;<span class="comment">    * 48:d=5  hl=2 l=  12 cons:           SEQUENCE     (== *loptseq   - this sequence is optional, may be missing)</span></div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;<span class="comment">    * 50:d=6  hl=2 l=   8 prim:             OBJECT     :hmacWithSHA256 (== *lhmac)</span></div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;<span class="comment">    * 60:d=6  hl=2 l=   0 prim:             NULL</span></div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;<span class="comment">    * 62:d=3  hl=2 l=  20 cons:       SEQUENCE</span></div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;<span class="comment">    * 64:d=4  hl=2 l=   8 prim:         OBJECT         :des-ede3-cbc (== *lenc)</span></div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;<span class="comment">    * 74:d=4  hl=2 l=   8 prim:         OCTET STRING   [HEX DUMP]:B1404C4688DC9A5A</span></div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;<span class="comment">    * 84:d=1  hl=4 l= 296 prim:   OCTET STRING         :bytes (== encrypted data)</span></div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;   lkdf = s-&gt;next-&gt;child-&gt;child;</div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;   lenc = s-&gt;next-&gt;child-&gt;next-&gt;child;</div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;</div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;   <span class="keywordflow">if</span> ((err = <a class="code" href="tomcrypt__private_8h.html#aaa860b1fbc776e0760df8934a6aa245a">pk_oid_cmp_with_asn1</a>(<a class="code" href="pbes2_8c.html#a5c2b966969310bd02cc0337f5120afec">_oid_pbkdf2</a>, lkdf)) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>) <span class="keywordflow">return</span> err;</div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;</div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;   <span class="keywordflow">if</span> (!<a class="code" href="tomcrypt__private_8h.html#a896c8b07a35ff2799061855f08a8325a">LTC_ASN1_IS_TYPE</a>(lkdf-&gt;next, LTC_ASN1_SEQUENCE) ||</div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;       !<a class="code" href="tomcrypt__private_8h.html#a896c8b07a35ff2799061855f08a8325a">LTC_ASN1_IS_TYPE</a>(lkdf-&gt;next-&gt;child, LTC_ASN1_OCTET_STRING) ||</div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;       !<a class="code" href="tomcrypt__private_8h.html#a896c8b07a35ff2799061855f08a8325a">LTC_ASN1_IS_TYPE</a>(lkdf-&gt;next-&gt;child-&gt;next, LTC_ASN1_INTEGER)) {</div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06ca980088f10ffe9009aec286038a9e79da">CRYPT_INVALID_PACKET</a>;</div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;   }</div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;</div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;   liter = lkdf-&gt;next-&gt;child-&gt;next;</div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;   loptseq = liter-&gt;next;</div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;   res-&gt;<a class="code" href="structpbes__arg.html#a356304efb7c4b45d06779905fd254797">salt</a> = lkdf-&gt;next-&gt;child;</div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;   res-&gt;<a class="code" href="structpbes__arg.html#a78b52a8d8572e6947ebe909b51490ec6">iterations</a> = <a class="code" href="tomcrypt__private_8h.html#a4e68c807adc159c7553da37ce38196b2">mp_get_int</a>(liter-&gt;data);</div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;</div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;   <span class="comment">/* There&#39;s an optional INTEGER keyLength after the iterations, skip that if it&#39;s there.</span></div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;<span class="comment">    * c.f. RFC 2898 A.2 PBKDF2 */</span></div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;   <span class="keywordflow">if</span>(<a class="code" href="tomcrypt__private_8h.html#a896c8b07a35ff2799061855f08a8325a">LTC_ASN1_IS_TYPE</a>(loptseq, LTC_ASN1_INTEGER)) {</div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;      loptseq = loptseq-&gt;next;</div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;   }</div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;</div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;   <span class="comment">/* this sequence is optional */</span></div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;   lhmac = NULL;</div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="tomcrypt__private_8h.html#a896c8b07a35ff2799061855f08a8325a">LTC_ASN1_IS_TYPE</a>(loptseq, LTC_ASN1_SEQUENCE) &amp;&amp;</div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;       <a class="code" href="tomcrypt__private_8h.html#a896c8b07a35ff2799061855f08a8325a">LTC_ASN1_IS_TYPE</a>(loptseq-&gt;child, LTC_ASN1_OBJECT_IDENTIFIER)) {</div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;      lhmac = loptseq-&gt;child;</div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;   }</div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;   <span class="keywordflow">if</span> ((err = <a class="code" href="pbes2_8c.html#a6d172113e8d3bf8ef62690a35a2bbf52">_pbes2_from_oid</a>(lenc, lhmac, &amp;res-&gt;<a class="code" href="structpbes__arg.html#a6879b93a34abc3b85c42fea0b0e92156">type</a>)) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>) <span class="keywordflow">return</span> err;</div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;</div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="tomcrypt__private_8h.html#a896c8b07a35ff2799061855f08a8325a">LTC_ASN1_IS_TYPE</a>(lenc-&gt;next, LTC_ASN1_OCTET_STRING)) {</div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;      <span class="comment">/* &#39;NON-RC2&#39;-CBC */</span></div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;      res-&gt;<a class="code" href="structpbes__arg.html#aeecdb7fb21b9beacfa5adf1f715eb9fd">iv</a> = lenc-&gt;next;</div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="tomcrypt__private_8h.html#a896c8b07a35ff2799061855f08a8325a">LTC_ASN1_IS_TYPE</a>(lenc-&gt;next, LTC_ASN1_SEQUENCE)) {</div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;      <span class="comment">/* RC2-CBC is a bit special ...</span></div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;<span class="comment">       *</span></div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;<span class="comment">       * RC2-CBC-Parameter ::= SEQUENCE {</span></div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;<span class="comment">       *     rc2ParameterVersion INTEGER OPTIONAL,</span></div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;<span class="comment">       *     iv OCTET STRING (SIZE(8)) }</span></div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;<span class="comment">       */</span></div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="tomcrypt__private_8h.html#a896c8b07a35ff2799061855f08a8325a">LTC_ASN1_IS_TYPE</a>(lenc-&gt;next-&gt;child, LTC_ASN1_INTEGER) &amp;&amp;</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;          <a class="code" href="tomcrypt__private_8h.html#a896c8b07a35ff2799061855f08a8325a">LTC_ASN1_IS_TYPE</a>(lenc-&gt;next-&gt;child-&gt;next, LTC_ASN1_OCTET_STRING)) {</div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;         klen = <a class="code" href="tomcrypt__private_8h.html#a4e68c807adc159c7553da37ce38196b2">mp_get_int</a>(lenc-&gt;next-&gt;child-&gt;data);</div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;         res-&gt;<a class="code" href="structpbes__arg.html#aeecdb7fb21b9beacfa5adf1f715eb9fd">iv</a>   = lenc-&gt;next-&gt;child-&gt;next;</div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;         <span class="comment">/*</span></div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;<span class="comment">          * Effective Key Bits         Encoding</span></div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;<span class="comment">          *         40                    160</span></div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;<span class="comment">          *         64                    120</span></div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;<span class="comment">          *        128                     58</span></div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;<span class="comment">          *       b &gt;= 256                  b</span></div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;<span class="comment">          */</span></div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;         <span class="keywordflow">switch</span> (klen) {</div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;            <span class="keywordflow">case</span> 160:</div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;               res-&gt;<a class="code" href="structpbes__arg.html#ac59e419107215d6c89e2d9789a0c49f4">key_bits</a> = 40;</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;               <span class="keywordflow">break</span>;</div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;            <span class="keywordflow">case</span> 120:</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;               res-&gt;<a class="code" href="structpbes__arg.html#ac59e419107215d6c89e2d9789a0c49f4">key_bits</a> = 64;</div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;               <span class="keywordflow">break</span>;</div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;            <span class="keywordflow">case</span> 58:</div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;               res-&gt;<a class="code" href="structpbes__arg.html#ac59e419107215d6c89e2d9789a0c49f4">key_bits</a> = 128;</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;               <span class="keywordflow">break</span>;</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;            <span class="keywordflow">default</span>:</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;               <span class="comment">/* We don&#39;t handle undefined Key Bits */</span></div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;               <span class="keywordflow">if</span> (klen &lt; 256) <span class="keywordflow">return</span> <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06caafed43f3b625e72191e08e65b4bb5e02">CRYPT_INVALID_KEYSIZE</a>;</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;</div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;               res-&gt;<a class="code" href="structpbes__arg.html#ac59e419107215d6c89e2d9789a0c49f4">key_bits</a> = klen;</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;               <span class="keywordflow">break</span>;</div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;         }</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="tomcrypt__private_8h.html#a896c8b07a35ff2799061855f08a8325a">LTC_ASN1_IS_TYPE</a>(lenc-&gt;next-&gt;child, LTC_ASN1_OCTET_STRING)) {</div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;         res-&gt;<a class="code" href="structpbes__arg.html#aeecdb7fb21b9beacfa5adf1f715eb9fd">iv</a>   = lenc-&gt;next-&gt;child;</div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;         <span class="comment">/*</span></div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;<span class="comment">          * If the rc2ParameterVersion field is omitted, the &quot;effective key bits&quot;</span></div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;<span class="comment">          * defaults to 32.</span></div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;<span class="comment">          */</span></div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;         res-&gt;<a class="code" href="structpbes__arg.html#ac59e419107215d6c89e2d9789a0c49f4">key_bits</a> = 32;</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;         <span class="keywordflow">return</span> <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06ca980088f10ffe9009aec286038a9e79da">CRYPT_INVALID_PACKET</a>;</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;      }</div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;   }</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;</div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>;</div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;}</div><div class="ttc" id="tomcrypt_8h_html_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334"><div class="ttname"><a href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a></div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt_8h_source.html#l00042">tomcrypt.h:42</a></div></div>
<div class="ttc" id="pbes2_8c_html_a5c2b966969310bd02cc0337f5120afec"><div class="ttname"><a href="pbes2_8c.html#a5c2b966969310bd02cc0337f5120afec">_oid_pbkdf2</a></div><div class="ttdeci">static const char *const _oid_pbkdf2</div><div class="ttdef"><b>Definition:</b> <a href="pbes2_8c_source.html#l00014">pbes2.c:14</a></div></div>
<div class="ttc" id="tomcrypt__argchk_8h_html_a683da3e041e49f196318b6ea951414ba"><div class="ttname"><a href="tomcrypt__argchk_8h.html#a683da3e041e49f196318b6ea951414ba">LTC_ARGCHK</a></div><div class="ttdeci">#define LTC_ARGCHK(x)</div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt__argchk_8h_source.html#l00019">tomcrypt_argchk.h:19</a></div></div>
<div class="ttc" id="pbes2_8c_html_a6d172113e8d3bf8ef62690a35a2bbf52"><div class="ttname"><a href="pbes2_8c.html#a6d172113e8d3bf8ef62690a35a2bbf52">_pbes2_from_oid</a></div><div class="ttdeci">static int _pbes2_from_oid(const ltc_asn1_list *cipher_oid, const ltc_asn1_list *hmac_oid, pbes_properties *res)</div><div class="ttdef"><b>Definition:</b> <a href="pbes2_8c_source.html#l00054">pbes2.c:54</a></div></div>
<div class="ttc" id="tomcrypt_8h_html_adc29c2ff13d900c2f185ee95427fb06ca980088f10ffe9009aec286038a9e79da"><div class="ttname"><a href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06ca980088f10ffe9009aec286038a9e79da">CRYPT_INVALID_PACKET</a></div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt_8h_source.html#l00051">tomcrypt.h:51</a></div></div>
<div class="ttc" id="tomcrypt__private_8h_html_a4e68c807adc159c7553da37ce38196b2"><div class="ttname"><a href="tomcrypt__private_8h.html#a4e68c807adc159c7553da37ce38196b2">mp_get_int</a></div><div class="ttdeci">#define mp_get_int(a)</div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt__private_8h_source.html#l00141">tomcrypt_private.h:141</a></div></div>
<div class="ttc" id="structpbes__arg_html_ac59e419107215d6c89e2d9789a0c49f4"><div class="ttname"><a href="structpbes__arg.html#ac59e419107215d6c89e2d9789a0c49f4">pbes_arg::key_bits</a></div><div class="ttdeci">unsigned long key_bits</div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt__private_8h_source.html#l00066">tomcrypt_private.h:66</a></div></div>
<div class="ttc" id="structpbes__arg_html_aeecdb7fb21b9beacfa5adf1f715eb9fd"><div class="ttname"><a href="structpbes__arg.html#aeecdb7fb21b9beacfa5adf1f715eb9fd">pbes_arg::iv</a></div><div class="ttdeci">ltc_asn1_list * iv</div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt__private_8h_source.html#l00063">tomcrypt_private.h:63</a></div></div>
<div class="ttc" id="tomcrypt__private_8h_html_a896c8b07a35ff2799061855f08a8325a"><div class="ttname"><a href="tomcrypt__private_8h.html#a896c8b07a35ff2799061855f08a8325a">LTC_ASN1_IS_TYPE</a></div><div class="ttdeci">#define LTC_ASN1_IS_TYPE(e, t)</div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt__private_8h_source.html#l00302">tomcrypt_private.h:302</a></div></div>
<div class="ttc" id="structpbes__arg_html_a356304efb7c4b45d06779905fd254797"><div class="ttname"><a href="structpbes__arg.html#a356304efb7c4b45d06779905fd254797">pbes_arg::salt</a></div><div class="ttdeci">ltc_asn1_list * salt</div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt__private_8h_source.html#l00062">tomcrypt_private.h:62</a></div></div>
<div class="ttc" id="tomcrypt_8h_html_adc29c2ff13d900c2f185ee95427fb06caafed43f3b625e72191e08e65b4bb5e02"><div class="ttname"><a href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06caafed43f3b625e72191e08e65b4bb5e02">CRYPT_INVALID_KEYSIZE</a></div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt_8h_source.html#l00046">tomcrypt.h:46</a></div></div>
<div class="ttc" id="structpbes__arg_html_a6879b93a34abc3b85c42fea0b0e92156"><div class="ttname"><a href="structpbes__arg.html#a6879b93a34abc3b85c42fea0b0e92156">pbes_arg::type</a></div><div class="ttdeci">pbes_properties type</div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt__private_8h_source.html#l00058">tomcrypt_private.h:58</a></div></div>
<div class="ttc" id="pbes2_8c_html_a44eda0598ba3b6bfd85a19991094dff9"><div class="ttname"><a href="pbes2_8c.html#a44eda0598ba3b6bfd85a19991094dff9">_oid_pbes2</a></div><div class="ttdeci">static const char *const _oid_pbes2</div><div class="ttdef"><b>Definition:</b> <a href="pbes2_8c_source.html#l00013">pbes2.c:13</a></div></div>
<div class="ttc" id="structpbes__arg_html_a78b52a8d8572e6947ebe909b51490ec6"><div class="ttname"><a href="structpbes__arg.html#a78b52a8d8572e6947ebe909b51490ec6">pbes_arg::iterations</a></div><div class="ttdeci">unsigned long iterations</div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt__private_8h_source.html#l00064">tomcrypt_private.h:64</a></div></div>
<div class="ttc" id="tomcrypt__private_8h_html_aaa860b1fbc776e0760df8934a6aa245a"><div class="ttname"><a href="tomcrypt__private_8h.html#aaa860b1fbc776e0760df8934a6aa245a">pk_oid_cmp_with_asn1</a></div><div class="ttdeci">int pk_oid_cmp_with_asn1(const char *o1, const ltc_asn1_list *o2)</div><div class="ttdef"><b>Definition:</b> <a href="pk__oid__cmp_8c_source.html#l00041">pk_oid_cmp.c:41</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="pbes2_8c_source.html#l00013">_oid_pbes2</a>, <a class="el" href="pbes2_8c_source.html#l00014">_oid_pbkdf2</a>, <a class="el" href="pbes2_8c_source.html#l00054">_pbes2_from_oid()</a>, <a class="el" href="tomcrypt_8h_source.html#l00046">CRYPT_INVALID_KEYSIZE</a>, <a class="el" href="tomcrypt_8h_source.html#l00051">CRYPT_INVALID_PACKET</a>, <a class="el" href="tomcrypt_8h_source.html#l00042">CRYPT_OK</a>, <a class="el" href="tomcrypt__private_8h_source.html#l00064">pbes_arg::iterations</a>, <a class="el" href="tomcrypt__private_8h_source.html#l00063">pbes_arg::iv</a>, <a class="el" href="tomcrypt__private_8h_source.html#l00066">pbes_arg::key_bits</a>, <a class="el" href="tomcrypt__argchk_8h_source.html#l00019">LTC_ARGCHK</a>, <a class="el" href="tomcrypt__private_8h_source.html#l00302">LTC_ASN1_IS_TYPE</a>, <a class="el" href="tomcrypt__private_8h_source.html#l00141">mp_get_int</a>, <a class="el" href="pk__oid__cmp_8c_source.html#l00041">pk_oid_cmp_with_asn1()</a>, <a class="el" href="tomcrypt__private_8h_source.html#l00062">pbes_arg::salt</a>, and <a class="el" href="tomcrypt__private_8h_source.html#l00058">pbes_arg::type</a>.</p>

<p class="reference">Referenced by <a class="el" href="pkcs8__decode__flexi_8c_source.html#l00023">pkcs8_decode_flexi()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="tomcrypt__private_8h_a741f04fef81b90c03eeba79d1d680273_cgraph.png" border="0" usemap="#tomcrypt__private_8h_a741f04fef81b90c03eeba79d1d680273_cgraph" alt=""/></div>
<!-- MAP 59 -->
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="tomcrypt__private_8h_a741f04fef81b90c03eeba79d1d680273_icgraph.png" border="0" usemap="#tomcrypt__private_8h_a741f04fef81b90c03eeba79d1d680273_icgraph" alt=""/></div>
<!-- MAP 60 -->
</div>

</div>
</div>
<a id="a7df0f8ba7d5d6b9752a7bb9c5e3f7081"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7df0f8ba7d5d6b9752a7bb9c5e3f7081">&#9670;&nbsp;</a></span>pbes_decrypt()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int pbes_decrypt </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structpbes__arg.html">pbes_arg</a> *&#160;</td>
          <td class="paramname"><em>arg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char *&#160;</td>
          <td class="paramname"><em>dec_data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned long *&#160;</td>
          <td class="paramname"><em>dec_size</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Decrypt Data encrypted via either PBES1 or PBES2. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">arg</td><td>The according PBES parameters </td></tr>
    <tr><td class="paramname">dec_data</td><td>[out] The decrypted data </td></tr>
    <tr><td class="paramname">dec_size</td><td>[in/out] The length of the encrypted resp. decrypted data </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>CRYPT_OK on success </dd></dl>

<p class="definition">Definition at line <a class="el" href="pbes_8c_source.html#l00021">21</a> of file <a class="el" href="pbes_8c_source.html">pbes.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;{</div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;   <span class="keywordtype">int</span> err, hid, cid;</div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;   <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> k[32], *iv;</div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;   <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> klen, keylen, dlen;</div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;   <span class="keywordtype">long</span> diff;</div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;   symmetric_CBC cbc;</div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;</div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;   <a class="code" href="tomcrypt__argchk_8h.html#a683da3e041e49f196318b6ea951414ba">LTC_ARGCHK</a>(arg           != NULL);</div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;   <a class="code" href="tomcrypt__argchk_8h.html#a683da3e041e49f196318b6ea951414ba">LTC_ARGCHK</a>(arg-&gt;<a class="code" href="structpbes__arg.html#a6879b93a34abc3b85c42fea0b0e92156">type</a>.<a class="code" href="structpbes__properties.html#a6edc1f4ee556a89b6812d0be927b1547">kdf</a> != NULL);</div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;   <a class="code" href="tomcrypt__argchk_8h.html#a683da3e041e49f196318b6ea951414ba">LTC_ARGCHK</a>(dec_data      != NULL);</div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;   <a class="code" href="tomcrypt__argchk_8h.html#a683da3e041e49f196318b6ea951414ba">LTC_ARGCHK</a>(dec_size      != NULL);</div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;</div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;   hid = <a class="code" href="tomcrypt__hash_8h.html#a1818254b9c8f09047af3b66ea7f5852b">find_hash</a>(arg-&gt;<a class="code" href="structpbes__arg.html#a6879b93a34abc3b85c42fea0b0e92156">type</a>.<a class="code" href="structpbes__properties.html#ae2a9b6e73cee94acd3d082641c2b6ea8">h</a>);</div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;   <span class="keywordflow">if</span> (hid == -1) <span class="keywordflow">return</span> <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cae729ddc4864ea7e12e9865bf6264642d">CRYPT_INVALID_HASH</a>;</div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;   cid = <a class="code" href="tomcrypt__cipher_8h.html#af5c3882342fd65a17239cd04bfdf44e2">find_cipher</a>(arg-&gt;<a class="code" href="structpbes__arg.html#a6879b93a34abc3b85c42fea0b0e92156">type</a>.<a class="code" href="structpbes__properties.html#a821664389b9d7c6de99aeb7593beb48c">c</a>);</div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;   <span class="keywordflow">if</span> (cid == -1) <span class="keywordflow">return</span> <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06ca302b958f5664adeb427c22f57c9d90a4">CRYPT_INVALID_CIPHER</a>;</div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;</div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;   klen = arg-&gt;<a class="code" href="structpbes__arg.html#a6879b93a34abc3b85c42fea0b0e92156">type</a>.<a class="code" href="structpbes__properties.html#ad29dce0a2ea0da6e3007fbf220383ae4">keylen</a>;</div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;</div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;   <span class="comment">/* RC2 special case */</span></div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;   <span class="keywordflow">if</span> (arg-&gt;<a class="code" href="structpbes__arg.html#ac59e419107215d6c89e2d9789a0c49f4">key_bits</a> != 0) {</div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;      <span class="comment">/* We can&#39;t handle odd lengths of Key Bits */</span></div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;      <span class="keywordflow">if</span> ((arg-&gt;<a class="code" href="structpbes__arg.html#ac59e419107215d6c89e2d9789a0c49f4">key_bits</a> % 8) != 0) <span class="keywordflow">return</span> <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06caafed43f3b625e72191e08e65b4bb5e02">CRYPT_INVALID_KEYSIZE</a>;</div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;      <span class="comment">/* Internally we use bytes, not bits */</span></div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;      klen = arg-&gt;<a class="code" href="structpbes__arg.html#ac59e419107215d6c89e2d9789a0c49f4">key_bits</a> / 8;</div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;   }</div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;   keylen = klen;</div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;</div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;   <span class="keywordflow">if</span> (arg-&gt;<a class="code" href="structpbes__arg.html#aeecdb7fb21b9beacfa5adf1f715eb9fd">iv</a> != NULL) {</div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;      iv = arg-&gt;<a class="code" href="structpbes__arg.html#aeecdb7fb21b9beacfa5adf1f715eb9fd">iv</a>-&gt;data;</div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;      iv = k + klen;</div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;      klen += arg-&gt;<a class="code" href="structpbes__arg.html#a6879b93a34abc3b85c42fea0b0e92156">type</a>.<a class="code" href="structpbes__properties.html#a62ec0e2217643f5e3a52684b067f5dc2">blocklen</a>;</div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;   }</div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;</div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;   <span class="keywordflow">if</span> (klen &gt; <span class="keyword">sizeof</span>(k)) <span class="keywordflow">return</span> <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06ca92aa8bad3930f08d5a188bf72094b066">CRYPT_INVALID_ARG</a>;</div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;</div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;   <span class="keywordflow">if</span> ((err = arg-&gt;<a class="code" href="structpbes__arg.html#a6879b93a34abc3b85c42fea0b0e92156">type</a>.<a class="code" href="structpbes__properties.html#a6edc1f4ee556a89b6812d0be927b1547">kdf</a>(arg-&gt;<a class="code" href="structpbes__arg.html#a146b6c8875be0a3ac9f426327e83186a">pwd</a>, arg-&gt;<a class="code" href="structpbes__arg.html#a6f7f1324f1acfd51dcc7c1e334db7e0a">pwdlen</a>, arg-&gt;<a class="code" href="structpbes__arg.html#a356304efb7c4b45d06779905fd254797">salt</a>-&gt;data, arg-&gt;<a class="code" href="structpbes__arg.html#a356304efb7c4b45d06779905fd254797">salt</a>-&gt;size, arg-&gt;<a class="code" href="structpbes__arg.html#a78b52a8d8572e6947ebe909b51490ec6">iterations</a>, hid, k, &amp;klen)) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>) <span class="keywordflow">goto</span> LBL_ERROR;</div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;   <span class="keywordflow">if</span> ((err = <a class="code" href="cbc__start_8c.html#abba6632aa97f200faf29cdb7f5d99eee">cbc_start</a>(cid, iv, k, keylen, 0, &amp;cbc)) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>) <span class="keywordflow">goto</span> LBL_ERROR;</div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;   <span class="keywordflow">if</span> ((err = <a class="code" href="cbc__decrypt_8c.html#a370774a78d86e94ee3dee504dc15773f">cbc_decrypt</a>(arg-&gt;<a class="code" href="structpbes__arg.html#a8e69f095d7a7e8f5fad6fa49ea2d0d00">enc_data</a>-&gt;data, dec_data, arg-&gt;<a class="code" href="structpbes__arg.html#a8e69f095d7a7e8f5fad6fa49ea2d0d00">enc_data</a>-&gt;size, &amp;cbc)) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>) <span class="keywordflow">goto</span> LBL_ERROR;</div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;   <span class="keywordflow">if</span> ((err = <a class="code" href="cbc__done_8c.html#a13f57f4d9801877029527e4ad3a2dd5f">cbc_done</a>(&amp;cbc)) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>) <span class="keywordflow">goto</span> LBL_ERROR;</div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;   dlen = arg-&gt;<a class="code" href="structpbes__arg.html#a8e69f095d7a7e8f5fad6fa49ea2d0d00">enc_data</a>-&gt;size;</div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;   <span class="keywordflow">if</span> ((err = <a class="code" href="padding__depad_8c.html#a82df175ea5c72fef7e519125bbe9fb89">padding_depad</a>(dec_data, &amp;dlen, LTC_PAD_PKCS7)) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>) <span class="keywordflow">goto</span> LBL_ERROR;</div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;   diff = (long)arg-&gt;<a class="code" href="structpbes__arg.html#a8e69f095d7a7e8f5fad6fa49ea2d0d00">enc_data</a>-&gt;size - (<span class="keywordtype">long</span>)dlen;</div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;   <span class="keywordflow">if</span> ((diff &lt;= 0) || (diff &gt; <a class="code" href="tomcrypt__cipher_8h.html#a47d36a5949d990da7da81e79c44820fb">cipher_descriptor</a>[cid].<a class="code" href="structltc__cipher__descriptor.html#afa2af7325fd3a834910dd92e8c9acf49">block_length</a>)) {</div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;      err = <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06caee3022c2372277db42c7d43310bcb43b">CRYPT_PK_INVALID_PADDING</a>;</div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;      <span class="keywordflow">goto</span> LBL_ERROR;</div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;   }</div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;   *dec_size = dlen;</div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>;</div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;</div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;LBL_ERROR:</div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;   <a class="code" href="tomcrypt__misc_8h.html#a63b6e188713790263bfd3612fe8b398f">zeromem</a>(k, <span class="keyword">sizeof</span>(k));</div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;   <a class="code" href="tomcrypt__misc_8h.html#a63b6e188713790263bfd3612fe8b398f">zeromem</a>(dec_data, *dec_size);</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;   <span class="keywordflow">return</span> err;</div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;}</div><div class="ttc" id="structpbes__properties_html_ad29dce0a2ea0da6e3007fbf220383ae4"><div class="ttname"><a href="structpbes__properties.html#ad29dce0a2ea0da6e3007fbf220383ae4">pbes_properties::keylen</a></div><div class="ttdeci">unsigned long keylen</div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt__private_8h_source.html#l00051">tomcrypt_private.h:51</a></div></div>
<div class="ttc" id="padding__depad_8c_html_a82df175ea5c72fef7e519125bbe9fb89"><div class="ttname"><a href="padding__depad_8c.html#a82df175ea5c72fef7e519125bbe9fb89">padding_depad</a></div><div class="ttdeci">int padding_depad(const unsigned char *data, unsigned long *length, unsigned long mode)</div><div class="ttdoc">Remove padding from your data.</div><div class="ttdef"><b>Definition:</b> <a href="padding__depad_8c_source.html#l00023">padding_depad.c:23</a></div></div>
<div class="ttc" id="tomcrypt_8h_html_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334"><div class="ttname"><a href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a></div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt_8h_source.html#l00042">tomcrypt.h:42</a></div></div>
<div class="ttc" id="tomcrypt__cipher_8h_html_a47d36a5949d990da7da81e79c44820fb"><div class="ttname"><a href="tomcrypt__cipher_8h.html#a47d36a5949d990da7da81e79c44820fb">cipher_descriptor</a></div><div class="ttdeci">struct ltc_cipher_descriptor cipher_descriptor[]</div></div>
<div class="ttc" id="tomcrypt_8h_html_adc29c2ff13d900c2f185ee95427fb06ca302b958f5664adeb427c22f57c9d90a4"><div class="ttname"><a href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06ca302b958f5664adeb427c22f57c9d90a4">CRYPT_INVALID_CIPHER</a></div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt_8h_source.html#l00056">tomcrypt.h:56</a></div></div>
<div class="ttc" id="cbc__start_8c_html_abba6632aa97f200faf29cdb7f5d99eee"><div class="ttname"><a href="cbc__start_8c.html#abba6632aa97f200faf29cdb7f5d99eee">cbc_start</a></div><div class="ttdeci">int cbc_start(int cipher, const unsigned char *IV, const unsigned char *key, int keylen, int num_rounds, symmetric_CBC *cbc)</div><div class="ttdoc">Initialize a CBC context.</div><div class="ttdef"><b>Definition:</b> <a href="cbc__start_8c_source.html#l00028">cbc_start.c:28</a></div></div>
<div class="ttc" id="tomcrypt__hash_8h_html_a1818254b9c8f09047af3b66ea7f5852b"><div class="ttname"><a href="tomcrypt__hash_8h.html#a1818254b9c8f09047af3b66ea7f5852b">find_hash</a></div><div class="ttdeci">int find_hash(const char *name)</div><div class="ttdoc">Find a registered hash by name.</div><div class="ttdef"><b>Definition:</b> <a href="crypt__find__hash_8c_source.html#l00021">crypt_find_hash.c:21</a></div></div>
<div class="ttc" id="tomcrypt__argchk_8h_html_a683da3e041e49f196318b6ea951414ba"><div class="ttname"><a href="tomcrypt__argchk_8h.html#a683da3e041e49f196318b6ea951414ba">LTC_ARGCHK</a></div><div class="ttdeci">#define LTC_ARGCHK(x)</div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt__argchk_8h_source.html#l00019">tomcrypt_argchk.h:19</a></div></div>
<div class="ttc" id="cbc__decrypt_8c_html_a370774a78d86e94ee3dee504dc15773f"><div class="ttname"><a href="cbc__decrypt_8c.html#a370774a78d86e94ee3dee504dc15773f">cbc_decrypt</a></div><div class="ttdeci">int cbc_decrypt(const unsigned char *ct, unsigned char *pt, unsigned long len, symmetric_CBC *cbc)</div><div class="ttdoc">CBC decrypt.</div><div class="ttdef"><b>Definition:</b> <a href="cbc__decrypt_8c_source.html#l00027">cbc_decrypt.c:27</a></div></div>
<div class="ttc" id="structpbes__arg_html_a146b6c8875be0a3ac9f426327e83186a"><div class="ttname"><a href="structpbes__arg.html#a146b6c8875be0a3ac9f426327e83186a">pbes_arg::pwd</a></div><div class="ttdeci">const void * pwd</div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt__private_8h_source.html#l00059">tomcrypt_private.h:59</a></div></div>
<div class="ttc" id="tomcrypt__misc_8h_html_a63b6e188713790263bfd3612fe8b398f"><div class="ttname"><a href="tomcrypt__misc_8h.html#a63b6e188713790263bfd3612fe8b398f">zeromem</a></div><div class="ttdeci">void zeromem(volatile void *out, size_t outlen)</div><div class="ttdoc">Zero a block of memory.</div><div class="ttdef"><b>Definition:</b> <a href="zeromem_8c_source.html#l00021">zeromem.c:21</a></div></div>
<div class="ttc" id="tomcrypt_8h_html_adc29c2ff13d900c2f185ee95427fb06cae729ddc4864ea7e12e9865bf6264642d"><div class="ttname"><a href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cae729ddc4864ea7e12e9865bf6264642d">CRYPT_INVALID_HASH</a></div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt_8h_source.html#l00057">tomcrypt.h:57</a></div></div>
<div class="ttc" id="structpbes__arg_html_ac59e419107215d6c89e2d9789a0c49f4"><div class="ttname"><a href="structpbes__arg.html#ac59e419107215d6c89e2d9789a0c49f4">pbes_arg::key_bits</a></div><div class="ttdeci">unsigned long key_bits</div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt__private_8h_source.html#l00066">tomcrypt_private.h:66</a></div></div>
<div class="ttc" id="tomcrypt__cipher_8h_html_af5c3882342fd65a17239cd04bfdf44e2"><div class="ttname"><a href="tomcrypt__cipher_8h.html#af5c3882342fd65a17239cd04bfdf44e2">find_cipher</a></div><div class="ttdeci">int find_cipher(const char *name)</div><div class="ttdoc">Find a registered cipher by name.</div><div class="ttdef"><b>Definition:</b> <a href="crypt__find__cipher_8c_source.html#l00021">crypt_find_cipher.c:21</a></div></div>
<div class="ttc" id="structpbes__arg_html_aeecdb7fb21b9beacfa5adf1f715eb9fd"><div class="ttname"><a href="structpbes__arg.html#aeecdb7fb21b9beacfa5adf1f715eb9fd">pbes_arg::iv</a></div><div class="ttdeci">ltc_asn1_list * iv</div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt__private_8h_source.html#l00063">tomcrypt_private.h:63</a></div></div>
<div class="ttc" id="structpbes__properties_html_a821664389b9d7c6de99aeb7593beb48c"><div class="ttname"><a href="structpbes__properties.html#a821664389b9d7c6de99aeb7593beb48c">pbes_properties::c</a></div><div class="ttdeci">const char * c</div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt__private_8h_source.html#l00050">tomcrypt_private.h:50</a></div></div>
<div class="ttc" id="tomcrypt_8h_html_adc29c2ff13d900c2f185ee95427fb06ca92aa8bad3930f08d5a188bf72094b066"><div class="ttname"><a href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06ca92aa8bad3930f08d5a188bf72094b066">CRYPT_INVALID_ARG</a></div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt_8h_source.html#l00065">tomcrypt.h:65</a></div></div>
<div class="ttc" id="structpbes__arg_html_a356304efb7c4b45d06779905fd254797"><div class="ttname"><a href="structpbes__arg.html#a356304efb7c4b45d06779905fd254797">pbes_arg::salt</a></div><div class="ttdeci">ltc_asn1_list * salt</div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt__private_8h_source.html#l00062">tomcrypt_private.h:62</a></div></div>
<div class="ttc" id="tomcrypt_8h_html_adc29c2ff13d900c2f185ee95427fb06caafed43f3b625e72191e08e65b4bb5e02"><div class="ttname"><a href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06caafed43f3b625e72191e08e65b4bb5e02">CRYPT_INVALID_KEYSIZE</a></div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt_8h_source.html#l00046">tomcrypt.h:46</a></div></div>
<div class="ttc" id="structpbes__arg_html_a6879b93a34abc3b85c42fea0b0e92156"><div class="ttname"><a href="structpbes__arg.html#a6879b93a34abc3b85c42fea0b0e92156">pbes_arg::type</a></div><div class="ttdeci">pbes_properties type</div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt__private_8h_source.html#l00058">tomcrypt_private.h:58</a></div></div>
<div class="ttc" id="tomcrypt_8h_html_adc29c2ff13d900c2f185ee95427fb06caee3022c2372277db42c7d43310bcb43b"><div class="ttname"><a href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06caee3022c2372277db42c7d43310bcb43b">CRYPT_PK_INVALID_PADDING</a></div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt_8h_source.html#l00079">tomcrypt.h:79</a></div></div>
<div class="ttc" id="structpbes__properties_html_ae2a9b6e73cee94acd3d082641c2b6ea8"><div class="ttname"><a href="structpbes__properties.html#ae2a9b6e73cee94acd3d082641c2b6ea8">pbes_properties::h</a></div><div class="ttdeci">const char * h</div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt__private_8h_source.html#l00048">tomcrypt_private.h:48</a></div></div>
<div class="ttc" id="structpbes__arg_html_a6f7f1324f1acfd51dcc7c1e334db7e0a"><div class="ttname"><a href="structpbes__arg.html#a6f7f1324f1acfd51dcc7c1e334db7e0a">pbes_arg::pwdlen</a></div><div class="ttdeci">unsigned long pwdlen</div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt__private_8h_source.html#l00060">tomcrypt_private.h:60</a></div></div>
<div class="ttc" id="structpbes__properties_html_a62ec0e2217643f5e3a52684b067f5dc2"><div class="ttname"><a href="structpbes__properties.html#a62ec0e2217643f5e3a52684b067f5dc2">pbes_properties::blocklen</a></div><div class="ttdeci">unsigned long blocklen</div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt__private_8h_source.html#l00053">tomcrypt_private.h:53</a></div></div>
<div class="ttc" id="structpbes__arg_html_a78b52a8d8572e6947ebe909b51490ec6"><div class="ttname"><a href="structpbes__arg.html#a78b52a8d8572e6947ebe909b51490ec6">pbes_arg::iterations</a></div><div class="ttdeci">unsigned long iterations</div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt__private_8h_source.html#l00064">tomcrypt_private.h:64</a></div></div>
<div class="ttc" id="cbc__done_8c_html_a13f57f4d9801877029527e4ad3a2dd5f"><div class="ttname"><a href="cbc__done_8c.html#a13f57f4d9801877029527e4ad3a2dd5f">cbc_done</a></div><div class="ttdeci">int cbc_done(symmetric_CBC *cbc)</div><div class="ttdoc">Terminate the chain.</div><div class="ttdef"><b>Definition:</b> <a href="cbc__done_8c_source.html#l00022">cbc_done.c:22</a></div></div>
<div class="ttc" id="structltc__cipher__descriptor_html_afa2af7325fd3a834910dd92e8c9acf49"><div class="ttname"><a href="structltc__cipher__descriptor.html#afa2af7325fd3a834910dd92e8c9acf49">ltc_cipher_descriptor::block_length</a></div><div class="ttdeci">int block_length</div><div class="ttdoc">block size (octets)</div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt__cipher_8h_source.html#l00379">tomcrypt_cipher.h:379</a></div></div>
<div class="ttc" id="structpbes__arg_html_a8e69f095d7a7e8f5fad6fa49ea2d0d00"><div class="ttname"><a href="structpbes__arg.html#a8e69f095d7a7e8f5fad6fa49ea2d0d00">pbes_arg::enc_data</a></div><div class="ttdeci">ltc_asn1_list * enc_data</div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt__private_8h_source.html#l00061">tomcrypt_private.h:61</a></div></div>
<div class="ttc" id="structpbes__properties_html_a6edc1f4ee556a89b6812d0be927b1547"><div class="ttname"><a href="structpbes__properties.html#a6edc1f4ee556a89b6812d0be927b1547">pbes_properties::kdf</a></div><div class="ttdeci">fn_kdf_t kdf</div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt__private_8h_source.html#l00046">tomcrypt_private.h:46</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="tomcrypt__cipher_8h_source.html#l00379">ltc_cipher_descriptor::block_length</a>, <a class="el" href="tomcrypt__private_8h_source.html#l00053">pbes_properties::blocklen</a>, <a class="el" href="tomcrypt__private_8h_source.html#l00050">pbes_properties::c</a>, <a class="el" href="cbc__decrypt_8c_source.html#l00027">cbc_decrypt()</a>, <a class="el" href="cbc__done_8c_source.html#l00022">cbc_done()</a>, <a class="el" href="cbc__start_8c_source.html#l00028">cbc_start()</a>, <a class="el" href="tomcrypt__cipher_8h.html#a47d36a5949d990da7da81e79c44820fb">cipher_descriptor</a>, <a class="el" href="tomcrypt_8h_source.html#l00065">CRYPT_INVALID_ARG</a>, <a class="el" href="tomcrypt_8h_source.html#l00056">CRYPT_INVALID_CIPHER</a>, <a class="el" href="tomcrypt_8h_source.html#l00057">CRYPT_INVALID_HASH</a>, <a class="el" href="tomcrypt_8h_source.html#l00046">CRYPT_INVALID_KEYSIZE</a>, <a class="el" href="tomcrypt_8h_source.html#l00042">CRYPT_OK</a>, <a class="el" href="tomcrypt_8h_source.html#l00079">CRYPT_PK_INVALID_PADDING</a>, <a class="el" href="tomcrypt__private_8h_source.html#l00061">pbes_arg::enc_data</a>, <a class="el" href="crypt__find__cipher_8c_source.html#l00021">find_cipher()</a>, <a class="el" href="crypt__find__hash_8c_source.html#l00021">find_hash()</a>, <a class="el" href="tomcrypt__private_8h_source.html#l00048">pbes_properties::h</a>, <a class="el" href="tomcrypt__private_8h_source.html#l00064">pbes_arg::iterations</a>, <a class="el" href="tomcrypt__private_8h_source.html#l00063">pbes_arg::iv</a>, <a class="el" href="tomcrypt__private_8h_source.html#l00046">pbes_properties::kdf</a>, <a class="el" href="tomcrypt__private_8h_source.html#l00066">pbes_arg::key_bits</a>, <a class="el" href="tomcrypt__private_8h_source.html#l00051">pbes_properties::keylen</a>, <a class="el" href="tomcrypt__argchk_8h_source.html#l00019">LTC_ARGCHK</a>, <a class="el" href="padding__depad_8c_source.html#l00023">padding_depad()</a>, <a class="el" href="tomcrypt__private_8h_source.html#l00059">pbes_arg::pwd</a>, <a class="el" href="tomcrypt__private_8h_source.html#l00060">pbes_arg::pwdlen</a>, <a class="el" href="tomcrypt__private_8h_source.html#l00062">pbes_arg::salt</a>, <a class="el" href="tomcrypt__private_8h_source.html#l00058">pbes_arg::type</a>, and <a class="el" href="zeromem_8c_source.html#l00021">zeromem()</a>.</p>

<p class="reference">Referenced by <a class="el" href="pkcs8__decode__flexi_8c_source.html#l00023">pkcs8_decode_flexi()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="tomcrypt__private_8h_a7df0f8ba7d5d6b9752a7bb9c5e3f7081_cgraph.png" border="0" usemap="#tomcrypt__private_8h_a7df0f8ba7d5d6b9752a7bb9c5e3f7081_cgraph" alt=""/></div>
<!-- MAP 61 -->
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="tomcrypt__private_8h_a7df0f8ba7d5d6b9752a7bb9c5e3f7081_icgraph.png" border="0" usemap="#tomcrypt__private_8h_a7df0f8ba7d5d6b9752a7bb9c5e3f7081_icgraph" alt=""/></div>
<!-- MAP 62 -->
</div>

</div>
</div>
<a id="acff5b3d0c6e1145e07d1a3ff53fadce5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acff5b3d0c6e1145e07d1a3ff53fadce5">&#9670;&nbsp;</a></span>pk_get_oid()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int pk_get_oid </td>
          <td>(</td>
          <td class="paramtype">enum <a class="el" href="tomcrypt__private_8h.html#a981c610adcaa77d61adb80dde41a044b">ltc_oid_id</a>&#160;</td>
          <td class="paramname"><em>id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char **&#160;</td>
          <td class="paramname"><em>st</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="pk__get__oid_8c_source.html#l00029">29</a> of file <a class="el" href="pk__get__oid_8c_source.html">pk_get_oid.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;{</div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;   <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i;</div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;   <a class="code" href="tomcrypt__argchk_8h.html#a683da3e041e49f196318b6ea951414ba">LTC_ARGCHK</a>(st != NULL);</div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;   <span class="keywordflow">for</span> (i = 0; i &lt; <span class="keyword">sizeof</span>(<a class="code" href="pk__get__oid_8c.html#aa1b71c293ec0a64799ecb075399a82bd">pka_oids</a>)/<span class="keyword">sizeof</span>(<a class="code" href="pk__get__oid_8c.html#aa1b71c293ec0a64799ecb075399a82bd">pka_oids</a>[0]); ++i) {</div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="pk__get__oid_8c.html#aa1b71c293ec0a64799ecb075399a82bd">pka_oids</a>[i].<span class="keywordtype">id</span> == <span class="keywordtype">id</span>) {</div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;         *st = <a class="code" href="pk__get__oid_8c.html#aa1b71c293ec0a64799ecb075399a82bd">pka_oids</a>[i].<a class="code" href="structoid__table__entry.html#ae3be974f1f46a4a102d3bab52ef0cf36">oid</a>;</div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;         <span class="keywordflow">return</span> <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>;</div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;      }</div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;   }</div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06ca92aa8bad3930f08d5a188bf72094b066">CRYPT_INVALID_ARG</a>;</div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;}</div><div class="ttc" id="tomcrypt_8h_html_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334"><div class="ttname"><a href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a></div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt_8h_source.html#l00042">tomcrypt.h:42</a></div></div>
<div class="ttc" id="tomcrypt__argchk_8h_html_a683da3e041e49f196318b6ea951414ba"><div class="ttname"><a href="tomcrypt__argchk_8h.html#a683da3e041e49f196318b6ea951414ba">LTC_ARGCHK</a></div><div class="ttdeci">#define LTC_ARGCHK(x)</div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt__argchk_8h_source.html#l00019">tomcrypt_argchk.h:19</a></div></div>
<div class="ttc" id="structoid__table__entry_html_ae3be974f1f46a4a102d3bab52ef0cf36"><div class="ttname"><a href="structoid__table__entry.html#ae3be974f1f46a4a102d3bab52ef0cf36">oid_table_entry::oid</a></div><div class="ttdeci">const char * oid</div><div class="ttdef"><b>Definition:</b> <a href="pk__get__oid_8c_source.html#l00015">pk_get_oid.c:15</a></div></div>
<div class="ttc" id="tomcrypt_8h_html_adc29c2ff13d900c2f185ee95427fb06ca92aa8bad3930f08d5a188bf72094b066"><div class="ttname"><a href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06ca92aa8bad3930f08d5a188bf72094b066">CRYPT_INVALID_ARG</a></div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt_8h_source.html#l00065">tomcrypt.h:65</a></div></div>
<div class="ttc" id="pk__get__oid_8c_html_aa1b71c293ec0a64799ecb075399a82bd"><div class="ttname"><a href="pk__get__oid_8c.html#aa1b71c293ec0a64799ecb075399a82bd">pka_oids</a></div><div class="ttdeci">static const oid_table_entry pka_oids[]</div><div class="ttdef"><b>Definition:</b> <a href="pk__get__oid_8c_source.html#l00018">pk_get_oid.c:18</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="tomcrypt_8h_source.html#l00065">CRYPT_INVALID_ARG</a>, <a class="el" href="tomcrypt_8h_source.html#l00042">CRYPT_OK</a>, <a class="el" href="tomcrypt__argchk_8h_source.html#l00019">LTC_ARGCHK</a>, <a class="el" href="pk__get__oid_8c_source.html#l00015">oid_table_entry::oid</a>, and <a class="el" href="pk__get__oid_8c_source.html#l00018">pka_oids</a>.</p>

<p class="reference">Referenced by <a class="el" href="ecc__export__openssl_8c_source.html#l00023">ecc_export_openssl()</a>, <a class="el" href="ecc__import__pkcs8_8c_source.html#l00046">ecc_import_pkcs8()</a>, <a class="el" href="rsa__import__pkcs8_8c_source.html#l00050">rsa_import_pkcs8()</a>, <a class="el" href="x509__decode__subject__public__key__info_8c_source.html#l00040">x509_decode_subject_public_key_info()</a>, and <a class="el" href="x509__encode__subject__public__key__info_8c_source.html#l00040">x509_encode_subject_public_key_info()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="tomcrypt__private_8h_acff5b3d0c6e1145e07d1a3ff53fadce5_icgraph.png" border="0" usemap="#tomcrypt__private_8h_acff5b3d0c6e1145e07d1a3ff53fadce5_icgraph" alt=""/></div>
<!-- MAP 63 -->
</div>

</div>
</div>
<a id="aaa860b1fbc776e0760df8934a6aa245a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaa860b1fbc776e0760df8934a6aa245a">&#9670;&nbsp;</a></span>pk_oid_cmp_with_asn1()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int pk_oid_cmp_with_asn1 </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>o1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const ltc_asn1_list *&#160;</td>
          <td class="paramname"><em>o2</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="pk__oid__cmp_8c_source.html#l00041">41</a> of file <a class="el" href="pk__oid__cmp_8c_source.html">pk_oid_cmp.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;{</div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;   <span class="keywordflow">if</span> (o1 == NULL || o2 == NULL) <span class="keywordflow">return</span> <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06ca03c22220d7538be04455cd2aa6ddf9da">CRYPT_ERROR</a>;</div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;</div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;   <span class="keywordflow">if</span> (o2-&gt;type != LTC_ASN1_OBJECT_IDENTIFIER) <span class="keywordflow">return</span> <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06ca92aa8bad3930f08d5a188bf72094b066">CRYPT_INVALID_ARG</a>;</div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;</div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="pk__oid__cmp_8c.html#a4283c0cfa77d37ab8add0b7c531d3d6f">pk_oid_cmp_with_ulong</a>(o1, o2-&gt;data, o2-&gt;size);</div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;}</div><div class="ttc" id="pk__oid__cmp_8c_html_a4283c0cfa77d37ab8add0b7c531d3d6f"><div class="ttname"><a href="pk__oid__cmp_8c.html#a4283c0cfa77d37ab8add0b7c531d3d6f">pk_oid_cmp_with_ulong</a></div><div class="ttdeci">int pk_oid_cmp_with_ulong(const char *o1, const unsigned long *o2, unsigned long o2size)</div><div class="ttdef"><b>Definition:</b> <a href="pk__oid__cmp_8c_source.html#l00017">pk_oid_cmp.c:17</a></div></div>
<div class="ttc" id="tomcrypt_8h_html_adc29c2ff13d900c2f185ee95427fb06ca92aa8bad3930f08d5a188bf72094b066"><div class="ttname"><a href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06ca92aa8bad3930f08d5a188bf72094b066">CRYPT_INVALID_ARG</a></div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt_8h_source.html#l00065">tomcrypt.h:65</a></div></div>
<div class="ttc" id="tomcrypt_8h_html_adc29c2ff13d900c2f185ee95427fb06ca03c22220d7538be04455cd2aa6ddf9da"><div class="ttname"><a href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06ca03c22220d7538be04455cd2aa6ddf9da">CRYPT_ERROR</a></div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt_8h_source.html#l00043">tomcrypt.h:43</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="tomcrypt_8h_source.html#l00043">CRYPT_ERROR</a>, <a class="el" href="tomcrypt_8h_source.html#l00065">CRYPT_INVALID_ARG</a>, and <a class="el" href="pk__oid__cmp_8c_source.html#l00017">pk_oid_cmp_with_ulong()</a>.</p>

<p class="reference">Referenced by <a class="el" href="pbes1_8c_source.html#l00075">_pbes1_from_oid()</a>, <a class="el" href="pbes2_8c_source.html#l00054">_pbes2_from_oid()</a>, <a class="el" href="ecc__import__pkcs8_8c_source.html#l00046">ecc_import_pkcs8()</a>, <a class="el" href="pbes2_8c_source.html#l00084">pbes2_extract()</a>, <a class="el" href="rsa__import__pkcs8_8c_source.html#l00050">rsa_import_pkcs8()</a>, and <a class="el" href="x509__decode__subject__public__key__info_8c_source.html#l00040">x509_decode_subject_public_key_info()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="tomcrypt__private_8h_aaa860b1fbc776e0760df8934a6aa245a_cgraph.png" border="0" usemap="#tomcrypt__private_8h_aaa860b1fbc776e0760df8934a6aa245a_cgraph" alt=""/></div>
<!-- MAP 64 -->
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="tomcrypt__private_8h_aaa860b1fbc776e0760df8934a6aa245a_icgraph.png" border="0" usemap="#tomcrypt__private_8h_aaa860b1fbc776e0760df8934a6aa245a_icgraph" alt=""/></div>
<!-- MAP 65 -->
</div>

</div>
</div>
<a id="a4283c0cfa77d37ab8add0b7c531d3d6f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4283c0cfa77d37ab8add0b7c531d3d6f">&#9670;&nbsp;</a></span>pk_oid_cmp_with_ulong()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int pk_oid_cmp_with_ulong </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>o1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned long *&#160;</td>
          <td class="paramname"><em>o2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned long&#160;</td>
          <td class="paramname"><em>o2size</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="pk__oid__cmp_8c_source.html#l00017">17</a> of file <a class="el" href="pk__oid__cmp_8c_source.html">pk_oid_cmp.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;{</div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;   <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> i;</div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;   <span class="keywordtype">char</span> tmp[256] = { 0 };</div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;   <span class="keywordtype">int</span> err;</div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;</div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;   <span class="keywordflow">if</span> (o1 == NULL || o2 == NULL) <span class="keywordflow">return</span> <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06ca03c22220d7538be04455cd2aa6ddf9da">CRYPT_ERROR</a>;</div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;</div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;   i = <span class="keyword">sizeof</span>(tmp);</div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;   <span class="keywordflow">if</span> ((err = <a class="code" href="tomcrypt__private_8h.html#a5ead1435fcad3d1f1842a6419079f036">pk_oid_num_to_str</a>(o2, o2size, tmp, &amp;i)) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>) {</div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;      <span class="keywordflow">return</span> err;</div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;   }</div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;</div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="tomcrypt__cfg_8h.html#a5d6e3d69e1d3f54de008b963bba3c6b3">XSTRCMP</a>(o1, tmp) != 0) {</div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06ca18dac5b6ef2e90712e2ae43c4734f00d">CRYPT_PK_INVALID_TYPE</a>;</div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;   }</div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;</div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>;</div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;}</div><div class="ttc" id="tomcrypt_8h_html_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334"><div class="ttname"><a href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a></div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt_8h_source.html#l00042">tomcrypt.h:42</a></div></div>
<div class="ttc" id="tomcrypt_8h_html_adc29c2ff13d900c2f185ee95427fb06ca18dac5b6ef2e90712e2ae43c4734f00d"><div class="ttname"><a href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06ca18dac5b6ef2e90712e2ae43c4734f00d">CRYPT_PK_INVALID_TYPE</a></div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt_8h_source.html#l00068">tomcrypt.h:68</a></div></div>
<div class="ttc" id="tomcrypt__cfg_8h_html_a5d6e3d69e1d3f54de008b963bba3c6b3"><div class="ttname"><a href="tomcrypt__cfg_8h.html#a5d6e3d69e1d3f54de008b963bba3c6b3">XSTRCMP</a></div><div class="ttdeci">int XSTRCMP(const char *s1, const char *s2)</div></div>
<div class="ttc" id="tomcrypt__private_8h_html_a5ead1435fcad3d1f1842a6419079f036"><div class="ttname"><a href="tomcrypt__private_8h.html#a5ead1435fcad3d1f1842a6419079f036">pk_oid_num_to_str</a></div><div class="ttdeci">int pk_oid_num_to_str(const unsigned long *oid, unsigned long oidlen, char *OID, unsigned long *outlen)</div><div class="ttdef"><b>Definition:</b> <a href="pk__oid__str_8c_source.html#l00050">pk_oid_str.c:50</a></div></div>
<div class="ttc" id="tomcrypt_8h_html_adc29c2ff13d900c2f185ee95427fb06ca03c22220d7538be04455cd2aa6ddf9da"><div class="ttname"><a href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06ca03c22220d7538be04455cd2aa6ddf9da">CRYPT_ERROR</a></div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt_8h_source.html#l00043">tomcrypt.h:43</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="tomcrypt_8h_source.html#l00043">CRYPT_ERROR</a>, <a class="el" href="tomcrypt_8h_source.html#l00042">CRYPT_OK</a>, <a class="el" href="tomcrypt_8h_source.html#l00068">CRYPT_PK_INVALID_TYPE</a>, <a class="el" href="pk__oid__str_8c_source.html#l00050">pk_oid_num_to_str()</a>, and <a class="el" href="tomcrypt__cfg_8h.html#a5d6e3d69e1d3f54de008b963bba3c6b3">XSTRCMP()</a>.</p>

<p class="reference">Referenced by <a class="el" href="ecc__recover__key_8c_source.html#l00032">ecc_recover_key()</a>, <a class="el" href="ecc__sign__hash_8c_source.html#l00032">ecc_sign_hash_ex()</a>, <a class="el" href="ecc__verify__hash_8c_source.html#l00030">ecc_verify_hash_ex()</a>, and <a class="el" href="pk__oid__cmp_8c_source.html#l00041">pk_oid_cmp_with_asn1()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="tomcrypt__private_8h_a4283c0cfa77d37ab8add0b7c531d3d6f_cgraph.png" border="0" usemap="#tomcrypt__private_8h_a4283c0cfa77d37ab8add0b7c531d3d6f_cgraph" alt=""/></div>
<!-- MAP 66 -->
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="tomcrypt__private_8h_a4283c0cfa77d37ab8add0b7c531d3d6f_icgraph.png" border="0" usemap="#tomcrypt__private_8h_a4283c0cfa77d37ab8add0b7c531d3d6f_icgraph" alt=""/></div>
<!-- MAP 67 -->
</div>

</div>
</div>
<a id="a5ead1435fcad3d1f1842a6419079f036"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5ead1435fcad3d1f1842a6419079f036">&#9670;&nbsp;</a></span>pk_oid_num_to_str()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int pk_oid_num_to_str </td>
          <td>(</td>
          <td class="paramtype">const unsigned long *&#160;</td>
          <td class="paramname"><em>oid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned long&#160;</td>
          <td class="paramname"><em>oidlen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>OID</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned long *&#160;</td>
          <td class="paramname"><em>outlen</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="pk__oid__str_8c_source.html#l00050">50</a> of file <a class="el" href="pk__oid__str_8c_source.html">pk_oid_str.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;{</div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;   <span class="keywordtype">int</span> i;</div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;   <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> j, k;</div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;   <span class="keywordtype">char</span> tmp[256] = { 0 };</div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;</div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;   <a class="code" href="tomcrypt__argchk_8h.html#a683da3e041e49f196318b6ea951414ba">LTC_ARGCHK</a>(oid != NULL);</div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;   <a class="code" href="tomcrypt__argchk_8h.html#a683da3e041e49f196318b6ea951414ba">LTC_ARGCHK</a>(<a class="code" href="ecc__find__curve_8c.html#a3b9aae9990e63034f7d199729f025b23">OID</a> != NULL);</div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;   <a class="code" href="tomcrypt__argchk_8h.html#a683da3e041e49f196318b6ea951414ba">LTC_ARGCHK</a>(outlen != NULL);</div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;</div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;   <span class="keywordflow">for</span> (i = oidlen - 1, k = 0; i &gt;= 0; i--) {</div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;      j = oid[i];</div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;      <span class="keywordflow">if</span> (j == 0) {</div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;         tmp[k] = <span class="charliteral">&#39;0&#39;</span>;</div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;         <span class="keywordflow">if</span> (++k &gt;= <span class="keyword">sizeof</span>(tmp)) <span class="keywordflow">return</span> <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06ca03c22220d7538be04455cd2aa6ddf9da">CRYPT_ERROR</a>;</div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;      }</div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;      <span class="keywordflow">else</span> {</div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;         <span class="keywordflow">while</span> (j &gt; 0) {</div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;            tmp[k] = <span class="charliteral">&#39;0&#39;</span> + (j % 10);</div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;            <span class="keywordflow">if</span> (++k &gt;= <span class="keyword">sizeof</span>(tmp)) <span class="keywordflow">return</span> <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06ca03c22220d7538be04455cd2aa6ddf9da">CRYPT_ERROR</a>;</div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;            j /= 10;</div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;         }</div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;      }</div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;      <span class="keywordflow">if</span> (i &gt; 0) {</div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;        tmp[k] = <span class="charliteral">&#39;.&#39;</span>;</div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;        <span class="keywordflow">if</span> (++k &gt;= <span class="keyword">sizeof</span>(tmp)) <span class="keywordflow">return</span> <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06ca03c22220d7538be04455cd2aa6ddf9da">CRYPT_ERROR</a>;</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;      }</div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;   }</div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;   <span class="keywordflow">if</span> (*outlen &lt; k + 1) {</div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;      *outlen = k + 1;</div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06caccd878f5599f3036ffe759dbe1a1ac16">CRYPT_BUFFER_OVERFLOW</a>;</div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;   }</div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;   <span class="keywordflow">for</span> (j = 0; j &lt; k; j++) <a class="code" href="ecc__find__curve_8c.html#a3b9aae9990e63034f7d199729f025b23">OID</a>[j] = tmp[k - j - 1];</div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;   <a class="code" href="ecc__find__curve_8c.html#a3b9aae9990e63034f7d199729f025b23">OID</a>[k] = <span class="charliteral">&#39;\0&#39;</span>;</div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;   *outlen = k; <span class="comment">/* the length without terminating NUL byte */</span></div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>;</div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;}</div><div class="ttc" id="tomcrypt_8h_html_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334"><div class="ttname"><a href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a></div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt_8h_source.html#l00042">tomcrypt.h:42</a></div></div>
<div class="ttc" id="ecc__find__curve_8c_html_a3b9aae9990e63034f7d199729f025b23"><div class="ttname"><a href="ecc__find__curve_8c.html#a3b9aae9990e63034f7d199729f025b23">OID</a></div><div class="ttdeci">const char * OID</div><div class="ttdef"><b>Definition:</b> <a href="ecc__find__curve_8c_source.html#l00015">ecc_find_curve.c:15</a></div></div>
<div class="ttc" id="tomcrypt__argchk_8h_html_a683da3e041e49f196318b6ea951414ba"><div class="ttname"><a href="tomcrypt__argchk_8h.html#a683da3e041e49f196318b6ea951414ba">LTC_ARGCHK</a></div><div class="ttdeci">#define LTC_ARGCHK(x)</div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt__argchk_8h_source.html#l00019">tomcrypt_argchk.h:19</a></div></div>
<div class="ttc" id="tomcrypt_8h_html_adc29c2ff13d900c2f185ee95427fb06caccd878f5599f3036ffe759dbe1a1ac16"><div class="ttname"><a href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06caccd878f5599f3036ffe759dbe1a1ac16">CRYPT_BUFFER_OVERFLOW</a></div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt_8h_source.html#l00050">tomcrypt.h:50</a></div></div>
<div class="ttc" id="tomcrypt_8h_html_adc29c2ff13d900c2f185ee95427fb06ca03c22220d7538be04455cd2aa6ddf9da"><div class="ttname"><a href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06ca03c22220d7538be04455cd2aa6ddf9da">CRYPT_ERROR</a></div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt_8h_source.html#l00043">tomcrypt.h:43</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="tomcrypt_8h_source.html#l00050">CRYPT_BUFFER_OVERFLOW</a>, <a class="el" href="tomcrypt_8h_source.html#l00043">CRYPT_ERROR</a>, <a class="el" href="tomcrypt_8h_source.html#l00042">CRYPT_OK</a>, <a class="el" href="tomcrypt__argchk_8h_source.html#l00019">LTC_ARGCHK</a>, and <a class="el" href="ecc__find__curve_8c_source.html#l00015">OID</a>.</p>

<p class="reference">Referenced by <a class="el" href="ecc__import__openssl_8c_source.html#l00014">_ecc_import_private_with_oid()</a>, <a class="el" href="ecc__import__x509_8c_source.html#l00013">_ecc_import_x509_with_oid()</a>, <a class="el" href="ecc__get__oid__str_8c_source.html#l00021">ecc_get_oid_str()</a>, <a class="el" href="ecc__import__pkcs8_8c_source.html#l00046">ecc_import_pkcs8()</a>, and <a class="el" href="pk__oid__cmp_8c_source.html#l00017">pk_oid_cmp_with_ulong()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="tomcrypt__private_8h_a5ead1435fcad3d1f1842a6419079f036_icgraph.png" border="0" usemap="#tomcrypt__private_8h_a5ead1435fcad3d1f1842a6419079f036_icgraph" alt=""/></div>
<!-- MAP 68 -->
</div>

</div>
</div>
<a id="ad99c87d19f50f703708d36a931fe5df6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad99c87d19f50f703708d36a931fe5df6">&#9670;&nbsp;</a></span>pk_oid_str_to_num()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int pk_oid_str_to_num </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>OID</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned long *&#160;</td>
          <td class="paramname"><em>oid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned long *&#160;</td>
          <td class="paramname"><em>oidlen</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="pk__oid__str_8c_source.html#l00012">12</a> of file <a class="el" href="pk__oid__str_8c_source.html">pk_oid_str.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;{</div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;   <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> i, j, limit, OID_len, oid_j;</div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;</div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;   <a class="code" href="tomcrypt__argchk_8h.html#a683da3e041e49f196318b6ea951414ba">LTC_ARGCHK</a>(oidlen != NULL);</div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;</div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;   limit = *oidlen;</div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;   *oidlen = 0; <span class="comment">/* make sure that we return zero oidlen on error */</span></div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;   <span class="keywordflow">for</span> (i = 0; i &lt; limit; i++) oid[i] = 0;</div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;</div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="ecc__find__curve_8c.html#a3b9aae9990e63034f7d199729f025b23">OID</a> == NULL) <span class="keywordflow">return</span> <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>;</div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;</div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;   OID_len = strlen(<a class="code" href="ecc__find__curve_8c.html#a3b9aae9990e63034f7d199729f025b23">OID</a>);</div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;   <span class="keywordflow">if</span> (OID_len == 0) <span class="keywordflow">return</span> <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>;</div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;</div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;   <span class="keywordflow">for</span> (i = 0, j = 0; i &lt; OID_len; i++) {</div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="ecc__find__curve_8c.html#a3b9aae9990e63034f7d199729f025b23">OID</a>[i] == <span class="charliteral">&#39;.&#39;</span>) {</div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;         <span class="keywordflow">if</span> (++j &gt;= limit) <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;      }</div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((<a class="code" href="ecc__find__curve_8c.html#a3b9aae9990e63034f7d199729f025b23">OID</a>[i] &gt;= <span class="charliteral">&#39;0&#39;</span>) &amp;&amp; (<a class="code" href="ecc__find__curve_8c.html#a3b9aae9990e63034f7d199729f025b23">OID</a>[i] &lt;= <span class="charliteral">&#39;9&#39;</span>)) {</div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;         <span class="keywordflow">if</span> ((j &gt;= limit) || (oid == NULL)) <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;         oid_j = oid[j];</div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;         oid[j] = oid[j] * 10 + (<a class="code" href="ecc__find__curve_8c.html#a3b9aae9990e63034f7d199729f025b23">OID</a>[i] - <span class="charliteral">&#39;0&#39;</span>);</div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;         <span class="keywordflow">if</span> (oid[j] &lt; oid_j) <span class="keywordflow">return</span> <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06ca3a147cc0bbea3f8779364ad00c2678b4">CRYPT_OVERFLOW</a>;</div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;      }</div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;      <span class="keywordflow">else</span> {</div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;         <span class="keywordflow">return</span> <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06ca03c22220d7538be04455cd2aa6ddf9da">CRYPT_ERROR</a>;</div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;      }</div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;   }</div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;   <span class="keywordflow">if</span> (j == 0) <span class="keywordflow">return</span> <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06ca03c22220d7538be04455cd2aa6ddf9da">CRYPT_ERROR</a>;</div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;   <span class="keywordflow">if</span> (j &gt;= limit) {</div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;      *oidlen = j;</div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06caccd878f5599f3036ffe759dbe1a1ac16">CRYPT_BUFFER_OVERFLOW</a>;</div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;   }</div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;   *oidlen = j + 1;</div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>;</div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;}</div><div class="ttc" id="tomcrypt_8h_html_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334"><div class="ttname"><a href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a></div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt_8h_source.html#l00042">tomcrypt.h:42</a></div></div>
<div class="ttc" id="ecc__find__curve_8c_html_a3b9aae9990e63034f7d199729f025b23"><div class="ttname"><a href="ecc__find__curve_8c.html#a3b9aae9990e63034f7d199729f025b23">OID</a></div><div class="ttdeci">const char * OID</div><div class="ttdef"><b>Definition:</b> <a href="ecc__find__curve_8c_source.html#l00015">ecc_find_curve.c:15</a></div></div>
<div class="ttc" id="tomcrypt__argchk_8h_html_a683da3e041e49f196318b6ea951414ba"><div class="ttname"><a href="tomcrypt__argchk_8h.html#a683da3e041e49f196318b6ea951414ba">LTC_ARGCHK</a></div><div class="ttdeci">#define LTC_ARGCHK(x)</div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt__argchk_8h_source.html#l00019">tomcrypt_argchk.h:19</a></div></div>
<div class="ttc" id="tomcrypt_8h_html_adc29c2ff13d900c2f185ee95427fb06ca3a147cc0bbea3f8779364ad00c2678b4"><div class="ttname"><a href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06ca3a147cc0bbea3f8779364ad00c2678b4">CRYPT_OVERFLOW</a></div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt_8h_source.html#l00070">tomcrypt.h:70</a></div></div>
<div class="ttc" id="tomcrypt_8h_html_adc29c2ff13d900c2f185ee95427fb06caccd878f5599f3036ffe759dbe1a1ac16"><div class="ttname"><a href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06caccd878f5599f3036ffe759dbe1a1ac16">CRYPT_BUFFER_OVERFLOW</a></div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt_8h_source.html#l00050">tomcrypt.h:50</a></div></div>
<div class="ttc" id="tomcrypt_8h_html_adc29c2ff13d900c2f185ee95427fb06ca03c22220d7538be04455cd2aa6ddf9da"><div class="ttname"><a href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06ca03c22220d7538be04455cd2aa6ddf9da">CRYPT_ERROR</a></div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt_8h_source.html#l00043">tomcrypt.h:43</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="tomcrypt_8h_source.html#l00050">CRYPT_BUFFER_OVERFLOW</a>, <a class="el" href="tomcrypt_8h_source.html#l00043">CRYPT_ERROR</a>, <a class="el" href="tomcrypt_8h_source.html#l00042">CRYPT_OK</a>, <a class="el" href="tomcrypt_8h_source.html#l00070">CRYPT_OVERFLOW</a>, <a class="el" href="tomcrypt__argchk_8h_source.html#l00019">LTC_ARGCHK</a>, and <a class="el" href="ecc__find__curve_8c_source.html#l00015">OID</a>.</p>

<p class="reference">Referenced by <a class="el" href="ecc__set__curve__internal_8c_source.html#l00021">_ecc_oid_lookup()</a>, <a class="el" href="ecc__export__openssl_8c_source.html#l00023">ecc_export_openssl()</a>, <a class="el" href="ecc__set__curve_8c_source.html#l00014">ecc_set_curve()</a>, and <a class="el" href="x509__encode__subject__public__key__info_8c_source.html#l00040">x509_encode_subject_public_key_info()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="tomcrypt__private_8h_ad99c87d19f50f703708d36a931fe5df6_icgraph.png" border="0" usemap="#tomcrypt__private_8h_ad99c87d19f50f703708d36a931fe5df6_icgraph" alt=""/></div>
<!-- MAP 69 -->
</div>

</div>
</div>
<a id="a362c9fba9251fa6d35445f4ccae24fe8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a362c9fba9251fa6d35445f4ccae24fe8">&#9670;&nbsp;</a></span>pkcs12_kdf()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int pkcs12_kdf </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>hash_id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned char *&#160;</td>
          <td class="paramname"><em>pw</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned long&#160;</td>
          <td class="paramname"><em>pwlen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned char *&#160;</td>
          <td class="paramname"><em>salt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned long&#160;</td>
          <td class="paramname"><em>saltlen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>iterations</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char&#160;</td>
          <td class="paramname"><em>purpose</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char *&#160;</td>
          <td class="paramname"><em>out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned long&#160;</td>
          <td class="paramname"><em>outlen</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="pkcs12__kdf_8c_source.html#l00014">14</a> of file <a class="el" href="pkcs12__kdf_8c_source.html">pkcs12_kdf.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;{</div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;   <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> u = <a class="code" href="tomcrypt__hash_8h.html#ab0e4f02e30a47da79baa9240e79cde92">hash_descriptor</a>[hash_id].<a class="code" href="structltc__hash__descriptor.html#a49bd027653ff21408cb2661748d719ef">hashsize</a>;</div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;   <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> v = <a class="code" href="tomcrypt__hash_8h.html#ab0e4f02e30a47da79baa9240e79cde92">hash_descriptor</a>[hash_id].<a class="code" href="structltc__hash__descriptor.html#ad0ac47c32e536997b59a5571acae2251">blocksize</a>;</div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;   <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <a class="code" href="khazad_8c.html#a86ea50de5a3e0ae87762f4298d35284c">c</a> = (outlen + u - 1) / u;</div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;   <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> Slen = ((saltlen + v - 1) / v) * v;</div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;   <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> Plen = ((pwlen + v - 1) / v) * v;</div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;   <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> k = (Plen + Slen) / v;</div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;   <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> Alen, keylen = 0;</div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;   <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> tmp, i, j, n;</div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;   <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> ch;</div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;   <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> D[<a class="code" href="tomcrypt_8h.html#ab59933beebb2b857c992b93cf53f0d10">MAXBLOCKSIZE</a>], A[<a class="code" href="tomcrypt_8h.html#ab59933beebb2b857c992b93cf53f0d10">MAXBLOCKSIZE</a>], B[<a class="code" href="tomcrypt_8h.html#ab59933beebb2b857c992b93cf53f0d10">MAXBLOCKSIZE</a>];</div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;   <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *<a class="code" href="md5_8c.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, *key;</div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;   <span class="keywordtype">int</span> err = <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06ca03c22220d7538be04455cd2aa6ddf9da">CRYPT_ERROR</a>;</div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;</div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;   <a class="code" href="tomcrypt__argchk_8h.html#a683da3e041e49f196318b6ea951414ba">LTC_ARGCHK</a>(pw   != NULL);</div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;   <a class="code" href="tomcrypt__argchk_8h.html#a683da3e041e49f196318b6ea951414ba">LTC_ARGCHK</a>(salt != NULL);</div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;   <a class="code" href="tomcrypt__argchk_8h.html#a683da3e041e49f196318b6ea951414ba">LTC_ARGCHK</a>(out  != NULL);</div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;</div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;   key = <a class="code" href="tomcrypt__cfg_8h.html#af363355f38fbaacdefacf270436ae1c9">XMALLOC</a>(u * <a class="code" href="khazad_8c.html#a86ea50de5a3e0ae87762f4298d35284c">c</a>);</div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;   <a class="code" href="md5_8c.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>   = <a class="code" href="tomcrypt__cfg_8h.html#af363355f38fbaacdefacf270436ae1c9">XMALLOC</a>(Plen + Slen);</div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;   <span class="keywordflow">if</span> (key == NULL || <a class="code" href="md5_8c.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> == NULL) <span class="keywordflow">goto</span> DONE;</div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;   <a class="code" href="tomcrypt__misc_8h.html#a63b6e188713790263bfd3612fe8b398f">zeromem</a>(key, u * <a class="code" href="khazad_8c.html#a86ea50de5a3e0ae87762f4298d35284c">c</a>);</div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;</div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;   <span class="keywordflow">for</span> (i = 0; i &lt; v;    i++) D[i] = purpose;              <span class="comment">/* D - diversifier */</span></div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;   <span class="keywordflow">for</span> (i = 0; i &lt; Slen; i++) <a class="code" href="md5_8c.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>[i] = salt[i % saltlen];</div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;   <span class="keywordflow">for</span> (i = 0; i &lt; Plen; i++) <a class="code" href="md5_8c.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>[Slen + i] = pw[i % pwlen]; <span class="comment">/* I = Salt || Pass */</span></div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;</div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;   <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="khazad_8c.html#a86ea50de5a3e0ae87762f4298d35284c">c</a>; i++) {</div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;      Alen = <span class="keyword">sizeof</span>(A);</div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;      err = <a class="code" href="hash__memory__multi_8c.html#a85566393d0f13710bafc9501361eff06">hash_memory_multi</a>(hash_id, A, &amp;Alen, D, v, <a class="code" href="md5_8c.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, Slen + Plen, NULL); <span class="comment">/* A = HASH(D || I) */</span></div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;      <span class="keywordflow">if</span> (err != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>) <span class="keywordflow">goto</span> DONE;</div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;      <span class="keywordflow">for</span> (j = 1; j &lt; iterations; j++) {</div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;         err = <a class="code" href="hash__memory_8c.html#a8672bf28488595ef1519a6754498869c">hash_memory</a>(hash_id, A, Alen, A, &amp;Alen); <span class="comment">/* A = HASH(A) */</span></div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;         <span class="keywordflow">if</span> (err != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>) <span class="keywordflow">goto</span> DONE;</div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;      }</div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;      <span class="comment">/* fill buffer B with A */</span></div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;      <span class="keywordflow">for</span> (j = 0; j &lt; v; j++) B[j] = A[j % Alen];</div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;      <span class="comment">/* B += 1 */</span></div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;      <span class="keywordflow">for</span> (j = v; j &gt; 0; j--) {</div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;         <span class="keywordflow">if</span> (++B[j - 1] != 0) <span class="keywordflow">break</span>;</div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;      }</div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;      <span class="comment">/* I_n += B */</span></div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;      <span class="keywordflow">for</span> (n = 0; n &lt; k; n++) {</div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;         ch = 0;</div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;         <span class="keywordflow">for</span> (j = v; j &gt; 0; j--) {</div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;            tmp = <a class="code" href="md5_8c.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>[n * v + j - 1] + B[j - 1] + ch;</div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;            ch = (<span class="keywordtype">unsigned</span> char)((tmp &gt;&gt; 8) &amp; 0xFF);</div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;            <a class="code" href="md5_8c.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>[n * v + j - 1] = (<span class="keywordtype">unsigned</span> char)(tmp &amp; 0xFF);</div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;         }</div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;      }</div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;      <span class="comment">/* store derived key block */</span></div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;      <a class="code" href="tomcrypt__cfg_8h.html#a7691dd48d60d5fc6daf2fa7ec4c55e12">XMEMCPY</a>(&amp;key[keylen], A, Alen);</div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;      keylen += Alen;</div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;   }</div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;</div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;   <a class="code" href="tomcrypt__cfg_8h.html#a7691dd48d60d5fc6daf2fa7ec4c55e12">XMEMCPY</a>(out, key, outlen);</div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;   err = <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>;</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;DONE:</div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="md5_8c.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>) {</div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;      <a class="code" href="tomcrypt__misc_8h.html#a63b6e188713790263bfd3612fe8b398f">zeromem</a>(<a class="code" href="md5_8c.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, Plen + Slen);</div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;      <a class="code" href="tomcrypt__cfg_8h.html#a260d66fc0690e0502cf3bfe7b5244b75">XFREE</a>(<a class="code" href="md5_8c.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>);</div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;   }</div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;   <span class="keywordflow">if</span> (key) {</div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;      <a class="code" href="tomcrypt__misc_8h.html#a63b6e188713790263bfd3612fe8b398f">zeromem</a>(key, u * <a class="code" href="khazad_8c.html#a86ea50de5a3e0ae87762f4298d35284c">c</a>);</div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;      <a class="code" href="tomcrypt__cfg_8h.html#a260d66fc0690e0502cf3bfe7b5244b75">XFREE</a>(key);</div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;   }</div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;   <span class="keywordflow">return</span> err;</div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;}</div><div class="ttc" id="tomcrypt__hash_8h_html_ab0e4f02e30a47da79baa9240e79cde92"><div class="ttname"><a href="tomcrypt__hash_8h.html#ab0e4f02e30a47da79baa9240e79cde92">hash_descriptor</a></div><div class="ttdeci">struct ltc_hash_descriptor hash_descriptor[]</div></div>
<div class="ttc" id="tomcrypt_8h_html_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334"><div class="ttname"><a href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a></div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt_8h_source.html#l00042">tomcrypt.h:42</a></div></div>
<div class="ttc" id="hash__memory_8c_html_a8672bf28488595ef1519a6754498869c"><div class="ttname"><a href="hash__memory_8c.html#a8672bf28488595ef1519a6754498869c">hash_memory</a></div><div class="ttdeci">int hash_memory(int hash, const unsigned char *in, unsigned long inlen, unsigned char *out, unsigned long *outlen)</div><div class="ttdoc">Hash a block of memory and store the digest.</div><div class="ttdef"><b>Definition:</b> <a href="hash__memory_8c_source.html#l00026">hash_memory.c:26</a></div></div>
<div class="ttc" id="tomcrypt__cfg_8h_html_af363355f38fbaacdefacf270436ae1c9"><div class="ttname"><a href="tomcrypt__cfg_8h.html#af363355f38fbaacdefacf270436ae1c9">XMALLOC</a></div><div class="ttdeci">void * XMALLOC(size_t n)</div></div>
<div class="ttc" id="tomcrypt__argchk_8h_html_a683da3e041e49f196318b6ea951414ba"><div class="ttname"><a href="tomcrypt__argchk_8h.html#a683da3e041e49f196318b6ea951414ba">LTC_ARGCHK</a></div><div class="ttdeci">#define LTC_ARGCHK(x)</div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt__argchk_8h_source.html#l00019">tomcrypt_argchk.h:19</a></div></div>
<div class="ttc" id="tomcrypt_8h_html_ab59933beebb2b857c992b93cf53f0d10"><div class="ttname"><a href="tomcrypt_8h.html#ab59933beebb2b857c992b93cf53f0d10">MAXBLOCKSIZE</a></div><div class="ttdeci">#define MAXBLOCKSIZE</div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt_8h_source.html#l00033">tomcrypt.h:33</a></div></div>
<div class="ttc" id="tomcrypt__misc_8h_html_a63b6e188713790263bfd3612fe8b398f"><div class="ttname"><a href="tomcrypt__misc_8h.html#a63b6e188713790263bfd3612fe8b398f">zeromem</a></div><div class="ttdeci">void zeromem(volatile void *out, size_t outlen)</div><div class="ttdoc">Zero a block of memory.</div><div class="ttdef"><b>Definition:</b> <a href="zeromem_8c_source.html#l00021">zeromem.c:21</a></div></div>
<div class="ttc" id="tomcrypt__cfg_8h_html_a260d66fc0690e0502cf3bfe7b5244b75"><div class="ttname"><a href="tomcrypt__cfg_8h.html#a260d66fc0690e0502cf3bfe7b5244b75">XFREE</a></div><div class="ttdeci">void XFREE(void *p)</div></div>
<div class="ttc" id="khazad_8c_html_a86ea50de5a3e0ae87762f4298d35284c"><div class="ttname"><a href="khazad_8c.html#a86ea50de5a3e0ae87762f4298d35284c">c</a></div><div class="ttdeci">static const ulong64 c[8+1]</div><div class="ttdef"><b>Definition:</b> <a href="khazad_8c_source.html#l00570">khazad.c:570</a></div></div>
<div class="ttc" id="structltc__hash__descriptor_html_a49bd027653ff21408cb2661748d719ef"><div class="ttname"><a href="structltc__hash__descriptor.html#a49bd027653ff21408cb2661748d719ef">ltc_hash_descriptor::hashsize</a></div><div class="ttdeci">unsigned long hashsize</div><div class="ttdoc">Size of digest in octets.</div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt__hash_8h_source.html#l00211">tomcrypt_hash.h:211</a></div></div>
<div class="ttc" id="hash__memory__multi_8c_html_a85566393d0f13710bafc9501361eff06"><div class="ttname"><a href="hash__memory__multi_8c.html#a85566393d0f13710bafc9501361eff06">hash_memory_multi</a></div><div class="ttdeci">int hash_memory_multi(int hash, unsigned char *out, unsigned long *outlen, const unsigned char *in, unsigned long inlen,...)</div><div class="ttdoc">Hash multiple (non-adjacent) blocks of memory at once.</div><div class="ttdef"><b>Definition:</b> <a href="hash__memory__multi_8c_source.html#l00028">hash_memory_multi.c:28</a></div></div>
<div class="ttc" id="structltc__hash__descriptor_html_ad0ac47c32e536997b59a5571acae2251"><div class="ttname"><a href="structltc__hash__descriptor.html#ad0ac47c32e536997b59a5571acae2251">ltc_hash_descriptor::blocksize</a></div><div class="ttdeci">unsigned long blocksize</div><div class="ttdoc">Input block size in octets.</div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt__hash_8h_source.html#l00213">tomcrypt_hash.h:213</a></div></div>
<div class="ttc" id="tomcrypt__cfg_8h_html_a7691dd48d60d5fc6daf2fa7ec4c55e12"><div class="ttname"><a href="tomcrypt__cfg_8h.html#a7691dd48d60d5fc6daf2fa7ec4c55e12">XMEMCPY</a></div><div class="ttdeci">void * XMEMCPY(void *dest, const void *src, size_t n)</div></div>
<div class="ttc" id="md5_8c_html_ac0eafdc9ee161b71e7af98af736952fd"><div class="ttname"><a href="md5_8c.html#ac0eafdc9ee161b71e7af98af736952fd">I</a></div><div class="ttdeci">#define I(x, y, z)</div><div class="ttdef"><b>Definition:</b> <a href="md5_8c_source.html#l00040">md5.c:40</a></div></div>
<div class="ttc" id="tomcrypt_8h_html_adc29c2ff13d900c2f185ee95427fb06ca03c22220d7538be04455cd2aa6ddf9da"><div class="ttname"><a href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06ca03c22220d7538be04455cd2aa6ddf9da">CRYPT_ERROR</a></div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt_8h_source.html#l00043">tomcrypt.h:43</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="tomcrypt__hash_8h_source.html#l00213">ltc_hash_descriptor::blocksize</a>, <a class="el" href="khazad_8c_source.html#l00570">c</a>, <a class="el" href="tomcrypt_8h_source.html#l00043">CRYPT_ERROR</a>, <a class="el" href="tomcrypt_8h_source.html#l00042">CRYPT_OK</a>, <a class="el" href="tomcrypt__hash_8h.html#ab0e4f02e30a47da79baa9240e79cde92">hash_descriptor</a>, <a class="el" href="hash__memory_8c_source.html#l00026">hash_memory()</a>, <a class="el" href="hash__memory__multi_8c_source.html#l00028">hash_memory_multi()</a>, <a class="el" href="tomcrypt__hash_8h_source.html#l00211">ltc_hash_descriptor::hashsize</a>, <a class="el" href="md5_8c_source.html#l00040">I</a>, <a class="el" href="tomcrypt__argchk_8h_source.html#l00019">LTC_ARGCHK</a>, <a class="el" href="tomcrypt_8h_source.html#l00033">MAXBLOCKSIZE</a>, <a class="el" href="tomcrypt__cfg_8h.html#a260d66fc0690e0502cf3bfe7b5244b75">XFREE()</a>, <a class="el" href="tomcrypt__cfg_8h.html#af363355f38fbaacdefacf270436ae1c9">XMALLOC()</a>, <a class="el" href="tomcrypt__cfg_8h.html#a7691dd48d60d5fc6daf2fa7ec4c55e12">XMEMCPY()</a>, and <a class="el" href="zeromem_8c_source.html#l00021">zeromem()</a>.</p>

<p class="reference">Referenced by <a class="el" href="pbes1_8c_source.html#l00022">_pkcs_12_wrap()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="tomcrypt__private_8h_a362c9fba9251fa6d35445f4ccae24fe8_cgraph.png" border="0" usemap="#tomcrypt__private_8h_a362c9fba9251fa6d35445f4ccae24fe8_cgraph" alt=""/></div>
<!-- MAP 70 -->
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="tomcrypt__private_8h_a362c9fba9251fa6d35445f4ccae24fe8_icgraph.png" border="0" usemap="#tomcrypt__private_8h_a362c9fba9251fa6d35445f4ccae24fe8_icgraph" alt=""/></div>
<!-- MAP 71 -->
</div>

</div>
</div>
<a id="af7de8585646f421393f3c744654ae587"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af7de8585646f421393f3c744654ae587">&#9670;&nbsp;</a></span>pkcs12_utf8_to_utf16()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int pkcs12_utf8_to_utf16 </td>
          <td>(</td>
          <td class="paramtype">const unsigned char *&#160;</td>
          <td class="paramname"><em>in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned long&#160;</td>
          <td class="paramname"><em>inlen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char *&#160;</td>
          <td class="paramname"><em>out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned long *&#160;</td>
          <td class="paramname"><em>outlen</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="pkcs12__utf8__to__utf16_8c_source.html#l00014">14</a> of file <a class="el" href="pkcs12__utf8__to__utf16_8c_source.html">pkcs12_utf8_to_utf16.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;                                                                          {</div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;   <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <a class="code" href="ocb__init_8c.html#afed088663f8704004425cdae2120b9b3">len</a> = 0;</div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>* in_end = in + inlen;</div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;   <span class="keyword">const</span> <a class="code" href="tomcrypt__cfg_8h.html#a1f20274bb048d3c8a916b261dfff9567">ulong32</a> offset[6] = {</div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;      0x00000000UL, 0x00003080UL, 0x000E2080UL,</div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;      0x03C82080UL, 0xFA082080UL, 0x82082080UL</div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;   };</div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;   <span class="keywordtype">int</span> err = <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06ca03c22220d7538be04455cd2aa6ddf9da">CRYPT_ERROR</a>;</div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;</div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;   <a class="code" href="tomcrypt__argchk_8h.html#a683da3e041e49f196318b6ea951414ba">LTC_ARGCHK</a>(in     != NULL);</div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;   <a class="code" href="tomcrypt__argchk_8h.html#a683da3e041e49f196318b6ea951414ba">LTC_ARGCHK</a>(out    != NULL);</div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;   <a class="code" href="tomcrypt__argchk_8h.html#a683da3e041e49f196318b6ea951414ba">LTC_ARGCHK</a>(outlen != NULL);</div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;</div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;   <span class="keywordflow">while</span> (in &lt; in_end) {</div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;      <a class="code" href="tomcrypt__cfg_8h.html#a1f20274bb048d3c8a916b261dfff9567">ulong32</a> ch = 0;</div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;      <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> extra = 0; <span class="comment">/* 0 */</span></div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;      <span class="keywordflow">if</span> (*in &gt;= 192) extra++;  <span class="comment">/* 1 */</span></div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;      <span class="keywordflow">if</span> (*in &gt;= 224) extra++;  <span class="comment">/* 2 */</span></div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;      <span class="keywordflow">if</span> (*in &gt;= 240) extra++;  <span class="comment">/* 3 */</span></div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;      <span class="keywordflow">if</span> (*in &gt;= 248) extra++;  <span class="comment">/* 4 */</span></div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;      <span class="keywordflow">if</span> (*in &gt;= 252) extra++;  <span class="comment">/* 5 */</span></div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;      <span class="keywordflow">if</span> (in + extra &gt;= in_end) <span class="keywordflow">goto</span> ERROR;</div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;      <span class="keywordflow">switch</span> (extra) {</div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;         <span class="keywordflow">case</span> 5: ch += *in++; ch &lt;&lt;= 6;</div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;         <span class="comment">/* FALLTHROUGH */</span></div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;         <span class="keywordflow">case</span> 4: ch += *in++; ch &lt;&lt;= 6;</div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;         <span class="comment">/* FALLTHROUGH */</span></div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;         <span class="keywordflow">case</span> 3: ch += *in++; ch &lt;&lt;= 6;</div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;         <span class="comment">/* FALLTHROUGH */</span></div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;         <span class="keywordflow">case</span> 2: ch += *in++; ch &lt;&lt;= 6;</div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;         <span class="comment">/* FALLTHROUGH */</span></div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;         <span class="keywordflow">case</span> 1: ch += *in++; ch &lt;&lt;= 6;</div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;         <span class="comment">/* FALLTHROUGH */</span></div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;         <span class="keywordflow">case</span> 0: ch += *in++;</div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;      }</div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;      ch -= offset[extra];</div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;      <span class="keywordflow">if</span> (ch &gt; 0xFFFF) <span class="keywordflow">goto</span> ERROR;</div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;      <span class="keywordflow">if</span> (*outlen &gt;= <a class="code" href="ocb__init_8c.html#afed088663f8704004425cdae2120b9b3">len</a> + 2) {</div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;         out[<a class="code" href="ocb__init_8c.html#afed088663f8704004425cdae2120b9b3">len</a>] = (<span class="keywordtype">unsigned</span> short)((ch &gt;&gt; 8) &amp; 0xFF);</div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;         out[<a class="code" href="ocb__init_8c.html#afed088663f8704004425cdae2120b9b3">len</a> + 1] = (<span class="keywordtype">unsigned</span> char)(ch &amp; 0xFF);</div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;      }</div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;      <a class="code" href="ocb__init_8c.html#afed088663f8704004425cdae2120b9b3">len</a> += 2;</div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;   }</div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;</div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;   err = <a class="code" href="ocb__init_8c.html#afed088663f8704004425cdae2120b9b3">len</a> &gt; *outlen ? <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06caccd878f5599f3036ffe759dbe1a1ac16">CRYPT_BUFFER_OVERFLOW</a> : <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>;</div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;   *outlen = <a class="code" href="ocb__init_8c.html#afed088663f8704004425cdae2120b9b3">len</a>;</div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;ERROR:</div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;   <span class="keywordflow">return</span> err;</div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;}</div><div class="ttc" id="tomcrypt_8h_html_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334"><div class="ttname"><a href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a></div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt_8h_source.html#l00042">tomcrypt.h:42</a></div></div>
<div class="ttc" id="tomcrypt__argchk_8h_html_a683da3e041e49f196318b6ea951414ba"><div class="ttname"><a href="tomcrypt__argchk_8h.html#a683da3e041e49f196318b6ea951414ba">LTC_ARGCHK</a></div><div class="ttdeci">#define LTC_ARGCHK(x)</div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt__argchk_8h_source.html#l00019">tomcrypt_argchk.h:19</a></div></div>
<div class="ttc" id="ocb__init_8c_html_afed088663f8704004425cdae2120b9b3"><div class="ttname"><a href="ocb__init_8c.html#afed088663f8704004425cdae2120b9b3">len</a></div><div class="ttdeci">int len</div><div class="ttdef"><b>Definition:</b> <a href="ocb__init_8c_source.html#l00019">ocb_init.c:19</a></div></div>
<div class="ttc" id="tomcrypt__cfg_8h_html_a1f20274bb048d3c8a916b261dfff9567"><div class="ttname"><a href="tomcrypt__cfg_8h.html#a1f20274bb048d3c8a916b261dfff9567">ulong32</a></div><div class="ttdeci">unsigned long ulong32</div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt__cfg_8h_source.html#l00226">tomcrypt_cfg.h:226</a></div></div>
<div class="ttc" id="tomcrypt_8h_html_adc29c2ff13d900c2f185ee95427fb06caccd878f5599f3036ffe759dbe1a1ac16"><div class="ttname"><a href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06caccd878f5599f3036ffe759dbe1a1ac16">CRYPT_BUFFER_OVERFLOW</a></div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt_8h_source.html#l00050">tomcrypt.h:50</a></div></div>
<div class="ttc" id="tomcrypt_8h_html_adc29c2ff13d900c2f185ee95427fb06ca03c22220d7538be04455cd2aa6ddf9da"><div class="ttname"><a href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06ca03c22220d7538be04455cd2aa6ddf9da">CRYPT_ERROR</a></div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt_8h_source.html#l00043">tomcrypt.h:43</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="tomcrypt_8h_source.html#l00050">CRYPT_BUFFER_OVERFLOW</a>, <a class="el" href="tomcrypt_8h_source.html#l00043">CRYPT_ERROR</a>, <a class="el" href="tomcrypt_8h_source.html#l00042">CRYPT_OK</a>, <a class="el" href="ocb__init_8c_source.html#l00019">len</a>, and <a class="el" href="tomcrypt__argchk_8h_source.html#l00019">LTC_ARGCHK</a>.</p>

<p class="reference">Referenced by <a class="el" href="pbes1_8c_source.html#l00022">_pkcs_12_wrap()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="tomcrypt__private_8h_af7de8585646f421393f3c744654ae587_icgraph.png" border="0" usemap="#tomcrypt__private_8h_af7de8585646f421393f3c744654ae587_icgraph" alt=""/></div>
<!-- MAP 72 -->
</div>

</div>
</div>
<a id="a1b0d8fcf234d94638b2554ccea725003"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1b0d8fcf234d94638b2554ccea725003">&#9670;&nbsp;</a></span>pkcs8_decode_flexi()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int pkcs8_decode_flexi </td>
          <td>(</td>
          <td class="paramtype">const unsigned char *&#160;</td>
          <td class="paramname"><em>in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned long&#160;</td>
          <td class="paramname"><em>inlen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const void *&#160;</td>
          <td class="paramname"><em>pwd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned long&#160;</td>
          <td class="paramname"><em>pwdlen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">ltc_asn1_list **&#160;</td>
          <td class="paramname"><em>decoded_list</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>PKCS#8 decrypt if necessary &amp; flexi-decode. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">in</td><td>Pointer to the ASN.1 encoded input data </td></tr>
    <tr><td class="paramname">inlen</td><td>Length of the input data </td></tr>
    <tr><td class="paramname">pwd</td><td>Pointer to the password that was used when encrypting </td></tr>
    <tr><td class="paramname">pwdlen</td><td>Length of the password </td></tr>
    <tr><td class="paramname">decoded_list</td><td>Pointer to a pointer for the flexi-decoded list </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>CRYPT_OK on success </dd></dl>

<p class="definition">Definition at line <a class="el" href="pkcs8__decode__flexi_8c_source.html#l00023">23</a> of file <a class="el" href="pkcs8__decode__flexi_8c_source.html">pkcs8_decode_flexi.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;{</div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;   <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <a class="code" href="ocb__init_8c.html#afed088663f8704004425cdae2120b9b3">len</a> = inlen;</div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;   <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> dec_size;</div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;   <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *dec_data = NULL;</div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;   ltc_asn1_list *l = NULL;</div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;   <span class="keywordtype">int</span> err;</div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;</div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;   <a class="code" href="tomcrypt__argchk_8h.html#a683da3e041e49f196318b6ea951414ba">LTC_ARGCHK</a>(in           != NULL);</div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;   <a class="code" href="tomcrypt__argchk_8h.html#a683da3e041e49f196318b6ea951414ba">LTC_ARGCHK</a>(decoded_list != NULL);</div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;</div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;   *decoded_list = NULL;</div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;   <span class="keywordflow">if</span> ((err = <a class="code" href="der__decode__sequence__flexi_8c.html#acec68888a6eae3b64f54b37cfb43d9b1">der_decode_sequence_flexi</a>(in, &amp;<a class="code" href="ocb__init_8c.html#afed088663f8704004425cdae2120b9b3">len</a>, &amp;l)) == <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>) {</div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;      <span class="comment">/* the following &quot;if&quot; detects whether it is encrypted or not */</span></div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;      <span class="comment">/* PKCS8 Setup</span></div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="comment">       *  0:d=0  hl=4 l= 380 cons: SEQUENCE</span></div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="comment">       *  4:d=1  hl=2 l=  78 cons:   SEQUENCE</span></div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="comment">       *  6:d=2  hl=2 l=   9 prim:     OBJECT             :OID indicating PBES1 or PBES2 (== *lalgoid)</span></div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="comment">       * 17:d=2  hl=2 l=  65 cons:     SEQUENCE</span></div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="comment">       *     Stuff in between is dependent on whether it&#39;s PBES1 or PBES2</span></div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="comment">       * 84:d=1  hl=4 l= 296 prim:   OCTET STRING         :bytes (== encrypted data)</span></div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<span class="comment">       */</span></div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;      <span class="keywordflow">if</span> (l-&gt;type == LTC_ASN1_SEQUENCE &amp;&amp;</div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;          <a class="code" href="tomcrypt__private_8h.html#a896c8b07a35ff2799061855f08a8325a">LTC_ASN1_IS_TYPE</a>(l-&gt;child, LTC_ASN1_SEQUENCE) &amp;&amp;</div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;          <a class="code" href="tomcrypt__private_8h.html#a896c8b07a35ff2799061855f08a8325a">LTC_ASN1_IS_TYPE</a>(l-&gt;child-&gt;child, LTC_ASN1_OBJECT_IDENTIFIER) &amp;&amp;</div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;          <a class="code" href="tomcrypt__private_8h.html#a896c8b07a35ff2799061855f08a8325a">LTC_ASN1_IS_TYPE</a>(l-&gt;child-&gt;child-&gt;next, LTC_ASN1_SEQUENCE) &amp;&amp;</div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;          <a class="code" href="tomcrypt__private_8h.html#a896c8b07a35ff2799061855f08a8325a">LTC_ASN1_IS_TYPE</a>(l-&gt;child-&gt;next, LTC_ASN1_OCTET_STRING)) {</div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;         ltc_asn1_list *lalgoid = l-&gt;child-&gt;child;</div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;         <a class="code" href="structpbes__arg.html">pbes_arg</a> pbes;</div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;</div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;         <a class="code" href="tomcrypt__cfg_8h.html#aa3c34a6f6c61de7da9258b5a30e32c2f">XMEMSET</a>(&amp;pbes, 0, <span class="keyword">sizeof</span>(pbes));</div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;</div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;         <span class="keywordflow">if</span> (<a class="code" href="tomcrypt__private_8h.html#a3573423ba7eb454bb5f969ee9b580024">pbes1_extract</a>(lalgoid, &amp;pbes) == <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>) {</div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;            <span class="comment">/* Successfully extracted PBES1 parameters */</span></div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;         } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="tomcrypt__private_8h.html#a741f04fef81b90c03eeba79d1d680273">pbes2_extract</a>(lalgoid, &amp;pbes) == <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>) {</div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;            <span class="comment">/* Successfully extracted PBES2 parameters */</span></div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;         } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;            <span class="comment">/* unsupported encryption */</span></div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;            err = <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06ca980088f10ffe9009aec286038a9e79da">CRYPT_INVALID_PACKET</a>;</div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;            <span class="keywordflow">goto</span> LBL_DONE;</div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;         }</div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;</div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;         pbes.<a class="code" href="structpbes__arg.html#a8e69f095d7a7e8f5fad6fa49ea2d0d00">enc_data</a> = l-&gt;child-&gt;next;</div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;         pbes.<a class="code" href="structpbes__arg.html#a146b6c8875be0a3ac9f426327e83186a">pwd</a> = pwd;</div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;         pbes.<a class="code" href="structpbes__arg.html#a6f7f1324f1acfd51dcc7c1e334db7e0a">pwdlen</a> = pwdlen;</div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;</div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;         dec_size = pbes.<a class="code" href="structpbes__arg.html#a8e69f095d7a7e8f5fad6fa49ea2d0d00">enc_data</a>-&gt;size;</div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;         <span class="keywordflow">if</span> ((dec_data = <a class="code" href="tomcrypt__cfg_8h.html#af363355f38fbaacdefacf270436ae1c9">XMALLOC</a>(dec_size)) == NULL) {</div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;            err = <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06ca0ce0d27adc7ea10b74b7ea904b8bfa82">CRYPT_MEM</a>;</div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;            <span class="keywordflow">goto</span> LBL_DONE;</div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;         }</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;</div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;         <span class="keywordflow">if</span> ((err = <a class="code" href="tomcrypt__private_8h.html#a7df0f8ba7d5d6b9752a7bb9c5e3f7081">pbes_decrypt</a>(&amp;pbes, dec_data, &amp;dec_size)) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>) <span class="keywordflow">goto</span> LBL_DONE;</div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;</div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;         der_free_sequence_flexi(l);</div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;         l = NULL;</div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;         err = <a class="code" href="der__decode__sequence__flexi_8c.html#acec68888a6eae3b64f54b37cfb43d9b1">der_decode_sequence_flexi</a>(dec_data, &amp;dec_size, &amp;l);</div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;         <span class="keywordflow">if</span> (err != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>) <span class="keywordflow">goto</span> LBL_DONE;</div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;         *decoded_list = l;</div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;      }</div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;      <span class="keywordflow">else</span> {</div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;         <span class="comment">/* not encrypted */</span></div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;         err = <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>;</div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;         *decoded_list = l;</div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;      }</div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;      <span class="comment">/* Set l to NULL so it won&#39;t be free&#39;d */</span></div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;      l = NULL;</div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;   }</div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;</div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;LBL_DONE:</div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;   <span class="keywordflow">if</span> (l) der_free_sequence_flexi(l);</div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;   <span class="keywordflow">if</span> (dec_data) {</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;      <a class="code" href="tomcrypt__misc_8h.html#a63b6e188713790263bfd3612fe8b398f">zeromem</a>(dec_data, dec_size);</div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;      <a class="code" href="tomcrypt__cfg_8h.html#a260d66fc0690e0502cf3bfe7b5244b75">XFREE</a>(dec_data);</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;   }</div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;   <span class="keywordflow">return</span> err;</div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;}</div><div class="ttc" id="tomcrypt_8h_html_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334"><div class="ttname"><a href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a></div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt_8h_source.html#l00042">tomcrypt.h:42</a></div></div>
<div class="ttc" id="tomcrypt__cfg_8h_html_af363355f38fbaacdefacf270436ae1c9"><div class="ttname"><a href="tomcrypt__cfg_8h.html#af363355f38fbaacdefacf270436ae1c9">XMALLOC</a></div><div class="ttdeci">void * XMALLOC(size_t n)</div></div>
<div class="ttc" id="tomcrypt__argchk_8h_html_a683da3e041e49f196318b6ea951414ba"><div class="ttname"><a href="tomcrypt__argchk_8h.html#a683da3e041e49f196318b6ea951414ba">LTC_ARGCHK</a></div><div class="ttdeci">#define LTC_ARGCHK(x)</div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt__argchk_8h_source.html#l00019">tomcrypt_argchk.h:19</a></div></div>
<div class="ttc" id="tomcrypt_8h_html_adc29c2ff13d900c2f185ee95427fb06ca980088f10ffe9009aec286038a9e79da"><div class="ttname"><a href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06ca980088f10ffe9009aec286038a9e79da">CRYPT_INVALID_PACKET</a></div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt_8h_source.html#l00051">tomcrypt.h:51</a></div></div>
<div class="ttc" id="structpbes__arg_html_a146b6c8875be0a3ac9f426327e83186a"><div class="ttname"><a href="structpbes__arg.html#a146b6c8875be0a3ac9f426327e83186a">pbes_arg::pwd</a></div><div class="ttdeci">const void * pwd</div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt__private_8h_source.html#l00059">tomcrypt_private.h:59</a></div></div>
<div class="ttc" id="tomcrypt__cfg_8h_html_aa3c34a6f6c61de7da9258b5a30e32c2f"><div class="ttname"><a href="tomcrypt__cfg_8h.html#aa3c34a6f6c61de7da9258b5a30e32c2f">XMEMSET</a></div><div class="ttdeci">void * XMEMSET(void *s, int c, size_t n)</div></div>
<div class="ttc" id="tomcrypt__misc_8h_html_a63b6e188713790263bfd3612fe8b398f"><div class="ttname"><a href="tomcrypt__misc_8h.html#a63b6e188713790263bfd3612fe8b398f">zeromem</a></div><div class="ttdeci">void zeromem(volatile void *out, size_t outlen)</div><div class="ttdoc">Zero a block of memory.</div><div class="ttdef"><b>Definition:</b> <a href="zeromem_8c_source.html#l00021">zeromem.c:21</a></div></div>
<div class="ttc" id="tomcrypt_8h_html_adc29c2ff13d900c2f185ee95427fb06ca0ce0d27adc7ea10b74b7ea904b8bfa82"><div class="ttname"><a href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06ca0ce0d27adc7ea10b74b7ea904b8bfa82">CRYPT_MEM</a></div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt_8h_source.html#l00060">tomcrypt.h:60</a></div></div>
<div class="ttc" id="ocb__init_8c_html_afed088663f8704004425cdae2120b9b3"><div class="ttname"><a href="ocb__init_8c.html#afed088663f8704004425cdae2120b9b3">len</a></div><div class="ttdeci">int len</div><div class="ttdef"><b>Definition:</b> <a href="ocb__init_8c_source.html#l00019">ocb_init.c:19</a></div></div>
<div class="ttc" id="tomcrypt__cfg_8h_html_a260d66fc0690e0502cf3bfe7b5244b75"><div class="ttname"><a href="tomcrypt__cfg_8h.html#a260d66fc0690e0502cf3bfe7b5244b75">XFREE</a></div><div class="ttdeci">void XFREE(void *p)</div></div>
<div class="ttc" id="tomcrypt__private_8h_html_a896c8b07a35ff2799061855f08a8325a"><div class="ttname"><a href="tomcrypt__private_8h.html#a896c8b07a35ff2799061855f08a8325a">LTC_ASN1_IS_TYPE</a></div><div class="ttdeci">#define LTC_ASN1_IS_TYPE(e, t)</div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt__private_8h_source.html#l00302">tomcrypt_private.h:302</a></div></div>
<div class="ttc" id="tomcrypt__private_8h_html_a741f04fef81b90c03eeba79d1d680273"><div class="ttname"><a href="tomcrypt__private_8h.html#a741f04fef81b90c03eeba79d1d680273">pbes2_extract</a></div><div class="ttdeci">int pbes2_extract(const ltc_asn1_list *s, pbes_arg *res)</div><div class="ttdoc">Extract PBES2 parameters.</div><div class="ttdef"><b>Definition:</b> <a href="pbes2_8c_source.html#l00084">pbes2.c:84</a></div></div>
<div class="ttc" id="structpbes__arg_html"><div class="ttname"><a href="structpbes__arg.html">pbes_arg</a></div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt__private_8h_source.html#l00056">tomcrypt_private.h:56</a></div></div>
<div class="ttc" id="der__decode__sequence__flexi_8c_html_acec68888a6eae3b64f54b37cfb43d9b1"><div class="ttname"><a href="der__decode__sequence__flexi_8c.html#acec68888a6eae3b64f54b37cfb43d9b1">der_decode_sequence_flexi</a></div><div class="ttdeci">int der_decode_sequence_flexi(const unsigned char *in, unsigned long *inlen, ltc_asn1_list **out)</div><div class="ttdoc">ASN.1 DER Flexi(ble) decoder will decode arbitrary DER packets and create a linked list of the decode...</div><div class="ttdef"><b>Definition:</b> <a href="der__decode__sequence__flexi_8c_source.html#l00044">der_decode_sequence_flexi.c:44</a></div></div>
<div class="ttc" id="structpbes__arg_html_a6f7f1324f1acfd51dcc7c1e334db7e0a"><div class="ttname"><a href="structpbes__arg.html#a6f7f1324f1acfd51dcc7c1e334db7e0a">pbes_arg::pwdlen</a></div><div class="ttdeci">unsigned long pwdlen</div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt__private_8h_source.html#l00060">tomcrypt_private.h:60</a></div></div>
<div class="ttc" id="tomcrypt__private_8h_html_a3573423ba7eb454bb5f969ee9b580024"><div class="ttname"><a href="tomcrypt__private_8h.html#a3573423ba7eb454bb5f969ee9b580024">pbes1_extract</a></div><div class="ttdeci">int pbes1_extract(const ltc_asn1_list *s, pbes_arg *res)</div><div class="ttdoc">Extract PBES1 parameters.</div><div class="ttdef"><b>Definition:</b> <a href="pbes1_8c_source.html#l00094">pbes1.c:94</a></div></div>
<div class="ttc" id="tomcrypt__private_8h_html_a7df0f8ba7d5d6b9752a7bb9c5e3f7081"><div class="ttname"><a href="tomcrypt__private_8h.html#a7df0f8ba7d5d6b9752a7bb9c5e3f7081">pbes_decrypt</a></div><div class="ttdeci">int pbes_decrypt(const pbes_arg *arg, unsigned char *dec_data, unsigned long *dec_size)</div><div class="ttdoc">Decrypt Data encrypted via either PBES1 or PBES2.</div><div class="ttdef"><b>Definition:</b> <a href="pbes_8c_source.html#l00021">pbes.c:21</a></div></div>
<div class="ttc" id="structpbes__arg_html_a8e69f095d7a7e8f5fad6fa49ea2d0d00"><div class="ttname"><a href="structpbes__arg.html#a8e69f095d7a7e8f5fad6fa49ea2d0d00">pbes_arg::enc_data</a></div><div class="ttdeci">ltc_asn1_list * enc_data</div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt__private_8h_source.html#l00061">tomcrypt_private.h:61</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="tomcrypt_8h_source.html#l00051">CRYPT_INVALID_PACKET</a>, <a class="el" href="tomcrypt_8h_source.html#l00060">CRYPT_MEM</a>, <a class="el" href="tomcrypt_8h_source.html#l00042">CRYPT_OK</a>, <a class="el" href="der__decode__sequence__flexi_8c_source.html#l00044">der_decode_sequence_flexi()</a>, <a class="el" href="tomcrypt__private_8h_source.html#l00061">pbes_arg::enc_data</a>, <a class="el" href="ocb__init_8c_source.html#l00019">len</a>, <a class="el" href="tomcrypt__argchk_8h_source.html#l00019">LTC_ARGCHK</a>, <a class="el" href="tomcrypt__private_8h_source.html#l00302">LTC_ASN1_IS_TYPE</a>, <a class="el" href="pbes1_8c_source.html#l00094">pbes1_extract()</a>, <a class="el" href="pbes2_8c_source.html#l00084">pbes2_extract()</a>, <a class="el" href="pbes_8c_source.html#l00021">pbes_decrypt()</a>, <a class="el" href="tomcrypt__private_8h_source.html#l00059">pbes_arg::pwd</a>, <a class="el" href="tomcrypt__private_8h_source.html#l00060">pbes_arg::pwdlen</a>, <a class="el" href="tomcrypt__cfg_8h.html#a260d66fc0690e0502cf3bfe7b5244b75">XFREE()</a>, <a class="el" href="tomcrypt__cfg_8h.html#af363355f38fbaacdefacf270436ae1c9">XMALLOC()</a>, <a class="el" href="tomcrypt__cfg_8h.html#aa3c34a6f6c61de7da9258b5a30e32c2f">XMEMSET()</a>, and <a class="el" href="zeromem_8c_source.html#l00021">zeromem()</a>.</p>

<p class="reference">Referenced by <a class="el" href="ecc__import__pkcs8_8c_source.html#l00046">ecc_import_pkcs8()</a>, and <a class="el" href="rsa__import__pkcs8_8c_source.html#l00050">rsa_import_pkcs8()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="tomcrypt__private_8h_a1b0d8fcf234d94638b2554ccea725003_cgraph.png" border="0" usemap="#tomcrypt__private_8h_a1b0d8fcf234d94638b2554ccea725003_cgraph" alt=""/></div>
<!-- MAP 73 -->
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="tomcrypt__private_8h_a1b0d8fcf234d94638b2554ccea725003_icgraph.png" border="0" usemap="#tomcrypt__private_8h_a1b0d8fcf234d94638b2554ccea725003_icgraph" alt=""/></div>
<!-- MAP 74 -->
</div>

</div>
</div>
<a id="a5a58a92a44e093e5b35960f7b92a6eb9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5a58a92a44e093e5b35960f7b92a6eb9">&#9670;&nbsp;</a></span>rand_bn_bits()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int rand_bn_bits </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>N</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>bits</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structprng__state.html">prng_state</a> *&#160;</td>
          <td class="paramname"><em>prng</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>wprng</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Generate a random number N with given bitlength (note: MSB can be 0) </p>

<p class="definition">Definition at line <a class="el" href="rand__bn_8c_source.html#l00016">16</a> of file <a class="el" href="rand__bn_8c_source.html">rand_bn.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;{</div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;   <span class="keywordtype">int</span> res, bytes;</div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;   <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *buf, <a class="code" href="gcm__gf__mult_8c.html#a3a2325b458f400e186d773b14e6c1ed9">mask</a>;</div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;</div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;   <a class="code" href="tomcrypt__argchk_8h.html#a683da3e041e49f196318b6ea951414ba">LTC_ARGCHK</a>(<a class="code" href="sober128__stream_8c.html#a0240ac851181b84ac374872dc5434ee4">N</a> != NULL);</div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;   <a class="code" href="tomcrypt__argchk_8h.html#a683da3e041e49f196318b6ea951414ba">LTC_ARGCHK</a>(bits &gt; 1);</div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;</div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;   <span class="comment">/* check PRNG */</span></div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;   <span class="keywordflow">if</span> ((res = <a class="code" href="tomcrypt__prng_8h.html#a7e4a212c1a29a3b8bb4f8d5a34676a1e">prng_is_valid</a>(wprng)) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>) <span class="keywordflow">return</span> res;</div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;</div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;   bytes = (bits+7) &gt;&gt; 3;</div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;   <a class="code" href="gcm__gf__mult_8c.html#a3a2325b458f400e186d773b14e6c1ed9">mask</a> = 0xff &lt;&lt; (8 - bits % 8);</div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;</div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;   <span class="comment">/* allocate buffer */</span></div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;   <span class="keywordflow">if</span> ((buf = <a class="code" href="tomcrypt__cfg_8h.html#a151dda14cd7acae31eaf1102b0cc0685">XCALLOC</a>(1, bytes)) == NULL) <span class="keywordflow">return</span> <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06ca0ce0d27adc7ea10b74b7ea904b8bfa82">CRYPT_MEM</a>;</div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;</div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;   <span class="comment">/* generate random bytes */</span></div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="tomcrypt__prng_8h.html#ac03ee9f603bf966f3afb3f6be156239b">prng_descriptor</a>[wprng].read(buf, bytes, prng) != (<span class="keywordtype">unsigned</span> long)bytes) {</div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;      res = <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06ca68eea82b3b71f23031cd94b10c920bf3">CRYPT_ERROR_READPRNG</a>;</div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;      <span class="keywordflow">goto</span> cleanup;</div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;   }</div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;   <span class="comment">/* mask bits */</span></div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;   buf[0] &amp;= ~<a class="code" href="gcm__gf__mult_8c.html#a3a2325b458f400e186d773b14e6c1ed9">mask</a>;</div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;   <span class="comment">/* load value */</span></div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;   <span class="keywordflow">if</span> ((res = <a class="code" href="tomcrypt__private_8h.html#a9e20e2044bb5a279e27512d1e1b65754">mp_read_unsigned_bin</a>(<a class="code" href="sober128__stream_8c.html#a0240ac851181b84ac374872dc5434ee4">N</a>, buf, bytes)) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>) <span class="keywordflow">goto</span> cleanup;</div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;</div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;   res = <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>;</div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;</div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;cleanup:</div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<span class="preprocessor">#ifdef LTC_CLEAN_STACK</span></div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;   <a class="code" href="tomcrypt__misc_8h.html#a63b6e188713790263bfd3612fe8b398f">zeromem</a>(buf, bytes);</div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;   <a class="code" href="tomcrypt__cfg_8h.html#a260d66fc0690e0502cf3bfe7b5244b75">XFREE</a>(buf);</div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;   <span class="keywordflow">return</span> res;</div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;}</div><div class="ttc" id="tomcrypt_8h_html_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334"><div class="ttname"><a href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a></div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt_8h_source.html#l00042">tomcrypt.h:42</a></div></div>
<div class="ttc" id="sober128__stream_8c_html_a0240ac851181b84ac374872dc5434ee4"><div class="ttname"><a href="sober128__stream_8c.html#a0240ac851181b84ac374872dc5434ee4">N</a></div><div class="ttdeci">#define N</div><div class="ttdef"><b>Definition:</b> <a href="sober128__stream_8c_source.html#l00023">sober128_stream.c:23</a></div></div>
<div class="ttc" id="tomcrypt__argchk_8h_html_a683da3e041e49f196318b6ea951414ba"><div class="ttname"><a href="tomcrypt__argchk_8h.html#a683da3e041e49f196318b6ea951414ba">LTC_ARGCHK</a></div><div class="ttdeci">#define LTC_ARGCHK(x)</div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt__argchk_8h_source.html#l00019">tomcrypt_argchk.h:19</a></div></div>
<div class="ttc" id="tomcrypt__misc_8h_html_a63b6e188713790263bfd3612fe8b398f"><div class="ttname"><a href="tomcrypt__misc_8h.html#a63b6e188713790263bfd3612fe8b398f">zeromem</a></div><div class="ttdeci">void zeromem(volatile void *out, size_t outlen)</div><div class="ttdoc">Zero a block of memory.</div><div class="ttdef"><b>Definition:</b> <a href="zeromem_8c_source.html#l00021">zeromem.c:21</a></div></div>
<div class="ttc" id="tomcrypt_8h_html_adc29c2ff13d900c2f185ee95427fb06ca0ce0d27adc7ea10b74b7ea904b8bfa82"><div class="ttname"><a href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06ca0ce0d27adc7ea10b74b7ea904b8bfa82">CRYPT_MEM</a></div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt_8h_source.html#l00060">tomcrypt.h:60</a></div></div>
<div class="ttc" id="tomcrypt__cfg_8h_html_a260d66fc0690e0502cf3bfe7b5244b75"><div class="ttname"><a href="tomcrypt__cfg_8h.html#a260d66fc0690e0502cf3bfe7b5244b75">XFREE</a></div><div class="ttdeci">void XFREE(void *p)</div></div>
<div class="ttc" id="tomcrypt__prng_8h_html_a7e4a212c1a29a3b8bb4f8d5a34676a1e"><div class="ttname"><a href="tomcrypt__prng_8h.html#a7e4a212c1a29a3b8bb4f8d5a34676a1e">prng_is_valid</a></div><div class="ttdeci">int prng_is_valid(int idx)</div><div class="ttdef"><b>Definition:</b> <a href="crypt__prng__is__valid_8c_source.html#l00021">crypt_prng_is_valid.c:21</a></div></div>
<div class="ttc" id="gcm__gf__mult_8c_html_a3a2325b458f400e186d773b14e6c1ed9"><div class="ttname"><a href="gcm__gf__mult_8c.html#a3a2325b458f400e186d773b14e6c1ed9">mask</a></div><div class="ttdeci">static const unsigned char mask[]</div><div class="ttdef"><b>Definition:</b> <a href="gcm__gf__mult_8c_source.html#l00071">gcm_gf_mult.c:71</a></div></div>
<div class="ttc" id="tomcrypt__private_8h_html_a9e20e2044bb5a279e27512d1e1b65754"><div class="ttname"><a href="tomcrypt__private_8h.html#a9e20e2044bb5a279e27512d1e1b65754">mp_read_unsigned_bin</a></div><div class="ttdeci">#define mp_read_unsigned_bin(a, b, c)</div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt__private_8h_source.html#l00154">tomcrypt_private.h:154</a></div></div>
<div class="ttc" id="tomcrypt__prng_8h_html_ac03ee9f603bf966f3afb3f6be156239b"><div class="ttname"><a href="tomcrypt__prng_8h.html#ac03ee9f603bf966f3afb3f6be156239b">prng_descriptor</a></div><div class="ttdeci">struct ltc_prng_descriptor prng_descriptor[]</div></div>
<div class="ttc" id="tomcrypt_8h_html_adc29c2ff13d900c2f185ee95427fb06ca68eea82b3b71f23031cd94b10c920bf3"><div class="ttname"><a href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06ca68eea82b3b71f23031cd94b10c920bf3">CRYPT_ERROR_READPRNG</a></div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt_8h_source.html#l00054">tomcrypt.h:54</a></div></div>
<div class="ttc" id="tomcrypt__cfg_8h_html_a151dda14cd7acae31eaf1102b0cc0685"><div class="ttname"><a href="tomcrypt__cfg_8h.html#a151dda14cd7acae31eaf1102b0cc0685">XCALLOC</a></div><div class="ttdeci">void * XCALLOC(size_t n, size_t s)</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="tomcrypt_8h_source.html#l00054">CRYPT_ERROR_READPRNG</a>, <a class="el" href="tomcrypt_8h_source.html#l00060">CRYPT_MEM</a>, <a class="el" href="tomcrypt_8h_source.html#l00042">CRYPT_OK</a>, <a class="el" href="tomcrypt__argchk_8h_source.html#l00019">LTC_ARGCHK</a>, <a class="el" href="gcm__gf__mult_8c_source.html#l00071">mask</a>, <a class="el" href="tomcrypt__private_8h_source.html#l00154">mp_read_unsigned_bin</a>, <a class="el" href="sober128__stream_8c_source.html#l00023">N</a>, <a class="el" href="tomcrypt__prng_8h.html#ac03ee9f603bf966f3afb3f6be156239b">prng_descriptor</a>, <a class="el" href="crypt__prng__is__valid_8c_source.html#l00021">prng_is_valid()</a>, <a class="el" href="tomcrypt__cfg_8h.html#a151dda14cd7acae31eaf1102b0cc0685">XCALLOC()</a>, <a class="el" href="tomcrypt__cfg_8h.html#a260d66fc0690e0502cf3bfe7b5244b75">XFREE()</a>, and <a class="el" href="zeromem_8c_source.html#l00021">zeromem()</a>.</p>

<p class="reference">Referenced by <a class="el" href="dsa__generate__pqg_8c_source.html#l00029">_dsa_make_params()</a>, <a class="el" href="dsa__sign__hash_8c_source.html#l00029">dsa_sign_hash_raw()</a>, and <a class="el" href="rand__bn_8c_source.html#l00056">rand_bn_upto()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="tomcrypt__private_8h_a5a58a92a44e093e5b35960f7b92a6eb9_cgraph.png" border="0" usemap="#tomcrypt__private_8h_a5a58a92a44e093e5b35960f7b92a6eb9_cgraph" alt=""/></div>
<!-- MAP 75 -->
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="tomcrypt__private_8h_a5a58a92a44e093e5b35960f7b92a6eb9_icgraph.png" border="0" usemap="#tomcrypt__private_8h_a5a58a92a44e093e5b35960f7b92a6eb9_icgraph" alt=""/></div>
<!-- MAP 76 -->
</div>

</div>
</div>
<a id="a8050acf530841fb2da3b667204039856"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8050acf530841fb2da3b667204039856">&#9670;&nbsp;</a></span>rand_bn_upto()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int rand_bn_upto </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>N</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>limit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structprng__state.html">prng_state</a> *&#160;</td>
          <td class="paramname"><em>prng</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>wprng</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Generate a random number N in a range: 1 &lt;= N &lt; limit. </p>

<p class="definition">Definition at line <a class="el" href="rand__bn_8c_source.html#l00056">56</a> of file <a class="el" href="rand__bn_8c_source.html">rand_bn.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;{</div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;   <span class="keywordtype">int</span> res, bits;</div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;</div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;   <a class="code" href="tomcrypt__argchk_8h.html#a683da3e041e49f196318b6ea951414ba">LTC_ARGCHK</a>(<a class="code" href="sober128__stream_8c.html#a0240ac851181b84ac374872dc5434ee4">N</a> != NULL);</div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;   <a class="code" href="tomcrypt__argchk_8h.html#a683da3e041e49f196318b6ea951414ba">LTC_ARGCHK</a>(limit != NULL);</div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;</div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;   bits = <a class="code" href="tomcrypt__private_8h.html#afa1671e20e699f66319ed2e8d9119e7e">mp_count_bits</a>(limit);</div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;   <span class="keywordflow">do</span> {</div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;     res = <a class="code" href="rand__bn_8c.html#a5a58a92a44e093e5b35960f7b92a6eb9">rand_bn_bits</a>(<a class="code" href="sober128__stream_8c.html#a0240ac851181b84ac374872dc5434ee4">N</a>, bits, prng, wprng);</div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;     <span class="keywordflow">if</span> (res != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>) <span class="keywordflow">return</span> res;</div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;   } <span class="keywordflow">while</span> (<a class="code" href="tomcrypt__private_8h.html#a6ce44f2e6f872565a468b67d9a93dc28">mp_cmp_d</a>(<a class="code" href="sober128__stream_8c.html#a0240ac851181b84ac374872dc5434ee4">N</a>, 0) != <a class="code" href="tomcrypt__math_8h.html#adff156a960d44f0f5b67b75ef1f1c29b">LTC_MP_GT</a> || <a class="code" href="tomcrypt__private_8h.html#a62ea02fbe7dd2d456e49520264d775ee">mp_cmp</a>(<a class="code" href="sober128__stream_8c.html#a0240ac851181b84ac374872dc5434ee4">N</a>, limit) != <a class="code" href="tomcrypt__math_8h.html#a42d0c7d4c09793df79660774d3436db2">LTC_MP_LT</a>);</div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;</div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>;</div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;}</div><div class="ttc" id="tomcrypt_8h_html_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334"><div class="ttname"><a href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a></div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt_8h_source.html#l00042">tomcrypt.h:42</a></div></div>
<div class="ttc" id="tomcrypt__math_8h_html_a42d0c7d4c09793df79660774d3436db2"><div class="ttname"><a href="tomcrypt__math_8h.html#a42d0c7d4c09793df79660774d3436db2">LTC_MP_LT</a></div><div class="ttdeci">#define LTC_MP_LT</div><div class="ttdoc">math functions</div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt__math_8h_source.html#l00012">tomcrypt_math.h:12</a></div></div>
<div class="ttc" id="sober128__stream_8c_html_a0240ac851181b84ac374872dc5434ee4"><div class="ttname"><a href="sober128__stream_8c.html#a0240ac851181b84ac374872dc5434ee4">N</a></div><div class="ttdeci">#define N</div><div class="ttdef"><b>Definition:</b> <a href="sober128__stream_8c_source.html#l00023">sober128_stream.c:23</a></div></div>
<div class="ttc" id="tomcrypt__argchk_8h_html_a683da3e041e49f196318b6ea951414ba"><div class="ttname"><a href="tomcrypt__argchk_8h.html#a683da3e041e49f196318b6ea951414ba">LTC_ARGCHK</a></div><div class="ttdeci">#define LTC_ARGCHK(x)</div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt__argchk_8h_source.html#l00019">tomcrypt_argchk.h:19</a></div></div>
<div class="ttc" id="tomcrypt__private_8h_html_afa1671e20e699f66319ed2e8d9119e7e"><div class="ttname"><a href="tomcrypt__private_8h.html#afa1671e20e699f66319ed2e8d9119e7e">mp_count_bits</a></div><div class="ttdeci">#define mp_count_bits(a)</div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt__private_8h_source.html#l00146">tomcrypt_private.h:146</a></div></div>
<div class="ttc" id="tomcrypt__private_8h_html_a62ea02fbe7dd2d456e49520264d775ee"><div class="ttname"><a href="tomcrypt__private_8h.html#a62ea02fbe7dd2d456e49520264d775ee">mp_cmp</a></div><div class="ttdeci">#define mp_cmp(a, b)</div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt__private_8h_source.html#l00144">tomcrypt_private.h:144</a></div></div>
<div class="ttc" id="tomcrypt__math_8h_html_adff156a960d44f0f5b67b75ef1f1c29b"><div class="ttname"><a href="tomcrypt__math_8h.html#adff156a960d44f0f5b67b75ef1f1c29b">LTC_MP_GT</a></div><div class="ttdeci">#define LTC_MP_GT</div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt__math_8h_source.html#l00014">tomcrypt_math.h:14</a></div></div>
<div class="ttc" id="tomcrypt__private_8h_html_a6ce44f2e6f872565a468b67d9a93dc28"><div class="ttname"><a href="tomcrypt__private_8h.html#a6ce44f2e6f872565a468b67d9a93dc28">mp_cmp_d</a></div><div class="ttdeci">#define mp_cmp_d(a, b)</div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt__private_8h_source.html#l00145">tomcrypt_private.h:145</a></div></div>
<div class="ttc" id="rand__bn_8c_html_a5a58a92a44e093e5b35960f7b92a6eb9"><div class="ttname"><a href="rand__bn_8c.html#a5a58a92a44e093e5b35960f7b92a6eb9">rand_bn_bits</a></div><div class="ttdeci">int rand_bn_bits(void *N, int bits, prng_state *prng, int wprng)</div><div class="ttdoc">Generate a random number N with given bitlength (note: MSB can be 0)</div><div class="ttdef"><b>Definition:</b> <a href="rand__bn_8c_source.html#l00016">rand_bn.c:16</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="tomcrypt_8h_source.html#l00042">CRYPT_OK</a>, <a class="el" href="tomcrypt__argchk_8h_source.html#l00019">LTC_ARGCHK</a>, <a class="el" href="tomcrypt__math_8h_source.html#l00014">LTC_MP_GT</a>, <a class="el" href="tomcrypt__math_8h_source.html#l00012">LTC_MP_LT</a>, <a class="el" href="tomcrypt__private_8h_source.html#l00144">mp_cmp</a>, <a class="el" href="tomcrypt__private_8h_source.html#l00145">mp_cmp_d</a>, <a class="el" href="tomcrypt__private_8h_source.html#l00146">mp_count_bits</a>, <a class="el" href="sober128__stream_8c_source.html#l00023">N</a>, and <a class="el" href="rand__bn_8c_source.html#l00016">rand_bn_bits()</a>.</p>

<p class="reference">Referenced by <a class="el" href="dsa__encrypt__key_8c_source.html#l00030">dsa_encrypt_key()</a>, <a class="el" href="dsa__generate__key_8c_source.html#l00025">dsa_generate_key()</a>, <a class="el" href="ecc__make__key_8c_source.html#l00044">ecc_generate_key()</a>, and <a class="el" href="ecc__sign__hash_8c_source.html#l00032">ecc_sign_hash_ex()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="tomcrypt__private_8h_a8050acf530841fb2da3b667204039856_cgraph.png" border="0" usemap="#tomcrypt__private_8h_a8050acf530841fb2da3b667204039856_cgraph" alt=""/></div>
<!-- MAP 77 -->
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="tomcrypt__private_8h_a8050acf530841fb2da3b667204039856_icgraph.png" border="0" usemap="#tomcrypt__private_8h_a8050acf530841fb2da3b667204039856_icgraph" alt=""/></div>
<!-- MAP 78 -->
</div>

</div>
</div>
<a id="aec241d5f502a71d5a72188a42d6be5f0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aec241d5f502a71d5a72188a42d6be5f0">&#9670;&nbsp;</a></span>x509_decode_subject_public_key_info()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int x509_decode_subject_public_key_info </td>
          <td>(</td>
          <td class="paramtype">const unsigned char *&#160;</td>
          <td class="paramname"><em>in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned long&#160;</td>
          <td class="paramname"><em>inlen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>algorithm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>public_key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned long *&#160;</td>
          <td class="paramname"><em>public_key_len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">ltc_asn1_type&#160;</td>
          <td class="paramname"><em>parameters_type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">ltc_asn1_list *&#160;</td>
          <td class="paramname"><em>parameters</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned long *&#160;</td>
          <td class="paramname"><em>parameters_len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Decode a SubjectPublicKeyInfo. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">in</td><td>The input buffer </td></tr>
    <tr><td class="paramname">inlen</td><td>The length of the input buffer </td></tr>
    <tr><td class="paramname">algorithm</td><td>One out of the enum #public_key_algorithms </td></tr>
    <tr><td class="paramname">public_key</td><td>The buffer for the public key </td></tr>
    <tr><td class="paramname">public_key_len</td><td>[in/out] The length of the public key buffer and the written length </td></tr>
    <tr><td class="paramname">parameters_type</td><td>The parameters' type out of the enum ltc_asn1_type </td></tr>
    <tr><td class="paramname">parameters</td><td>The parameters to include </td></tr>
    <tr><td class="paramname">parameters_len</td><td>[in/out]The number of parameters to include </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>CRYPT_OK on success </dd></dl>

<p class="definition">Definition at line <a class="el" href="x509__decode__subject__public__key__info_8c_source.html#l00040">40</a> of file <a class="el" href="x509__decode__subject__public__key__info_8c_source.html">x509_decode_subject_public_key_info.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;{</div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;   <span class="keywordtype">int</span> err;</div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;   <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <a class="code" href="ocb__init_8c.html#afed088663f8704004425cdae2120b9b3">len</a>, alg_id_num;</div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span>* oid;</div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;   <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *tmpbuf;</div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;   <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>  tmpoid[16];</div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;   ltc_asn1_list alg_id[2];</div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;   ltc_asn1_list subject_pubkey[2];</div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;</div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;   <a class="code" href="tomcrypt__argchk_8h.html#a683da3e041e49f196318b6ea951414ba">LTC_ARGCHK</a>(in    != NULL);</div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;   <a class="code" href="tomcrypt__argchk_8h.html#a683da3e041e49f196318b6ea951414ba">LTC_ARGCHK</a>(inlen != 0);</div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;   <a class="code" href="tomcrypt__argchk_8h.html#a683da3e041e49f196318b6ea951414ba">LTC_ARGCHK</a>(public_key_len != NULL);</div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;   <span class="keywordflow">if</span> (parameters_type != LTC_ASN1_EOL) {</div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;      <a class="code" href="tomcrypt__argchk_8h.html#a683da3e041e49f196318b6ea951414ba">LTC_ARGCHK</a>(parameters_len != NULL);</div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;   }</div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;</div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;   err = <a class="code" href="tomcrypt__private_8h.html#acff5b3d0c6e1145e07d1a3ff53fadce5">pk_get_oid</a>(algorithm, &amp;oid);</div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;   <span class="keywordflow">if</span> (err != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>) {</div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;        <span class="keywordflow">return</span> err;</div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;   }</div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;</div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;   <span class="comment">/* see if the OpenSSL DER format RSA public key will work */</span></div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;   tmpbuf = <a class="code" href="tomcrypt__cfg_8h.html#a151dda14cd7acae31eaf1102b0cc0685">XCALLOC</a>(1, inlen);</div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;   <span class="keywordflow">if</span> (tmpbuf == NULL) {</div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;       err = <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06ca0ce0d27adc7ea10b74b7ea904b8bfa82">CRYPT_MEM</a>;</div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;       <span class="keywordflow">goto</span> LBL_ERR;</div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;   }</div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;</div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;   <span class="comment">/* this includes the internal hash ID and optional params (NULL in this case) */</span></div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;   LTC_SET_ASN1(alg_id, 0, LTC_ASN1_OBJECT_IDENTIFIER, tmpoid, <span class="keyword">sizeof</span>(tmpoid)/<span class="keyword">sizeof</span>(tmpoid[0]));</div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;   <span class="keywordflow">if</span> (parameters_type == LTC_ASN1_EOL) {</div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;      alg_id_num = 1;</div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;   }</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;   <span class="keywordflow">else</span> {</div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;      LTC_SET_ASN1(alg_id, 1, parameters_type, parameters, *parameters_len);</div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;      alg_id_num = 2;</div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;   }</div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;</div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;   <span class="comment">/* the actual format of the SSL DER key is odd, it stores a RSAPublicKey</span></div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;<span class="comment">    * in a **BIT** string ... so we have to extract it then proceed to convert bit to octet</span></div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;   LTC_SET_ASN1(subject_pubkey, 0, LTC_ASN1_SEQUENCE, alg_id, alg_id_num);</div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;   LTC_SET_ASN1(subject_pubkey, 1, LTC_ASN1_RAW_BIT_STRING, tmpbuf, inlen*8U);</div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;</div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;   err=der_decode_sequence(in, inlen, subject_pubkey, 2UL);</div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;   <span class="keywordflow">if</span> (err != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>) {</div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;           <span class="keywordflow">goto</span> LBL_ERR;</div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;   }</div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;   <span class="keywordflow">if</span> (parameters_type != LTC_ASN1_EOL) {</div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;      *parameters_len = alg_id[1].size;</div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;   }</div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;</div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;   <span class="keywordflow">if</span> ((err = <a class="code" href="tomcrypt__private_8h.html#aaa860b1fbc776e0760df8934a6aa245a">pk_oid_cmp_with_asn1</a>(oid, &amp;alg_id[0])) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>) {</div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;      <span class="comment">/* OID mismatch */</span></div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;      <span class="keywordflow">goto</span> LBL_ERR;</div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;   }</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;</div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;   <a class="code" href="ocb__init_8c.html#afed088663f8704004425cdae2120b9b3">len</a> = subject_pubkey[1].size/8;</div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;   <span class="keywordflow">if</span> (*public_key_len &gt;= <a class="code" href="ocb__init_8c.html#afed088663f8704004425cdae2120b9b3">len</a>) {</div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;       <a class="code" href="tomcrypt__cfg_8h.html#a7691dd48d60d5fc6daf2fa7ec4c55e12">XMEMCPY</a>(public_key, subject_pubkey[1].data, <a class="code" href="ocb__init_8c.html#afed088663f8704004425cdae2120b9b3">len</a>);</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;       *public_key_len = <a class="code" href="ocb__init_8c.html#afed088663f8704004425cdae2120b9b3">len</a>;</div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;        *public_key_len = <a class="code" href="ocb__init_8c.html#afed088663f8704004425cdae2120b9b3">len</a>;</div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;        err = <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06caccd878f5599f3036ffe759dbe1a1ac16">CRYPT_BUFFER_OVERFLOW</a>;</div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;        <span class="keywordflow">goto</span> LBL_ERR;</div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;    }</div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;</div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;    err = <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>;</div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;</div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;LBL_ERR:</div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;</div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;    <a class="code" href="tomcrypt__cfg_8h.html#a260d66fc0690e0502cf3bfe7b5244b75">XFREE</a>(tmpbuf);</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;</div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;    <span class="keywordflow">return</span> err;</div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;}</div><div class="ttc" id="tomcrypt_8h_html_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334"><div class="ttname"><a href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a></div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt_8h_source.html#l00042">tomcrypt.h:42</a></div></div>
<div class="ttc" id="tomcrypt__argchk_8h_html_a683da3e041e49f196318b6ea951414ba"><div class="ttname"><a href="tomcrypt__argchk_8h.html#a683da3e041e49f196318b6ea951414ba">LTC_ARGCHK</a></div><div class="ttdeci">#define LTC_ARGCHK(x)</div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt__argchk_8h_source.html#l00019">tomcrypt_argchk.h:19</a></div></div>
<div class="ttc" id="tomcrypt_8h_html_adc29c2ff13d900c2f185ee95427fb06ca0ce0d27adc7ea10b74b7ea904b8bfa82"><div class="ttname"><a href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06ca0ce0d27adc7ea10b74b7ea904b8bfa82">CRYPT_MEM</a></div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt_8h_source.html#l00060">tomcrypt.h:60</a></div></div>
<div class="ttc" id="ocb__init_8c_html_afed088663f8704004425cdae2120b9b3"><div class="ttname"><a href="ocb__init_8c.html#afed088663f8704004425cdae2120b9b3">len</a></div><div class="ttdeci">int len</div><div class="ttdef"><b>Definition:</b> <a href="ocb__init_8c_source.html#l00019">ocb_init.c:19</a></div></div>
<div class="ttc" id="tomcrypt__cfg_8h_html_a260d66fc0690e0502cf3bfe7b5244b75"><div class="ttname"><a href="tomcrypt__cfg_8h.html#a260d66fc0690e0502cf3bfe7b5244b75">XFREE</a></div><div class="ttdeci">void XFREE(void *p)</div></div>
<div class="ttc" id="tomcrypt__cfg_8h_html_a7691dd48d60d5fc6daf2fa7ec4c55e12"><div class="ttname"><a href="tomcrypt__cfg_8h.html#a7691dd48d60d5fc6daf2fa7ec4c55e12">XMEMCPY</a></div><div class="ttdeci">void * XMEMCPY(void *dest, const void *src, size_t n)</div></div>
<div class="ttc" id="tomcrypt_8h_html_adc29c2ff13d900c2f185ee95427fb06caccd878f5599f3036ffe759dbe1a1ac16"><div class="ttname"><a href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06caccd878f5599f3036ffe759dbe1a1ac16">CRYPT_BUFFER_OVERFLOW</a></div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt_8h_source.html#l00050">tomcrypt.h:50</a></div></div>
<div class="ttc" id="tomcrypt__private_8h_html_acff5b3d0c6e1145e07d1a3ff53fadce5"><div class="ttname"><a href="tomcrypt__private_8h.html#acff5b3d0c6e1145e07d1a3ff53fadce5">pk_get_oid</a></div><div class="ttdeci">int pk_get_oid(enum ltc_oid_id id, const char **st)</div><div class="ttdef"><b>Definition:</b> <a href="pk__get__oid_8c_source.html#l00029">pk_get_oid.c:29</a></div></div>
<div class="ttc" id="tomcrypt__private_8h_html_aaa860b1fbc776e0760df8934a6aa245a"><div class="ttname"><a href="tomcrypt__private_8h.html#aaa860b1fbc776e0760df8934a6aa245a">pk_oid_cmp_with_asn1</a></div><div class="ttdeci">int pk_oid_cmp_with_asn1(const char *o1, const ltc_asn1_list *o2)</div><div class="ttdef"><b>Definition:</b> <a href="pk__oid__cmp_8c_source.html#l00041">pk_oid_cmp.c:41</a></div></div>
<div class="ttc" id="tomcrypt__cfg_8h_html_a151dda14cd7acae31eaf1102b0cc0685"><div class="ttname"><a href="tomcrypt__cfg_8h.html#a151dda14cd7acae31eaf1102b0cc0685">XCALLOC</a></div><div class="ttdeci">void * XCALLOC(size_t n, size_t s)</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="tomcrypt_8h_source.html#l00050">CRYPT_BUFFER_OVERFLOW</a>, <a class="el" href="tomcrypt_8h_source.html#l00060">CRYPT_MEM</a>, <a class="el" href="tomcrypt_8h_source.html#l00042">CRYPT_OK</a>, <a class="el" href="ocb__init_8c_source.html#l00019">len</a>, <a class="el" href="tomcrypt__argchk_8h_source.html#l00019">LTC_ARGCHK</a>, <a class="el" href="pk__get__oid_8c_source.html#l00029">pk_get_oid()</a>, <a class="el" href="pk__oid__cmp_8c_source.html#l00041">pk_oid_cmp_with_asn1()</a>, <a class="el" href="tomcrypt__cfg_8h.html#a151dda14cd7acae31eaf1102b0cc0685">XCALLOC()</a>, <a class="el" href="tomcrypt__cfg_8h.html#a260d66fc0690e0502cf3bfe7b5244b75">XFREE()</a>, and <a class="el" href="tomcrypt__cfg_8h.html#a7691dd48d60d5fc6daf2fa7ec4c55e12">XMEMCPY()</a>.</p>

<p class="reference">Referenced by <a class="el" href="ecc__import__x509_8c_source.html#l00039">_ecc_import_x509_with_curve()</a>, <a class="el" href="ecc__import__x509_8c_source.html#l00013">_ecc_import_x509_with_oid()</a>, <a class="el" href="dsa__import_8c_source.html#l00025">dsa_import()</a>, <a class="el" href="rsa__import_8c_source.html#l00025">rsa_import()</a>, and <a class="el" href="rsa__import__x509_8c_source.html#l00025">rsa_import_x509()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="tomcrypt__private_8h_aec241d5f502a71d5a72188a42d6be5f0_cgraph.png" border="0" usemap="#tomcrypt__private_8h_aec241d5f502a71d5a72188a42d6be5f0_cgraph" alt=""/></div>
<!-- MAP 79 -->
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="tomcrypt__private_8h_aec241d5f502a71d5a72188a42d6be5f0_icgraph.png" border="0" usemap="#tomcrypt__private_8h_aec241d5f502a71d5a72188a42d6be5f0_icgraph" alt=""/></div>
<!-- MAP 80 -->
</div>

</div>
</div>
<a id="a69644f00dd0825d15c8c799c46ef6ece"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a69644f00dd0825d15c8c799c46ef6ece">&#9670;&nbsp;</a></span>x509_encode_subject_public_key_info()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int x509_encode_subject_public_key_info </td>
          <td>(</td>
          <td class="paramtype">unsigned char *&#160;</td>
          <td class="paramname"><em>out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned long *&#160;</td>
          <td class="paramname"><em>outlen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>algorithm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const void *&#160;</td>
          <td class="paramname"><em>public_key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned long&#160;</td>
          <td class="paramname"><em>public_key_len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">ltc_asn1_type&#160;</td>
          <td class="paramname"><em>parameters_type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">ltc_asn1_list *&#160;</td>
          <td class="paramname"><em>parameters</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned long&#160;</td>
          <td class="paramname"><em>parameters_len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Encode a SubjectPublicKeyInfo. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">out</td><td>The output buffer </td></tr>
    <tr><td class="paramname">outlen</td><td>[in/out] Length of buffer and resulting length of output </td></tr>
    <tr><td class="paramname">algorithm</td><td>One out of the enum #public_key_algorithms </td></tr>
    <tr><td class="paramname">public_key</td><td>The buffer for the public key </td></tr>
    <tr><td class="paramname">public_key_len</td><td>The length of the public key buffer </td></tr>
    <tr><td class="paramname">parameters_type</td><td>The parameters' type out of the enum ltc_asn1_type </td></tr>
    <tr><td class="paramname">parameters</td><td>The parameters to include </td></tr>
    <tr><td class="paramname">parameters_len</td><td>The number of parameters to include </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>CRYPT_OK on success </dd></dl>

<p class="definition">Definition at line <a class="el" href="x509__encode__subject__public__key__info_8c_source.html#l00040">40</a> of file <a class="el" href="x509__encode__subject__public__key__info_8c_source.html">x509_encode_subject_public_key_info.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;{</div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;   <span class="keywordtype">int</span>           err;</div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;   ltc_asn1_list alg_id[2];</div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="ecc__find__curve_8c.html#a3b9aae9990e63034f7d199729f025b23">OID</a>;</div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;   <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> oid[16], oidlen;</div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;</div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;   <a class="code" href="tomcrypt__argchk_8h.html#a683da3e041e49f196318b6ea951414ba">LTC_ARGCHK</a>(out    != NULL);</div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;   <a class="code" href="tomcrypt__argchk_8h.html#a683da3e041e49f196318b6ea951414ba">LTC_ARGCHK</a>(outlen != NULL);</div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;</div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;   <span class="keywordflow">if</span> ((err = <a class="code" href="tomcrypt__private_8h.html#acff5b3d0c6e1145e07d1a3ff53fadce5">pk_get_oid</a>(algorithm, &amp;<a class="code" href="ecc__find__curve_8c.html#a3b9aae9990e63034f7d199729f025b23">OID</a>)) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>) {</div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;        <span class="keywordflow">return</span> err;</div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;   }</div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;</div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;   oidlen = <span class="keyword">sizeof</span>(oid)/<span class="keyword">sizeof</span>(oid[0]);</div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;   <span class="keywordflow">if</span> ((err = <a class="code" href="tomcrypt__private_8h.html#ad99c87d19f50f703708d36a931fe5df6">pk_oid_str_to_num</a>(<a class="code" href="ecc__find__curve_8c.html#a3b9aae9990e63034f7d199729f025b23">OID</a>, oid, &amp;oidlen)) != <a class="code" href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a>) {</div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;      <span class="keywordflow">return</span> err;</div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;   }</div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;</div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;   LTC_SET_ASN1(alg_id, 0, LTC_ASN1_OBJECT_IDENTIFIER, oid,        oidlen);</div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;   LTC_SET_ASN1(alg_id, 1, parameters_type,            parameters, parameters_len);</div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;</div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="der__encode__sequence__multi_8c.html#a1a5a69543a5c89f81560b52d6f11b8c5">der_encode_sequence_multi</a>(out, outlen,</div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;        LTC_ASN1_SEQUENCE, (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>)<span class="keyword">sizeof</span>(alg_id)/<span class="keyword">sizeof</span>(alg_id[0]), alg_id,</div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;        LTC_ASN1_RAW_BIT_STRING, public_key_len*8U, public_key,</div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;        LTC_ASN1_EOL,     0UL, NULL);</div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;</div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;}</div><div class="ttc" id="tomcrypt_8h_html_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334"><div class="ttname"><a href="tomcrypt_8h.html#adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334">CRYPT_OK</a></div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt_8h_source.html#l00042">tomcrypt.h:42</a></div></div>
<div class="ttc" id="ecc__find__curve_8c_html_a3b9aae9990e63034f7d199729f025b23"><div class="ttname"><a href="ecc__find__curve_8c.html#a3b9aae9990e63034f7d199729f025b23">OID</a></div><div class="ttdeci">const char * OID</div><div class="ttdef"><b>Definition:</b> <a href="ecc__find__curve_8c_source.html#l00015">ecc_find_curve.c:15</a></div></div>
<div class="ttc" id="tomcrypt__private_8h_html_ad99c87d19f50f703708d36a931fe5df6"><div class="ttname"><a href="tomcrypt__private_8h.html#ad99c87d19f50f703708d36a931fe5df6">pk_oid_str_to_num</a></div><div class="ttdeci">int pk_oid_str_to_num(const char *OID, unsigned long *oid, unsigned long *oidlen)</div><div class="ttdef"><b>Definition:</b> <a href="pk__oid__str_8c_source.html#l00012">pk_oid_str.c:12</a></div></div>
<div class="ttc" id="tomcrypt__argchk_8h_html_a683da3e041e49f196318b6ea951414ba"><div class="ttname"><a href="tomcrypt__argchk_8h.html#a683da3e041e49f196318b6ea951414ba">LTC_ARGCHK</a></div><div class="ttdeci">#define LTC_ARGCHK(x)</div><div class="ttdef"><b>Definition:</b> <a href="tomcrypt__argchk_8h_source.html#l00019">tomcrypt_argchk.h:19</a></div></div>
<div class="ttc" id="der__encode__sequence__multi_8c_html_a1a5a69543a5c89f81560b52d6f11b8c5"><div class="ttname"><a href="der__encode__sequence__multi_8c.html#a1a5a69543a5c89f81560b52d6f11b8c5">der_encode_sequence_multi</a></div><div class="ttdeci">int der_encode_sequence_multi(unsigned char *out, unsigned long *outlen,...)</div><div class="ttdoc">Encode a SEQUENCE type using a VA list.</div><div class="ttdef"><b>Definition:</b> <a href="der__encode__sequence__multi_8c_source.html#l00027">der_encode_sequence_multi.c:27</a></div></div>
<div class="ttc" id="tomcrypt__private_8h_html_acff5b3d0c6e1145e07d1a3ff53fadce5"><div class="ttname"><a href="tomcrypt__private_8h.html#acff5b3d0c6e1145e07d1a3ff53fadce5">pk_get_oid</a></div><div class="ttdeci">int pk_get_oid(enum ltc_oid_id id, const char **st)</div><div class="ttdef"><b>Definition:</b> <a href="pk__get__oid_8c_source.html#l00029">pk_get_oid.c:29</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="tomcrypt_8h_source.html#l00042">CRYPT_OK</a>, <a class="el" href="der__encode__sequence__multi_8c_source.html#l00027">der_encode_sequence_multi()</a>, <a class="el" href="tomcrypt__argchk_8h_source.html#l00019">LTC_ARGCHK</a>, <a class="el" href="ecc__find__curve_8c_source.html#l00015">OID</a>, <a class="el" href="pk__get__oid_8c_source.html#l00029">pk_get_oid()</a>, and <a class="el" href="pk__oid__str_8c_source.html#l00012">pk_oid_str_to_num()</a>.</p>

<p class="reference">Referenced by <a class="el" href="dsa__export_8c_source.html#l00026">dsa_export()</a>, <a class="el" href="ecc__export__openssl_8c_source.html#l00023">ecc_export_openssl()</a>, and <a class="el" href="rsa__export_8c_source.html#l00026">rsa_export()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="tomcrypt__private_8h_a69644f00dd0825d15c8c799c46ef6ece_cgraph.png" border="0" usemap="#tomcrypt__private_8h_a69644f00dd0825d15c8c799c46ef6ece_cgraph" alt=""/></div>
<!-- MAP 81 -->
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="tomcrypt__private_8h_a69644f00dd0825d15c8c799c46ef6ece_icgraph.png" border="0" usemap="#tomcrypt__private_8h_a69644f00dd0825d15c8c799c46ef6ece_icgraph" alt=""/></div>
<!-- MAP 82 -->
</div>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="a411f77ba949e37dca9c1ef1e43127cb1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a411f77ba949e37dca9c1ef1e43127cb1">&#9670;&nbsp;</a></span>der_asn1_tag_to_type_map</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const ltc_asn1_type der_asn1_tag_to_type_map[]</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>A Map from ASN.1 Tags to ltc_asn1_type. </p>

<p class="definition">Definition at line <a class="el" href="der__asn1__maps_8c_source.html#l00120">120</a> of file <a class="el" href="der__asn1__maps_8c_source.html">der_asn1_maps.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="der__decode__asn1__identifier_8c_source.html#l00065">der_decode_asn1_identifier()</a>.</p>

</div>
</div>
<a id="a6ad32891f744af2b205041ad6dc5bce0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6ad32891f744af2b205041ad6dc5bce0">&#9670;&nbsp;</a></span>der_asn1_tag_to_type_map_sz</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const unsigned long der_asn1_tag_to_type_map_sz</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="der__asn1__maps_8c_source.html#l00161">161</a> of file <a class="el" href="der__asn1__maps_8c_source.html">der_asn1_maps.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="der__decode__asn1__identifier_8c_source.html#l00065">der_decode_asn1_identifier()</a>.</p>

</div>
</div>
<a id="a6306ca88074facac89ee0f6c04cbf2f2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6306ca88074facac89ee0f6c04cbf2f2">&#9670;&nbsp;</a></span>der_asn1_type_to_identifier_map</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const int der_asn1_type_to_identifier_map[]</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>A Map from ltc_asn1_type to the regularly used ASN.1 identifier. </p>

<p class="definition">Definition at line <a class="el" href="der__asn1__maps_8c_source.html#l00021">21</a> of file <a class="el" href="der__asn1__maps_8c_source.html">der_asn1_maps.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="der__encode__set_8c_source.html#l00019">_ltc_to_asn1()</a>, <a class="el" href="der__decode__custom__type_8c_source.html#l00048">der_decode_custom_type_ex()</a>, and <a class="el" href="der__encode__asn1__identifier_8c_source.html#l00024">der_encode_asn1_identifier()</a>.</p>

</div>
</div>
<a id="ae8d2a220c8f5b51d2db97b0382a9f206"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae8d2a220c8f5b51d2db97b0382a9f206">&#9670;&nbsp;</a></span>der_asn1_type_to_identifier_map_sz</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const unsigned long der_asn1_type_to_identifier_map_sz</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="der__asn1__maps_8c_source.html#l00048">48</a> of file <a class="el" href="der__asn1__maps_8c_source.html">der_asn1_maps.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="der__decode__custom__type_8c_source.html#l00048">der_decode_custom_type_ex()</a>, and <a class="el" href="der__encode__asn1__identifier_8c_source.html#l00024">der_encode_asn1_identifier()</a>.</p>

</div>
</div>
<a id="a45c19266abadb7a8a27dc330b000cfc4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a45c19266abadb7a8a27dc330b000cfc4">&#9670;&nbsp;</a></span>ltc_dh_sets</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="structltc__dh__set__type.html">ltc_dh_set_type</a> ltc_dh_sets[]</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="dh_8c_source.html#l00015">15</a> of file <a class="el" href="dh_8c_source.html">dh.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="dh__set_8c_source.html#l00056">dh_set_pg_groupsize()</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_3d1127c0ed484a3823411b7e1748de30.html">M:</a></li><li class="navelem"><a class="el" href="dir_a706303f8d84b26c5b31e94ed2f60325.html">Office</a></li><li class="navelem"><a class="el" href="dir_4339db983405b38e91c36e5dd080cee9.html">!Doutorado</a></li><li class="navelem"><a class="el" href="dir_48b7a187bfb6a1248a9b2a293126e90b.html">0. RepositorioSVN</a></li><li class="navelem"><a class="el" href="dir_0082229fbb81d6546c7447205b2d1f36.html">HAMSTER_Prototype</a></li><li class="navelem"><a class="el" href="dir_659fafc6305c7d0b7aee97ff4c33cacf.html">branches</a></li><li class="navelem"><a class="el" href="dir_421ea5b898285498c0aa13d98fdda436.html">JINT2018</a></li><li class="navelem"><a class="el" href="dir_3b195b2970dd1c33847069aa8f40362f.html">include</a></li><li class="navelem"><a class="el" href="dir_71b768464081a1cc41acd8b85ae6df7f.html">libtomcrypt-develop</a></li><li class="navelem"><a class="el" href="dir_741faac8ec9f85fd943a5b186bf49d47.html">src</a></li><li class="navelem"><a class="el" href="dir_a0acb8384b4122a9c7afcf2489cf4036.html">headers</a></li><li class="navelem"><a class="el" href="tomcrypt__private_8h.html">tomcrypt_private.h</a></li>
    <li class="footer">Generated on Wed Apr 10 2019 18:13:32 for LibTomCrypt by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.15 </li>
  </ul>
</div>
</body>
</html>
