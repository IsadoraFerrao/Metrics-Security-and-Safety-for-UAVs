\hypertarget{der__encode__asn1__identifier_8c}{}\section{M\+:/\+Office/!\+Doutorado/0. Repositorio\+S\+V\+N/\+H\+A\+M\+S\+T\+E\+R\+\_\+\+Prototype/branches/\+J\+I\+N\+T2018/include/libtomcrypt-\/develop/src/pk/asn1/der/general/der\+\_\+encode\+\_\+asn1\+\_\+identifier.c File Reference}
\label{der__encode__asn1__identifier_8c}\index{M:/Office/"!Doutorado/0. RepositorioSVN/HAMSTER\_Prototype/branches/JINT2018/include/libtomcrypt-\/develop/src/pk/asn1/der/general/der\_encode\_asn1\_identifier.c@{M:/Office/"!Doutorado/0. RepositorioSVN/HAMSTER\_Prototype/branches/JINT2018/include/libtomcrypt-\/develop/src/pk/asn1/der/general/der\_encode\_asn1\_identifier.c}}


A\+S\+N.\+1 D\+ER, encode the A\+S\+N.\+1 Identifier, Steffen Jaeckel.  


{\ttfamily \#include \char`\"{}tomcrypt\+\_\+private.\+h\char`\"{}}\newline
Include dependency graph for der\+\_\+encode\+\_\+asn1\+\_\+identifier.\+c\+:
% FIG 0
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
int \mbox{\hyperlink{der__encode__asn1__identifier_8c_a093815c0cc44624723a3d668992b3008}{der\+\_\+encode\+\_\+asn1\+\_\+identifier}} (const ltc\+\_\+asn1\+\_\+list $\ast$id, unsigned char $\ast$out, unsigned long $\ast$outlen)
\begin{DoxyCompactList}\small\item\em Encode the A\+S\+N.\+1 Identifier. \end{DoxyCompactList}\end{DoxyCompactItemize}


\subsection{Detailed Description}
A\+S\+N.\+1 D\+ER, encode the A\+S\+N.\+1 Identifier, Steffen Jaeckel. 



\subsection{Function Documentation}
\mbox{\Hypertarget{der__encode__asn1__identifier_8c_a093815c0cc44624723a3d668992b3008}\label{der__encode__asn1__identifier_8c_a093815c0cc44624723a3d668992b3008}} 
\index{der\_encode\_asn1\_identifier.c@{der\_encode\_asn1\_identifier.c}!der\_encode\_asn1\_identifier@{der\_encode\_asn1\_identifier}}
\index{der\_encode\_asn1\_identifier@{der\_encode\_asn1\_identifier}!der\_encode\_asn1\_identifier.c@{der\_encode\_asn1\_identifier.c}}
\subsubsection{\texorpdfstring{der\_encode\_asn1\_identifier()}{der\_encode\_asn1\_identifier()}}
{\footnotesize\ttfamily int der\+\_\+encode\+\_\+asn1\+\_\+identifier (\begin{DoxyParamCaption}\item[{const ltc\+\_\+asn1\+\_\+list $\ast$}]{id,  }\item[{unsigned char $\ast$}]{out,  }\item[{unsigned long $\ast$}]{outlen }\end{DoxyParamCaption})}



Encode the A\+S\+N.\+1 Identifier. 


\begin{DoxyParams}{Parameters}
{\em id} & The A\+S\+N.\+1 Identifer to encode \\
\hline
{\em out} & Where to write the identifier to \\
\hline
{\em outlen} & \mbox{[}in/out\mbox{]} The size of out available/written \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
C\+R\+Y\+P\+T\+\_\+\+OK if successful 
\end{DoxyReturn}


Definition at line 24 of file der\+\_\+encode\+\_\+asn1\+\_\+identifier.\+c.


\begin{DoxyCode}{0}
\DoxyCodeLine{25 \{}
\DoxyCodeLine{26    \mbox{\hyperlink{tomcrypt__cfg_8h_ab4afaf24b39288a7be6fd03fe8345f61}{ulong64}} tmp;}
\DoxyCodeLine{27    \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} tag\_len;}
\DoxyCodeLine{28 }
\DoxyCodeLine{29    \mbox{\hyperlink{tomcrypt__argchk_8h_a683da3e041e49f196318b6ea951414ba}{LTC\_ARGCHK}}(\textcolor{keywordtype}{id}  != NULL);}
\DoxyCodeLine{30    \mbox{\hyperlink{tomcrypt__argchk_8h_a683da3e041e49f196318b6ea951414ba}{LTC\_ARGCHK}}(outlen != NULL);}
\DoxyCodeLine{31 }
\DoxyCodeLine{32    \textcolor{keywordflow}{if} (id->type != LTC\_ASN1\_CUSTOM\_TYPE) \{}
\DoxyCodeLine{33       \textcolor{keywordflow}{if} ((\textcolor{keywordtype}{unsigned})id->type >= \mbox{\hyperlink{tomcrypt__private_8h_ae8d2a220c8f5b51d2db97b0382a9f206}{der\_asn1\_type\_to\_identifier\_map\_sz}}) \{}
\DoxyCodeLine{34          \textcolor{keywordflow}{return} \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06ca92aa8bad3930f08d5a188bf72094b066}{CRYPT\_INVALID\_ARG}};}
\DoxyCodeLine{35       \}}
\DoxyCodeLine{36       \textcolor{keywordflow}{if} (\mbox{\hyperlink{tomcrypt__private_8h_a6306ca88074facac89ee0f6c04cbf2f2}{der\_asn1\_type\_to\_identifier\_map}}[id->type] == -1) \{}
\DoxyCodeLine{37          \textcolor{keywordflow}{return} \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06ca92aa8bad3930f08d5a188bf72094b066}{CRYPT\_INVALID\_ARG}};}
\DoxyCodeLine{38       \}}
\DoxyCodeLine{39       \textcolor{keywordflow}{if} (out != NULL) \{}
\DoxyCodeLine{40          *out = \mbox{\hyperlink{tomcrypt__private_8h_a6306ca88074facac89ee0f6c04cbf2f2}{der\_asn1\_type\_to\_identifier\_map}}[\textcolor{keywordtype}{id}->type];}
\DoxyCodeLine{41       \}}
\DoxyCodeLine{42       *outlen = 1;}
\DoxyCodeLine{43       \textcolor{keywordflow}{return} \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}};}
\DoxyCodeLine{44    \}}
\DoxyCodeLine{45    \textcolor{keywordflow}{if} (id->klass < LTC\_ASN1\_CL\_UNIVERSAL || id->klass > LTC\_ASN1\_CL\_PRIVATE) \{}
\DoxyCodeLine{46       \textcolor{keywordflow}{return} \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06ca92aa8bad3930f08d5a188bf72094b066}{CRYPT\_INVALID\_ARG}};}
\DoxyCodeLine{47    \}}
\DoxyCodeLine{48    \textcolor{keywordflow}{if} (id->pc < LTC\_ASN1\_PC\_PRIMITIVE || id->pc > LTC\_ASN1\_PC\_CONSTRUCTED) \{}
\DoxyCodeLine{49       \textcolor{keywordflow}{return} \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06ca92aa8bad3930f08d5a188bf72094b066}{CRYPT\_INVALID\_ARG}};}
\DoxyCodeLine{50    \}}
\DoxyCodeLine{51    \textcolor{keywordflow}{if} (id->tag > (ULONG\_MAX >> (8 + 7))) \{}
\DoxyCodeLine{52       \textcolor{keywordflow}{return} \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06ca92aa8bad3930f08d5a188bf72094b066}{CRYPT\_INVALID\_ARG}};}
\DoxyCodeLine{53    \}}
\DoxyCodeLine{54 }
\DoxyCodeLine{55    \textcolor{keywordflow}{if} (out != NULL) \{}
\DoxyCodeLine{56       \textcolor{keywordflow}{if} (*outlen < 1) \{}
\DoxyCodeLine{57          \textcolor{keywordflow}{return} \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06caccd878f5599f3036ffe759dbe1a1ac16}{CRYPT\_BUFFER\_OVERFLOW}};}
\DoxyCodeLine{58       \}}
\DoxyCodeLine{59 }
\DoxyCodeLine{60       out[0] = \textcolor{keywordtype}{id}->klass << 6 | \textcolor{keywordtype}{id}->pc << 5;}
\DoxyCodeLine{61    \}}
\DoxyCodeLine{62 }
\DoxyCodeLine{63    \textcolor{keywordflow}{if} (id->tag < 0x1f) \{}
\DoxyCodeLine{64       \textcolor{keywordflow}{if} (out != NULL) \{}
\DoxyCodeLine{65          out[0] |= \textcolor{keywordtype}{id}->tag \& 0x1f;}
\DoxyCodeLine{66       \}}
\DoxyCodeLine{67       *outlen = 1;}
\DoxyCodeLine{68    \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{69       tag\_len = 0;}
\DoxyCodeLine{70       tmp = \textcolor{keywordtype}{id}->tag;}
\DoxyCodeLine{71       \textcolor{keywordflow}{do} \{}
\DoxyCodeLine{72          tag\_len++;}
\DoxyCodeLine{73          tmp >>= 7;}
\DoxyCodeLine{74       \} \textcolor{keywordflow}{while} (tmp);}
\DoxyCodeLine{75 }
\DoxyCodeLine{76       \textcolor{keywordflow}{if} (out != NULL) \{}
\DoxyCodeLine{77          \textcolor{keywordflow}{if} (*outlen < tag\_len + 1) \{}
\DoxyCodeLine{78             \textcolor{keywordflow}{return} \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06caccd878f5599f3036ffe759dbe1a1ac16}{CRYPT\_BUFFER\_OVERFLOW}};}
\DoxyCodeLine{79          \}}
\DoxyCodeLine{80          out[0] |= 0x1f;}
\DoxyCodeLine{81          \textcolor{keywordflow}{for} (tmp = 1; tmp <= tag\_len; ++tmp) \{}
\DoxyCodeLine{82             out[tmp] = ((\textcolor{keywordtype}{id}->tag >> (7 * (tag\_len - tmp))) \& 0x7f) | 0x80;}
\DoxyCodeLine{83          \}}
\DoxyCodeLine{84          out[tag\_len] \&= ~0x80;}
\DoxyCodeLine{85       \}}
\DoxyCodeLine{86       *outlen = tag\_len + 1;}
\DoxyCodeLine{87    \}}
\DoxyCodeLine{88 }
\DoxyCodeLine{89    \textcolor{keywordflow}{return} \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}};}
\DoxyCodeLine{90 \}}

\end{DoxyCode}


References C\+R\+Y\+P\+T\+\_\+\+B\+U\+F\+F\+E\+R\+\_\+\+O\+V\+E\+R\+F\+L\+OW, C\+R\+Y\+P\+T\+\_\+\+I\+N\+V\+A\+L\+I\+D\+\_\+\+A\+RG, C\+R\+Y\+P\+T\+\_\+\+OK, der\+\_\+asn1\+\_\+type\+\_\+to\+\_\+identifier\+\_\+map, der\+\_\+asn1\+\_\+type\+\_\+to\+\_\+identifier\+\_\+map\+\_\+sz, and L\+T\+C\+\_\+\+A\+R\+G\+C\+HK.



Referenced by der\+\_\+encode\+\_\+custom\+\_\+type(), and der\+\_\+length\+\_\+asn1\+\_\+identifier().

Here is the caller graph for this function\+:
% FIG 1
