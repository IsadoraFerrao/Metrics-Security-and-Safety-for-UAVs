\hypertarget{chacha20_8c}{}\section{M\+:/\+Office/!\+Doutorado/0. Repositorio\+S\+V\+N/\+H\+A\+M\+S\+T\+E\+R\+\_\+\+Prototype/branches/\+J\+I\+N\+T2018/include/libtomcrypt-\/develop/src/prngs/chacha20.c File Reference}
\label{chacha20_8c}\index{M:/Office/"!Doutorado/0. RepositorioSVN/HAMSTER\_Prototype/branches/JINT2018/include/libtomcrypt-\/develop/src/prngs/chacha20.c@{M:/Office/"!Doutorado/0. RepositorioSVN/HAMSTER\_Prototype/branches/JINT2018/include/libtomcrypt-\/develop/src/prngs/chacha20.c}}
{\ttfamily \#include \char`\"{}tomcrypt\+\_\+private.\+h\char`\"{}}\newline
Include dependency graph for chacha20.\+c\+:
% FIG 0
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
int \mbox{\hyperlink{chacha20_8c_aa52a7cb95c35a702f9cbf374bacf9530}{chacha20\+\_\+prng\+\_\+start}} (\mbox{\hyperlink{structprng__state}{prng\+\_\+state}} $\ast$prng)
\begin{DoxyCompactList}\small\item\em Start the P\+R\+NG. \end{DoxyCompactList}\item 
int \mbox{\hyperlink{chacha20_8c_ae75ffa7e5ccf945ae352f106fb3b3f13}{chacha20\+\_\+prng\+\_\+add\+\_\+entropy}} (const unsigned char $\ast$in, unsigned long inlen, \mbox{\hyperlink{structprng__state}{prng\+\_\+state}} $\ast$prng)
\begin{DoxyCompactList}\small\item\em Add entropy to the P\+R\+NG state. \end{DoxyCompactList}\item 
int \mbox{\hyperlink{chacha20_8c_a4d83a788328b93577373da5036f9e3ff}{chacha20\+\_\+prng\+\_\+ready}} (\mbox{\hyperlink{structprng__state}{prng\+\_\+state}} $\ast$prng)
\begin{DoxyCompactList}\small\item\em Make the P\+R\+NG ready to read from. \end{DoxyCompactList}\item 
unsigned long \mbox{\hyperlink{chacha20_8c_a5adfff638ebc7c30cd3840ddd6807c30}{chacha20\+\_\+prng\+\_\+read}} (unsigned char $\ast$out, unsigned long outlen, \mbox{\hyperlink{structprng__state}{prng\+\_\+state}} $\ast$prng)
\begin{DoxyCompactList}\small\item\em Read from the P\+R\+NG. \end{DoxyCompactList}\item 
int \mbox{\hyperlink{chacha20_8c_ac4c6ba884d06287d4e168743899a058b}{chacha20\+\_\+prng\+\_\+done}} (\mbox{\hyperlink{structprng__state}{prng\+\_\+state}} $\ast$prng)
\begin{DoxyCompactList}\small\item\em Terminate the P\+R\+NG. \end{DoxyCompactList}\item 
int \mbox{\hyperlink{chacha20_8c_a91e9ef4c395ab95e10838e117e5aa1a1}{chacha20\+\_\+prng\+\_\+export}} (unsigned char $\ast$out, unsigned long $\ast$outlen, \mbox{\hyperlink{structprng__state}{prng\+\_\+state}} $\ast$prng)
\begin{DoxyCompactList}\small\item\em Export the P\+R\+NG state. \end{DoxyCompactList}\item 
int \mbox{\hyperlink{chacha20_8c_aec1d8ebf9e796fe1223995e48d665a92}{chacha20\+\_\+prng\+\_\+import}} (const unsigned char $\ast$in, unsigned long inlen, \mbox{\hyperlink{structprng__state}{prng\+\_\+state}} $\ast$prng)
\begin{DoxyCompactList}\small\item\em Import a P\+R\+NG state. \end{DoxyCompactList}\item 
int \mbox{\hyperlink{chacha20_8c_a1c178a6f1b7255371d3340913c29b64a}{chacha20\+\_\+prng\+\_\+test}} (void)
\begin{DoxyCompactList}\small\item\em P\+R\+NG self-\/test. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Variables}
\begin{DoxyCompactItemize}
\item 
const struct \mbox{\hyperlink{structltc__prng__descriptor}{ltc\+\_\+prng\+\_\+descriptor}} \mbox{\hyperlink{chacha20_8c_a379b46b2ee8c713bed1a63d68bf0086c}{chacha20\+\_\+prng\+\_\+desc}}
\end{DoxyCompactItemize}


\subsection{Function Documentation}
\mbox{\Hypertarget{chacha20_8c_ae75ffa7e5ccf945ae352f106fb3b3f13}\label{chacha20_8c_ae75ffa7e5ccf945ae352f106fb3b3f13}} 
\index{chacha20.c@{chacha20.c}!chacha20\_prng\_add\_entropy@{chacha20\_prng\_add\_entropy}}
\index{chacha20\_prng\_add\_entropy@{chacha20\_prng\_add\_entropy}!chacha20.c@{chacha20.c}}
\subsubsection{\texorpdfstring{chacha20\_prng\_add\_entropy()}{chacha20\_prng\_add\_entropy()}}
{\footnotesize\ttfamily int chacha20\+\_\+prng\+\_\+add\+\_\+entropy (\begin{DoxyParamCaption}\item[{const unsigned char $\ast$}]{in,  }\item[{unsigned long}]{inlen,  }\item[{\mbox{\hyperlink{structprng__state}{prng\+\_\+state}} $\ast$}]{prng }\end{DoxyParamCaption})}



Add entropy to the P\+R\+NG state. 


\begin{DoxyParams}{Parameters}
{\em in} & The data to add \\
\hline
{\em inlen} & Length of the data to add \\
\hline
{\em prng} & P\+R\+NG state to update \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
C\+R\+Y\+P\+T\+\_\+\+OK if successful 
\end{DoxyReturn}


Definition at line 54 of file chacha20.\+c.


\begin{DoxyCode}{0}
\DoxyCodeLine{55 \{}
\DoxyCodeLine{56    \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char} buf[40];}
\DoxyCodeLine{57    \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} i;}
\DoxyCodeLine{58    \textcolor{keywordtype}{int} err;}
\DoxyCodeLine{59 }
\DoxyCodeLine{60    \mbox{\hyperlink{tomcrypt__argchk_8h_a683da3e041e49f196318b6ea951414ba}{LTC\_ARGCHK}}(prng != NULL);}
\DoxyCodeLine{61    \mbox{\hyperlink{tomcrypt__argchk_8h_a683da3e041e49f196318b6ea951414ba}{LTC\_ARGCHK}}(in != NULL);}
\DoxyCodeLine{62    \mbox{\hyperlink{tomcrypt__argchk_8h_a683da3e041e49f196318b6ea951414ba}{LTC\_ARGCHK}}(inlen > 0);}
\DoxyCodeLine{63 }
\DoxyCodeLine{64    \mbox{\hyperlink{tomcrypt__custom_8h_a427a107414e4d775fbf23f4a499f4a31}{LTC\_MUTEX\_LOCK}}(\&prng->lock);}
\DoxyCodeLine{65    \textcolor{keywordflow}{if} (prng->\mbox{\hyperlink{structprng__state_ad5b2704260668ba49701ba0169286837}{ready}}) \{}
\DoxyCodeLine{66       \textcolor{comment}{/* chacha20\_prng\_ready() was already called, do "rekey" operation */}}
\DoxyCodeLine{67       \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{chacha__keystream_8c_a3a29ed9997a58d432f9e8ddca7b90bdd}{chacha\_keystream}}(\&prng->\mbox{\hyperlink{structprng__state_a73ffeba26752871bc883f035a89f0991}{u}}.chacha.s, buf, \textcolor{keyword}{sizeof}(buf))) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}}) \textcolor{keywordflow}{goto} LBL\_UNLOCK;}
\DoxyCodeLine{68       \textcolor{keywordflow}{for}(i = 0; i < inlen; i++) buf[i \% \textcolor{keyword}{sizeof}(buf)] \string^= in[i];}
\DoxyCodeLine{69       \textcolor{comment}{/* key 32 bytes, 20 rounds */}}
\DoxyCodeLine{70       \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{chacha__setup_8c_aaaad339dc43c455ff5cc2df1960ddfeb}{chacha\_setup}}(\&prng->\mbox{\hyperlink{structprng__state_a73ffeba26752871bc883f035a89f0991}{u}}.chacha.s, buf, 32, 20)) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}})      \textcolor{keywordflow}{goto} LBL\_UNLOCK;}
\DoxyCodeLine{71       \textcolor{comment}{/* iv 8 bytes */}}
\DoxyCodeLine{72       \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{chacha__ivctr64_8c_a2575d8a5708351cc77001ae00e77a132}{chacha\_ivctr64}}(\&prng->\mbox{\hyperlink{structprng__state_a73ffeba26752871bc883f035a89f0991}{u}}.chacha.s, buf + 32, 8, 0)) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}}) \textcolor{keywordflow}{goto} LBL\_UNLOCK;}
\DoxyCodeLine{73       \textcolor{comment}{/* clear KEY + IV */}}
\DoxyCodeLine{74       \mbox{\hyperlink{tomcrypt__misc_8h_a63b6e188713790263bfd3612fe8b398f}{zeromem}}(buf, \textcolor{keyword}{sizeof}(buf));}
\DoxyCodeLine{75    \}}
\DoxyCodeLine{76    \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{77       \textcolor{comment}{/* chacha20\_prng\_ready() was not called yet, add entropy to ent buffer */}}
\DoxyCodeLine{78       \textcolor{keywordflow}{while} (inlen--) prng->\mbox{\hyperlink{structprng__state_a73ffeba26752871bc883f035a89f0991}{u}}.chacha.ent[prng->\mbox{\hyperlink{structprng__state_a73ffeba26752871bc883f035a89f0991}{u}}.chacha.idx++ \% \textcolor{keyword}{sizeof}(prng->\mbox{\hyperlink{structprng__state_a73ffeba26752871bc883f035a89f0991}{u}}.chacha.ent)] \string^= *in++;}
\DoxyCodeLine{79    \}}
\DoxyCodeLine{80    err = \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}};}
\DoxyCodeLine{81 LBL\_UNLOCK:}
\DoxyCodeLine{82    \mbox{\hyperlink{tomcrypt__custom_8h_acdf267be91b178b4fafe8f992d57a7f1}{LTC\_MUTEX\_UNLOCK}}(\&prng->lock);}
\DoxyCodeLine{83    \textcolor{keywordflow}{return} err;}
\DoxyCodeLine{84 \}}

\end{DoxyCode}


References chacha\+\_\+ivctr64(), chacha\+\_\+keystream(), chacha\+\_\+setup(), C\+R\+Y\+P\+T\+\_\+\+OK, L\+T\+C\+\_\+\+A\+R\+G\+C\+HK, L\+T\+C\+\_\+\+M\+U\+T\+E\+X\+\_\+\+L\+O\+CK, L\+T\+C\+\_\+\+M\+U\+T\+E\+X\+\_\+\+U\+N\+L\+O\+CK, prng\+\_\+state\+::ready, prng\+\_\+state\+::u, and zeromem().



Referenced by chacha20\+\_\+prng\+\_\+import(), and chacha20\+\_\+prng\+\_\+test().

Here is the call graph for this function\+:
% FIG 1
Here is the caller graph for this function\+:
% FIG 2
\mbox{\Hypertarget{chacha20_8c_ac4c6ba884d06287d4e168743899a058b}\label{chacha20_8c_ac4c6ba884d06287d4e168743899a058b}} 
\index{chacha20.c@{chacha20.c}!chacha20\_prng\_done@{chacha20\_prng\_done}}
\index{chacha20\_prng\_done@{chacha20\_prng\_done}!chacha20.c@{chacha20.c}}
\subsubsection{\texorpdfstring{chacha20\_prng\_done()}{chacha20\_prng\_done()}}
{\footnotesize\ttfamily int chacha20\+\_\+prng\+\_\+done (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structprng__state}{prng\+\_\+state}} $\ast$}]{prng }\end{DoxyParamCaption})}



Terminate the P\+R\+NG. 


\begin{DoxyParams}{Parameters}
{\em prng} & The P\+R\+NG to terminate \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
C\+R\+Y\+P\+T\+\_\+\+OK if successful 
\end{DoxyReturn}


Definition at line 134 of file chacha20.\+c.


\begin{DoxyCode}{0}
\DoxyCodeLine{135 \{}
\DoxyCodeLine{136    \textcolor{keywordtype}{int} err;}
\DoxyCodeLine{137    \mbox{\hyperlink{tomcrypt__argchk_8h_a683da3e041e49f196318b6ea951414ba}{LTC\_ARGCHK}}(prng != NULL);}
\DoxyCodeLine{138    \mbox{\hyperlink{tomcrypt__custom_8h_a427a107414e4d775fbf23f4a499f4a31}{LTC\_MUTEX\_LOCK}}(\&prng->lock);}
\DoxyCodeLine{139    prng->\mbox{\hyperlink{structprng__state_ad5b2704260668ba49701ba0169286837}{ready}} = 0;}
\DoxyCodeLine{140    err = \mbox{\hyperlink{chacha__done_8c_a4936c207e7ef938d31047954fae30e39}{chacha\_done}}(\&prng->\mbox{\hyperlink{structprng__state_a73ffeba26752871bc883f035a89f0991}{u}}.chacha.s);}
\DoxyCodeLine{141    \mbox{\hyperlink{tomcrypt__custom_8h_acdf267be91b178b4fafe8f992d57a7f1}{LTC\_MUTEX\_UNLOCK}}(\&prng->lock);}
\DoxyCodeLine{142    \mbox{\hyperlink{tomcrypt__custom_8h_ae3979e1469d64fe3e864c9effca73724}{LTC\_MUTEX\_DESTROY}}(\&prng->lock);}
\DoxyCodeLine{143    \textcolor{keywordflow}{return} err;}
\DoxyCodeLine{144 \}}

\end{DoxyCode}


References chacha\+\_\+done(), L\+T\+C\+\_\+\+A\+R\+G\+C\+HK, L\+T\+C\+\_\+\+M\+U\+T\+E\+X\+\_\+\+D\+E\+S\+T\+R\+OY, L\+T\+C\+\_\+\+M\+U\+T\+E\+X\+\_\+\+L\+O\+CK, L\+T\+C\+\_\+\+M\+U\+T\+E\+X\+\_\+\+U\+N\+L\+O\+CK, prng\+\_\+state\+::ready, and prng\+\_\+state\+::u.



Referenced by chacha20\+\_\+prng\+\_\+test().

Here is the call graph for this function\+:
% FIG 3
Here is the caller graph for this function\+:
% FIG 4
\mbox{\Hypertarget{chacha20_8c_a91e9ef4c395ab95e10838e117e5aa1a1}\label{chacha20_8c_a91e9ef4c395ab95e10838e117e5aa1a1}} 
\index{chacha20.c@{chacha20.c}!chacha20\_prng\_export@{chacha20\_prng\_export}}
\index{chacha20\_prng\_export@{chacha20\_prng\_export}!chacha20.c@{chacha20.c}}
\subsubsection{\texorpdfstring{chacha20\_prng\_export()}{chacha20\_prng\_export()}}
{\footnotesize\ttfamily int chacha20\+\_\+prng\+\_\+export (\begin{DoxyParamCaption}\item[{unsigned char $\ast$}]{out,  }\item[{unsigned long $\ast$}]{outlen,  }\item[{\mbox{\hyperlink{structprng__state}{prng\+\_\+state}} $\ast$}]{prng }\end{DoxyParamCaption})}



Export the P\+R\+NG state. 


\begin{DoxyParams}{Parameters}
{\em out} & \mbox{[}out\mbox{]} Destination \\
\hline
{\em outlen} & \mbox{[}in/out\mbox{]} Max size and resulting size of the state \\
\hline
{\em prng} & The P\+R\+NG to export \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
C\+R\+Y\+P\+T\+\_\+\+OK if successful 
\end{DoxyReturn}


Definition at line 153 of file chacha20.\+c.


\begin{DoxyCode}{0}
\DoxyCodeLine{163 \{}

\end{DoxyCode}


Referenced by chacha20\+\_\+prng\+\_\+test().

Here is the caller graph for this function\+:
% FIG 5
\mbox{\Hypertarget{chacha20_8c_aec1d8ebf9e796fe1223995e48d665a92}\label{chacha20_8c_aec1d8ebf9e796fe1223995e48d665a92}} 
\index{chacha20.c@{chacha20.c}!chacha20\_prng\_import@{chacha20\_prng\_import}}
\index{chacha20\_prng\_import@{chacha20\_prng\_import}!chacha20.c@{chacha20.c}}
\subsubsection{\texorpdfstring{chacha20\_prng\_import()}{chacha20\_prng\_import()}}
{\footnotesize\ttfamily int chacha20\+\_\+prng\+\_\+import (\begin{DoxyParamCaption}\item[{const unsigned char $\ast$}]{in,  }\item[{unsigned long}]{inlen,  }\item[{\mbox{\hyperlink{structprng__state}{prng\+\_\+state}} $\ast$}]{prng }\end{DoxyParamCaption})}



Import a P\+R\+NG state. 


\begin{DoxyParams}{Parameters}
{\em in} & The P\+R\+NG state \\
\hline
{\em inlen} & Size of the state \\
\hline
{\em prng} & The P\+R\+NG to import \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
C\+R\+Y\+P\+T\+\_\+\+OK if successful 
\end{DoxyReturn}


Definition at line 162 of file chacha20.\+c.


\begin{DoxyCode}{0}
\DoxyCodeLine{163 \{}
\DoxyCodeLine{164    \textcolor{keywordtype}{int} err;}
\DoxyCodeLine{165 }
\DoxyCodeLine{166    \mbox{\hyperlink{tomcrypt__argchk_8h_a683da3e041e49f196318b6ea951414ba}{LTC\_ARGCHK}}(prng != NULL);}
\DoxyCodeLine{167    \mbox{\hyperlink{tomcrypt__argchk_8h_a683da3e041e49f196318b6ea951414ba}{LTC\_ARGCHK}}(in   != NULL);}
\DoxyCodeLine{168    \textcolor{keywordflow}{if} (inlen < (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long})\mbox{\hyperlink{chacha20_8c_a379b46b2ee8c713bed1a63d68bf0086c}{chacha20\_prng\_desc}}.\mbox{\hyperlink{structltc__prng__descriptor_a41ef184ab75b213366392faabcde420c}{export\_size}}) \textcolor{keywordflow}{return} \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06ca92aa8bad3930f08d5a188bf72094b066}{CRYPT\_INVALID\_ARG}};}
\DoxyCodeLine{169 }
\DoxyCodeLine{170    \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{chacha20_8c_aa52a7cb95c35a702f9cbf374bacf9530}{chacha20\_prng\_start}}(prng)) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}})                  \textcolor{keywordflow}{return} err;}
\DoxyCodeLine{171    \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{chacha20_8c_ae75ffa7e5ccf945ae352f106fb3b3f13}{chacha20\_prng\_add\_entropy}}(in, inlen, prng)) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}}) \textcolor{keywordflow}{return} err;}
\DoxyCodeLine{172    \textcolor{keywordflow}{return} \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}};}
\DoxyCodeLine{173 \}}

\end{DoxyCode}


References chacha20\+\_\+prng\+\_\+add\+\_\+entropy(), chacha20\+\_\+prng\+\_\+desc, chacha20\+\_\+prng\+\_\+start(), C\+R\+Y\+P\+T\+\_\+\+I\+N\+V\+A\+L\+I\+D\+\_\+\+A\+RG, C\+R\+Y\+P\+T\+\_\+\+OK, ltc\+\_\+prng\+\_\+descriptor\+::export\+\_\+size, and L\+T\+C\+\_\+\+A\+R\+G\+C\+HK.



Referenced by chacha20\+\_\+prng\+\_\+test().

Here is the call graph for this function\+:
% FIG 6
Here is the caller graph for this function\+:
% FIG 7
\mbox{\Hypertarget{chacha20_8c_a5adfff638ebc7c30cd3840ddd6807c30}\label{chacha20_8c_a5adfff638ebc7c30cd3840ddd6807c30}} 
\index{chacha20.c@{chacha20.c}!chacha20\_prng\_read@{chacha20\_prng\_read}}
\index{chacha20\_prng\_read@{chacha20\_prng\_read}!chacha20.c@{chacha20.c}}
\subsubsection{\texorpdfstring{chacha20\_prng\_read()}{chacha20\_prng\_read()}}
{\footnotesize\ttfamily unsigned long chacha20\+\_\+prng\+\_\+read (\begin{DoxyParamCaption}\item[{unsigned char $\ast$}]{out,  }\item[{unsigned long}]{outlen,  }\item[{\mbox{\hyperlink{structprng__state}{prng\+\_\+state}} $\ast$}]{prng }\end{DoxyParamCaption})}



Read from the P\+R\+NG. 


\begin{DoxyParams}{Parameters}
{\em out} & Destination \\
\hline
{\em outlen} & Length of output \\
\hline
{\em prng} & The active P\+R\+NG to read from \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Number of octets read 
\end{DoxyReturn}


Definition at line 118 of file chacha20.\+c.


\begin{DoxyCode}{0}
\DoxyCodeLine{119 \{}
\DoxyCodeLine{120    \textcolor{keywordflow}{if} (outlen == 0 || prng == NULL || out == NULL) \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{121    \mbox{\hyperlink{tomcrypt__custom_8h_a427a107414e4d775fbf23f4a499f4a31}{LTC\_MUTEX\_LOCK}}(\&prng->lock);}
\DoxyCodeLine{122    \textcolor{keywordflow}{if} (!prng->\mbox{\hyperlink{structprng__state_ad5b2704260668ba49701ba0169286837}{ready}}) \{ outlen = 0; \textcolor{keywordflow}{goto} LBL\_UNLOCK; \}}
\DoxyCodeLine{123    \textcolor{keywordflow}{if} (\mbox{\hyperlink{chacha__keystream_8c_a3a29ed9997a58d432f9e8ddca7b90bdd}{chacha\_keystream}}(\&prng->\mbox{\hyperlink{structprng__state_a73ffeba26752871bc883f035a89f0991}{u}}.chacha.s, out, outlen) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}}) outlen = 0;}
\DoxyCodeLine{124 LBL\_UNLOCK:}
\DoxyCodeLine{125    \mbox{\hyperlink{tomcrypt__custom_8h_acdf267be91b178b4fafe8f992d57a7f1}{LTC\_MUTEX\_UNLOCK}}(\&prng->lock);}
\DoxyCodeLine{126    \textcolor{keywordflow}{return} outlen;}
\DoxyCodeLine{127 \}}

\end{DoxyCode}


References chacha\+\_\+keystream(), C\+R\+Y\+P\+T\+\_\+\+OK, L\+T\+C\+\_\+\+M\+U\+T\+E\+X\+\_\+\+L\+O\+CK, L\+T\+C\+\_\+\+M\+U\+T\+E\+X\+\_\+\+U\+N\+L\+O\+CK, prng\+\_\+state\+::ready, and prng\+\_\+state\+::u.



Referenced by chacha20\+\_\+prng\+\_\+test().

Here is the call graph for this function\+:
% FIG 8
Here is the caller graph for this function\+:
% FIG 9
\mbox{\Hypertarget{chacha20_8c_a4d83a788328b93577373da5036f9e3ff}\label{chacha20_8c_a4d83a788328b93577373da5036f9e3ff}} 
\index{chacha20.c@{chacha20.c}!chacha20\_prng\_ready@{chacha20\_prng\_ready}}
\index{chacha20\_prng\_ready@{chacha20\_prng\_ready}!chacha20.c@{chacha20.c}}
\subsubsection{\texorpdfstring{chacha20\_prng\_ready()}{chacha20\_prng\_ready()}}
{\footnotesize\ttfamily int chacha20\+\_\+prng\+\_\+ready (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structprng__state}{prng\+\_\+state}} $\ast$}]{prng }\end{DoxyParamCaption})}



Make the P\+R\+NG ready to read from. 


\begin{DoxyParams}{Parameters}
{\em prng} & The P\+R\+NG to make active \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
C\+R\+Y\+P\+T\+\_\+\+OK if successful 
\end{DoxyReturn}


Definition at line 91 of file chacha20.\+c.


\begin{DoxyCode}{0}
\DoxyCodeLine{92 \{}
\DoxyCodeLine{93    \textcolor{keywordtype}{int} err;}
\DoxyCodeLine{94 }
\DoxyCodeLine{95    \mbox{\hyperlink{tomcrypt__argchk_8h_a683da3e041e49f196318b6ea951414ba}{LTC\_ARGCHK}}(prng != NULL);}
\DoxyCodeLine{96 }
\DoxyCodeLine{97    \mbox{\hyperlink{tomcrypt__custom_8h_a427a107414e4d775fbf23f4a499f4a31}{LTC\_MUTEX\_LOCK}}(\&prng->lock);}
\DoxyCodeLine{98    \textcolor{keywordflow}{if} (prng->\mbox{\hyperlink{structprng__state_ad5b2704260668ba49701ba0169286837}{ready}})                                                    \{ err = \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}}; \textcolor{keywordflow}{goto} LBL\_UNLOCK; \}}
\DoxyCodeLine{99    \textcolor{comment}{/* key 32 bytes, 20 rounds */}}
\DoxyCodeLine{100    \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{chacha__setup_8c_aaaad339dc43c455ff5cc2df1960ddfeb}{chacha\_setup}}(\&prng->\mbox{\hyperlink{structprng__state_a73ffeba26752871bc883f035a89f0991}{u}}.chacha.s, prng->\mbox{\hyperlink{structprng__state_a73ffeba26752871bc883f035a89f0991}{u}}.chacha.ent, 32, 20)) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}})      \textcolor{keywordflow}{goto} LBL\_UNLOCK;}
\DoxyCodeLine{101    \textcolor{comment}{/* iv 8 bytes */}}
\DoxyCodeLine{102    \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{chacha__ivctr64_8c_a2575d8a5708351cc77001ae00e77a132}{chacha\_ivctr64}}(\&prng->\mbox{\hyperlink{structprng__state_a73ffeba26752871bc883f035a89f0991}{u}}.chacha.s, prng->\mbox{\hyperlink{structprng__state_a73ffeba26752871bc883f035a89f0991}{u}}.chacha.ent + 32, 8, 0)) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}}) \textcolor{keywordflow}{goto} LBL\_UNLOCK;}
\DoxyCodeLine{103    \mbox{\hyperlink{tomcrypt__cfg_8h_aa3c34a6f6c61de7da9258b5a30e32c2f}{XMEMSET}}(\&prng->\mbox{\hyperlink{structprng__state_a73ffeba26752871bc883f035a89f0991}{u}}.chacha.ent, 0, \textcolor{keyword}{sizeof}(prng->\mbox{\hyperlink{structprng__state_a73ffeba26752871bc883f035a89f0991}{u}}.chacha.ent));}
\DoxyCodeLine{104    prng->\mbox{\hyperlink{structprng__state_a73ffeba26752871bc883f035a89f0991}{u}}.chacha.idx = 0;}
\DoxyCodeLine{105    prng->\mbox{\hyperlink{structprng__state_ad5b2704260668ba49701ba0169286837}{ready}} = 1;}
\DoxyCodeLine{106 LBL\_UNLOCK:}
\DoxyCodeLine{107    \mbox{\hyperlink{tomcrypt__custom_8h_acdf267be91b178b4fafe8f992d57a7f1}{LTC\_MUTEX\_UNLOCK}}(\&prng->lock);}
\DoxyCodeLine{108    \textcolor{keywordflow}{return} err;}
\DoxyCodeLine{109 \}}

\end{DoxyCode}


References chacha\+\_\+ivctr64(), chacha\+\_\+setup(), C\+R\+Y\+P\+T\+\_\+\+OK, L\+T\+C\+\_\+\+A\+R\+G\+C\+HK, L\+T\+C\+\_\+\+M\+U\+T\+E\+X\+\_\+\+L\+O\+CK, L\+T\+C\+\_\+\+M\+U\+T\+E\+X\+\_\+\+U\+N\+L\+O\+CK, prng\+\_\+state\+::ready, prng\+\_\+state\+::u, and X\+M\+E\+M\+S\+E\+T().



Referenced by chacha20\+\_\+prng\+\_\+test().

Here is the call graph for this function\+:
% FIG 10
Here is the caller graph for this function\+:
% FIG 11
\mbox{\Hypertarget{chacha20_8c_aa52a7cb95c35a702f9cbf374bacf9530}\label{chacha20_8c_aa52a7cb95c35a702f9cbf374bacf9530}} 
\index{chacha20.c@{chacha20.c}!chacha20\_prng\_start@{chacha20\_prng\_start}}
\index{chacha20\_prng\_start@{chacha20\_prng\_start}!chacha20.c@{chacha20.c}}
\subsubsection{\texorpdfstring{chacha20\_prng\_start()}{chacha20\_prng\_start()}}
{\footnotesize\ttfamily int chacha20\+\_\+prng\+\_\+start (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structprng__state}{prng\+\_\+state}} $\ast$}]{prng }\end{DoxyParamCaption})}



Start the P\+R\+NG. 


\begin{DoxyParams}{Parameters}
{\em prng} & The P\+R\+NG state to initialize \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
C\+R\+Y\+P\+T\+\_\+\+OK if successful 
\end{DoxyReturn}


Definition at line 37 of file chacha20.\+c.


\begin{DoxyCode}{0}
\DoxyCodeLine{38 \{}
\DoxyCodeLine{39    \mbox{\hyperlink{tomcrypt__argchk_8h_a683da3e041e49f196318b6ea951414ba}{LTC\_ARGCHK}}(prng != NULL);}
\DoxyCodeLine{40    prng->\mbox{\hyperlink{structprng__state_ad5b2704260668ba49701ba0169286837}{ready}} = 0;}
\DoxyCodeLine{41    \mbox{\hyperlink{tomcrypt__cfg_8h_aa3c34a6f6c61de7da9258b5a30e32c2f}{XMEMSET}}(\&prng->\mbox{\hyperlink{structprng__state_a73ffeba26752871bc883f035a89f0991}{u}}.chacha.ent, 0, \textcolor{keyword}{sizeof}(prng->\mbox{\hyperlink{structprng__state_a73ffeba26752871bc883f035a89f0991}{u}}.chacha.ent));}
\DoxyCodeLine{42    prng->\mbox{\hyperlink{structprng__state_a73ffeba26752871bc883f035a89f0991}{u}}.chacha.idx = 0;}
\DoxyCodeLine{43    \mbox{\hyperlink{tomcrypt__custom_8h_a450b04a6e1d004908791edaa0901d284}{LTC\_MUTEX\_INIT}}(\&prng->lock)}
\DoxyCodeLine{44    return \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}};}
\DoxyCodeLine{45 \}}

\end{DoxyCode}


References C\+R\+Y\+P\+T\+\_\+\+OK, L\+T\+C\+\_\+\+A\+R\+G\+C\+HK, L\+T\+C\+\_\+\+M\+U\+T\+E\+X\+\_\+\+I\+N\+IT, prng\+\_\+state\+::ready, prng\+\_\+state\+::u, and X\+M\+E\+M\+S\+E\+T().



Referenced by chacha20\+\_\+prng\+\_\+import(), and chacha20\+\_\+prng\+\_\+test().

Here is the call graph for this function\+:
% FIG 12
Here is the caller graph for this function\+:
% FIG 13
\mbox{\Hypertarget{chacha20_8c_a1c178a6f1b7255371d3340913c29b64a}\label{chacha20_8c_a1c178a6f1b7255371d3340913c29b64a}} 
\index{chacha20.c@{chacha20.c}!chacha20\_prng\_test@{chacha20\_prng\_test}}
\index{chacha20\_prng\_test@{chacha20\_prng\_test}!chacha20.c@{chacha20.c}}
\subsubsection{\texorpdfstring{chacha20\_prng\_test()}{chacha20\_prng\_test()}}
{\footnotesize\ttfamily int chacha20\+\_\+prng\+\_\+test (\begin{DoxyParamCaption}\item[{void}]{ }\end{DoxyParamCaption})}



P\+R\+NG self-\/test. 

\begin{DoxyReturn}{Returns}
C\+R\+Y\+P\+T\+\_\+\+OK if successful, C\+R\+Y\+P\+T\+\_\+\+N\+OP if self-\/testing has been disabled 
\end{DoxyReturn}


Definition at line 179 of file chacha20.\+c.


\begin{DoxyCode}{0}
\DoxyCodeLine{180 \{}
\DoxyCodeLine{181 \textcolor{preprocessor}{\#ifndef LTC\_TEST}}
\DoxyCodeLine{182    \textcolor{keywordflow}{return} \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cac43a7799c7fd5f515172da6cfc0f9cf5}{CRYPT\_NOP}};}
\DoxyCodeLine{183 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{184    \mbox{\hyperlink{structprng__state}{prng\_state}} st;}
\DoxyCodeLine{185    \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char} en[] = \{ 0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07, 0x08, 0x09, 0x0a,}
\DoxyCodeLine{186                           0x0b, 0x0c, 0x0d, 0x0e, 0x0f, 0x10, 0x11, 0x12, 0x13, 0x14,}
\DoxyCodeLine{187                           0x15, 0x16, 0x17, 0x18, 0x19, 0x1a, 0x1b, 0x1c, 0x1d, 0x1e,}
\DoxyCodeLine{188                           0x1f, 0x20, 0x21, 0x22, 0x23, 0x24, 0x25, 0x26, 0x27, 0x28,}
\DoxyCodeLine{189                           0x29, 0x2a, 0x2b, 0x2c, 0x2d, 0x2e, 0x2f, 0x30, 0x31, 0x32 \};}
\DoxyCodeLine{190    \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char} dmp[300];}
\DoxyCodeLine{191    \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} dmplen = \textcolor{keyword}{sizeof}(dmp);}
\DoxyCodeLine{192    \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char} out[500];}
\DoxyCodeLine{193    \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char} \mbox{\hyperlink{tiger_8c_a65f7891fccbfcf7d08964555630773b3}{t1}}[] = \{ 0x59, 0xB2, 0x26, 0x95, 0x2B, 0x01, 0x8F, 0x05, 0xBE, 0xD8 \};}
\DoxyCodeLine{194    \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char} \mbox{\hyperlink{tiger_8c_aa4652e2d6053d420dcbea07a113db5fe}{t2}}[] = \{ 0x47, 0xC9, 0x0D, 0x03, 0xE4, 0x75, 0x34, 0x27, 0xBD, 0xDE \};}
\DoxyCodeLine{195    \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char} \mbox{\hyperlink{tiger_8c_a71a491fa5f35065b954a3001ebed0f28}{t3}}[] = \{ 0xBC, 0xFA, 0xEF, 0x59, 0x37, 0x7F, 0x1A, 0x91, 0x1A, 0xA6 \};}
\DoxyCodeLine{196    \textcolor{keywordtype}{int} err;}
\DoxyCodeLine{197 }
\DoxyCodeLine{198    \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{chacha20_8c_aa52a7cb95c35a702f9cbf374bacf9530}{chacha20\_prng\_start}}(\&st)) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}})                       \textcolor{keywordflow}{return} err;}
\DoxyCodeLine{199    \textcolor{comment}{/* add entropy to uninitialized prng */}}
\DoxyCodeLine{200    \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{chacha20_8c_ae75ffa7e5ccf945ae352f106fb3b3f13}{chacha20\_prng\_add\_entropy}}(en, \textcolor{keyword}{sizeof}(en), \&st)) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}}) \textcolor{keywordflow}{return} err;}
\DoxyCodeLine{201    \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{chacha20_8c_a4d83a788328b93577373da5036f9e3ff}{chacha20\_prng\_ready}}(\&st)) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}})                       \textcolor{keywordflow}{return} err;}
\DoxyCodeLine{202    \textcolor{keywordflow}{if} (\mbox{\hyperlink{chacha20_8c_a5adfff638ebc7c30cd3840ddd6807c30}{chacha20\_prng\_read}}(out, 10, \&st) != 10)                             \textcolor{keywordflow}{return} \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06ca68eea82b3b71f23031cd94b10c920bf3}{CRYPT\_ERROR\_READPRNG}}; \textcolor{comment}{/* 10 bytes for testing */}}
\DoxyCodeLine{203    \textcolor{keywordflow}{if} (\mbox{\hyperlink{tomcrypt__misc_8h_a7764a7f27897c6182335752df00b5f8e}{compare\_testvector}}(out, 10, \mbox{\hyperlink{tiger_8c_a65f7891fccbfcf7d08964555630773b3}{t1}}, \textcolor{keyword}{sizeof}(\mbox{\hyperlink{tiger_8c_a65f7891fccbfcf7d08964555630773b3}{t1}}), \textcolor{stringliteral}{"CHACHA-PRNG"}, 1))      \textcolor{keywordflow}{return} \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06caf98a132fdf93633389677f31f9bb39ca}{CRYPT\_FAIL\_TESTVECTOR}};}
\DoxyCodeLine{204    \textcolor{keywordflow}{if} (\mbox{\hyperlink{chacha20_8c_a5adfff638ebc7c30cd3840ddd6807c30}{chacha20\_prng\_read}}(out, 500, \&st) != 500)                           \textcolor{keywordflow}{return} \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06ca68eea82b3b71f23031cd94b10c920bf3}{CRYPT\_ERROR\_READPRNG}}; \textcolor{comment}{/* skip 500 bytes */}}
\DoxyCodeLine{205    \textcolor{comment}{/* add entropy to already initialized prng */}}
\DoxyCodeLine{206    \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{chacha20_8c_ae75ffa7e5ccf945ae352f106fb3b3f13}{chacha20\_prng\_add\_entropy}}(en, \textcolor{keyword}{sizeof}(en), \&st)) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}}) \textcolor{keywordflow}{return} err;}
\DoxyCodeLine{207    \textcolor{keywordflow}{if} (\mbox{\hyperlink{chacha20_8c_a5adfff638ebc7c30cd3840ddd6807c30}{chacha20\_prng\_read}}(out, 500, \&st) != 500)                           \textcolor{keywordflow}{return} \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06ca68eea82b3b71f23031cd94b10c920bf3}{CRYPT\_ERROR\_READPRNG}}; \textcolor{comment}{/* skip 500 bytes */}}
\DoxyCodeLine{208    \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{chacha20_8c_a91e9ef4c395ab95e10838e117e5aa1a1}{chacha20\_prng\_export}}(dmp, \&dmplen, \&st)) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}})        \textcolor{keywordflow}{return} err;}
\DoxyCodeLine{209    \textcolor{keywordflow}{if} (\mbox{\hyperlink{chacha20_8c_a5adfff638ebc7c30cd3840ddd6807c30}{chacha20\_prng\_read}}(out, 500, \&st) != 500)                           \textcolor{keywordflow}{return} \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06ca68eea82b3b71f23031cd94b10c920bf3}{CRYPT\_ERROR\_READPRNG}}; \textcolor{comment}{/* skip 500 bytes */}}
\DoxyCodeLine{210    \textcolor{keywordflow}{if} (\mbox{\hyperlink{chacha20_8c_a5adfff638ebc7c30cd3840ddd6807c30}{chacha20\_prng\_read}}(out, 10, \&st) != 10)                             \textcolor{keywordflow}{return} \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06ca68eea82b3b71f23031cd94b10c920bf3}{CRYPT\_ERROR\_READPRNG}}; \textcolor{comment}{/* 10 bytes for testing */}}
\DoxyCodeLine{211    \textcolor{keywordflow}{if} (\mbox{\hyperlink{tomcrypt__misc_8h_a7764a7f27897c6182335752df00b5f8e}{compare\_testvector}}(out, 10, \mbox{\hyperlink{tiger_8c_aa4652e2d6053d420dcbea07a113db5fe}{t2}}, \textcolor{keyword}{sizeof}(\mbox{\hyperlink{tiger_8c_aa4652e2d6053d420dcbea07a113db5fe}{t2}}), \textcolor{stringliteral}{"CHACHA-PRNG"}, 2))      \textcolor{keywordflow}{return} \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06caf98a132fdf93633389677f31f9bb39ca}{CRYPT\_FAIL\_TESTVECTOR}};}
\DoxyCodeLine{212    \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{chacha20_8c_ac4c6ba884d06287d4e168743899a058b}{chacha20\_prng\_done}}(\&st)) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}})                        \textcolor{keywordflow}{return} err;}
\DoxyCodeLine{213    \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{chacha20_8c_aec1d8ebf9e796fe1223995e48d665a92}{chacha20\_prng\_import}}(dmp, dmplen, \&st)) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}})         \textcolor{keywordflow}{return} err;}
\DoxyCodeLine{214    \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{chacha20_8c_a4d83a788328b93577373da5036f9e3ff}{chacha20\_prng\_ready}}(\&st)) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}})                       \textcolor{keywordflow}{return} err;}
\DoxyCodeLine{215    \textcolor{keywordflow}{if} (\mbox{\hyperlink{chacha20_8c_a5adfff638ebc7c30cd3840ddd6807c30}{chacha20\_prng\_read}}(out, 500, \&st) != 500)                           \textcolor{keywordflow}{return} \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06ca68eea82b3b71f23031cd94b10c920bf3}{CRYPT\_ERROR\_READPRNG}}; \textcolor{comment}{/* skip 500 bytes */}}
\DoxyCodeLine{216    \textcolor{keywordflow}{if} (\mbox{\hyperlink{chacha20_8c_a5adfff638ebc7c30cd3840ddd6807c30}{chacha20\_prng\_read}}(out, 10, \&st) != 10)                             \textcolor{keywordflow}{return} \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06ca68eea82b3b71f23031cd94b10c920bf3}{CRYPT\_ERROR\_READPRNG}}; \textcolor{comment}{/* 10 bytes for testing */}}
\DoxyCodeLine{217    \textcolor{keywordflow}{if} (\mbox{\hyperlink{tomcrypt__misc_8h_a7764a7f27897c6182335752df00b5f8e}{compare\_testvector}}(out, 10, \mbox{\hyperlink{tiger_8c_a71a491fa5f35065b954a3001ebed0f28}{t3}}, \textcolor{keyword}{sizeof}(\mbox{\hyperlink{tiger_8c_a71a491fa5f35065b954a3001ebed0f28}{t3}}), \textcolor{stringliteral}{"CHACHA-PRNG"}, 3))      \textcolor{keywordflow}{return} \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06caf98a132fdf93633389677f31f9bb39ca}{CRYPT\_FAIL\_TESTVECTOR}};}
\DoxyCodeLine{218    \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{chacha20_8c_ac4c6ba884d06287d4e168743899a058b}{chacha20\_prng\_done}}(\&st)) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}})                        \textcolor{keywordflow}{return} err;}
\DoxyCodeLine{219 }
\DoxyCodeLine{220    \textcolor{keywordflow}{return} \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}};}
\DoxyCodeLine{221 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{222 \}}

\end{DoxyCode}


References chacha20\+\_\+prng\+\_\+add\+\_\+entropy(), chacha20\+\_\+prng\+\_\+done(), chacha20\+\_\+prng\+\_\+export(), chacha20\+\_\+prng\+\_\+import(), chacha20\+\_\+prng\+\_\+read(), chacha20\+\_\+prng\+\_\+ready(), chacha20\+\_\+prng\+\_\+start(), compare\+\_\+testvector(), C\+R\+Y\+P\+T\+\_\+\+E\+R\+R\+O\+R\+\_\+\+R\+E\+A\+D\+P\+R\+NG, C\+R\+Y\+P\+T\+\_\+\+F\+A\+I\+L\+\_\+\+T\+E\+S\+T\+V\+E\+C\+T\+OR, C\+R\+Y\+P\+T\+\_\+\+N\+OP, C\+R\+Y\+P\+T\+\_\+\+OK, t1, t2, and t3.

Here is the call graph for this function\+:
% FIG 14


\subsection{Variable Documentation}
\mbox{\Hypertarget{chacha20_8c_a379b46b2ee8c713bed1a63d68bf0086c}\label{chacha20_8c_a379b46b2ee8c713bed1a63d68bf0086c}} 
\index{chacha20.c@{chacha20.c}!chacha20\_prng\_desc@{chacha20\_prng\_desc}}
\index{chacha20\_prng\_desc@{chacha20\_prng\_desc}!chacha20.c@{chacha20.c}}
\subsubsection{\texorpdfstring{chacha20\_prng\_desc}{chacha20\_prng\_desc}}
{\footnotesize\ttfamily const struct \mbox{\hyperlink{structltc__prng__descriptor}{ltc\+\_\+prng\+\_\+descriptor}} chacha20\+\_\+prng\+\_\+desc}

{\bfseries Initial value\+:}
\begin{DoxyCode}{0}
\DoxyCodeLine{=}
\DoxyCodeLine{\{}
\DoxyCodeLine{   \textcolor{stringliteral}{"chacha20"},}
\DoxyCodeLine{   40,}
\DoxyCodeLine{   \&\mbox{\hyperlink{chacha20_8c_aa52a7cb95c35a702f9cbf374bacf9530}{chacha20\_prng\_start}},}
\DoxyCodeLine{   \&\mbox{\hyperlink{chacha20_8c_ae75ffa7e5ccf945ae352f106fb3b3f13}{chacha20\_prng\_add\_entropy}},}
\DoxyCodeLine{   \&\mbox{\hyperlink{chacha20_8c_a4d83a788328b93577373da5036f9e3ff}{chacha20\_prng\_ready}},}
\DoxyCodeLine{   \&\mbox{\hyperlink{chacha20_8c_a5adfff638ebc7c30cd3840ddd6807c30}{chacha20\_prng\_read}},}
\DoxyCodeLine{   \&\mbox{\hyperlink{chacha20_8c_ac4c6ba884d06287d4e168743899a058b}{chacha20\_prng\_done}},}
\DoxyCodeLine{   \&\mbox{\hyperlink{chacha20_8c_a91e9ef4c395ab95e10838e117e5aa1a1}{chacha20\_prng\_export}},}
\DoxyCodeLine{   \&\mbox{\hyperlink{chacha20_8c_aec1d8ebf9e796fe1223995e48d665a92}{chacha20\_prng\_import}},}
\DoxyCodeLine{   \&\mbox{\hyperlink{chacha20_8c_a1c178a6f1b7255371d3340913c29b64a}{chacha20\_prng\_test}}}
\DoxyCodeLine{\}}

\end{DoxyCode}


Definition at line 18 of file chacha20.\+c.



Referenced by chacha20\+\_\+prng\+\_\+import(), and register\+\_\+all\+\_\+prngs().

