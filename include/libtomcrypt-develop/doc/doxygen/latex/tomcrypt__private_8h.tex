\hypertarget{tomcrypt__private_8h}{}\section{M\+:/\+Office/!\+Doutorado/0. Repositorio\+S\+V\+N/\+H\+A\+M\+S\+T\+E\+R\+\_\+\+Prototype/branches/\+J\+I\+N\+T2018/include/libtomcrypt-\/develop/src/headers/tomcrypt\+\_\+private.h File Reference}
\label{tomcrypt__private_8h}\index{M:/Office/"!Doutorado/0. RepositorioSVN/HAMSTER\_Prototype/branches/JINT2018/include/libtomcrypt-\/develop/src/headers/tomcrypt\_private.h@{M:/Office/"!Doutorado/0. RepositorioSVN/HAMSTER\_Prototype/branches/JINT2018/include/libtomcrypt-\/develop/src/headers/tomcrypt\_private.h}}
{\ttfamily \#include \char`\"{}tomcrypt.\+h\char`\"{}}\newline
Include dependency graph for tomcrypt\+\_\+private.\+h\+:
% FIG 0
This graph shows which files directly or indirectly include this file\+:
% FIG 1
\subsection*{Data Structures}
\begin{DoxyCompactItemize}
\item 
struct \mbox{\hyperlink{structltc__dh__set__type}{ltc\+\_\+dh\+\_\+set\+\_\+type}}
\item 
struct \mbox{\hyperlink{structpbes__properties}{pbes\+\_\+properties}}
\item 
struct \mbox{\hyperlink{structpbes__arg}{pbes\+\_\+arg}}
\end{DoxyCompactItemize}
\subsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\#define \mbox{\hyperlink{tomcrypt__private_8h_a2b8e12593fe11f8eaeace6ce0fcc7566}{L\+T\+C\+\_\+\+P\+A\+D\+\_\+\+M\+A\+SK}}~(0x\+F000\+U)
\item 
\#define \mbox{\hyperlink{tomcrypt__private_8h_ae7c734d30e56dd5f0306f54246d47c2b}{H\+A\+S\+H\+\_\+\+P\+R\+O\+C\+E\+SS}}(func\+\_\+name,  compress\+\_\+name,  state\+\_\+var,  block\+\_\+size)
\item 
\#define \mbox{\hyperlink{tomcrypt__private_8h_ab8e25bc0c3ace6218c5c7d49198405c9}{M\+P\+\_\+\+D\+I\+G\+I\+T\+\_\+\+B\+IT}}~ltc\+\_\+mp.\+bits\+\_\+per\+\_\+digit
\item 
\#define \mbox{\hyperlink{tomcrypt__private_8h_aff03c4f22c68d651747055048c509cf3}{mp\+\_\+init}}(a)~\mbox{\hyperlink{tfm__desc_8c_a4f8948d7c94899bf8ddee4721114d593}{ltc\+\_\+mp.\+init}}(a)
\item 
\#define \mbox{\hyperlink{tomcrypt__private_8h_adb6322247b1a4f0347219acab3120bd3}{mp\+\_\+init\+\_\+multi}}~\mbox{\hyperlink{multi_8c_a327161b10428b234d74713b8a08acb2a}{ltc\+\_\+init\+\_\+multi}}
\item 
\#define \mbox{\hyperlink{tomcrypt__private_8h_ab05b6b59fa182b81f5f990d5621229f6}{mp\+\_\+clear}}(a)~\mbox{\hyperlink{tfm__desc_8c_a9626887f45edba884c412234edf7d1d6}{ltc\+\_\+mp.\+deinit}}(a)
\item 
\#define \mbox{\hyperlink{tomcrypt__private_8h_aad5c8a3112b3e4613f9efc86692c43cb}{mp\+\_\+clear\+\_\+multi}}~\mbox{\hyperlink{multi_8c_abcb92ed327d5fcf9bf9bcff2a6a3107a}{ltc\+\_\+deinit\+\_\+multi}}
\item 
\#define \mbox{\hyperlink{tomcrypt__private_8h_ad0d492c0676e4944383a7ae9e9ebd63b}{mp\+\_\+cleanup\+\_\+multi}}~\mbox{\hyperlink{multi_8c_a53eb69feb3f6ec63778a845a07771762}{ltc\+\_\+cleanup\+\_\+multi}}
\item 
\#define \mbox{\hyperlink{tomcrypt__private_8h_ad2f4da76a1604a39a01d9366dc0ea892}{mp\+\_\+init\+\_\+copy}}(a,  b)~\mbox{\hyperlink{tfm__desc_8c_a9c0dddd7edf258f69ca346540f3da61a}{ltc\+\_\+mp.\+init\+\_\+copy}}(a, b)
\item 
\#define \mbox{\hyperlink{tomcrypt__private_8h_a0a85470068985d2c10a4df85ca54a7d0}{mp\+\_\+neg}}(a,  b)~\mbox{\hyperlink{tfm__desc_8c_adc67bac9fd8e42c930369ddabaa5f2db}{ltc\+\_\+mp.\+neg}}(a, b)
\item 
\#define \mbox{\hyperlink{tomcrypt__private_8h_afbb35bc8f920448d169ddc83a4308840}{mp\+\_\+copy}}(a,  b)~\mbox{\hyperlink{tfm__desc_8c_ad88f68a4e6f0c7334e93eebf7ddbb2d3}{ltc\+\_\+mp.\+copy}}(a, b)
\item 
\#define \mbox{\hyperlink{tomcrypt__private_8h_a000b0542ef4ecf639ff69895490fdb8f}{mp\+\_\+set}}(a,  b)~\mbox{\hyperlink{tfm__desc_8c_a0b4961498876dba1898ece1416698b10}{ltc\+\_\+mp.\+set\+\_\+int}}(a, b)
\item 
\#define \mbox{\hyperlink{tomcrypt__private_8h_ab06bc6503c4faab10b7ce60bef365d65}{mp\+\_\+set\+\_\+int}}(a,  b)~\mbox{\hyperlink{tfm__desc_8c_a0b4961498876dba1898ece1416698b10}{ltc\+\_\+mp.\+set\+\_\+int}}(a, b)
\item 
\#define \mbox{\hyperlink{tomcrypt__private_8h_a4e68c807adc159c7553da37ce38196b2}{mp\+\_\+get\+\_\+int}}(a)~\mbox{\hyperlink{tfm__desc_8c_ac31838ab831d4094fe109d327019548c}{ltc\+\_\+mp.\+get\+\_\+int}}(a)
\item 
\#define \mbox{\hyperlink{tomcrypt__private_8h_a62267879327e26468c45bbd83f7f2669}{mp\+\_\+get\+\_\+digit}}(a,  n)~\mbox{\hyperlink{tfm__desc_8c_a6171f32e40e45f55caf4a7cb475e866c}{ltc\+\_\+mp.\+get\+\_\+digit}}(a, n)
\item 
\#define \mbox{\hyperlink{tomcrypt__private_8h_ae51a279d51ab72f09d9f97335b8be6c9}{mp\+\_\+get\+\_\+digit\+\_\+count}}(a)~\mbox{\hyperlink{tfm__desc_8c_a10c8ab52ee86746d3389aa2400c88ac2}{ltc\+\_\+mp.\+get\+\_\+digit\+\_\+count}}(a)
\item 
\#define \mbox{\hyperlink{tomcrypt__private_8h_a62ea02fbe7dd2d456e49520264d775ee}{mp\+\_\+cmp}}(a,  b)~\mbox{\hyperlink{tfm__desc_8c_aecfc62c80bd6acc7a95d1391ad8252f7}{ltc\+\_\+mp.\+compare}}(a, b)
\item 
\#define \mbox{\hyperlink{tomcrypt__private_8h_a6ce44f2e6f872565a468b67d9a93dc28}{mp\+\_\+cmp\+\_\+d}}(a,  b)~\mbox{\hyperlink{tfm__desc_8c_aee3f861609cd9406655be85087a7bb06}{ltc\+\_\+mp.\+compare\+\_\+d}}(a, b)
\item 
\#define \mbox{\hyperlink{tomcrypt__private_8h_afa1671e20e699f66319ed2e8d9119e7e}{mp\+\_\+count\+\_\+bits}}(a)~\mbox{\hyperlink{tfm__desc_8c_a55e39d3b1adb176ed84c1211a7123071}{ltc\+\_\+mp.\+count\+\_\+bits}}(a)
\item 
\#define \mbox{\hyperlink{tomcrypt__private_8h_a566a41699158970f4d7a0554081706dd}{mp\+\_\+cnt\+\_\+lsb}}(a)~\mbox{\hyperlink{tfm__desc_8c_a2506b220df2c67f8b9969f6c627c84a1}{ltc\+\_\+mp.\+count\+\_\+lsb\+\_\+bits}}(a)
\item 
\#define \mbox{\hyperlink{tomcrypt__private_8h_abeb03f01d3819863d5de470797c629de}{mp\+\_\+2expt}}(a,  b)~\mbox{\hyperlink{tfm__desc_8c_a4f1673caee67fa1b6f8b745661a68eb1}{ltc\+\_\+mp.\+twoexpt}}(a, b)
\item 
\#define \mbox{\hyperlink{tomcrypt__private_8h_a12263d4d7da068c2a630d2ffc0c8bc1b}{mp\+\_\+read\+\_\+radix}}(a,  b,  \mbox{\hyperlink{khazad_8c_a86ea50de5a3e0ae87762f4298d35284c}{c}})~\mbox{\hyperlink{tfm__desc_8c_af84d5b7caaf005f40f924afd8ada2380}{ltc\+\_\+mp.\+read\+\_\+radix}}(a, b, \mbox{\hyperlink{khazad_8c_a86ea50de5a3e0ae87762f4298d35284c}{c}})
\item 
\#define \mbox{\hyperlink{tomcrypt__private_8h_a560fd673c15ccf143fdfdcb2b21764e3}{mp\+\_\+toradix}}(a,  b,  \mbox{\hyperlink{khazad_8c_a86ea50de5a3e0ae87762f4298d35284c}{c}})~\mbox{\hyperlink{tfm__desc_8c_aa40161a29cddd18172c7a64a18b6dc2c}{ltc\+\_\+mp.\+write\+\_\+radix}}(a, b, \mbox{\hyperlink{khazad_8c_a86ea50de5a3e0ae87762f4298d35284c}{c}})
\item 
\#define \mbox{\hyperlink{tomcrypt__private_8h_ad301148bb24f43a8c7003a6976dfaa5a}{mp\+\_\+unsigned\+\_\+bin\+\_\+size}}(a)~\mbox{\hyperlink{tfm__desc_8c_adb7e3791a36546ca7550e34344e2cb47}{ltc\+\_\+mp.\+unsigned\+\_\+size}}(a)
\item 
\#define \mbox{\hyperlink{tomcrypt__private_8h_a376a4d31dcfeb65c069db0485b9602f8}{mp\+\_\+to\+\_\+unsigned\+\_\+bin}}(a,  b)~\mbox{\hyperlink{tfm__desc_8c_a0f1b2cd32964ecad0001b7169b53f1d1}{ltc\+\_\+mp.\+unsigned\+\_\+write}}(a, b)
\item 
\#define \mbox{\hyperlink{tomcrypt__private_8h_a9e20e2044bb5a279e27512d1e1b65754}{mp\+\_\+read\+\_\+unsigned\+\_\+bin}}(a,  b,  \mbox{\hyperlink{khazad_8c_a86ea50de5a3e0ae87762f4298d35284c}{c}})~\mbox{\hyperlink{tfm__desc_8c_a39cf7045cbd39dc7ee5ecdf59dbe3313}{ltc\+\_\+mp.\+unsigned\+\_\+read}}(a, b, \mbox{\hyperlink{khazad_8c_a86ea50de5a3e0ae87762f4298d35284c}{c}})
\item 
\#define \mbox{\hyperlink{tomcrypt__private_8h_a175d04f8aeaa1c3895fe14de6cc0d2db}{mp\+\_\+add}}(a,  b,  \mbox{\hyperlink{khazad_8c_a86ea50de5a3e0ae87762f4298d35284c}{c}})~\mbox{\hyperlink{tfm__desc_8c_a274c97efa9f26a6d22ca17dbcb52e58b}{ltc\+\_\+mp.\+add}}(a, b, \mbox{\hyperlink{khazad_8c_a86ea50de5a3e0ae87762f4298d35284c}{c}})
\item 
\#define \mbox{\hyperlink{tomcrypt__private_8h_a69f09e7351d696b635ffbc9912684ab4}{mp\+\_\+add\+\_\+d}}(a,  b,  \mbox{\hyperlink{khazad_8c_a86ea50de5a3e0ae87762f4298d35284c}{c}})~\mbox{\hyperlink{tfm__desc_8c_a9cce188374e60ab500e0e658738eb0ce}{ltc\+\_\+mp.\+addi}}(a, b, \mbox{\hyperlink{khazad_8c_a86ea50de5a3e0ae87762f4298d35284c}{c}})
\item 
\#define \mbox{\hyperlink{tomcrypt__private_8h_ab8d0882c3b58263b638b41fbf110fde8}{mp\+\_\+sub}}(a,  b,  \mbox{\hyperlink{khazad_8c_a86ea50de5a3e0ae87762f4298d35284c}{c}})~\mbox{\hyperlink{tfm__desc_8c_ac1994aaeae47e7ef1b1b6fe723898be0}{ltc\+\_\+mp.\+sub}}(a, b, \mbox{\hyperlink{khazad_8c_a86ea50de5a3e0ae87762f4298d35284c}{c}})
\item 
\#define \mbox{\hyperlink{tomcrypt__private_8h_a4215ff0d6838acb3d959d3e68c923de7}{mp\+\_\+sub\+\_\+d}}(a,  b,  \mbox{\hyperlink{khazad_8c_a86ea50de5a3e0ae87762f4298d35284c}{c}})~\mbox{\hyperlink{tfm__desc_8c_afa8ec5f7da0f83c1ea1f3da29e9be588}{ltc\+\_\+mp.\+subi}}(a, b, \mbox{\hyperlink{khazad_8c_a86ea50de5a3e0ae87762f4298d35284c}{c}})
\item 
\#define \mbox{\hyperlink{tomcrypt__private_8h_a7606d2423856b32b09245a2fa1ef34ee}{mp\+\_\+mul}}(a,  b,  \mbox{\hyperlink{khazad_8c_a86ea50de5a3e0ae87762f4298d35284c}{c}})~\mbox{\hyperlink{tfm__desc_8c_a7050c53d3ede33130b5137ee21872390}{ltc\+\_\+mp.\+mul}}(a, b, \mbox{\hyperlink{khazad_8c_a86ea50de5a3e0ae87762f4298d35284c}{c}})
\item 
\#define \mbox{\hyperlink{tomcrypt__private_8h_a6732f5faae69c8d1305898ca8e2943d5}{mp\+\_\+mul\+\_\+d}}(a,  b,  \mbox{\hyperlink{khazad_8c_a86ea50de5a3e0ae87762f4298d35284c}{c}})~\mbox{\hyperlink{tfm__desc_8c_a1bde65678f43510d80f8851860e15e34}{ltc\+\_\+mp.\+muli}}(a, b, \mbox{\hyperlink{khazad_8c_a86ea50de5a3e0ae87762f4298d35284c}{c}})
\item 
\#define \mbox{\hyperlink{tomcrypt__private_8h_aea81d79b5462e99068908d80edb8bd1a}{mp\+\_\+sqr}}(a,  b)~\mbox{\hyperlink{tfm__desc_8c_acb23c57b2c947a4345287b337fa78764}{ltc\+\_\+mp.\+sqr}}(a, b)
\item 
\#define \mbox{\hyperlink{tomcrypt__private_8h_af1a090c9979e328596fa37512f519a09}{mp\+\_\+sqrtmod\+\_\+prime}}(a,  b,  \mbox{\hyperlink{khazad_8c_a86ea50de5a3e0ae87762f4298d35284c}{c}})~\mbox{\hyperlink{ltm__desc_8c_aec55b2d137e8b50b343f2d9986db1843}{ltc\+\_\+mp.\+sqrtmod\+\_\+prime}}(a, b, \mbox{\hyperlink{khazad_8c_a86ea50de5a3e0ae87762f4298d35284c}{c}})
\item 
\#define \mbox{\hyperlink{tomcrypt__private_8h_a861721ee02d3b5d84328090f3058f7c3}{mp\+\_\+div}}(a,  b,  \mbox{\hyperlink{khazad_8c_a86ea50de5a3e0ae87762f4298d35284c}{c}},  d)~ltc\+\_\+mp.\+mpdiv(a, b, \mbox{\hyperlink{khazad_8c_a86ea50de5a3e0ae87762f4298d35284c}{c}}, d)
\item 
\#define \mbox{\hyperlink{tomcrypt__private_8h_aec841464b436981f5758a49c561f39fe}{mp\+\_\+div\+\_\+2}}(a,  b)~\mbox{\hyperlink{tfm__desc_8c_a38e564335cd5493b0e02969fda1c73a0}{ltc\+\_\+mp.\+div\+\_\+2}}(a, b)
\item 
\#define \mbox{\hyperlink{tomcrypt__private_8h_ac7deed6f00e289706070b16f98c430fe}{mp\+\_\+mod}}(a,  b,  \mbox{\hyperlink{khazad_8c_a86ea50de5a3e0ae87762f4298d35284c}{c}})~ltc\+\_\+mp.\+mpdiv(a, b, N\+U\+LL, \mbox{\hyperlink{khazad_8c_a86ea50de5a3e0ae87762f4298d35284c}{c}})
\item 
\#define \mbox{\hyperlink{tomcrypt__private_8h_afd41c0725f692174823db3e939b3ac1e}{mp\+\_\+mod\+\_\+d}}(a,  b,  \mbox{\hyperlink{khazad_8c_a86ea50de5a3e0ae87762f4298d35284c}{c}})~\mbox{\hyperlink{tfm__desc_8c_a825311b5e56f780acb119b19a3cbdca0}{ltc\+\_\+mp.\+modi}}(a, b, \mbox{\hyperlink{khazad_8c_a86ea50de5a3e0ae87762f4298d35284c}{c}})
\item 
\#define \mbox{\hyperlink{tomcrypt__private_8h_ad9deb5f35c296a1cd7ae37f4e4e210f4}{mp\+\_\+gcd}}(a,  b,  \mbox{\hyperlink{khazad_8c_a86ea50de5a3e0ae87762f4298d35284c}{c}})~\mbox{\hyperlink{tfm__desc_8c_afb49bbeaad5528b5afd96667e06c19ef}{ltc\+\_\+mp.\+gcd}}(a, b, \mbox{\hyperlink{khazad_8c_a86ea50de5a3e0ae87762f4298d35284c}{c}})
\item 
\#define \mbox{\hyperlink{tomcrypt__private_8h_a42ca6ad7676c236e06ee8b53e278a1a2}{mp\+\_\+lcm}}(a,  b,  \mbox{\hyperlink{khazad_8c_a86ea50de5a3e0ae87762f4298d35284c}{c}})~\mbox{\hyperlink{tfm__desc_8c_ade2a62ec3e6aa65016ad994bdae98424}{ltc\+\_\+mp.\+lcm}}(a, b, \mbox{\hyperlink{khazad_8c_a86ea50de5a3e0ae87762f4298d35284c}{c}})
\item 
\#define \mbox{\hyperlink{tomcrypt__private_8h_a3cc86fdd66c67023afe490b3534d459b}{mp\+\_\+addmod}}(a,  b,  \mbox{\hyperlink{khazad_8c_a86ea50de5a3e0ae87762f4298d35284c}{c}},  d)~\mbox{\hyperlink{tfm__desc_8c_a1197b0ad15639bfc3fc66314c2ce8527}{ltc\+\_\+mp.\+addmod}}(a, b, \mbox{\hyperlink{khazad_8c_a86ea50de5a3e0ae87762f4298d35284c}{c}}, d)
\item 
\#define \mbox{\hyperlink{tomcrypt__private_8h_a15e2f6c11b3fcebe885ecc14d759ac01}{mp\+\_\+submod}}(a,  b,  \mbox{\hyperlink{khazad_8c_a86ea50de5a3e0ae87762f4298d35284c}{c}},  d)~\mbox{\hyperlink{tfm__desc_8c_ac6a3bdd2a041584938590017969f9f76}{ltc\+\_\+mp.\+submod}}(a, b, \mbox{\hyperlink{khazad_8c_a86ea50de5a3e0ae87762f4298d35284c}{c}}, d)
\item 
\#define \mbox{\hyperlink{tomcrypt__private_8h_a0c32b20b84951870c7b09f5b6f2679c9}{mp\+\_\+mulmod}}(a,  b,  \mbox{\hyperlink{khazad_8c_a86ea50de5a3e0ae87762f4298d35284c}{c}},  d)~\mbox{\hyperlink{tfm__desc_8c_a4c6702198a33b0c56f0a886d7c2206c5}{ltc\+\_\+mp.\+mulmod}}(a, b, \mbox{\hyperlink{khazad_8c_a86ea50de5a3e0ae87762f4298d35284c}{c}}, d)
\item 
\#define \mbox{\hyperlink{tomcrypt__private_8h_a6542bece10f5cf20b6c754646c20fcb4}{mp\+\_\+sqrmod}}(a,  b,  \mbox{\hyperlink{khazad_8c_a86ea50de5a3e0ae87762f4298d35284c}{c}})~\mbox{\hyperlink{tfm__desc_8c_a2a2ed54ac95cb81e7a744b060eeb34af}{ltc\+\_\+mp.\+sqrmod}}(a, b, \mbox{\hyperlink{khazad_8c_a86ea50de5a3e0ae87762f4298d35284c}{c}})
\item 
\#define \mbox{\hyperlink{tomcrypt__private_8h_a8be707236375351ab194f908c8ba9233}{mp\+\_\+invmod}}(a,  b,  \mbox{\hyperlink{khazad_8c_a86ea50de5a3e0ae87762f4298d35284c}{c}})~\mbox{\hyperlink{tfm__desc_8c_ac982ab06185a4919fdd77d7ab0fd8093}{ltc\+\_\+mp.\+invmod}}(a, b, \mbox{\hyperlink{khazad_8c_a86ea50de5a3e0ae87762f4298d35284c}{c}})
\item 
\#define \mbox{\hyperlink{tomcrypt__private_8h_a42560b136f9c3cf1411a82a8cae6d954}{mp\+\_\+montgomery\+\_\+setup}}(a,  b)~\mbox{\hyperlink{tfm__desc_8c_a771ef8a9d5b1b2633613bfad28b282c2}{ltc\+\_\+mp.\+montgomery\+\_\+setup}}(a, b)
\item 
\#define \mbox{\hyperlink{tomcrypt__private_8h_a8e30da64ace4410ca56cb110a6fedd19}{mp\+\_\+montgomery\+\_\+normalization}}(a,  b)~\mbox{\hyperlink{tfm__desc_8c_aa047d6197825069c90f4f89a59f5ed6d}{ltc\+\_\+mp.\+montgomery\+\_\+normalization}}(a, b)
\item 
\#define \mbox{\hyperlink{tomcrypt__private_8h_a4201ed2dbae154496e1a2ae9ba8aa7a8}{mp\+\_\+montgomery\+\_\+reduce}}(a,  b,  \mbox{\hyperlink{khazad_8c_a86ea50de5a3e0ae87762f4298d35284c}{c}})~\mbox{\hyperlink{tfm__desc_8c_a109a8d07cc14bf2f0bd604a773d7e02c}{ltc\+\_\+mp.\+montgomery\+\_\+reduce}}(a, b, \mbox{\hyperlink{khazad_8c_a86ea50de5a3e0ae87762f4298d35284c}{c}})
\item 
\#define \mbox{\hyperlink{tomcrypt__private_8h_ac1935719c005c8bffb7590628e84c024}{mp\+\_\+montgomery\+\_\+free}}(a)~\mbox{\hyperlink{tfm__desc_8c_a8d6035f0021cfaf5936a3c37d2cb2427}{ltc\+\_\+mp.\+montgomery\+\_\+deinit}}(a)
\item 
\#define \mbox{\hyperlink{tomcrypt__private_8h_a4fb1221fbef91bf8163390e3cfb82085}{mp\+\_\+exptmod}}(a,  b,  \mbox{\hyperlink{khazad_8c_a86ea50de5a3e0ae87762f4298d35284c}{c}},  d)~\mbox{\hyperlink{tfm__desc_8c_a251a26828a3c68dff4bbe01f54470275}{ltc\+\_\+mp.\+exptmod}}(a,b,\mbox{\hyperlink{khazad_8c_a86ea50de5a3e0ae87762f4298d35284c}{c}},d)
\item 
\#define \mbox{\hyperlink{tomcrypt__private_8h_ab3681f96d55cf707b92d6254f58ea3de}{mp\+\_\+prime\+\_\+is\+\_\+prime}}(a,  b,  \mbox{\hyperlink{khazad_8c_a86ea50de5a3e0ae87762f4298d35284c}{c}})~\mbox{\hyperlink{tfm__desc_8c_a48fb4f337851176a7ee5b0836e77d7df}{ltc\+\_\+mp.\+isprime}}(a, b, \mbox{\hyperlink{khazad_8c_a86ea50de5a3e0ae87762f4298d35284c}{c}})
\item 
\#define \mbox{\hyperlink{tomcrypt__private_8h_a910040068490f9f6e5185c970ab869c9}{mp\+\_\+iszero}}(a)~(\mbox{\hyperlink{tomcrypt__private_8h_a6ce44f2e6f872565a468b67d9a93dc28}{mp\+\_\+cmp\+\_\+d}}(a, 0) == \mbox{\hyperlink{tomcrypt__math_8h_a035a31bde4f31419eb259e36e5776607}{L\+T\+C\+\_\+\+M\+P\+\_\+\+EQ}} ? \mbox{\hyperlink{tomcrypt__math_8h_acc2da047f8fb30a3e2b2403aac617fe0}{L\+T\+C\+\_\+\+M\+P\+\_\+\+Y\+ES}} \+: \mbox{\hyperlink{tomcrypt__math_8h_a40f1119339954fb273ecb35e48c1d569}{L\+T\+C\+\_\+\+M\+P\+\_\+\+NO}})
\item 
\#define \mbox{\hyperlink{tomcrypt__private_8h_a93ed39c257831509afc74f2b6da66ae7}{mp\+\_\+isodd}}(a)~(\mbox{\hyperlink{tomcrypt__private_8h_ae51a279d51ab72f09d9f97335b8be6c9}{mp\+\_\+get\+\_\+digit\+\_\+count}}(a) $>$ 0 ? (\mbox{\hyperlink{tomcrypt__private_8h_a62267879327e26468c45bbd83f7f2669}{mp\+\_\+get\+\_\+digit}}(a, 0) \& 1 ? \mbox{\hyperlink{tomcrypt__math_8h_acc2da047f8fb30a3e2b2403aac617fe0}{L\+T\+C\+\_\+\+M\+P\+\_\+\+Y\+ES}} \+: \mbox{\hyperlink{tomcrypt__math_8h_a40f1119339954fb273ecb35e48c1d569}{L\+T\+C\+\_\+\+M\+P\+\_\+\+NO}}) \+: \mbox{\hyperlink{tomcrypt__math_8h_a40f1119339954fb273ecb35e48c1d569}{L\+T\+C\+\_\+\+M\+P\+\_\+\+NO}})
\item 
\#define \mbox{\hyperlink{tomcrypt__private_8h_a16c03b9a12fc6832ae878eabb57e13cc}{mp\+\_\+exch}}(a,  b)~do \{ void $\ast$A\+B\+C\+\_\+\+\_\+tmp = a; a = b; b = A\+B\+C\+\_\+\+\_\+tmp; \} while(0)
\item 
\#define \mbox{\hyperlink{tomcrypt__private_8h_a4b9ad86294c22251f11369ed62f236b9}{mp\+\_\+tohex}}(a,  b)~\mbox{\hyperlink{tomcrypt__private_8h_a560fd673c15ccf143fdfdcb2b21764e3}{mp\+\_\+toradix}}(a, b, 16)
\item 
\#define \mbox{\hyperlink{tomcrypt__private_8h_a9a1503b0adb58db297bc6bfd784b3945}{mp\+\_\+rand}}(a,  b)~ltc\+\_\+mp.\+rand(a, b)
\item 
\#define \mbox{\hyperlink{tomcrypt__private_8h_a896c8b07a35ff2799061855f08a8325a}{L\+T\+C\+\_\+\+A\+S\+N1\+\_\+\+I\+S\+\_\+\+T\+Y\+PE}}(e,  t)~(((e) != N\+U\+LL) \&\& ((e)-\/$>$type == (t)))
\item 
\#define \mbox{\hyperlink{tomcrypt__private_8h_ae463e0ea9b84288e301f114d43ef3e9a}{\+\_\+\+L\+T\+C\+\_\+\+P\+R\+N\+G\+\_\+\+E\+X\+P\+O\+RT}}(which)
\item 
\#define \mbox{\hyperlink{tomcrypt__private_8h_a319cb143574102827d3b0055ded27533}{L\+T\+C\+\_\+\+B\+Y\+TE}}(x,  n)~(((x) $>$$>$ (8 $\ast$ (n))) \& 255)
\end{DoxyCompactItemize}
\subsection*{Typedefs}
\begin{DoxyCompactItemize}
\item 
typedef int($\ast$ \mbox{\hyperlink{tomcrypt__private_8h_a056acfa9f8dfc66d7ebbe1315389f3b2}{fn\+\_\+kdf\+\_\+t}}) (const unsigned char $\ast$password, unsigned long password\+\_\+len, const unsigned char $\ast$salt, unsigned long salt\+\_\+len, int iteration\+\_\+count, int hash\+\_\+idx, unsigned char $\ast$out, unsigned long $\ast$outlen)
\end{DoxyCompactItemize}
\subsection*{Enumerations}
\begin{DoxyCompactItemize}
\item 
enum \mbox{\hyperlink{tomcrypt__private_8h_a981c610adcaa77d61adb80dde41a044b}{ltc\+\_\+oid\+\_\+id}} \{ \newline
\mbox{\hyperlink{tomcrypt__private_8h_a981c610adcaa77d61adb80dde41a044ba40273a1f176419e8c4638e0efb15854f}{P\+K\+A\+\_\+\+R\+SA}}, 
\newline
\mbox{\hyperlink{tomcrypt__private_8h_a981c610adcaa77d61adb80dde41a044babe5d329be6c70ca6a43ba1099a69386d}{P\+K\+A\+\_\+\+D\+SA}}, 
\newline
\mbox{\hyperlink{tomcrypt__private_8h_a981c610adcaa77d61adb80dde41a044bafe7642b8f160f5b4e79903c13bf39a4e}{P\+K\+A\+\_\+\+EC}}, 
\newline
\mbox{\hyperlink{tomcrypt__private_8h_a981c610adcaa77d61adb80dde41a044bad815f93f03c91dcfaa47330dcf8a397a}{P\+K\+A\+\_\+\+E\+C\+\_\+\+P\+R\+I\+M\+EF}}
 \}
\end{DoxyCompactItemize}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
int \mbox{\hyperlink{tomcrypt__private_8h_ac4af92f890be670e795a758ec452b402}{ocb3\+\_\+int\+\_\+ntz}} (unsigned long x)
\begin{DoxyCompactList}\small\item\em Returns the number of leading zero bits \mbox{[}from lsb up\mbox{]} (internal function) \end{DoxyCompactList}\item 
void \mbox{\hyperlink{tomcrypt__private_8h_a5bf6caa4615657cdfd8f8941620a987c}{ocb3\+\_\+int\+\_\+xor\+\_\+blocks}} (unsigned char $\ast$out, const unsigned char $\ast$block\+\_\+a, const unsigned char $\ast$block\+\_\+b, unsigned long block\+\_\+len)
\begin{DoxyCompactList}\small\item\em Compute xor for two blocks of bytes \textquotesingle{}out = block\+\_\+a X\+OR block\+\_\+b\textquotesingle{} (internal function) \end{DoxyCompactList}\item 
void \mbox{\hyperlink{tomcrypt__private_8h_a669fada75ab21a80b652dfbc2b54e346}{copy\+\_\+or\+\_\+zeromem}} (const unsigned char $\ast$src, unsigned char $\ast$dest, unsigned long \mbox{\hyperlink{pmac__init_8c_afed088663f8704004425cdae2120b9b3}{len}}, int coz)
\begin{DoxyCompactList}\small\item\em Either copy or zero a block of memory in constant time. \end{DoxyCompactList}\item 
int \mbox{\hyperlink{tomcrypt__private_8h_a7df0f8ba7d5d6b9752a7bb9c5e3f7081}{pbes\+\_\+decrypt}} (const \mbox{\hyperlink{structpbes__arg}{pbes\+\_\+arg}} $\ast$arg, unsigned char $\ast$dec\+\_\+data, unsigned long $\ast$dec\+\_\+size)
\begin{DoxyCompactList}\small\item\em Decrypt Data encrypted via either P\+B\+E\+S1 or P\+B\+E\+S2. \end{DoxyCompactList}\item 
int \mbox{\hyperlink{tomcrypt__private_8h_a3573423ba7eb454bb5f969ee9b580024}{pbes1\+\_\+extract}} (const ltc\+\_\+asn1\+\_\+list $\ast$s, \mbox{\hyperlink{structpbes__arg}{pbes\+\_\+arg}} $\ast$res)
\begin{DoxyCompactList}\small\item\em Extract P\+B\+E\+S1 parameters. \end{DoxyCompactList}\item 
int \mbox{\hyperlink{tomcrypt__private_8h_a741f04fef81b90c03eeba79d1d680273}{pbes2\+\_\+extract}} (const ltc\+\_\+asn1\+\_\+list $\ast$s, \mbox{\hyperlink{structpbes__arg}{pbes\+\_\+arg}} $\ast$res)
\begin{DoxyCompactList}\small\item\em Extract P\+B\+E\+S2 parameters. \end{DoxyCompactList}\item 
int \mbox{\hyperlink{tomcrypt__private_8h_a5a58a92a44e093e5b35960f7b92a6eb9}{rand\+\_\+bn\+\_\+bits}} (void $\ast$\mbox{\hyperlink{sober128__stream_8c_a0240ac851181b84ac374872dc5434ee4}{N}}, int bits, \mbox{\hyperlink{structprng__state}{prng\+\_\+state}} $\ast$prng, int wprng)
\begin{DoxyCompactList}\small\item\em Generate a random number N with given bitlength (note\+: M\+SB can be 0) \end{DoxyCompactList}\item 
int \mbox{\hyperlink{tomcrypt__private_8h_a8050acf530841fb2da3b667204039856}{rand\+\_\+bn\+\_\+upto}} (void $\ast$\mbox{\hyperlink{sober128__stream_8c_a0240ac851181b84ac374872dc5434ee4}{N}}, void $\ast$limit, \mbox{\hyperlink{structprng__state}{prng\+\_\+state}} $\ast$prng, int wprng)
\begin{DoxyCompactList}\small\item\em Generate a random number N in a range\+: 1 $<$= N $<$ limit. \end{DoxyCompactList}\item 
int \mbox{\hyperlink{tomcrypt__private_8h_acff5b3d0c6e1145e07d1a3ff53fadce5}{pk\+\_\+get\+\_\+oid}} (enum \mbox{\hyperlink{tomcrypt__private_8h_a981c610adcaa77d61adb80dde41a044b}{ltc\+\_\+oid\+\_\+id}} id, const char $\ast$$\ast$st)
\item 
int \mbox{\hyperlink{tomcrypt__private_8h_ad99c87d19f50f703708d36a931fe5df6}{pk\+\_\+oid\+\_\+str\+\_\+to\+\_\+num}} (const char $\ast$\mbox{\hyperlink{ecc__find__curve_8c_a3b9aae9990e63034f7d199729f025b23}{O\+ID}}, unsigned long $\ast$oid, unsigned long $\ast$oidlen)
\item 
int \mbox{\hyperlink{tomcrypt__private_8h_a5ead1435fcad3d1f1842a6419079f036}{pk\+\_\+oid\+\_\+num\+\_\+to\+\_\+str}} (const unsigned long $\ast$oid, unsigned long oidlen, char $\ast$\mbox{\hyperlink{ecc__find__curve_8c_a3b9aae9990e63034f7d199729f025b23}{O\+ID}}, unsigned long $\ast$outlen)
\item 
int \mbox{\hyperlink{tomcrypt__private_8h_a88fc16c33e95216e30eae5beb8e92da1}{dh\+\_\+check\+\_\+pubkey}} (const dh\+\_\+key $\ast$key)
\begin{DoxyCompactList}\small\item\em Check DH public key (I\+N\+T\+E\+R\+N\+AL O\+N\+LY, not part of public A\+PI) \end{DoxyCompactList}\item 
int \mbox{\hyperlink{tomcrypt__private_8h_a5058c67d67d65a00c30b08ee3c0149f1}{ecc\+\_\+set\+\_\+curve\+\_\+from\+\_\+mpis}} (void $\ast$a, void $\ast$b, void $\ast$prime, void $\ast$order, void $\ast$gx, void $\ast$gy, unsigned long cofactor, ecc\+\_\+key $\ast$key)
\item 
int \mbox{\hyperlink{tomcrypt__private_8h_aa65ad9426232274db6f50ae2ba05a600}{ecc\+\_\+copy\+\_\+curve}} (const ecc\+\_\+key $\ast$srckey, ecc\+\_\+key $\ast$key)
\item 
int \mbox{\hyperlink{tomcrypt__private_8h_ae380263c82c1fe0cde8dc08e89f7940c}{ecc\+\_\+set\+\_\+curve\+\_\+by\+\_\+size}} (int size, ecc\+\_\+key $\ast$key)
\item 
int \mbox{\hyperlink{tomcrypt__private_8h_a6e24f3e6a3975c4d9e261a6031cab7b5}{ecc\+\_\+import\+\_\+subject\+\_\+public\+\_\+key\+\_\+info}} (const unsigned char $\ast$in, unsigned long inlen, ecc\+\_\+key $\ast$key)
\item 
int \mbox{\hyperlink{tomcrypt__private_8h_a5921e9a5a19d09bc948281baf09ea128}{ecc\+\_\+ssh\+\_\+ecdsa\+\_\+encode\+\_\+name}} (char $\ast$buffer, unsigned long $\ast$buflen, const ecc\+\_\+key $\ast$key)
\begin{DoxyCompactList}\small\item\em Curve/\+O\+ID to S\+S\+H+\+E\+C\+D\+SA name string mapping. \end{DoxyCompactList}\item 
\mbox{\hyperlink{tomcrypt__math_8h_a2a6efaeaa795aa54274d7c4fd66b018a}{ecc\+\_\+point}} $\ast$ \mbox{\hyperlink{tomcrypt__private_8h_a532af6ef2d0f6d1d8cd79e5f81e87cf8}{ltc\+\_\+ecc\+\_\+new\+\_\+point}} (void)
\begin{DoxyCompactList}\small\item\em Allocate a new E\+CC point. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{tomcrypt__private_8h_a4cef83a7c070c94ff78d4df10a7b624f}{ltc\+\_\+ecc\+\_\+del\+\_\+point}} (\mbox{\hyperlink{tomcrypt__math_8h_a2a6efaeaa795aa54274d7c4fd66b018a}{ecc\+\_\+point}} $\ast$p)
\begin{DoxyCompactList}\small\item\em Free an E\+CC point from memory. \end{DoxyCompactList}\item 
int \mbox{\hyperlink{tomcrypt__private_8h_adc0366a4a0c272b7594bcea0d8fe7ccb}{ltc\+\_\+ecc\+\_\+set\+\_\+point\+\_\+xyz}} (\mbox{\hyperlink{tomcrypt__cfg_8h_a4e98fa26a5de0ac87e06af901bad57c4}{ltc\+\_\+mp\+\_\+digit}} x, \mbox{\hyperlink{tomcrypt__cfg_8h_a4e98fa26a5de0ac87e06af901bad57c4}{ltc\+\_\+mp\+\_\+digit}} y, \mbox{\hyperlink{tomcrypt__cfg_8h_a4e98fa26a5de0ac87e06af901bad57c4}{ltc\+\_\+mp\+\_\+digit}} z, \mbox{\hyperlink{tomcrypt__math_8h_a2a6efaeaa795aa54274d7c4fd66b018a}{ecc\+\_\+point}} $\ast$p)
\item 
int \mbox{\hyperlink{tomcrypt__private_8h_a4b36b54e30a0a87aff57a936b386df7f}{ltc\+\_\+ecc\+\_\+copy\+\_\+point}} (const \mbox{\hyperlink{tomcrypt__math_8h_a2a6efaeaa795aa54274d7c4fd66b018a}{ecc\+\_\+point}} $\ast$src, \mbox{\hyperlink{tomcrypt__math_8h_a2a6efaeaa795aa54274d7c4fd66b018a}{ecc\+\_\+point}} $\ast$dst)
\item 
int \mbox{\hyperlink{tomcrypt__private_8h_affd37f56571ffc28d2c2687a76014b11}{ltc\+\_\+ecc\+\_\+is\+\_\+point}} (const ltc\+\_\+ecc\+\_\+dp $\ast$dp, void $\ast$x, void $\ast$y)
\begin{DoxyCompactList}\small\item\em Returns whether \mbox{[}x,y\mbox{]} is a point on curve defined by dp. \end{DoxyCompactList}\item 
int \mbox{\hyperlink{tomcrypt__private_8h_a54a2d7d30af25ef341a8aca09269177d}{ltc\+\_\+ecc\+\_\+is\+\_\+point\+\_\+at\+\_\+infinity}} (const \mbox{\hyperlink{tomcrypt__math_8h_a2a6efaeaa795aa54274d7c4fd66b018a}{ecc\+\_\+point}} $\ast$P, void $\ast$modulus, int $\ast$retval)
\item 
int \mbox{\hyperlink{tomcrypt__private_8h_aa63889eb69cecc42e44b7dfa9ad9d473}{ltc\+\_\+ecc\+\_\+import\+\_\+point}} (const unsigned char $\ast$in, unsigned long inlen, void $\ast$prime, void $\ast$a, void $\ast$b, void $\ast$x, void $\ast$y)
\item 
int \mbox{\hyperlink{tomcrypt__private_8h_ae647d3ad2082ac1e6fc81e857c5922b4}{ltc\+\_\+ecc\+\_\+export\+\_\+point}} (unsigned char $\ast$out, unsigned long $\ast$outlen, void $\ast$x, void $\ast$y, unsigned long size, int compressed)
\item 
int \mbox{\hyperlink{tomcrypt__private_8h_ac0dfaf009d9b0101291727341a20bb40}{ltc\+\_\+ecc\+\_\+verify\+\_\+key}} (const ecc\+\_\+key $\ast$key)
\begin{DoxyCompactList}\small\item\em Verify a key according to A\+N\+SI spec. \end{DoxyCompactList}\item 
int \mbox{\hyperlink{tomcrypt__private_8h_af9bdd0d8d602ef3b300b11d19d7bc33a}{ltc\+\_\+ecc\+\_\+projective\+\_\+dbl\+\_\+point}} (const \mbox{\hyperlink{tomcrypt__math_8h_a2a6efaeaa795aa54274d7c4fd66b018a}{ecc\+\_\+point}} $\ast$P, \mbox{\hyperlink{tomcrypt__math_8h_a2a6efaeaa795aa54274d7c4fd66b018a}{ecc\+\_\+point}} $\ast$\mbox{\hyperlink{sha512_8c_a8fb1dfc3ad6dd07bc99c1962e6583087}{R}}, void $\ast$ma, void $\ast$modulus, void $\ast$mp)
\begin{DoxyCompactList}\small\item\em Double an E\+CC point. \end{DoxyCompactList}\item 
int \mbox{\hyperlink{tomcrypt__private_8h_a16f3ff8dd19aa2ccc2aab4024927bc93}{ltc\+\_\+ecc\+\_\+projective\+\_\+add\+\_\+point}} (const \mbox{\hyperlink{tomcrypt__math_8h_a2a6efaeaa795aa54274d7c4fd66b018a}{ecc\+\_\+point}} $\ast$P, const \mbox{\hyperlink{tomcrypt__math_8h_a2a6efaeaa795aa54274d7c4fd66b018a}{ecc\+\_\+point}} $\ast$Q, \mbox{\hyperlink{tomcrypt__math_8h_a2a6efaeaa795aa54274d7c4fd66b018a}{ecc\+\_\+point}} $\ast$\mbox{\hyperlink{sha512_8c_a8fb1dfc3ad6dd07bc99c1962e6583087}{R}}, void $\ast$ma, void $\ast$modulus, void $\ast$mp)
\begin{DoxyCompactList}\small\item\em Add two E\+CC points. \end{DoxyCompactList}\item 
int \mbox{\hyperlink{tomcrypt__private_8h_a818e5e4135d8aa58cf09e502e98ccc90}{ltc\+\_\+ecc\+\_\+mulmod}} (void $\ast$k, const \mbox{\hyperlink{tomcrypt__math_8h_a2a6efaeaa795aa54274d7c4fd66b018a}{ecc\+\_\+point}} $\ast$\mbox{\hyperlink{rmd320_8c_ad96b7cf3182ce2ba85e5a7a93b12c441}{G}}, \mbox{\hyperlink{tomcrypt__math_8h_a2a6efaeaa795aa54274d7c4fd66b018a}{ecc\+\_\+point}} $\ast$\mbox{\hyperlink{sha512_8c_a8fb1dfc3ad6dd07bc99c1962e6583087}{R}}, void $\ast$a, void $\ast$modulus, int map)
\begin{DoxyCompactList}\small\item\em Perform a point multiplication (timing resistant) \end{DoxyCompactList}\item 
int \mbox{\hyperlink{tomcrypt__private_8h_a4aaa757939c4f4b54a3db21afc6aef9f}{ltc\+\_\+ecc\+\_\+mul2add}} (const \mbox{\hyperlink{tomcrypt__math_8h_a2a6efaeaa795aa54274d7c4fd66b018a}{ecc\+\_\+point}} $\ast$A, void $\ast$kA, const \mbox{\hyperlink{tomcrypt__math_8h_a2a6efaeaa795aa54274d7c4fd66b018a}{ecc\+\_\+point}} $\ast$B, void $\ast$kB, \mbox{\hyperlink{tomcrypt__math_8h_a2a6efaeaa795aa54274d7c4fd66b018a}{ecc\+\_\+point}} $\ast$C, void $\ast$ma, void $\ast$modulus)
\begin{DoxyCompactList}\small\item\em Computes k\+A$\ast$A + k\+B$\ast$B = C using Shamir\textquotesingle{}s Trick. \end{DoxyCompactList}\item 
int \mbox{\hyperlink{tomcrypt__private_8h_af9f9d49f05241e41e2f8660afdaf7dac}{ltc\+\_\+ecc\+\_\+map}} (\mbox{\hyperlink{tomcrypt__math_8h_a2a6efaeaa795aa54274d7c4fd66b018a}{ecc\+\_\+point}} $\ast$P, void $\ast$modulus, void $\ast$mp)
\begin{DoxyCompactList}\small\item\em Map a projective jacbobian point back to affine space. \end{DoxyCompactList}\item 
int \mbox{\hyperlink{tomcrypt__private_8h_aa5b2d573863af50ed2f38a00998a1274}{dsa\+\_\+int\+\_\+validate\+\_\+xy}} (const dsa\+\_\+key $\ast$key, int $\ast$stat)
\begin{DoxyCompactList}\small\item\em Validation of a D\+SA key (x and y values) \end{DoxyCompactList}\item 
int \mbox{\hyperlink{tomcrypt__private_8h_a78787aeedd134c0e586d4a42a83c89c2}{dsa\+\_\+int\+\_\+validate\+\_\+pqg}} (const dsa\+\_\+key $\ast$key, int $\ast$stat)
\begin{DoxyCompactList}\small\item\em Non-\/complex part (no primality testing) of the validation of D\+SA params (p, q, g) \end{DoxyCompactList}\item 
int \mbox{\hyperlink{tomcrypt__private_8h_abdc76d05886a02727e901ad26f2f3e81}{dsa\+\_\+int\+\_\+validate\+\_\+primes}} (const dsa\+\_\+key $\ast$key, int $\ast$stat)
\begin{DoxyCompactList}\small\item\em Primality testing of D\+SA params p and q. \end{DoxyCompactList}\item 
int \mbox{\hyperlink{tomcrypt__private_8h_aaa3acc13042e5d9244ac279a354775fe}{der\+\_\+decode\+\_\+custom\+\_\+type\+\_\+ex}} (const unsigned char $\ast$in, unsigned long inlen, ltc\+\_\+asn1\+\_\+list $\ast$root, ltc\+\_\+asn1\+\_\+list $\ast$list, unsigned long outlen, unsigned int flags)
\begin{DoxyCompactList}\small\item\em Extended-\/decode a Custom type. \end{DoxyCompactList}\item 
int \mbox{\hyperlink{tomcrypt__private_8h_a093815c0cc44624723a3d668992b3008}{der\+\_\+encode\+\_\+asn1\+\_\+identifier}} (const ltc\+\_\+asn1\+\_\+list $\ast$id, unsigned char $\ast$out, unsigned long $\ast$outlen)
\begin{DoxyCompactList}\small\item\em Encode the A\+S\+N.\+1 Identifier. \end{DoxyCompactList}\item 
int \mbox{\hyperlink{tomcrypt__private_8h_a651ad7c1f5a930476bb10b9d61555346}{der\+\_\+decode\+\_\+asn1\+\_\+identifier}} (const unsigned char $\ast$in, unsigned long $\ast$inlen, ltc\+\_\+asn1\+\_\+list $\ast$id)
\begin{DoxyCompactList}\small\item\em Decode the A\+S\+N.\+1 Identifier. \end{DoxyCompactList}\item 
int \mbox{\hyperlink{tomcrypt__private_8h_a12ee6e955851d0daff84581e3770a807}{der\+\_\+length\+\_\+asn1\+\_\+identifier}} (const ltc\+\_\+asn1\+\_\+list $\ast$id, unsigned long $\ast$idlen)
\begin{DoxyCompactList}\small\item\em Determine the length required when encoding the A\+S\+N.\+1 Identifier. \end{DoxyCompactList}\item 
int \mbox{\hyperlink{tomcrypt__private_8h_ae0b6c1f1188a5aa201aa84de9a659550}{der\+\_\+encode\+\_\+asn1\+\_\+length}} (unsigned long \mbox{\hyperlink{pmac__init_8c_afed088663f8704004425cdae2120b9b3}{len}}, unsigned char $\ast$out, unsigned long $\ast$outlen)
\begin{DoxyCompactList}\small\item\em Encode the A\+S\+N.\+1 length field. \end{DoxyCompactList}\item 
int \mbox{\hyperlink{tomcrypt__private_8h_af90423764098b8876368d0984d96053a}{der\+\_\+decode\+\_\+asn1\+\_\+length}} (const unsigned char $\ast$in, unsigned long $\ast$inlen, unsigned long $\ast$outlen)
\begin{DoxyCompactList}\small\item\em Decode the A\+S\+N.\+1 Length field. \end{DoxyCompactList}\item 
int \mbox{\hyperlink{tomcrypt__private_8h_a8999e23c66cda0d777570e54f3a5c795}{der\+\_\+length\+\_\+asn1\+\_\+length}} (unsigned long \mbox{\hyperlink{pmac__init_8c_afed088663f8704004425cdae2120b9b3}{len}}, unsigned long $\ast$outlen)
\begin{DoxyCompactList}\small\item\em Determine the length required to encode len in the A\+S\+N.\+1 length field. \end{DoxyCompactList}\item 
int \mbox{\hyperlink{tomcrypt__private_8h_ad3804ae56675e41a9d142c62d6c3bb2d}{der\+\_\+length\+\_\+sequence\+\_\+ex}} (const ltc\+\_\+asn1\+\_\+list $\ast$list, unsigned long inlen, unsigned long $\ast$outlen, unsigned long $\ast$payloadlen)
\item 
int \mbox{\hyperlink{tomcrypt__private_8h_ab5141cf36663054d9ec6e46ed6909fce}{der\+\_\+decode\+\_\+sequence\+\_\+multi\+\_\+ex}} (const unsigned char $\ast$in, unsigned long inlen, unsigned int flags,...)
\begin{DoxyCompactList}\small\item\em Decode a S\+E\+Q\+U\+E\+N\+CE type using a VA list. \end{DoxyCompactList}\item 
int \mbox{\hyperlink{tomcrypt__private_8h_ae8e05b29e9cd248f6a81450eefd22163}{der\+\_\+teletex\+\_\+char\+\_\+encode}} (int \mbox{\hyperlink{khazad_8c_a86ea50de5a3e0ae87762f4298d35284c}{c}})
\item 
int \mbox{\hyperlink{tomcrypt__private_8h_ab300884b978bd66022a4003ef5a1f2a1}{der\+\_\+teletex\+\_\+value\+\_\+decode}} (int v)
\item 
int \mbox{\hyperlink{tomcrypt__private_8h_a400ea59efe4834eac94e65230dd59822}{der\+\_\+utf8\+\_\+valid\+\_\+char}} (const wchar\+\_\+t \mbox{\hyperlink{khazad_8c_a86ea50de5a3e0ae87762f4298d35284c}{c}})
\begin{DoxyCompactList}\small\item\em Test whether the given code point is valid character. \end{DoxyCompactList}\item 
int \mbox{\hyperlink{tomcrypt__private_8h_a69644f00dd0825d15c8c799c46ef6ece}{x509\+\_\+encode\+\_\+subject\+\_\+public\+\_\+key\+\_\+info}} (unsigned char $\ast$out, unsigned long $\ast$outlen, unsigned int algorithm, const void $\ast$public\+\_\+key, unsigned long public\+\_\+key\+\_\+len, ltc\+\_\+asn1\+\_\+type parameters\+\_\+type, ltc\+\_\+asn1\+\_\+list $\ast$parameters, unsigned long parameters\+\_\+len)
\begin{DoxyCompactList}\small\item\em Encode a Subject\+Public\+Key\+Info. \end{DoxyCompactList}\item 
int \mbox{\hyperlink{tomcrypt__private_8h_aec241d5f502a71d5a72188a42d6be5f0}{x509\+\_\+decode\+\_\+subject\+\_\+public\+\_\+key\+\_\+info}} (const unsigned char $\ast$in, unsigned long inlen, unsigned int algorithm, void $\ast$public\+\_\+key, unsigned long $\ast$public\+\_\+key\+\_\+len, ltc\+\_\+asn1\+\_\+type parameters\+\_\+type, ltc\+\_\+asn1\+\_\+list $\ast$parameters, unsigned long $\ast$parameters\+\_\+len)
\begin{DoxyCompactList}\small\item\em Decode a Subject\+Public\+Key\+Info. \end{DoxyCompactList}\item 
int \mbox{\hyperlink{tomcrypt__private_8h_a4283c0cfa77d37ab8add0b7c531d3d6f}{pk\+\_\+oid\+\_\+cmp\+\_\+with\+\_\+ulong}} (const char $\ast$o1, const unsigned long $\ast$o2, unsigned long o2size)
\item 
int \mbox{\hyperlink{tomcrypt__private_8h_aaa860b1fbc776e0760df8934a6aa245a}{pk\+\_\+oid\+\_\+cmp\+\_\+with\+\_\+asn1}} (const char $\ast$o1, const ltc\+\_\+asn1\+\_\+list $\ast$o2)
\item 
int \mbox{\hyperlink{tomcrypt__private_8h_a1b0d8fcf234d94638b2554ccea725003}{pkcs8\+\_\+decode\+\_\+flexi}} (const unsigned char $\ast$in, unsigned long inlen, const void $\ast$pwd, unsigned long pwdlen, ltc\+\_\+asn1\+\_\+list $\ast$$\ast$decoded\+\_\+list)
\begin{DoxyCompactList}\small\item\em P\+K\+CS\#8 decrypt if necessary \& flexi-\/decode. \end{DoxyCompactList}\item 
int \mbox{\hyperlink{tomcrypt__private_8h_af7de8585646f421393f3c744654ae587}{pkcs12\+\_\+utf8\+\_\+to\+\_\+utf16}} (const unsigned char $\ast$in, unsigned long inlen, unsigned char $\ast$out, unsigned long $\ast$outlen)
\item 
int \mbox{\hyperlink{tomcrypt__private_8h_a362c9fba9251fa6d35445f4ccae24fe8}{pkcs12\+\_\+kdf}} (int hash\+\_\+id, const unsigned char $\ast$pw, unsigned long pwlen, const unsigned char $\ast$salt, unsigned long saltlen, unsigned int iterations, unsigned char purpose, unsigned char $\ast$out, unsigned long outlen)
\end{DoxyCompactItemize}
\subsection*{Variables}
\begin{DoxyCompactItemize}
\item 
const \mbox{\hyperlink{structltc__dh__set__type}{ltc\+\_\+dh\+\_\+set\+\_\+type}} \mbox{\hyperlink{tomcrypt__private_8h_a45c19266abadb7a8a27dc330b000cfc4}{ltc\+\_\+dh\+\_\+sets}} \mbox{[}$\,$\mbox{]}
\item 
const ltc\+\_\+asn1\+\_\+type \mbox{\hyperlink{tomcrypt__private_8h_a411f77ba949e37dca9c1ef1e43127cb1}{der\+\_\+asn1\+\_\+tag\+\_\+to\+\_\+type\+\_\+map}} \mbox{[}$\,$\mbox{]}
\begin{DoxyCompactList}\small\item\em A Map from A\+S\+N.\+1 Tags to ltc\+\_\+asn1\+\_\+type. \end{DoxyCompactList}\item 
const unsigned long \mbox{\hyperlink{tomcrypt__private_8h_a6ad32891f744af2b205041ad6dc5bce0}{der\+\_\+asn1\+\_\+tag\+\_\+to\+\_\+type\+\_\+map\+\_\+sz}}
\item 
const int \mbox{\hyperlink{tomcrypt__private_8h_a6306ca88074facac89ee0f6c04cbf2f2}{der\+\_\+asn1\+\_\+type\+\_\+to\+\_\+identifier\+\_\+map}} \mbox{[}$\,$\mbox{]}
\begin{DoxyCompactList}\small\item\em A Map from ltc\+\_\+asn1\+\_\+type to the regularly used A\+S\+N.\+1 identifier. \end{DoxyCompactList}\item 
const unsigned long \mbox{\hyperlink{tomcrypt__private_8h_ae8d2a220c8f5b51d2db97b0382a9f206}{der\+\_\+asn1\+\_\+type\+\_\+to\+\_\+identifier\+\_\+map\+\_\+sz}}
\end{DoxyCompactItemize}


\subsection{Macro Definition Documentation}
\mbox{\Hypertarget{tomcrypt__private_8h_ae463e0ea9b84288e301f114d43ef3e9a}\label{tomcrypt__private_8h_ae463e0ea9b84288e301f114d43ef3e9a}} 
\index{tomcrypt\_private.h@{tomcrypt\_private.h}!\_LTC\_PRNG\_EXPORT@{\_LTC\_PRNG\_EXPORT}}
\index{\_LTC\_PRNG\_EXPORT@{\_LTC\_PRNG\_EXPORT}!tomcrypt\_private.h@{tomcrypt\_private.h}}
\subsubsection{\texorpdfstring{\_LTC\_PRNG\_EXPORT}{\_LTC\_PRNG\_EXPORT}}
{\footnotesize\ttfamily \#define \+\_\+\+L\+T\+C\+\_\+\+P\+R\+N\+G\+\_\+\+E\+X\+P\+O\+RT(\begin{DoxyParamCaption}\item[{}]{which }\end{DoxyParamCaption})}

{\bfseries Value\+:}
\begin{DoxyCode}{0}
\DoxyCodeLine{\textcolor{keywordtype}{int} which \#\# \_export(\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char} *out, \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} *outlen, \mbox{\hyperlink{structprng__state}{prng\_state}} *prng)      \(\backslash\)}
\DoxyCodeLine{\{                                                                                      \(\backslash\)}
\DoxyCodeLine{   unsigned \textcolor{keywordtype}{long} \mbox{\hyperlink{ocb__init_8c_afed088663f8704004425cdae2120b9b3}{len}} = which \#\# \_desc.export\_size;                                     \mbox{\hyperlink{tomcrypt__argchk_8h_a683da3e041e49f196318b6ea951414ba}{\(\backslash\)}}}
\DoxyCodeLine{\mbox{\hyperlink{tomcrypt__argchk_8h_a683da3e041e49f196318b6ea951414ba}{                                                                                       \(\backslash\)}}}
\DoxyCodeLine{\mbox{\hyperlink{tomcrypt__argchk_8h_a683da3e041e49f196318b6ea951414ba}{   LTC\_ARGCHK}}(prng   != NULL);                                                         \(\backslash\)}
\DoxyCodeLine{   LTC\_ARGCHK(out    != NULL);                                                         \(\backslash\)}
\DoxyCodeLine{   LTC\_ARGCHK(outlen != NULL);                                                         \(\backslash\)}
\DoxyCodeLine{                                                                                       \(\backslash\)}
\DoxyCodeLine{   if (*outlen < \mbox{\hyperlink{ocb__init_8c_afed088663f8704004425cdae2120b9b3}{len}}) \{                                                                \(\backslash\)}
\DoxyCodeLine{      *outlen = \mbox{\hyperlink{ocb__init_8c_afed088663f8704004425cdae2120b9b3}{len}};                                                                   \(\backslash\)}
\DoxyCodeLine{      return \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06caccd878f5599f3036ffe759dbe1a1ac16}{CRYPT\_BUFFER\_OVERFLOW}};                                                    \(\backslash\)}
\DoxyCodeLine{   \}                                                                                   \(\backslash\)}
\DoxyCodeLine{                                                                                       \(\backslash\)}
\DoxyCodeLine{   if (which \#\# \_read(out, \mbox{\hyperlink{ocb__init_8c_afed088663f8704004425cdae2120b9b3}{len}}, prng) != \mbox{\hyperlink{ocb__init_8c_afed088663f8704004425cdae2120b9b3}{len}}) \{                                        \(\backslash\)}
\DoxyCodeLine{      return \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06ca68eea82b3b71f23031cd94b10c920bf3}{CRYPT\_ERROR\_READPRNG}};                                                     \(\backslash\)}
\DoxyCodeLine{   \}                                                                                   \(\backslash\)}
\DoxyCodeLine{                                                                                       \(\backslash\)}
\DoxyCodeLine{   *outlen = \mbox{\hyperlink{ocb__init_8c_afed088663f8704004425cdae2120b9b3}{len}};                                                                      \(\backslash\)}
\DoxyCodeLine{   return \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}};                                                                    \(\backslash\)}
\DoxyCodeLine{\}}

\end{DoxyCode}


Definition at line 373 of file tomcrypt\+\_\+private.\+h.

\mbox{\Hypertarget{tomcrypt__private_8h_ae7c734d30e56dd5f0306f54246d47c2b}\label{tomcrypt__private_8h_ae7c734d30e56dd5f0306f54246d47c2b}} 
\index{tomcrypt\_private.h@{tomcrypt\_private.h}!HASH\_PROCESS@{HASH\_PROCESS}}
\index{HASH\_PROCESS@{HASH\_PROCESS}!tomcrypt\_private.h@{tomcrypt\_private.h}}
\subsubsection{\texorpdfstring{HASH\_PROCESS}{HASH\_PROCESS}}
{\footnotesize\ttfamily \#define H\+A\+S\+H\+\_\+\+P\+R\+O\+C\+E\+SS(\begin{DoxyParamCaption}\item[{}]{func\+\_\+name,  }\item[{}]{compress\+\_\+name,  }\item[{}]{state\+\_\+var,  }\item[{}]{block\+\_\+size }\end{DoxyParamCaption})}



Definition at line 76 of file tomcrypt\+\_\+private.\+h.

\mbox{\Hypertarget{tomcrypt__private_8h_a896c8b07a35ff2799061855f08a8325a}\label{tomcrypt__private_8h_a896c8b07a35ff2799061855f08a8325a}} 
\index{tomcrypt\_private.h@{tomcrypt\_private.h}!LTC\_ASN1\_IS\_TYPE@{LTC\_ASN1\_IS\_TYPE}}
\index{LTC\_ASN1\_IS\_TYPE@{LTC\_ASN1\_IS\_TYPE}!tomcrypt\_private.h@{tomcrypt\_private.h}}
\subsubsection{\texorpdfstring{LTC\_ASN1\_IS\_TYPE}{LTC\_ASN1\_IS\_TYPE}}
{\footnotesize\ttfamily \#define L\+T\+C\+\_\+\+A\+S\+N1\+\_\+\+I\+S\+\_\+\+T\+Y\+PE(\begin{DoxyParamCaption}\item[{}]{e,  }\item[{}]{t }\end{DoxyParamCaption})~(((e) != N\+U\+LL) \&\& ((e)-\/$>$type == (t)))}



Definition at line 302 of file tomcrypt\+\_\+private.\+h.

\mbox{\Hypertarget{tomcrypt__private_8h_a319cb143574102827d3b0055ded27533}\label{tomcrypt__private_8h_a319cb143574102827d3b0055ded27533}} 
\index{tomcrypt\_private.h@{tomcrypt\_private.h}!LTC\_BYTE@{LTC\_BYTE}}
\index{LTC\_BYTE@{LTC\_BYTE}!tomcrypt\_private.h@{tomcrypt\_private.h}}
\subsubsection{\texorpdfstring{LTC\_BYTE}{LTC\_BYTE}}
{\footnotesize\ttfamily \#define L\+T\+C\+\_\+\+B\+Y\+TE(\begin{DoxyParamCaption}\item[{}]{x,  }\item[{}]{n }\end{DoxyParamCaption})~(((x) $>$$>$ (8 $\ast$ (n))) \& 255)}



Definition at line 399 of file tomcrypt\+\_\+private.\+h.

\mbox{\Hypertarget{tomcrypt__private_8h_a2b8e12593fe11f8eaeace6ce0fcc7566}\label{tomcrypt__private_8h_a2b8e12593fe11f8eaeace6ce0fcc7566}} 
\index{tomcrypt\_private.h@{tomcrypt\_private.h}!LTC\_PAD\_MASK@{LTC\_PAD\_MASK}}
\index{LTC\_PAD\_MASK@{LTC\_PAD\_MASK}!tomcrypt\_private.h@{tomcrypt\_private.h}}
\subsubsection{\texorpdfstring{LTC\_PAD\_MASK}{LTC\_PAD\_MASK}}
{\footnotesize\ttfamily \#define L\+T\+C\+\_\+\+P\+A\+D\+\_\+\+M\+A\+SK~(0x\+F000\+U)}



Definition at line 16 of file tomcrypt\+\_\+private.\+h.

\mbox{\Hypertarget{tomcrypt__private_8h_abeb03f01d3819863d5de470797c629de}\label{tomcrypt__private_8h_abeb03f01d3819863d5de470797c629de}} 
\index{tomcrypt\_private.h@{tomcrypt\_private.h}!mp\_2expt@{mp\_2expt}}
\index{mp\_2expt@{mp\_2expt}!tomcrypt\_private.h@{tomcrypt\_private.h}}
\subsubsection{\texorpdfstring{mp\_2expt}{mp\_2expt}}
{\footnotesize\ttfamily \#define mp\+\_\+2expt(\begin{DoxyParamCaption}\item[{}]{a,  }\item[{}]{b }\end{DoxyParamCaption})~\mbox{\hyperlink{tfm__desc_8c_a4f1673caee67fa1b6f8b745661a68eb1}{ltc\+\_\+mp.\+twoexpt}}(a, b)}



Definition at line 148 of file tomcrypt\+\_\+private.\+h.

\mbox{\Hypertarget{tomcrypt__private_8h_a175d04f8aeaa1c3895fe14de6cc0d2db}\label{tomcrypt__private_8h_a175d04f8aeaa1c3895fe14de6cc0d2db}} 
\index{tomcrypt\_private.h@{tomcrypt\_private.h}!mp\_add@{mp\_add}}
\index{mp\_add@{mp\_add}!tomcrypt\_private.h@{tomcrypt\_private.h}}
\subsubsection{\texorpdfstring{mp\_add}{mp\_add}}
{\footnotesize\ttfamily \#define mp\+\_\+add(\begin{DoxyParamCaption}\item[{}]{a,  }\item[{}]{b,  }\item[{}]{\mbox{\hyperlink{khazad_8c_a86ea50de5a3e0ae87762f4298d35284c}{c}} }\end{DoxyParamCaption})~\mbox{\hyperlink{tfm__desc_8c_a274c97efa9f26a6d22ca17dbcb52e58b}{ltc\+\_\+mp.\+add}}(a, b, \mbox{\hyperlink{khazad_8c_a86ea50de5a3e0ae87762f4298d35284c}{c}})}



Definition at line 156 of file tomcrypt\+\_\+private.\+h.

\mbox{\Hypertarget{tomcrypt__private_8h_a69f09e7351d696b635ffbc9912684ab4}\label{tomcrypt__private_8h_a69f09e7351d696b635ffbc9912684ab4}} 
\index{tomcrypt\_private.h@{tomcrypt\_private.h}!mp\_add\_d@{mp\_add\_d}}
\index{mp\_add\_d@{mp\_add\_d}!tomcrypt\_private.h@{tomcrypt\_private.h}}
\subsubsection{\texorpdfstring{mp\_add\_d}{mp\_add\_d}}
{\footnotesize\ttfamily \#define mp\+\_\+add\+\_\+d(\begin{DoxyParamCaption}\item[{}]{a,  }\item[{}]{b,  }\item[{}]{\mbox{\hyperlink{khazad_8c_a86ea50de5a3e0ae87762f4298d35284c}{c}} }\end{DoxyParamCaption})~\mbox{\hyperlink{tfm__desc_8c_a9cce188374e60ab500e0e658738eb0ce}{ltc\+\_\+mp.\+addi}}(a, b, \mbox{\hyperlink{khazad_8c_a86ea50de5a3e0ae87762f4298d35284c}{c}})}



Definition at line 157 of file tomcrypt\+\_\+private.\+h.

\mbox{\Hypertarget{tomcrypt__private_8h_a3cc86fdd66c67023afe490b3534d459b}\label{tomcrypt__private_8h_a3cc86fdd66c67023afe490b3534d459b}} 
\index{tomcrypt\_private.h@{tomcrypt\_private.h}!mp\_addmod@{mp\_addmod}}
\index{mp\_addmod@{mp\_addmod}!tomcrypt\_private.h@{tomcrypt\_private.h}}
\subsubsection{\texorpdfstring{mp\_addmod}{mp\_addmod}}
{\footnotesize\ttfamily \#define mp\+\_\+addmod(\begin{DoxyParamCaption}\item[{}]{a,  }\item[{}]{b,  }\item[{}]{\mbox{\hyperlink{khazad_8c_a86ea50de5a3e0ae87762f4298d35284c}{c}},  }\item[{}]{d }\end{DoxyParamCaption})~\mbox{\hyperlink{tfm__desc_8c_a1197b0ad15639bfc3fc66314c2ce8527}{ltc\+\_\+mp.\+addmod}}(a, b, \mbox{\hyperlink{khazad_8c_a86ea50de5a3e0ae87762f4298d35284c}{c}}, d)}



Definition at line 171 of file tomcrypt\+\_\+private.\+h.

\mbox{\Hypertarget{tomcrypt__private_8h_ad0d492c0676e4944383a7ae9e9ebd63b}\label{tomcrypt__private_8h_ad0d492c0676e4944383a7ae9e9ebd63b}} 
\index{tomcrypt\_private.h@{tomcrypt\_private.h}!mp\_cleanup\_multi@{mp\_cleanup\_multi}}
\index{mp\_cleanup\_multi@{mp\_cleanup\_multi}!tomcrypt\_private.h@{tomcrypt\_private.h}}
\subsubsection{\texorpdfstring{mp\_cleanup\_multi}{mp\_cleanup\_multi}}
{\footnotesize\ttfamily \#define mp\+\_\+cleanup\+\_\+multi~\mbox{\hyperlink{multi_8c_a53eb69feb3f6ec63778a845a07771762}{ltc\+\_\+cleanup\+\_\+multi}}}



Definition at line 133 of file tomcrypt\+\_\+private.\+h.

\mbox{\Hypertarget{tomcrypt__private_8h_ab05b6b59fa182b81f5f990d5621229f6}\label{tomcrypt__private_8h_ab05b6b59fa182b81f5f990d5621229f6}} 
\index{tomcrypt\_private.h@{tomcrypt\_private.h}!mp\_clear@{mp\_clear}}
\index{mp\_clear@{mp\_clear}!tomcrypt\_private.h@{tomcrypt\_private.h}}
\subsubsection{\texorpdfstring{mp\_clear}{mp\_clear}}
{\footnotesize\ttfamily \#define mp\+\_\+clear(\begin{DoxyParamCaption}\item[{}]{a }\end{DoxyParamCaption})~\mbox{\hyperlink{tfm__desc_8c_a9626887f45edba884c412234edf7d1d6}{ltc\+\_\+mp.\+deinit}}(a)}



Definition at line 131 of file tomcrypt\+\_\+private.\+h.

\mbox{\Hypertarget{tomcrypt__private_8h_aad5c8a3112b3e4613f9efc86692c43cb}\label{tomcrypt__private_8h_aad5c8a3112b3e4613f9efc86692c43cb}} 
\index{tomcrypt\_private.h@{tomcrypt\_private.h}!mp\_clear\_multi@{mp\_clear\_multi}}
\index{mp\_clear\_multi@{mp\_clear\_multi}!tomcrypt\_private.h@{tomcrypt\_private.h}}
\subsubsection{\texorpdfstring{mp\_clear\_multi}{mp\_clear\_multi}}
{\footnotesize\ttfamily \#define mp\+\_\+clear\+\_\+multi~\mbox{\hyperlink{multi_8c_abcb92ed327d5fcf9bf9bcff2a6a3107a}{ltc\+\_\+deinit\+\_\+multi}}}



Definition at line 132 of file tomcrypt\+\_\+private.\+h.

\mbox{\Hypertarget{tomcrypt__private_8h_a62ea02fbe7dd2d456e49520264d775ee}\label{tomcrypt__private_8h_a62ea02fbe7dd2d456e49520264d775ee}} 
\index{tomcrypt\_private.h@{tomcrypt\_private.h}!mp\_cmp@{mp\_cmp}}
\index{mp\_cmp@{mp\_cmp}!tomcrypt\_private.h@{tomcrypt\_private.h}}
\subsubsection{\texorpdfstring{mp\_cmp}{mp\_cmp}}
{\footnotesize\ttfamily \#define mp\+\_\+cmp(\begin{DoxyParamCaption}\item[{}]{a,  }\item[{}]{b }\end{DoxyParamCaption})~\mbox{\hyperlink{tfm__desc_8c_aecfc62c80bd6acc7a95d1391ad8252f7}{ltc\+\_\+mp.\+compare}}(a, b)}



Definition at line 144 of file tomcrypt\+\_\+private.\+h.

\mbox{\Hypertarget{tomcrypt__private_8h_a6ce44f2e6f872565a468b67d9a93dc28}\label{tomcrypt__private_8h_a6ce44f2e6f872565a468b67d9a93dc28}} 
\index{tomcrypt\_private.h@{tomcrypt\_private.h}!mp\_cmp\_d@{mp\_cmp\_d}}
\index{mp\_cmp\_d@{mp\_cmp\_d}!tomcrypt\_private.h@{tomcrypt\_private.h}}
\subsubsection{\texorpdfstring{mp\_cmp\_d}{mp\_cmp\_d}}
{\footnotesize\ttfamily \#define mp\+\_\+cmp\+\_\+d(\begin{DoxyParamCaption}\item[{}]{a,  }\item[{}]{b }\end{DoxyParamCaption})~\mbox{\hyperlink{tfm__desc_8c_aee3f861609cd9406655be85087a7bb06}{ltc\+\_\+mp.\+compare\+\_\+d}}(a, b)}



Definition at line 145 of file tomcrypt\+\_\+private.\+h.

\mbox{\Hypertarget{tomcrypt__private_8h_a566a41699158970f4d7a0554081706dd}\label{tomcrypt__private_8h_a566a41699158970f4d7a0554081706dd}} 
\index{tomcrypt\_private.h@{tomcrypt\_private.h}!mp\_cnt\_lsb@{mp\_cnt\_lsb}}
\index{mp\_cnt\_lsb@{mp\_cnt\_lsb}!tomcrypt\_private.h@{tomcrypt\_private.h}}
\subsubsection{\texorpdfstring{mp\_cnt\_lsb}{mp\_cnt\_lsb}}
{\footnotesize\ttfamily \#define mp\+\_\+cnt\+\_\+lsb(\begin{DoxyParamCaption}\item[{}]{a }\end{DoxyParamCaption})~\mbox{\hyperlink{tfm__desc_8c_a2506b220df2c67f8b9969f6c627c84a1}{ltc\+\_\+mp.\+count\+\_\+lsb\+\_\+bits}}(a)}



Definition at line 147 of file tomcrypt\+\_\+private.\+h.

\mbox{\Hypertarget{tomcrypt__private_8h_afbb35bc8f920448d169ddc83a4308840}\label{tomcrypt__private_8h_afbb35bc8f920448d169ddc83a4308840}} 
\index{tomcrypt\_private.h@{tomcrypt\_private.h}!mp\_copy@{mp\_copy}}
\index{mp\_copy@{mp\_copy}!tomcrypt\_private.h@{tomcrypt\_private.h}}
\subsubsection{\texorpdfstring{mp\_copy}{mp\_copy}}
{\footnotesize\ttfamily \#define mp\+\_\+copy(\begin{DoxyParamCaption}\item[{}]{a,  }\item[{}]{b }\end{DoxyParamCaption})~\mbox{\hyperlink{tfm__desc_8c_ad88f68a4e6f0c7334e93eebf7ddbb2d3}{ltc\+\_\+mp.\+copy}}(a, b)}



Definition at line 137 of file tomcrypt\+\_\+private.\+h.

\mbox{\Hypertarget{tomcrypt__private_8h_afa1671e20e699f66319ed2e8d9119e7e}\label{tomcrypt__private_8h_afa1671e20e699f66319ed2e8d9119e7e}} 
\index{tomcrypt\_private.h@{tomcrypt\_private.h}!mp\_count\_bits@{mp\_count\_bits}}
\index{mp\_count\_bits@{mp\_count\_bits}!tomcrypt\_private.h@{tomcrypt\_private.h}}
\subsubsection{\texorpdfstring{mp\_count\_bits}{mp\_count\_bits}}
{\footnotesize\ttfamily \#define mp\+\_\+count\+\_\+bits(\begin{DoxyParamCaption}\item[{}]{a }\end{DoxyParamCaption})~\mbox{\hyperlink{tfm__desc_8c_a55e39d3b1adb176ed84c1211a7123071}{ltc\+\_\+mp.\+count\+\_\+bits}}(a)}



Definition at line 146 of file tomcrypt\+\_\+private.\+h.

\mbox{\Hypertarget{tomcrypt__private_8h_ab8e25bc0c3ace6218c5c7d49198405c9}\label{tomcrypt__private_8h_ab8e25bc0c3ace6218c5c7d49198405c9}} 
\index{tomcrypt\_private.h@{tomcrypt\_private.h}!MP\_DIGIT\_BIT@{MP\_DIGIT\_BIT}}
\index{MP\_DIGIT\_BIT@{MP\_DIGIT\_BIT}!tomcrypt\_private.h@{tomcrypt\_private.h}}
\subsubsection{\texorpdfstring{MP\_DIGIT\_BIT}{MP\_DIGIT\_BIT}}
{\footnotesize\ttfamily \#define M\+P\+\_\+\+D\+I\+G\+I\+T\+\_\+\+B\+IT~ltc\+\_\+mp.\+bits\+\_\+per\+\_\+digit}



Definition at line 126 of file tomcrypt\+\_\+private.\+h.

\mbox{\Hypertarget{tomcrypt__private_8h_a861721ee02d3b5d84328090f3058f7c3}\label{tomcrypt__private_8h_a861721ee02d3b5d84328090f3058f7c3}} 
\index{tomcrypt\_private.h@{tomcrypt\_private.h}!mp\_div@{mp\_div}}
\index{mp\_div@{mp\_div}!tomcrypt\_private.h@{tomcrypt\_private.h}}
\subsubsection{\texorpdfstring{mp\_div}{mp\_div}}
{\footnotesize\ttfamily \#define mp\+\_\+div(\begin{DoxyParamCaption}\item[{}]{a,  }\item[{}]{b,  }\item[{}]{\mbox{\hyperlink{khazad_8c_a86ea50de5a3e0ae87762f4298d35284c}{c}},  }\item[{}]{d }\end{DoxyParamCaption})~ltc\+\_\+mp.\+mpdiv(a, b, \mbox{\hyperlink{khazad_8c_a86ea50de5a3e0ae87762f4298d35284c}{c}}, d)}



Definition at line 164 of file tomcrypt\+\_\+private.\+h.

\mbox{\Hypertarget{tomcrypt__private_8h_aec841464b436981f5758a49c561f39fe}\label{tomcrypt__private_8h_aec841464b436981f5758a49c561f39fe}} 
\index{tomcrypt\_private.h@{tomcrypt\_private.h}!mp\_div\_2@{mp\_div\_2}}
\index{mp\_div\_2@{mp\_div\_2}!tomcrypt\_private.h@{tomcrypt\_private.h}}
\subsubsection{\texorpdfstring{mp\_div\_2}{mp\_div\_2}}
{\footnotesize\ttfamily \#define mp\+\_\+div\+\_\+2(\begin{DoxyParamCaption}\item[{}]{a,  }\item[{}]{b }\end{DoxyParamCaption})~\mbox{\hyperlink{tfm__desc_8c_a38e564335cd5493b0e02969fda1c73a0}{ltc\+\_\+mp.\+div\+\_\+2}}(a, b)}



Definition at line 165 of file tomcrypt\+\_\+private.\+h.

\mbox{\Hypertarget{tomcrypt__private_8h_a16c03b9a12fc6832ae878eabb57e13cc}\label{tomcrypt__private_8h_a16c03b9a12fc6832ae878eabb57e13cc}} 
\index{tomcrypt\_private.h@{tomcrypt\_private.h}!mp\_exch@{mp\_exch}}
\index{mp\_exch@{mp\_exch}!tomcrypt\_private.h@{tomcrypt\_private.h}}
\subsubsection{\texorpdfstring{mp\_exch}{mp\_exch}}
{\footnotesize\ttfamily \#define mp\+\_\+exch(\begin{DoxyParamCaption}\item[{}]{a,  }\item[{}]{b }\end{DoxyParamCaption})~do \{ void $\ast$A\+B\+C\+\_\+\+\_\+tmp = a; a = b; b = A\+B\+C\+\_\+\+\_\+tmp; \} while(0)}



Definition at line 187 of file tomcrypt\+\_\+private.\+h.

\mbox{\Hypertarget{tomcrypt__private_8h_a4fb1221fbef91bf8163390e3cfb82085}\label{tomcrypt__private_8h_a4fb1221fbef91bf8163390e3cfb82085}} 
\index{tomcrypt\_private.h@{tomcrypt\_private.h}!mp\_exptmod@{mp\_exptmod}}
\index{mp\_exptmod@{mp\_exptmod}!tomcrypt\_private.h@{tomcrypt\_private.h}}
\subsubsection{\texorpdfstring{mp\_exptmod}{mp\_exptmod}}
{\footnotesize\ttfamily \#define mp\+\_\+exptmod(\begin{DoxyParamCaption}\item[{}]{a,  }\item[{}]{b,  }\item[{}]{\mbox{\hyperlink{khazad_8c_a86ea50de5a3e0ae87762f4298d35284c}{c}},  }\item[{}]{d }\end{DoxyParamCaption})~\mbox{\hyperlink{tfm__desc_8c_a251a26828a3c68dff4bbe01f54470275}{ltc\+\_\+mp.\+exptmod}}(a,b,\mbox{\hyperlink{khazad_8c_a86ea50de5a3e0ae87762f4298d35284c}{c}},d)}



Definition at line 182 of file tomcrypt\+\_\+private.\+h.

\mbox{\Hypertarget{tomcrypt__private_8h_ad9deb5f35c296a1cd7ae37f4e4e210f4}\label{tomcrypt__private_8h_ad9deb5f35c296a1cd7ae37f4e4e210f4}} 
\index{tomcrypt\_private.h@{tomcrypt\_private.h}!mp\_gcd@{mp\_gcd}}
\index{mp\_gcd@{mp\_gcd}!tomcrypt\_private.h@{tomcrypt\_private.h}}
\subsubsection{\texorpdfstring{mp\_gcd}{mp\_gcd}}
{\footnotesize\ttfamily \#define mp\+\_\+gcd(\begin{DoxyParamCaption}\item[{}]{a,  }\item[{}]{b,  }\item[{}]{\mbox{\hyperlink{khazad_8c_a86ea50de5a3e0ae87762f4298d35284c}{c}} }\end{DoxyParamCaption})~\mbox{\hyperlink{tfm__desc_8c_afb49bbeaad5528b5afd96667e06c19ef}{ltc\+\_\+mp.\+gcd}}(a, b, \mbox{\hyperlink{khazad_8c_a86ea50de5a3e0ae87762f4298d35284c}{c}})}



Definition at line 168 of file tomcrypt\+\_\+private.\+h.

\mbox{\Hypertarget{tomcrypt__private_8h_a62267879327e26468c45bbd83f7f2669}\label{tomcrypt__private_8h_a62267879327e26468c45bbd83f7f2669}} 
\index{tomcrypt\_private.h@{tomcrypt\_private.h}!mp\_get\_digit@{mp\_get\_digit}}
\index{mp\_get\_digit@{mp\_get\_digit}!tomcrypt\_private.h@{tomcrypt\_private.h}}
\subsubsection{\texorpdfstring{mp\_get\_digit}{mp\_get\_digit}}
{\footnotesize\ttfamily \#define mp\+\_\+get\+\_\+digit(\begin{DoxyParamCaption}\item[{}]{a,  }\item[{}]{n }\end{DoxyParamCaption})~\mbox{\hyperlink{tfm__desc_8c_a6171f32e40e45f55caf4a7cb475e866c}{ltc\+\_\+mp.\+get\+\_\+digit}}(a, n)}



Definition at line 142 of file tomcrypt\+\_\+private.\+h.

\mbox{\Hypertarget{tomcrypt__private_8h_ae51a279d51ab72f09d9f97335b8be6c9}\label{tomcrypt__private_8h_ae51a279d51ab72f09d9f97335b8be6c9}} 
\index{tomcrypt\_private.h@{tomcrypt\_private.h}!mp\_get\_digit\_count@{mp\_get\_digit\_count}}
\index{mp\_get\_digit\_count@{mp\_get\_digit\_count}!tomcrypt\_private.h@{tomcrypt\_private.h}}
\subsubsection{\texorpdfstring{mp\_get\_digit\_count}{mp\_get\_digit\_count}}
{\footnotesize\ttfamily \#define mp\+\_\+get\+\_\+digit\+\_\+count(\begin{DoxyParamCaption}\item[{}]{a }\end{DoxyParamCaption})~\mbox{\hyperlink{tfm__desc_8c_a10c8ab52ee86746d3389aa2400c88ac2}{ltc\+\_\+mp.\+get\+\_\+digit\+\_\+count}}(a)}



Definition at line 143 of file tomcrypt\+\_\+private.\+h.

\mbox{\Hypertarget{tomcrypt__private_8h_a4e68c807adc159c7553da37ce38196b2}\label{tomcrypt__private_8h_a4e68c807adc159c7553da37ce38196b2}} 
\index{tomcrypt\_private.h@{tomcrypt\_private.h}!mp\_get\_int@{mp\_get\_int}}
\index{mp\_get\_int@{mp\_get\_int}!tomcrypt\_private.h@{tomcrypt\_private.h}}
\subsubsection{\texorpdfstring{mp\_get\_int}{mp\_get\_int}}
{\footnotesize\ttfamily \#define mp\+\_\+get\+\_\+int(\begin{DoxyParamCaption}\item[{}]{a }\end{DoxyParamCaption})~\mbox{\hyperlink{tfm__desc_8c_ac31838ab831d4094fe109d327019548c}{ltc\+\_\+mp.\+get\+\_\+int}}(a)}



Definition at line 141 of file tomcrypt\+\_\+private.\+h.

\mbox{\Hypertarget{tomcrypt__private_8h_aff03c4f22c68d651747055048c509cf3}\label{tomcrypt__private_8h_aff03c4f22c68d651747055048c509cf3}} 
\index{tomcrypt\_private.h@{tomcrypt\_private.h}!mp\_init@{mp\_init}}
\index{mp\_init@{mp\_init}!tomcrypt\_private.h@{tomcrypt\_private.h}}
\subsubsection{\texorpdfstring{mp\_init}{mp\_init}}
{\footnotesize\ttfamily \#define mp\+\_\+init(\begin{DoxyParamCaption}\item[{}]{a }\end{DoxyParamCaption})~\mbox{\hyperlink{tfm__desc_8c_a4f8948d7c94899bf8ddee4721114d593}{ltc\+\_\+mp.\+init}}(a)}



Definition at line 129 of file tomcrypt\+\_\+private.\+h.

\mbox{\Hypertarget{tomcrypt__private_8h_ad2f4da76a1604a39a01d9366dc0ea892}\label{tomcrypt__private_8h_ad2f4da76a1604a39a01d9366dc0ea892}} 
\index{tomcrypt\_private.h@{tomcrypt\_private.h}!mp\_init\_copy@{mp\_init\_copy}}
\index{mp\_init\_copy@{mp\_init\_copy}!tomcrypt\_private.h@{tomcrypt\_private.h}}
\subsubsection{\texorpdfstring{mp\_init\_copy}{mp\_init\_copy}}
{\footnotesize\ttfamily \#define mp\+\_\+init\+\_\+copy(\begin{DoxyParamCaption}\item[{}]{a,  }\item[{}]{b }\end{DoxyParamCaption})~\mbox{\hyperlink{tfm__desc_8c_a9c0dddd7edf258f69ca346540f3da61a}{ltc\+\_\+mp.\+init\+\_\+copy}}(a, b)}



Definition at line 134 of file tomcrypt\+\_\+private.\+h.

\mbox{\Hypertarget{tomcrypt__private_8h_adb6322247b1a4f0347219acab3120bd3}\label{tomcrypt__private_8h_adb6322247b1a4f0347219acab3120bd3}} 
\index{tomcrypt\_private.h@{tomcrypt\_private.h}!mp\_init\_multi@{mp\_init\_multi}}
\index{mp\_init\_multi@{mp\_init\_multi}!tomcrypt\_private.h@{tomcrypt\_private.h}}
\subsubsection{\texorpdfstring{mp\_init\_multi}{mp\_init\_multi}}
{\footnotesize\ttfamily \#define mp\+\_\+init\+\_\+multi~\mbox{\hyperlink{multi_8c_a327161b10428b234d74713b8a08acb2a}{ltc\+\_\+init\+\_\+multi}}}



Definition at line 130 of file tomcrypt\+\_\+private.\+h.

\mbox{\Hypertarget{tomcrypt__private_8h_a8be707236375351ab194f908c8ba9233}\label{tomcrypt__private_8h_a8be707236375351ab194f908c8ba9233}} 
\index{tomcrypt\_private.h@{tomcrypt\_private.h}!mp\_invmod@{mp\_invmod}}
\index{mp\_invmod@{mp\_invmod}!tomcrypt\_private.h@{tomcrypt\_private.h}}
\subsubsection{\texorpdfstring{mp\_invmod}{mp\_invmod}}
{\footnotesize\ttfamily \#define mp\+\_\+invmod(\begin{DoxyParamCaption}\item[{}]{a,  }\item[{}]{b,  }\item[{}]{\mbox{\hyperlink{khazad_8c_a86ea50de5a3e0ae87762f4298d35284c}{c}} }\end{DoxyParamCaption})~\mbox{\hyperlink{tfm__desc_8c_ac982ab06185a4919fdd77d7ab0fd8093}{ltc\+\_\+mp.\+invmod}}(a, b, \mbox{\hyperlink{khazad_8c_a86ea50de5a3e0ae87762f4298d35284c}{c}})}



Definition at line 175 of file tomcrypt\+\_\+private.\+h.

\mbox{\Hypertarget{tomcrypt__private_8h_a93ed39c257831509afc74f2b6da66ae7}\label{tomcrypt__private_8h_a93ed39c257831509afc74f2b6da66ae7}} 
\index{tomcrypt\_private.h@{tomcrypt\_private.h}!mp\_isodd@{mp\_isodd}}
\index{mp\_isodd@{mp\_isodd}!tomcrypt\_private.h@{tomcrypt\_private.h}}
\subsubsection{\texorpdfstring{mp\_isodd}{mp\_isodd}}
{\footnotesize\ttfamily \#define mp\+\_\+isodd(\begin{DoxyParamCaption}\item[{}]{a }\end{DoxyParamCaption})~(\mbox{\hyperlink{tomcrypt__private_8h_ae51a279d51ab72f09d9f97335b8be6c9}{mp\+\_\+get\+\_\+digit\+\_\+count}}(a) $>$ 0 ? (\mbox{\hyperlink{tomcrypt__private_8h_a62267879327e26468c45bbd83f7f2669}{mp\+\_\+get\+\_\+digit}}(a, 0) \& 1 ? \mbox{\hyperlink{tomcrypt__math_8h_acc2da047f8fb30a3e2b2403aac617fe0}{L\+T\+C\+\_\+\+M\+P\+\_\+\+Y\+ES}} \+: \mbox{\hyperlink{tomcrypt__math_8h_a40f1119339954fb273ecb35e48c1d569}{L\+T\+C\+\_\+\+M\+P\+\_\+\+NO}}) \+: \mbox{\hyperlink{tomcrypt__math_8h_a40f1119339954fb273ecb35e48c1d569}{L\+T\+C\+\_\+\+M\+P\+\_\+\+NO}})}



Definition at line 186 of file tomcrypt\+\_\+private.\+h.

\mbox{\Hypertarget{tomcrypt__private_8h_a910040068490f9f6e5185c970ab869c9}\label{tomcrypt__private_8h_a910040068490f9f6e5185c970ab869c9}} 
\index{tomcrypt\_private.h@{tomcrypt\_private.h}!mp\_iszero@{mp\_iszero}}
\index{mp\_iszero@{mp\_iszero}!tomcrypt\_private.h@{tomcrypt\_private.h}}
\subsubsection{\texorpdfstring{mp\_iszero}{mp\_iszero}}
{\footnotesize\ttfamily \#define mp\+\_\+iszero(\begin{DoxyParamCaption}\item[{}]{a }\end{DoxyParamCaption})~(\mbox{\hyperlink{tomcrypt__private_8h_a6ce44f2e6f872565a468b67d9a93dc28}{mp\+\_\+cmp\+\_\+d}}(a, 0) == \mbox{\hyperlink{tomcrypt__math_8h_a035a31bde4f31419eb259e36e5776607}{L\+T\+C\+\_\+\+M\+P\+\_\+\+EQ}} ? \mbox{\hyperlink{tomcrypt__math_8h_acc2da047f8fb30a3e2b2403aac617fe0}{L\+T\+C\+\_\+\+M\+P\+\_\+\+Y\+ES}} \+: \mbox{\hyperlink{tomcrypt__math_8h_a40f1119339954fb273ecb35e48c1d569}{L\+T\+C\+\_\+\+M\+P\+\_\+\+NO}})}



Definition at line 185 of file tomcrypt\+\_\+private.\+h.

\mbox{\Hypertarget{tomcrypt__private_8h_a42ca6ad7676c236e06ee8b53e278a1a2}\label{tomcrypt__private_8h_a42ca6ad7676c236e06ee8b53e278a1a2}} 
\index{tomcrypt\_private.h@{tomcrypt\_private.h}!mp\_lcm@{mp\_lcm}}
\index{mp\_lcm@{mp\_lcm}!tomcrypt\_private.h@{tomcrypt\_private.h}}
\subsubsection{\texorpdfstring{mp\_lcm}{mp\_lcm}}
{\footnotesize\ttfamily \#define mp\+\_\+lcm(\begin{DoxyParamCaption}\item[{}]{a,  }\item[{}]{b,  }\item[{}]{\mbox{\hyperlink{khazad_8c_a86ea50de5a3e0ae87762f4298d35284c}{c}} }\end{DoxyParamCaption})~\mbox{\hyperlink{tfm__desc_8c_ade2a62ec3e6aa65016ad994bdae98424}{ltc\+\_\+mp.\+lcm}}(a, b, \mbox{\hyperlink{khazad_8c_a86ea50de5a3e0ae87762f4298d35284c}{c}})}



Definition at line 169 of file tomcrypt\+\_\+private.\+h.

\mbox{\Hypertarget{tomcrypt__private_8h_ac7deed6f00e289706070b16f98c430fe}\label{tomcrypt__private_8h_ac7deed6f00e289706070b16f98c430fe}} 
\index{tomcrypt\_private.h@{tomcrypt\_private.h}!mp\_mod@{mp\_mod}}
\index{mp\_mod@{mp\_mod}!tomcrypt\_private.h@{tomcrypt\_private.h}}
\subsubsection{\texorpdfstring{mp\_mod}{mp\_mod}}
{\footnotesize\ttfamily \#define mp\+\_\+mod(\begin{DoxyParamCaption}\item[{}]{a,  }\item[{}]{b,  }\item[{}]{\mbox{\hyperlink{khazad_8c_a86ea50de5a3e0ae87762f4298d35284c}{c}} }\end{DoxyParamCaption})~ltc\+\_\+mp.\+mpdiv(a, b, N\+U\+LL, \mbox{\hyperlink{khazad_8c_a86ea50de5a3e0ae87762f4298d35284c}{c}})}



Definition at line 166 of file tomcrypt\+\_\+private.\+h.

\mbox{\Hypertarget{tomcrypt__private_8h_afd41c0725f692174823db3e939b3ac1e}\label{tomcrypt__private_8h_afd41c0725f692174823db3e939b3ac1e}} 
\index{tomcrypt\_private.h@{tomcrypt\_private.h}!mp\_mod\_d@{mp\_mod\_d}}
\index{mp\_mod\_d@{mp\_mod\_d}!tomcrypt\_private.h@{tomcrypt\_private.h}}
\subsubsection{\texorpdfstring{mp\_mod\_d}{mp\_mod\_d}}
{\footnotesize\ttfamily \#define mp\+\_\+mod\+\_\+d(\begin{DoxyParamCaption}\item[{}]{a,  }\item[{}]{b,  }\item[{}]{\mbox{\hyperlink{khazad_8c_a86ea50de5a3e0ae87762f4298d35284c}{c}} }\end{DoxyParamCaption})~\mbox{\hyperlink{tfm__desc_8c_a825311b5e56f780acb119b19a3cbdca0}{ltc\+\_\+mp.\+modi}}(a, b, \mbox{\hyperlink{khazad_8c_a86ea50de5a3e0ae87762f4298d35284c}{c}})}



Definition at line 167 of file tomcrypt\+\_\+private.\+h.

\mbox{\Hypertarget{tomcrypt__private_8h_ac1935719c005c8bffb7590628e84c024}\label{tomcrypt__private_8h_ac1935719c005c8bffb7590628e84c024}} 
\index{tomcrypt\_private.h@{tomcrypt\_private.h}!mp\_montgomery\_free@{mp\_montgomery\_free}}
\index{mp\_montgomery\_free@{mp\_montgomery\_free}!tomcrypt\_private.h@{tomcrypt\_private.h}}
\subsubsection{\texorpdfstring{mp\_montgomery\_free}{mp\_montgomery\_free}}
{\footnotesize\ttfamily \#define mp\+\_\+montgomery\+\_\+free(\begin{DoxyParamCaption}\item[{}]{a }\end{DoxyParamCaption})~\mbox{\hyperlink{tfm__desc_8c_a8d6035f0021cfaf5936a3c37d2cb2427}{ltc\+\_\+mp.\+montgomery\+\_\+deinit}}(a)}



Definition at line 180 of file tomcrypt\+\_\+private.\+h.

\mbox{\Hypertarget{tomcrypt__private_8h_a8e30da64ace4410ca56cb110a6fedd19}\label{tomcrypt__private_8h_a8e30da64ace4410ca56cb110a6fedd19}} 
\index{tomcrypt\_private.h@{tomcrypt\_private.h}!mp\_montgomery\_normalization@{mp\_montgomery\_normalization}}
\index{mp\_montgomery\_normalization@{mp\_montgomery\_normalization}!tomcrypt\_private.h@{tomcrypt\_private.h}}
\subsubsection{\texorpdfstring{mp\_montgomery\_normalization}{mp\_montgomery\_normalization}}
{\footnotesize\ttfamily \#define mp\+\_\+montgomery\+\_\+normalization(\begin{DoxyParamCaption}\item[{}]{a,  }\item[{}]{b }\end{DoxyParamCaption})~\mbox{\hyperlink{tfm__desc_8c_aa047d6197825069c90f4f89a59f5ed6d}{ltc\+\_\+mp.\+montgomery\+\_\+normalization}}(a, b)}



Definition at line 178 of file tomcrypt\+\_\+private.\+h.

\mbox{\Hypertarget{tomcrypt__private_8h_a4201ed2dbae154496e1a2ae9ba8aa7a8}\label{tomcrypt__private_8h_a4201ed2dbae154496e1a2ae9ba8aa7a8}} 
\index{tomcrypt\_private.h@{tomcrypt\_private.h}!mp\_montgomery\_reduce@{mp\_montgomery\_reduce}}
\index{mp\_montgomery\_reduce@{mp\_montgomery\_reduce}!tomcrypt\_private.h@{tomcrypt\_private.h}}
\subsubsection{\texorpdfstring{mp\_montgomery\_reduce}{mp\_montgomery\_reduce}}
{\footnotesize\ttfamily \#define mp\+\_\+montgomery\+\_\+reduce(\begin{DoxyParamCaption}\item[{}]{a,  }\item[{}]{b,  }\item[{}]{\mbox{\hyperlink{khazad_8c_a86ea50de5a3e0ae87762f4298d35284c}{c}} }\end{DoxyParamCaption})~\mbox{\hyperlink{tfm__desc_8c_a109a8d07cc14bf2f0bd604a773d7e02c}{ltc\+\_\+mp.\+montgomery\+\_\+reduce}}(a, b, \mbox{\hyperlink{khazad_8c_a86ea50de5a3e0ae87762f4298d35284c}{c}})}



Definition at line 179 of file tomcrypt\+\_\+private.\+h.

\mbox{\Hypertarget{tomcrypt__private_8h_a42560b136f9c3cf1411a82a8cae6d954}\label{tomcrypt__private_8h_a42560b136f9c3cf1411a82a8cae6d954}} 
\index{tomcrypt\_private.h@{tomcrypt\_private.h}!mp\_montgomery\_setup@{mp\_montgomery\_setup}}
\index{mp\_montgomery\_setup@{mp\_montgomery\_setup}!tomcrypt\_private.h@{tomcrypt\_private.h}}
\subsubsection{\texorpdfstring{mp\_montgomery\_setup}{mp\_montgomery\_setup}}
{\footnotesize\ttfamily \#define mp\+\_\+montgomery\+\_\+setup(\begin{DoxyParamCaption}\item[{}]{a,  }\item[{}]{b }\end{DoxyParamCaption})~\mbox{\hyperlink{tfm__desc_8c_a771ef8a9d5b1b2633613bfad28b282c2}{ltc\+\_\+mp.\+montgomery\+\_\+setup}}(a, b)}



Definition at line 177 of file tomcrypt\+\_\+private.\+h.

\mbox{\Hypertarget{tomcrypt__private_8h_a7606d2423856b32b09245a2fa1ef34ee}\label{tomcrypt__private_8h_a7606d2423856b32b09245a2fa1ef34ee}} 
\index{tomcrypt\_private.h@{tomcrypt\_private.h}!mp\_mul@{mp\_mul}}
\index{mp\_mul@{mp\_mul}!tomcrypt\_private.h@{tomcrypt\_private.h}}
\subsubsection{\texorpdfstring{mp\_mul}{mp\_mul}}
{\footnotesize\ttfamily \#define mp\+\_\+mul(\begin{DoxyParamCaption}\item[{}]{a,  }\item[{}]{b,  }\item[{}]{\mbox{\hyperlink{khazad_8c_a86ea50de5a3e0ae87762f4298d35284c}{c}} }\end{DoxyParamCaption})~\mbox{\hyperlink{tfm__desc_8c_a7050c53d3ede33130b5137ee21872390}{ltc\+\_\+mp.\+mul}}(a, b, \mbox{\hyperlink{khazad_8c_a86ea50de5a3e0ae87762f4298d35284c}{c}})}



Definition at line 160 of file tomcrypt\+\_\+private.\+h.

\mbox{\Hypertarget{tomcrypt__private_8h_a6732f5faae69c8d1305898ca8e2943d5}\label{tomcrypt__private_8h_a6732f5faae69c8d1305898ca8e2943d5}} 
\index{tomcrypt\_private.h@{tomcrypt\_private.h}!mp\_mul\_d@{mp\_mul\_d}}
\index{mp\_mul\_d@{mp\_mul\_d}!tomcrypt\_private.h@{tomcrypt\_private.h}}
\subsubsection{\texorpdfstring{mp\_mul\_d}{mp\_mul\_d}}
{\footnotesize\ttfamily \#define mp\+\_\+mul\+\_\+d(\begin{DoxyParamCaption}\item[{}]{a,  }\item[{}]{b,  }\item[{}]{\mbox{\hyperlink{khazad_8c_a86ea50de5a3e0ae87762f4298d35284c}{c}} }\end{DoxyParamCaption})~\mbox{\hyperlink{tfm__desc_8c_a1bde65678f43510d80f8851860e15e34}{ltc\+\_\+mp.\+muli}}(a, b, \mbox{\hyperlink{khazad_8c_a86ea50de5a3e0ae87762f4298d35284c}{c}})}



Definition at line 161 of file tomcrypt\+\_\+private.\+h.

\mbox{\Hypertarget{tomcrypt__private_8h_a0c32b20b84951870c7b09f5b6f2679c9}\label{tomcrypt__private_8h_a0c32b20b84951870c7b09f5b6f2679c9}} 
\index{tomcrypt\_private.h@{tomcrypt\_private.h}!mp\_mulmod@{mp\_mulmod}}
\index{mp\_mulmod@{mp\_mulmod}!tomcrypt\_private.h@{tomcrypt\_private.h}}
\subsubsection{\texorpdfstring{mp\_mulmod}{mp\_mulmod}}
{\footnotesize\ttfamily \#define mp\+\_\+mulmod(\begin{DoxyParamCaption}\item[{}]{a,  }\item[{}]{b,  }\item[{}]{\mbox{\hyperlink{khazad_8c_a86ea50de5a3e0ae87762f4298d35284c}{c}},  }\item[{}]{d }\end{DoxyParamCaption})~\mbox{\hyperlink{tfm__desc_8c_a4c6702198a33b0c56f0a886d7c2206c5}{ltc\+\_\+mp.\+mulmod}}(a, b, \mbox{\hyperlink{khazad_8c_a86ea50de5a3e0ae87762f4298d35284c}{c}}, d)}



Definition at line 173 of file tomcrypt\+\_\+private.\+h.

\mbox{\Hypertarget{tomcrypt__private_8h_a0a85470068985d2c10a4df85ca54a7d0}\label{tomcrypt__private_8h_a0a85470068985d2c10a4df85ca54a7d0}} 
\index{tomcrypt\_private.h@{tomcrypt\_private.h}!mp\_neg@{mp\_neg}}
\index{mp\_neg@{mp\_neg}!tomcrypt\_private.h@{tomcrypt\_private.h}}
\subsubsection{\texorpdfstring{mp\_neg}{mp\_neg}}
{\footnotesize\ttfamily \#define mp\+\_\+neg(\begin{DoxyParamCaption}\item[{}]{a,  }\item[{}]{b }\end{DoxyParamCaption})~\mbox{\hyperlink{tfm__desc_8c_adc67bac9fd8e42c930369ddabaa5f2db}{ltc\+\_\+mp.\+neg}}(a, b)}



Definition at line 136 of file tomcrypt\+\_\+private.\+h.

\mbox{\Hypertarget{tomcrypt__private_8h_ab3681f96d55cf707b92d6254f58ea3de}\label{tomcrypt__private_8h_ab3681f96d55cf707b92d6254f58ea3de}} 
\index{tomcrypt\_private.h@{tomcrypt\_private.h}!mp\_prime\_is\_prime@{mp\_prime\_is\_prime}}
\index{mp\_prime\_is\_prime@{mp\_prime\_is\_prime}!tomcrypt\_private.h@{tomcrypt\_private.h}}
\subsubsection{\texorpdfstring{mp\_prime\_is\_prime}{mp\_prime\_is\_prime}}
{\footnotesize\ttfamily \#define mp\+\_\+prime\+\_\+is\+\_\+prime(\begin{DoxyParamCaption}\item[{}]{a,  }\item[{}]{b,  }\item[{}]{\mbox{\hyperlink{khazad_8c_a86ea50de5a3e0ae87762f4298d35284c}{c}} }\end{DoxyParamCaption})~\mbox{\hyperlink{tfm__desc_8c_a48fb4f337851176a7ee5b0836e77d7df}{ltc\+\_\+mp.\+isprime}}(a, b, \mbox{\hyperlink{khazad_8c_a86ea50de5a3e0ae87762f4298d35284c}{c}})}



Definition at line 183 of file tomcrypt\+\_\+private.\+h.

\mbox{\Hypertarget{tomcrypt__private_8h_a9a1503b0adb58db297bc6bfd784b3945}\label{tomcrypt__private_8h_a9a1503b0adb58db297bc6bfd784b3945}} 
\index{tomcrypt\_private.h@{tomcrypt\_private.h}!mp\_rand@{mp\_rand}}
\index{mp\_rand@{mp\_rand}!tomcrypt\_private.h@{tomcrypt\_private.h}}
\subsubsection{\texorpdfstring{mp\_rand}{mp\_rand}}
{\footnotesize\ttfamily \#define mp\+\_\+rand(\begin{DoxyParamCaption}\item[{}]{a,  }\item[{}]{b }\end{DoxyParamCaption})~ltc\+\_\+mp.\+rand(a, b)}



Definition at line 191 of file tomcrypt\+\_\+private.\+h.

\mbox{\Hypertarget{tomcrypt__private_8h_a12263d4d7da068c2a630d2ffc0c8bc1b}\label{tomcrypt__private_8h_a12263d4d7da068c2a630d2ffc0c8bc1b}} 
\index{tomcrypt\_private.h@{tomcrypt\_private.h}!mp\_read\_radix@{mp\_read\_radix}}
\index{mp\_read\_radix@{mp\_read\_radix}!tomcrypt\_private.h@{tomcrypt\_private.h}}
\subsubsection{\texorpdfstring{mp\_read\_radix}{mp\_read\_radix}}
{\footnotesize\ttfamily \#define mp\+\_\+read\+\_\+radix(\begin{DoxyParamCaption}\item[{}]{a,  }\item[{}]{b,  }\item[{}]{\mbox{\hyperlink{khazad_8c_a86ea50de5a3e0ae87762f4298d35284c}{c}} }\end{DoxyParamCaption})~\mbox{\hyperlink{tfm__desc_8c_af84d5b7caaf005f40f924afd8ada2380}{ltc\+\_\+mp.\+read\+\_\+radix}}(a, b, \mbox{\hyperlink{khazad_8c_a86ea50de5a3e0ae87762f4298d35284c}{c}})}



Definition at line 150 of file tomcrypt\+\_\+private.\+h.

\mbox{\Hypertarget{tomcrypt__private_8h_a9e20e2044bb5a279e27512d1e1b65754}\label{tomcrypt__private_8h_a9e20e2044bb5a279e27512d1e1b65754}} 
\index{tomcrypt\_private.h@{tomcrypt\_private.h}!mp\_read\_unsigned\_bin@{mp\_read\_unsigned\_bin}}
\index{mp\_read\_unsigned\_bin@{mp\_read\_unsigned\_bin}!tomcrypt\_private.h@{tomcrypt\_private.h}}
\subsubsection{\texorpdfstring{mp\_read\_unsigned\_bin}{mp\_read\_unsigned\_bin}}
{\footnotesize\ttfamily \#define mp\+\_\+read\+\_\+unsigned\+\_\+bin(\begin{DoxyParamCaption}\item[{}]{a,  }\item[{}]{b,  }\item[{}]{\mbox{\hyperlink{khazad_8c_a86ea50de5a3e0ae87762f4298d35284c}{c}} }\end{DoxyParamCaption})~\mbox{\hyperlink{tfm__desc_8c_a39cf7045cbd39dc7ee5ecdf59dbe3313}{ltc\+\_\+mp.\+unsigned\+\_\+read}}(a, b, \mbox{\hyperlink{khazad_8c_a86ea50de5a3e0ae87762f4298d35284c}{c}})}



Definition at line 154 of file tomcrypt\+\_\+private.\+h.

\mbox{\Hypertarget{tomcrypt__private_8h_a000b0542ef4ecf639ff69895490fdb8f}\label{tomcrypt__private_8h_a000b0542ef4ecf639ff69895490fdb8f}} 
\index{tomcrypt\_private.h@{tomcrypt\_private.h}!mp\_set@{mp\_set}}
\index{mp\_set@{mp\_set}!tomcrypt\_private.h@{tomcrypt\_private.h}}
\subsubsection{\texorpdfstring{mp\_set}{mp\_set}}
{\footnotesize\ttfamily \#define mp\+\_\+set(\begin{DoxyParamCaption}\item[{}]{a,  }\item[{}]{b }\end{DoxyParamCaption})~\mbox{\hyperlink{tfm__desc_8c_a0b4961498876dba1898ece1416698b10}{ltc\+\_\+mp.\+set\+\_\+int}}(a, b)}



Definition at line 139 of file tomcrypt\+\_\+private.\+h.

\mbox{\Hypertarget{tomcrypt__private_8h_ab06bc6503c4faab10b7ce60bef365d65}\label{tomcrypt__private_8h_ab06bc6503c4faab10b7ce60bef365d65}} 
\index{tomcrypt\_private.h@{tomcrypt\_private.h}!mp\_set\_int@{mp\_set\_int}}
\index{mp\_set\_int@{mp\_set\_int}!tomcrypt\_private.h@{tomcrypt\_private.h}}
\subsubsection{\texorpdfstring{mp\_set\_int}{mp\_set\_int}}
{\footnotesize\ttfamily \#define mp\+\_\+set\+\_\+int(\begin{DoxyParamCaption}\item[{}]{a,  }\item[{}]{b }\end{DoxyParamCaption})~\mbox{\hyperlink{tfm__desc_8c_a0b4961498876dba1898ece1416698b10}{ltc\+\_\+mp.\+set\+\_\+int}}(a, b)}



Definition at line 140 of file tomcrypt\+\_\+private.\+h.

\mbox{\Hypertarget{tomcrypt__private_8h_aea81d79b5462e99068908d80edb8bd1a}\label{tomcrypt__private_8h_aea81d79b5462e99068908d80edb8bd1a}} 
\index{tomcrypt\_private.h@{tomcrypt\_private.h}!mp\_sqr@{mp\_sqr}}
\index{mp\_sqr@{mp\_sqr}!tomcrypt\_private.h@{tomcrypt\_private.h}}
\subsubsection{\texorpdfstring{mp\_sqr}{mp\_sqr}}
{\footnotesize\ttfamily \#define mp\+\_\+sqr(\begin{DoxyParamCaption}\item[{}]{a,  }\item[{}]{b }\end{DoxyParamCaption})~\mbox{\hyperlink{tfm__desc_8c_acb23c57b2c947a4345287b337fa78764}{ltc\+\_\+mp.\+sqr}}(a, b)}



Definition at line 162 of file tomcrypt\+\_\+private.\+h.

\mbox{\Hypertarget{tomcrypt__private_8h_a6542bece10f5cf20b6c754646c20fcb4}\label{tomcrypt__private_8h_a6542bece10f5cf20b6c754646c20fcb4}} 
\index{tomcrypt\_private.h@{tomcrypt\_private.h}!mp\_sqrmod@{mp\_sqrmod}}
\index{mp\_sqrmod@{mp\_sqrmod}!tomcrypt\_private.h@{tomcrypt\_private.h}}
\subsubsection{\texorpdfstring{mp\_sqrmod}{mp\_sqrmod}}
{\footnotesize\ttfamily \#define mp\+\_\+sqrmod(\begin{DoxyParamCaption}\item[{}]{a,  }\item[{}]{b,  }\item[{}]{\mbox{\hyperlink{khazad_8c_a86ea50de5a3e0ae87762f4298d35284c}{c}} }\end{DoxyParamCaption})~\mbox{\hyperlink{tfm__desc_8c_a2a2ed54ac95cb81e7a744b060eeb34af}{ltc\+\_\+mp.\+sqrmod}}(a, b, \mbox{\hyperlink{khazad_8c_a86ea50de5a3e0ae87762f4298d35284c}{c}})}



Definition at line 174 of file tomcrypt\+\_\+private.\+h.

\mbox{\Hypertarget{tomcrypt__private_8h_af1a090c9979e328596fa37512f519a09}\label{tomcrypt__private_8h_af1a090c9979e328596fa37512f519a09}} 
\index{tomcrypt\_private.h@{tomcrypt\_private.h}!mp\_sqrtmod\_prime@{mp\_sqrtmod\_prime}}
\index{mp\_sqrtmod\_prime@{mp\_sqrtmod\_prime}!tomcrypt\_private.h@{tomcrypt\_private.h}}
\subsubsection{\texorpdfstring{mp\_sqrtmod\_prime}{mp\_sqrtmod\_prime}}
{\footnotesize\ttfamily \#define mp\+\_\+sqrtmod\+\_\+prime(\begin{DoxyParamCaption}\item[{}]{a,  }\item[{}]{b,  }\item[{}]{\mbox{\hyperlink{khazad_8c_a86ea50de5a3e0ae87762f4298d35284c}{c}} }\end{DoxyParamCaption})~\mbox{\hyperlink{ltm__desc_8c_aec55b2d137e8b50b343f2d9986db1843}{ltc\+\_\+mp.\+sqrtmod\+\_\+prime}}(a, b, \mbox{\hyperlink{khazad_8c_a86ea50de5a3e0ae87762f4298d35284c}{c}})}



Definition at line 163 of file tomcrypt\+\_\+private.\+h.

\mbox{\Hypertarget{tomcrypt__private_8h_ab8d0882c3b58263b638b41fbf110fde8}\label{tomcrypt__private_8h_ab8d0882c3b58263b638b41fbf110fde8}} 
\index{tomcrypt\_private.h@{tomcrypt\_private.h}!mp\_sub@{mp\_sub}}
\index{mp\_sub@{mp\_sub}!tomcrypt\_private.h@{tomcrypt\_private.h}}
\subsubsection{\texorpdfstring{mp\_sub}{mp\_sub}}
{\footnotesize\ttfamily \#define mp\+\_\+sub(\begin{DoxyParamCaption}\item[{}]{a,  }\item[{}]{b,  }\item[{}]{\mbox{\hyperlink{khazad_8c_a86ea50de5a3e0ae87762f4298d35284c}{c}} }\end{DoxyParamCaption})~\mbox{\hyperlink{tfm__desc_8c_ac1994aaeae47e7ef1b1b6fe723898be0}{ltc\+\_\+mp.\+sub}}(a, b, \mbox{\hyperlink{khazad_8c_a86ea50de5a3e0ae87762f4298d35284c}{c}})}



Definition at line 158 of file tomcrypt\+\_\+private.\+h.

\mbox{\Hypertarget{tomcrypt__private_8h_a4215ff0d6838acb3d959d3e68c923de7}\label{tomcrypt__private_8h_a4215ff0d6838acb3d959d3e68c923de7}} 
\index{tomcrypt\_private.h@{tomcrypt\_private.h}!mp\_sub\_d@{mp\_sub\_d}}
\index{mp\_sub\_d@{mp\_sub\_d}!tomcrypt\_private.h@{tomcrypt\_private.h}}
\subsubsection{\texorpdfstring{mp\_sub\_d}{mp\_sub\_d}}
{\footnotesize\ttfamily \#define mp\+\_\+sub\+\_\+d(\begin{DoxyParamCaption}\item[{}]{a,  }\item[{}]{b,  }\item[{}]{\mbox{\hyperlink{khazad_8c_a86ea50de5a3e0ae87762f4298d35284c}{c}} }\end{DoxyParamCaption})~\mbox{\hyperlink{tfm__desc_8c_afa8ec5f7da0f83c1ea1f3da29e9be588}{ltc\+\_\+mp.\+subi}}(a, b, \mbox{\hyperlink{khazad_8c_a86ea50de5a3e0ae87762f4298d35284c}{c}})}



Definition at line 159 of file tomcrypt\+\_\+private.\+h.

\mbox{\Hypertarget{tomcrypt__private_8h_a15e2f6c11b3fcebe885ecc14d759ac01}\label{tomcrypt__private_8h_a15e2f6c11b3fcebe885ecc14d759ac01}} 
\index{tomcrypt\_private.h@{tomcrypt\_private.h}!mp\_submod@{mp\_submod}}
\index{mp\_submod@{mp\_submod}!tomcrypt\_private.h@{tomcrypt\_private.h}}
\subsubsection{\texorpdfstring{mp\_submod}{mp\_submod}}
{\footnotesize\ttfamily \#define mp\+\_\+submod(\begin{DoxyParamCaption}\item[{}]{a,  }\item[{}]{b,  }\item[{}]{\mbox{\hyperlink{khazad_8c_a86ea50de5a3e0ae87762f4298d35284c}{c}},  }\item[{}]{d }\end{DoxyParamCaption})~\mbox{\hyperlink{tfm__desc_8c_ac6a3bdd2a041584938590017969f9f76}{ltc\+\_\+mp.\+submod}}(a, b, \mbox{\hyperlink{khazad_8c_a86ea50de5a3e0ae87762f4298d35284c}{c}}, d)}



Definition at line 172 of file tomcrypt\+\_\+private.\+h.

\mbox{\Hypertarget{tomcrypt__private_8h_a376a4d31dcfeb65c069db0485b9602f8}\label{tomcrypt__private_8h_a376a4d31dcfeb65c069db0485b9602f8}} 
\index{tomcrypt\_private.h@{tomcrypt\_private.h}!mp\_to\_unsigned\_bin@{mp\_to\_unsigned\_bin}}
\index{mp\_to\_unsigned\_bin@{mp\_to\_unsigned\_bin}!tomcrypt\_private.h@{tomcrypt\_private.h}}
\subsubsection{\texorpdfstring{mp\_to\_unsigned\_bin}{mp\_to\_unsigned\_bin}}
{\footnotesize\ttfamily \#define mp\+\_\+to\+\_\+unsigned\+\_\+bin(\begin{DoxyParamCaption}\item[{}]{a,  }\item[{}]{b }\end{DoxyParamCaption})~\mbox{\hyperlink{tfm__desc_8c_a0f1b2cd32964ecad0001b7169b53f1d1}{ltc\+\_\+mp.\+unsigned\+\_\+write}}(a, b)}



Definition at line 153 of file tomcrypt\+\_\+private.\+h.

\mbox{\Hypertarget{tomcrypt__private_8h_a4b9ad86294c22251f11369ed62f236b9}\label{tomcrypt__private_8h_a4b9ad86294c22251f11369ed62f236b9}} 
\index{tomcrypt\_private.h@{tomcrypt\_private.h}!mp\_tohex@{mp\_tohex}}
\index{mp\_tohex@{mp\_tohex}!tomcrypt\_private.h@{tomcrypt\_private.h}}
\subsubsection{\texorpdfstring{mp\_tohex}{mp\_tohex}}
{\footnotesize\ttfamily \#define mp\+\_\+tohex(\begin{DoxyParamCaption}\item[{}]{a,  }\item[{}]{b }\end{DoxyParamCaption})~\mbox{\hyperlink{tomcrypt__private_8h_a560fd673c15ccf143fdfdcb2b21764e3}{mp\+\_\+toradix}}(a, b, 16)}



Definition at line 189 of file tomcrypt\+\_\+private.\+h.

\mbox{\Hypertarget{tomcrypt__private_8h_a560fd673c15ccf143fdfdcb2b21764e3}\label{tomcrypt__private_8h_a560fd673c15ccf143fdfdcb2b21764e3}} 
\index{tomcrypt\_private.h@{tomcrypt\_private.h}!mp\_toradix@{mp\_toradix}}
\index{mp\_toradix@{mp\_toradix}!tomcrypt\_private.h@{tomcrypt\_private.h}}
\subsubsection{\texorpdfstring{mp\_toradix}{mp\_toradix}}
{\footnotesize\ttfamily \#define mp\+\_\+toradix(\begin{DoxyParamCaption}\item[{}]{a,  }\item[{}]{b,  }\item[{}]{\mbox{\hyperlink{khazad_8c_a86ea50de5a3e0ae87762f4298d35284c}{c}} }\end{DoxyParamCaption})~\mbox{\hyperlink{tfm__desc_8c_aa40161a29cddd18172c7a64a18b6dc2c}{ltc\+\_\+mp.\+write\+\_\+radix}}(a, b, \mbox{\hyperlink{khazad_8c_a86ea50de5a3e0ae87762f4298d35284c}{c}})}



Definition at line 151 of file tomcrypt\+\_\+private.\+h.

\mbox{\Hypertarget{tomcrypt__private_8h_ad301148bb24f43a8c7003a6976dfaa5a}\label{tomcrypt__private_8h_ad301148bb24f43a8c7003a6976dfaa5a}} 
\index{tomcrypt\_private.h@{tomcrypt\_private.h}!mp\_unsigned\_bin\_size@{mp\_unsigned\_bin\_size}}
\index{mp\_unsigned\_bin\_size@{mp\_unsigned\_bin\_size}!tomcrypt\_private.h@{tomcrypt\_private.h}}
\subsubsection{\texorpdfstring{mp\_unsigned\_bin\_size}{mp\_unsigned\_bin\_size}}
{\footnotesize\ttfamily \#define mp\+\_\+unsigned\+\_\+bin\+\_\+size(\begin{DoxyParamCaption}\item[{}]{a }\end{DoxyParamCaption})~\mbox{\hyperlink{tfm__desc_8c_adb7e3791a36546ca7550e34344e2cb47}{ltc\+\_\+mp.\+unsigned\+\_\+size}}(a)}



Definition at line 152 of file tomcrypt\+\_\+private.\+h.



\subsection{Typedef Documentation}
\mbox{\Hypertarget{tomcrypt__private_8h_a056acfa9f8dfc66d7ebbe1315389f3b2}\label{tomcrypt__private_8h_a056acfa9f8dfc66d7ebbe1315389f3b2}} 
\index{tomcrypt\_private.h@{tomcrypt\_private.h}!fn\_kdf\_t@{fn\_kdf\_t}}
\index{fn\_kdf\_t@{fn\_kdf\_t}!tomcrypt\_private.h@{tomcrypt\_private.h}}
\subsubsection{\texorpdfstring{fn\_kdf\_t}{fn\_kdf\_t}}
{\footnotesize\ttfamily typedef int($\ast$ fn\+\_\+kdf\+\_\+t) (const unsigned char $\ast$password, unsigned long password\+\_\+len, const unsigned char $\ast$salt, unsigned long salt\+\_\+len, int iteration\+\_\+count, int hash\+\_\+idx, unsigned char $\ast$out, unsigned long $\ast$outlen)}



Definition at line 39 of file tomcrypt\+\_\+private.\+h.



\subsection{Enumeration Type Documentation}
\mbox{\Hypertarget{tomcrypt__private_8h_a981c610adcaa77d61adb80dde41a044b}\label{tomcrypt__private_8h_a981c610adcaa77d61adb80dde41a044b}} 
\index{tomcrypt\_private.h@{tomcrypt\_private.h}!ltc\_oid\_id@{ltc\_oid\_id}}
\index{ltc\_oid\_id@{ltc\_oid\_id}!tomcrypt\_private.h@{tomcrypt\_private.h}}
\subsubsection{\texorpdfstring{ltc\_oid\_id}{ltc\_oid\_id}}
{\footnotesize\ttfamily enum \mbox{\hyperlink{tomcrypt__private_8h_a981c610adcaa77d61adb80dde41a044b}{ltc\+\_\+oid\+\_\+id}}}

\begin{DoxyEnumFields}{Enumerator}
\raisebox{\heightof{T}}[0pt][0pt]{\index{PKA\_RSA@{PKA\_RSA}!tomcrypt\_private.h@{tomcrypt\_private.h}}\index{tomcrypt\_private.h@{tomcrypt\_private.h}!PKA\_RSA@{PKA\_RSA}}}\mbox{\Hypertarget{tomcrypt__private_8h_a981c610adcaa77d61adb80dde41a044ba40273a1f176419e8c4638e0efb15854f}\label{tomcrypt__private_8h_a981c610adcaa77d61adb80dde41a044ba40273a1f176419e8c4638e0efb15854f}} 
P\+K\+A\+\_\+\+R\+SA&\\
\hline

\raisebox{\heightof{T}}[0pt][0pt]{\index{PKA\_DSA@{PKA\_DSA}!tomcrypt\_private.h@{tomcrypt\_private.h}}\index{tomcrypt\_private.h@{tomcrypt\_private.h}!PKA\_DSA@{PKA\_DSA}}}\mbox{\Hypertarget{tomcrypt__private_8h_a981c610adcaa77d61adb80dde41a044babe5d329be6c70ca6a43ba1099a69386d}\label{tomcrypt__private_8h_a981c610adcaa77d61adb80dde41a044babe5d329be6c70ca6a43ba1099a69386d}} 
P\+K\+A\+\_\+\+D\+SA&\\
\hline

\raisebox{\heightof{T}}[0pt][0pt]{\index{PKA\_EC@{PKA\_EC}!tomcrypt\_private.h@{tomcrypt\_private.h}}\index{tomcrypt\_private.h@{tomcrypt\_private.h}!PKA\_EC@{PKA\_EC}}}\mbox{\Hypertarget{tomcrypt__private_8h_a981c610adcaa77d61adb80dde41a044bafe7642b8f160f5b4e79903c13bf39a4e}\label{tomcrypt__private_8h_a981c610adcaa77d61adb80dde41a044bafe7642b8f160f5b4e79903c13bf39a4e}} 
P\+K\+A\+\_\+\+EC&\\
\hline

\raisebox{\heightof{T}}[0pt][0pt]{\index{PKA\_EC\_PRIMEF@{PKA\_EC\_PRIMEF}!tomcrypt\_private.h@{tomcrypt\_private.h}}\index{tomcrypt\_private.h@{tomcrypt\_private.h}!PKA\_EC\_PRIMEF@{PKA\_EC\_PRIMEF}}}\mbox{\Hypertarget{tomcrypt__private_8h_a981c610adcaa77d61adb80dde41a044bad815f93f03c91dcfaa47330dcf8a397a}\label{tomcrypt__private_8h_a981c610adcaa77d61adb80dde41a044bad815f93f03c91dcfaa47330dcf8a397a}} 
P\+K\+A\+\_\+\+E\+C\+\_\+\+P\+R\+I\+M\+EF&\\
\hline

\end{DoxyEnumFields}


Definition at line 22 of file tomcrypt\+\_\+private.\+h.


\begin{DoxyCode}{0}
\DoxyCodeLine{22                 \{}
\DoxyCodeLine{23    \mbox{\hyperlink{tomcrypt__private_8h_a981c610adcaa77d61adb80dde41a044ba40273a1f176419e8c4638e0efb15854f}{PKA\_RSA}},}
\DoxyCodeLine{24    \mbox{\hyperlink{tomcrypt__private_8h_a981c610adcaa77d61adb80dde41a044babe5d329be6c70ca6a43ba1099a69386d}{PKA\_DSA}},}
\DoxyCodeLine{25    \mbox{\hyperlink{tomcrypt__private_8h_a981c610adcaa77d61adb80dde41a044bafe7642b8f160f5b4e79903c13bf39a4e}{PKA\_EC}},}
\DoxyCodeLine{26    \mbox{\hyperlink{tomcrypt__private_8h_a981c610adcaa77d61adb80dde41a044bad815f93f03c91dcfaa47330dcf8a397a}{PKA\_EC\_PRIMEF}}}
\DoxyCodeLine{27 \};}

\end{DoxyCode}


\subsection{Function Documentation}
\mbox{\Hypertarget{tomcrypt__private_8h_a669fada75ab21a80b652dfbc2b54e346}\label{tomcrypt__private_8h_a669fada75ab21a80b652dfbc2b54e346}} 
\index{tomcrypt\_private.h@{tomcrypt\_private.h}!copy\_or\_zeromem@{copy\_or\_zeromem}}
\index{copy\_or\_zeromem@{copy\_or\_zeromem}!tomcrypt\_private.h@{tomcrypt\_private.h}}
\subsubsection{\texorpdfstring{copy\_or\_zeromem()}{copy\_or\_zeromem()}}
{\footnotesize\ttfamily void copy\+\_\+or\+\_\+zeromem (\begin{DoxyParamCaption}\item[{const unsigned char $\ast$}]{src,  }\item[{unsigned char $\ast$}]{dest,  }\item[{unsigned long}]{len,  }\item[{int}]{coz }\end{DoxyParamCaption})}



Either copy or zero a block of memory in constant time. 


\begin{DoxyParams}{Parameters}
{\em src} & The source where to read from \\
\hline
{\em dest} & The destination where to write to \\
\hline
{\em len} & The length of the area to process (octets) \\
\hline
{\em coz} & Copy (on 0) Or Zero ($>$ 0) \\
\hline
\end{DoxyParams}


Definition at line 23 of file copy\+\_\+or\+\_\+zeromem.\+c.


\begin{DoxyCode}{0}
\DoxyCodeLine{24 \{}
\DoxyCodeLine{25    \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} y;}
\DoxyCodeLine{26 \textcolor{preprocessor}{\#ifdef LTC\_FAST}}
\DoxyCodeLine{27    \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} z;}
\DoxyCodeLine{28    LTC\_FAST\_TYPE fastMask = ~(LTC\_FAST\_TYPE)0; \textcolor{comment}{/* initialize fastMask at all ones */}}
\DoxyCodeLine{29 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{30    \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char} \mbox{\hyperlink{gcm__gf__mult_8c_a3a2325b458f400e186d773b14e6c1ed9}{mask}} = 0xff; \textcolor{comment}{/* initialize mask at all ones */}}
\DoxyCodeLine{31 }
\DoxyCodeLine{32    \mbox{\hyperlink{tomcrypt__argchk_8h_a67a6e5d66d0c7d80ddf5c583054608bd}{LTC\_ARGCHKVD}}(src  != NULL);}
\DoxyCodeLine{33    \mbox{\hyperlink{tomcrypt__argchk_8h_a67a6e5d66d0c7d80ddf5c583054608bd}{LTC\_ARGCHKVD}}(dest != NULL);}
\DoxyCodeLine{34 }
\DoxyCodeLine{35    \textcolor{keywordflow}{if} (coz != 0) coz = 1;}
\DoxyCodeLine{36    y = 0;}
\DoxyCodeLine{37    \mbox{\hyperlink{gcm__gf__mult_8c_a3a2325b458f400e186d773b14e6c1ed9}{mask}} *= 1 - coz; \textcolor{comment}{/* mask = ( coz ? 0 : 0xff ) */}}
\DoxyCodeLine{38 \textcolor{preprocessor}{\#ifdef LTC\_FAST}}
\DoxyCodeLine{39    fastMask *= 1 - coz;}
\DoxyCodeLine{40    \textcolor{keywordflow}{if} (\mbox{\hyperlink{ocb__init_8c_afed088663f8704004425cdae2120b9b3}{len}} \& ~15) \{}
\DoxyCodeLine{41       \textcolor{keywordflow}{for} (; y < (\mbox{\hyperlink{ocb__init_8c_afed088663f8704004425cdae2120b9b3}{len}} \& ~15); y += 16) \{}
\DoxyCodeLine{42         \textcolor{keywordflow}{for} (z = 0; z < 16; z += \textcolor{keyword}{sizeof}(LTC\_FAST\_TYPE)) \{}
\DoxyCodeLine{43           *(LTC\_FAST\_TYPE\_PTR\_CAST(\&dest[y+z])) = *(LTC\_FAST\_TYPE\_PTR\_CAST(\&src[y+z])) \& fastMask;}
\DoxyCodeLine{44         \}}
\DoxyCodeLine{45       \}}
\DoxyCodeLine{46    \}}
\DoxyCodeLine{47 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{48    \textcolor{keywordflow}{for} (; y < \mbox{\hyperlink{ocb__init_8c_afed088663f8704004425cdae2120b9b3}{len}}; y++) \{}
\DoxyCodeLine{49       dest[y] = src[y] \& \mbox{\hyperlink{gcm__gf__mult_8c_a3a2325b458f400e186d773b14e6c1ed9}{mask}};}
\DoxyCodeLine{50    \}}
\DoxyCodeLine{51 \textcolor{preprocessor}{\#ifdef LTC\_CLEAN\_STACK}}
\DoxyCodeLine{52 \textcolor{preprocessor}{\#ifdef LTC\_FAST}}
\DoxyCodeLine{53    fastMask = 0;}
\DoxyCodeLine{54 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{55    \mbox{\hyperlink{gcm__gf__mult_8c_a3a2325b458f400e186d773b14e6c1ed9}{mask}} = 0;}
\DoxyCodeLine{56 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{57 \}}

\end{DoxyCode}


References len, L\+T\+C\+\_\+\+A\+R\+G\+C\+H\+K\+VD, and mask.



Referenced by ccm\+\_\+memory().

Here is the caller graph for this function\+:
% FIG 2
\mbox{\Hypertarget{tomcrypt__private_8h_a651ad7c1f5a930476bb10b9d61555346}\label{tomcrypt__private_8h_a651ad7c1f5a930476bb10b9d61555346}} 
\index{tomcrypt\_private.h@{tomcrypt\_private.h}!der\_decode\_asn1\_identifier@{der\_decode\_asn1\_identifier}}
\index{der\_decode\_asn1\_identifier@{der\_decode\_asn1\_identifier}!tomcrypt\_private.h@{tomcrypt\_private.h}}
\subsubsection{\texorpdfstring{der\_decode\_asn1\_identifier()}{der\_decode\_asn1\_identifier()}}
{\footnotesize\ttfamily int der\+\_\+decode\+\_\+asn1\+\_\+identifier (\begin{DoxyParamCaption}\item[{const unsigned char $\ast$}]{in,  }\item[{unsigned long $\ast$}]{inlen,  }\item[{ltc\+\_\+asn1\+\_\+list $\ast$}]{id }\end{DoxyParamCaption})}



Decode the A\+S\+N.\+1 Identifier. 


\begin{DoxyParams}{Parameters}
{\em id} & Where to store the decoded Identifier \\
\hline
{\em in} & Where to read the Identifier from \\
\hline
{\em inlen} & \mbox{[}in/out\mbox{]} The size of in available/read \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
C\+R\+Y\+P\+T\+\_\+\+OK if successful 
\end{DoxyReturn}


Definition at line 65 of file der\+\_\+decode\+\_\+asn1\+\_\+identifier.\+c.


\begin{DoxyCode}{0}
\DoxyCodeLine{66 \{}
\DoxyCodeLine{67    \mbox{\hyperlink{tomcrypt__cfg_8h_ab4afaf24b39288a7be6fd03fe8345f61}{ulong64}} tmp;}
\DoxyCodeLine{68    \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} tag\_len;}
\DoxyCodeLine{69    \textcolor{keywordtype}{int} err;}
\DoxyCodeLine{70 }
\DoxyCodeLine{71    \mbox{\hyperlink{tomcrypt__argchk_8h_a683da3e041e49f196318b6ea951414ba}{LTC\_ARGCHK}}(\textcolor{keywordtype}{id}    != NULL);}
\DoxyCodeLine{72    \mbox{\hyperlink{tomcrypt__argchk_8h_a683da3e041e49f196318b6ea951414ba}{LTC\_ARGCHK}}(in    != NULL);}
\DoxyCodeLine{73    \mbox{\hyperlink{tomcrypt__argchk_8h_a683da3e041e49f196318b6ea951414ba}{LTC\_ARGCHK}}(inlen != NULL);}
\DoxyCodeLine{74 }
\DoxyCodeLine{75    \textcolor{keywordflow}{if} (*inlen == 0) \{}
\DoxyCodeLine{76       \textcolor{keywordflow}{return} \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06caccd878f5599f3036ffe759dbe1a1ac16}{CRYPT\_BUFFER\_OVERFLOW}};}
\DoxyCodeLine{77    \}}
\DoxyCodeLine{78 }
\DoxyCodeLine{79    tag\_len = 1;}
\DoxyCodeLine{80    \textcolor{keywordtype}{id}->klass = (in[0] >> 6) \& 0x3;}
\DoxyCodeLine{81    \textcolor{keywordtype}{id}->pc = (in[0] >> 5) \& 0x1;}
\DoxyCodeLine{82    \textcolor{keywordtype}{id}->tag = in[0] \& 0x1f;}
\DoxyCodeLine{83 }
\DoxyCodeLine{84    err = \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}};}
\DoxyCodeLine{85    \textcolor{keywordflow}{if} (id->tag == 0x1f) \{}
\DoxyCodeLine{86       \textcolor{keywordtype}{id}->tag = 0;}
\DoxyCodeLine{87       \textcolor{keywordflow}{do} \{}
\DoxyCodeLine{88          \textcolor{keywordflow}{if} (*inlen < tag\_len) \{}
\DoxyCodeLine{89             \textcolor{comment}{/* break the loop and trigger the BOF error-code */}}
\DoxyCodeLine{90             tmp = 0xff;}
\DoxyCodeLine{91             \textcolor{keywordflow}{break};}
\DoxyCodeLine{92          \}}
\DoxyCodeLine{93          \textcolor{keywordtype}{id}->tag <<= 7;}
\DoxyCodeLine{94          \textcolor{keywordtype}{id}->tag |= in[tag\_len] \& 0x7f;}
\DoxyCodeLine{95          tmp = in[tag\_len] \& 0x80;}
\DoxyCodeLine{96          tag\_len++;}
\DoxyCodeLine{97       \} \textcolor{keywordflow}{while} ((tmp != 0) \&\& (tag\_len < 10));}
\DoxyCodeLine{98 }
\DoxyCodeLine{99       \textcolor{keywordflow}{if} (tmp != 0) \{}
\DoxyCodeLine{100          err = \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06caccd878f5599f3036ffe759dbe1a1ac16}{CRYPT\_BUFFER\_OVERFLOW}};}
\DoxyCodeLine{101       \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (id->tag < 0x1f) \{}
\DoxyCodeLine{102          err = \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06ca001cb5383cce7c4581790abe472e816f}{CRYPT\_PK\_ASN1\_ERROR}};}
\DoxyCodeLine{103       \}}
\DoxyCodeLine{104    \}}
\DoxyCodeLine{105 }
\DoxyCodeLine{106    \textcolor{keywordflow}{if} (err != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}}) \{}
\DoxyCodeLine{107       \textcolor{keywordtype}{id}->pc = 0;}
\DoxyCodeLine{108       \textcolor{keywordtype}{id}->klass = 0;}
\DoxyCodeLine{109       \textcolor{keywordtype}{id}->tag = 0;}
\DoxyCodeLine{110    \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{111       *inlen = tag\_len;}
\DoxyCodeLine{112       \textcolor{keywordflow}{if} ((id->klass == LTC\_ASN1\_CL\_UNIVERSAL) \&\&}
\DoxyCodeLine{113             (\textcolor{keywordtype}{id}->tag < \mbox{\hyperlink{tomcrypt__private_8h_a6ad32891f744af2b205041ad6dc5bce0}{der\_asn1\_tag\_to\_type\_map\_sz}}) \&\&}
\DoxyCodeLine{114             (id->tag < \mbox{\hyperlink{der__decode__asn1__identifier_8c_ae0c8f7d434b413a2ff67589df588cdeb}{tag\_constructed\_map\_sz}}) \&\&}
\DoxyCodeLine{115             (\textcolor{keywordtype}{id}->pc == \mbox{\hyperlink{der__decode__asn1__identifier_8c_af435b696867260086b90e7ca08dc8b20}{tag\_constructed\_map}}[\textcolor{keywordtype}{id}->tag])) \{}
\DoxyCodeLine{116          \textcolor{keywordtype}{id}->type = \mbox{\hyperlink{tomcrypt__private_8h_a411f77ba949e37dca9c1ef1e43127cb1}{der\_asn1\_tag\_to\_type\_map}}[\textcolor{keywordtype}{id}->tag];}
\DoxyCodeLine{117       \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{118          \textcolor{keywordflow}{if} ((id->klass == LTC\_ASN1\_CL\_UNIVERSAL) \&\& (\textcolor{keywordtype}{id}->tag == 0)) \{}
\DoxyCodeLine{119             \textcolor{keywordtype}{id}->type = LTC\_ASN1\_EOL;}
\DoxyCodeLine{120          \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{121             \textcolor{keywordtype}{id}->type = LTC\_ASN1\_CUSTOM\_TYPE;}
\DoxyCodeLine{122          \}}
\DoxyCodeLine{123       \}}
\DoxyCodeLine{124    \}}
\DoxyCodeLine{125 }
\DoxyCodeLine{126    \textcolor{keywordflow}{return} \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}};}
\DoxyCodeLine{127 \}}

\end{DoxyCode}


References C\+R\+Y\+P\+T\+\_\+\+B\+U\+F\+F\+E\+R\+\_\+\+O\+V\+E\+R\+F\+L\+OW, C\+R\+Y\+P\+T\+\_\+\+OK, C\+R\+Y\+P\+T\+\_\+\+P\+K\+\_\+\+A\+S\+N1\+\_\+\+E\+R\+R\+OR, der\+\_\+asn1\+\_\+tag\+\_\+to\+\_\+type\+\_\+map, der\+\_\+asn1\+\_\+tag\+\_\+to\+\_\+type\+\_\+map\+\_\+sz, L\+T\+C\+\_\+\+A\+R\+G\+C\+HK, tag\+\_\+constructed\+\_\+map, and tag\+\_\+constructed\+\_\+map\+\_\+sz.



Referenced by der\+\_\+decode\+\_\+custom\+\_\+type\+\_\+ex(), and der\+\_\+decode\+\_\+sequence\+\_\+flexi().

Here is the caller graph for this function\+:
% FIG 3
\mbox{\Hypertarget{tomcrypt__private_8h_af90423764098b8876368d0984d96053a}\label{tomcrypt__private_8h_af90423764098b8876368d0984d96053a}} 
\index{tomcrypt\_private.h@{tomcrypt\_private.h}!der\_decode\_asn1\_length@{der\_decode\_asn1\_length}}
\index{der\_decode\_asn1\_length@{der\_decode\_asn1\_length}!tomcrypt\_private.h@{tomcrypt\_private.h}}
\subsubsection{\texorpdfstring{der\_decode\_asn1\_length()}{der\_decode\_asn1\_length()}}
{\footnotesize\ttfamily int der\+\_\+decode\+\_\+asn1\+\_\+length (\begin{DoxyParamCaption}\item[{const unsigned char $\ast$}]{in,  }\item[{unsigned long $\ast$}]{inlen,  }\item[{unsigned long $\ast$}]{outlen }\end{DoxyParamCaption})}



Decode the A\+S\+N.\+1 Length field. 


\begin{DoxyParams}{Parameters}
{\em in} & Where to read the length field from \\
\hline
{\em inlen} & \mbox{[}in/out\mbox{]} The size of in available/read \\
\hline
{\em outlen} & \mbox{[}out\mbox{]} The decoded A\+S\+N.\+1 length \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
C\+R\+Y\+P\+T\+\_\+\+OK if successful 
\end{DoxyReturn}


Definition at line 24 of file der\+\_\+decode\+\_\+asn1\+\_\+length.\+c.


\begin{DoxyCode}{0}
\DoxyCodeLine{25 \{}
\DoxyCodeLine{26    \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} real\_len, decoded\_len, offset, i;}
\DoxyCodeLine{27 }
\DoxyCodeLine{28    \mbox{\hyperlink{tomcrypt__argchk_8h_a683da3e041e49f196318b6ea951414ba}{LTC\_ARGCHK}}(in    != NULL);}
\DoxyCodeLine{29    \mbox{\hyperlink{tomcrypt__argchk_8h_a683da3e041e49f196318b6ea951414ba}{LTC\_ARGCHK}}(inlen != NULL);}
\DoxyCodeLine{30 }
\DoxyCodeLine{31    \textcolor{keywordflow}{if} (*inlen < 1) \{}
\DoxyCodeLine{32       \textcolor{keywordflow}{return} \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06caccd878f5599f3036ffe759dbe1a1ac16}{CRYPT\_BUFFER\_OVERFLOW}};}
\DoxyCodeLine{33    \}}
\DoxyCodeLine{34 }
\DoxyCodeLine{35    real\_len = in[0];}
\DoxyCodeLine{36 }
\DoxyCodeLine{37    \textcolor{keywordflow}{if} (real\_len < 128) \{}
\DoxyCodeLine{38       decoded\_len = real\_len;}
\DoxyCodeLine{39       offset = 1;}
\DoxyCodeLine{40    \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{41       real\_len \&= 0x7F;}
\DoxyCodeLine{42       \textcolor{keywordflow}{if} (real\_len == 0) \{}
\DoxyCodeLine{43          \textcolor{keywordflow}{return} \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06ca001cb5383cce7c4581790abe472e816f}{CRYPT\_PK\_ASN1\_ERROR}};}
\DoxyCodeLine{44       \}}
\DoxyCodeLine{45       \textcolor{keywordflow}{if} (real\_len > \textcolor{keyword}{sizeof}(decoded\_len)) \{}
\DoxyCodeLine{46          \textcolor{keywordflow}{return} \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06ca3a147cc0bbea3f8779364ad00c2678b4}{CRYPT\_OVERFLOW}};}
\DoxyCodeLine{47       \}}
\DoxyCodeLine{48       \textcolor{keywordflow}{if} (real\_len > (*inlen - 1)) \{}
\DoxyCodeLine{49          \textcolor{keywordflow}{return} \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06caccd878f5599f3036ffe759dbe1a1ac16}{CRYPT\_BUFFER\_OVERFLOW}};}
\DoxyCodeLine{50       \}}
\DoxyCodeLine{51       decoded\_len = 0;}
\DoxyCodeLine{52       offset = 1 + real\_len;}
\DoxyCodeLine{53       \textcolor{keywordflow}{for} (i = 0; i < real\_len; i++) \{}
\DoxyCodeLine{54          decoded\_len = (decoded\_len << 8) | in[1 + i];}
\DoxyCodeLine{55       \}}
\DoxyCodeLine{56    \}}
\DoxyCodeLine{57 }
\DoxyCodeLine{58    \textcolor{keywordflow}{if} (outlen != NULL) *outlen = decoded\_len;}
\DoxyCodeLine{59    \textcolor{keywordflow}{if} (decoded\_len > (*inlen - offset)) \textcolor{keywordflow}{return} \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06ca3a147cc0bbea3f8779364ad00c2678b4}{CRYPT\_OVERFLOW}};}
\DoxyCodeLine{60    *inlen = offset;}
\DoxyCodeLine{61 }
\DoxyCodeLine{62    \textcolor{keywordflow}{return} \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}};}
\DoxyCodeLine{63 \}}

\end{DoxyCode}


References C\+R\+Y\+P\+T\+\_\+\+B\+U\+F\+F\+E\+R\+\_\+\+O\+V\+E\+R\+F\+L\+OW, C\+R\+Y\+P\+T\+\_\+\+OK, C\+R\+Y\+P\+T\+\_\+\+O\+V\+E\+R\+F\+L\+OW, C\+R\+Y\+P\+T\+\_\+\+P\+K\+\_\+\+A\+S\+N1\+\_\+\+E\+R\+R\+OR, and L\+T\+C\+\_\+\+A\+R\+G\+C\+HK.



Referenced by der\+\_\+decode\+\_\+bit\+\_\+string(), der\+\_\+decode\+\_\+custom\+\_\+type\+\_\+ex(), der\+\_\+decode\+\_\+ia5\+\_\+string(), der\+\_\+decode\+\_\+integer(), der\+\_\+decode\+\_\+object\+\_\+identifier(), der\+\_\+decode\+\_\+octet\+\_\+string(), der\+\_\+decode\+\_\+printable\+\_\+string(), der\+\_\+decode\+\_\+raw\+\_\+bit\+\_\+string(), der\+\_\+decode\+\_\+sequence\+\_\+flexi(), der\+\_\+decode\+\_\+teletex\+\_\+string(), and der\+\_\+decode\+\_\+utf8\+\_\+string().

Here is the caller graph for this function\+:
% FIG 4
\mbox{\Hypertarget{tomcrypt__private_8h_aaa3acc13042e5d9244ac279a354775fe}\label{tomcrypt__private_8h_aaa3acc13042e5d9244ac279a354775fe}} 
\index{tomcrypt\_private.h@{tomcrypt\_private.h}!der\_decode\_custom\_type\_ex@{der\_decode\_custom\_type\_ex}}
\index{der\_decode\_custom\_type\_ex@{der\_decode\_custom\_type\_ex}!tomcrypt\_private.h@{tomcrypt\_private.h}}
\subsubsection{\texorpdfstring{der\_decode\_custom\_type\_ex()}{der\_decode\_custom\_type\_ex()}}
{\footnotesize\ttfamily int der\+\_\+decode\+\_\+custom\+\_\+type\+\_\+ex (\begin{DoxyParamCaption}\item[{const unsigned char $\ast$}]{in,  }\item[{unsigned long}]{inlen,  }\item[{ltc\+\_\+asn1\+\_\+list $\ast$}]{root,  }\item[{ltc\+\_\+asn1\+\_\+list $\ast$}]{list,  }\item[{unsigned long}]{outlen,  }\item[{unsigned int}]{flags }\end{DoxyParamCaption})}



Extended-\/decode a Custom type. 

This function is used to decode custom types and sequences/sets For custom types root is used For sequences/sets list and outlen are used


\begin{DoxyParams}{Parameters}
{\em in} & The D\+ER encoded input \\
\hline
{\em inlen} & The size of the input \\
\hline
{\em root} & The item that defines the custom type to decode \\
\hline
{\em list} & The list of items to decode \\
\hline
{\em outlen} & The number of items in the list \\
\hline
{\em flags} & c.\+f. enum ltc\+\_\+der\+\_\+seq \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
C\+R\+Y\+P\+T\+\_\+\+OK on success 
\end{DoxyReturn}


Definition at line 48 of file der\+\_\+decode\+\_\+custom\+\_\+type.\+c.


\begin{DoxyCode}{0}
\DoxyCodeLine{52 \{}
\DoxyCodeLine{53    \textcolor{keywordtype}{int}           err, seq\_err, i, ordered;}
\DoxyCodeLine{54    ltc\_asn1\_type type;}
\DoxyCodeLine{55    ltc\_asn1\_list ident;}
\DoxyCodeLine{56    \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} size, x, y, z, blksize;}
\DoxyCodeLine{57    \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char}* in\_new = NULL;}
\DoxyCodeLine{58    \textcolor{keywordtype}{void}          *data;}
\DoxyCodeLine{59 }
\DoxyCodeLine{60    \mbox{\hyperlink{tomcrypt__argchk_8h_a683da3e041e49f196318b6ea951414ba}{LTC\_ARGCHK}}(in   != NULL);}
\DoxyCodeLine{61 }
\DoxyCodeLine{62    \textcolor{comment}{/* get blk size */}}
\DoxyCodeLine{63    \textcolor{keywordflow}{if} (inlen < 2) \{}
\DoxyCodeLine{64       \textcolor{keywordflow}{return} \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06ca980088f10ffe9009aec286038a9e79da}{CRYPT\_INVALID\_PACKET}};}
\DoxyCodeLine{65    \}}
\DoxyCodeLine{66    x = 0;}
\DoxyCodeLine{67 }
\DoxyCodeLine{68    \textcolor{keywordflow}{if} (root == NULL) \{}
\DoxyCodeLine{69       \mbox{\hyperlink{tomcrypt__argchk_8h_a683da3e041e49f196318b6ea951414ba}{LTC\_ARGCHK}}(list != NULL);}
\DoxyCodeLine{70 }
\DoxyCodeLine{71       \textcolor{comment}{/* sequence type? We allow 0x30 SEQUENCE and 0x31 SET since fundamentally they're the same structure */}}
\DoxyCodeLine{72       \textcolor{keywordflow}{if} (in[x] != 0x30 \&\& in[x] != 0x31) \{}
\DoxyCodeLine{73          \textcolor{keywordflow}{return} \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06ca980088f10ffe9009aec286038a9e79da}{CRYPT\_INVALID\_PACKET}};}
\DoxyCodeLine{74       \}}
\DoxyCodeLine{75       ++x;}
\DoxyCodeLine{76    \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{77       \textcolor{keywordflow}{if} (root->type != LTC\_ASN1\_CUSTOM\_TYPE) \{}
\DoxyCodeLine{78          \textcolor{keywordflow}{return} \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06ca980088f10ffe9009aec286038a9e79da}{CRYPT\_INVALID\_PACKET}};}
\DoxyCodeLine{79       \}}
\DoxyCodeLine{80 }
\DoxyCodeLine{81       \textcolor{comment}{/* Alloc a copy of the data for primitive handling. */}}
\DoxyCodeLine{82       \textcolor{keywordflow}{if} (root->pc == LTC\_ASN1\_PC\_PRIMITIVE) \{}
\DoxyCodeLine{83          in\_new = \mbox{\hyperlink{tomcrypt__cfg_8h_af363355f38fbaacdefacf270436ae1c9}{XMALLOC}}(inlen);}
\DoxyCodeLine{84          \textcolor{keywordflow}{if} (in\_new == NULL) \{}
\DoxyCodeLine{85             \textcolor{keywordflow}{return} \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06ca0ce0d27adc7ea10b74b7ea904b8bfa82}{CRYPT\_MEM}};}
\DoxyCodeLine{86          \}}
\DoxyCodeLine{87          \mbox{\hyperlink{tomcrypt__cfg_8h_a7691dd48d60d5fc6daf2fa7ec4c55e12}{XMEMCPY}}(in\_new, in, inlen);}
\DoxyCodeLine{88          in = in\_new;}
\DoxyCodeLine{89       \}}
\DoxyCodeLine{90 }
\DoxyCodeLine{91       y = inlen;}
\DoxyCodeLine{92       \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{tomcrypt__private_8h_a651ad7c1f5a930476bb10b9d61555346}{der\_decode\_asn1\_identifier}}(in, \&y, \&ident)) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}}) \{}
\DoxyCodeLine{93          \textcolor{keywordflow}{goto} LBL\_ERR;}
\DoxyCodeLine{94       \}}
\DoxyCodeLine{95       \textcolor{keywordflow}{if} ((ident.type != root->type) ||}
\DoxyCodeLine{96             (ident.klass != root->klass) ||}
\DoxyCodeLine{97             (ident.pc != root->pc) ||}
\DoxyCodeLine{98             (ident.tag != root->tag)) \{}
\DoxyCodeLine{99          err = \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06ca980088f10ffe9009aec286038a9e79da}{CRYPT\_INVALID\_PACKET}};}
\DoxyCodeLine{100          \textcolor{keywordflow}{goto} LBL\_ERR;}
\DoxyCodeLine{101       \}}
\DoxyCodeLine{102       x += y;}
\DoxyCodeLine{103 }
\DoxyCodeLine{104       list = root->data;}
\DoxyCodeLine{105       outlen = root->size;}
\DoxyCodeLine{106    \}}
\DoxyCodeLine{107 }
\DoxyCodeLine{108    \textcolor{keywordflow}{if} (root != NULL \&\& root->pc == LTC\_ASN1\_PC\_PRIMITIVE) \{}
\DoxyCodeLine{109       \textcolor{keywordflow}{if} (((\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long})root->used >= \mbox{\hyperlink{tomcrypt__private_8h_ae8d2a220c8f5b51d2db97b0382a9f206}{der\_asn1\_type\_to\_identifier\_map\_sz}}) ||}
\DoxyCodeLine{110             (\mbox{\hyperlink{tomcrypt__private_8h_a6306ca88074facac89ee0f6c04cbf2f2}{der\_asn1\_type\_to\_identifier\_map}}[root->used] == -1)) \{}
\DoxyCodeLine{111          err = \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06ca980088f10ffe9009aec286038a9e79da}{CRYPT\_INVALID\_PACKET}};}
\DoxyCodeLine{112          \textcolor{keywordflow}{goto} LBL\_ERR;}
\DoxyCodeLine{113       \}}
\DoxyCodeLine{114 }
\DoxyCodeLine{115       root->type = (ltc\_asn1\_type)root->used;}
\DoxyCodeLine{116       list = root;}
\DoxyCodeLine{117       outlen = 1;}
\DoxyCodeLine{118 }
\DoxyCodeLine{119       x -= 1;}
\DoxyCodeLine{120       in\_new[x] = (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char})\mbox{\hyperlink{tomcrypt__private_8h_a6306ca88074facac89ee0f6c04cbf2f2}{der\_asn1\_type\_to\_identifier\_map}}[list[0].type];}
\DoxyCodeLine{121       blksize = inlen - x;}
\DoxyCodeLine{122    \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{123 }
\DoxyCodeLine{124       y = inlen - x;}
\DoxyCodeLine{125       \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{tomcrypt__private_8h_af90423764098b8876368d0984d96053a}{der\_decode\_asn1\_length}}(\&in[x], \&y, \&blksize)) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}}) \{}
\DoxyCodeLine{126          \textcolor{keywordflow}{goto} LBL\_ERR;}
\DoxyCodeLine{127       \}}
\DoxyCodeLine{128       x += y;}
\DoxyCodeLine{129    \}}
\DoxyCodeLine{130 }
\DoxyCodeLine{131    \textcolor{comment}{/* would this blksize overflow? */}}
\DoxyCodeLine{132    \textcolor{keywordflow}{if} (blksize > (inlen - x)) \{}
\DoxyCodeLine{133       err = \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06ca980088f10ffe9009aec286038a9e79da}{CRYPT\_INVALID\_PACKET}};}
\DoxyCodeLine{134       \textcolor{keywordflow}{goto} LBL\_ERR;}
\DoxyCodeLine{135    \}}
\DoxyCodeLine{136 }
\DoxyCodeLine{137    \textcolor{comment}{/* mark all as unused */}}
\DoxyCodeLine{138    \textcolor{keywordflow}{for} (i = 0; i < (int)outlen; i++) \{}
\DoxyCodeLine{139        list[i].used = 0;}
\DoxyCodeLine{140    \}}
\DoxyCodeLine{141    ordered = flags \& LTC\_DER\_SEQ\_ORDERED;}
\DoxyCodeLine{142 }
\DoxyCodeLine{143    \textcolor{comment}{/* ok read data */}}
\DoxyCodeLine{144    seq\_err  = \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}};}
\DoxyCodeLine{145    blksize += x;}
\DoxyCodeLine{146    inlen   -= x;}
\DoxyCodeLine{147    \textcolor{keywordflow}{for} (i = 0; i < (int)outlen; i++) \{}
\DoxyCodeLine{148        z    = 0;}
\DoxyCodeLine{149        type = list[i].type;}
\DoxyCodeLine{150        size = list[i].size;}
\DoxyCodeLine{151        data = list[i].data;}
\DoxyCodeLine{152        \textcolor{keywordflow}{if} (!ordered \&\& list[i].used == 1) \{ \textcolor{keywordflow}{continue}; \}}
\DoxyCodeLine{153 }
\DoxyCodeLine{154        \textcolor{keywordflow}{if} (type == LTC\_ASN1\_EOL) \{}
\DoxyCodeLine{155           \textcolor{keywordflow}{break};}
\DoxyCodeLine{156        \}}
\DoxyCodeLine{157 }
\DoxyCodeLine{158        \textcolor{keywordflow}{if} (root != NULL \&\& root->pc == LTC\_ASN1\_PC\_PRIMITIVE \&\& i != 0) \{}
\DoxyCodeLine{159           err = \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06ca001cb5383cce7c4581790abe472e816f}{CRYPT\_PK\_ASN1\_ERROR}};}
\DoxyCodeLine{160           \textcolor{keywordflow}{goto} LBL\_ERR;}
\DoxyCodeLine{161        \}}
\DoxyCodeLine{162 }
\DoxyCodeLine{163        \textcolor{keywordflow}{switch} (type) \{}
\DoxyCodeLine{164            \textcolor{keywordflow}{case} LTC\_ASN1\_BOOLEAN:}
\DoxyCodeLine{165                z = inlen;}
\DoxyCodeLine{166                \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{der__decode__boolean_8c_a5c72faaf0b34b18bd92db4d95e211a9d}{der\_decode\_boolean}}(in + x, z, ((\textcolor{keywordtype}{int} *)data))) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}}) \{}
\DoxyCodeLine{167                   \textcolor{keywordflow}{if} (!ordered || list[i].optional) \{ \textcolor{keywordflow}{continue}; \}}
\DoxyCodeLine{168                   \textcolor{keywordflow}{goto} LBL\_ERR;}
\DoxyCodeLine{169                \}}
\DoxyCodeLine{170                \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{der__length__boolean_8c_aa90c23682da0279cbe55ea64b2c3e381}{der\_length\_boolean}}(\&z)) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}}) \{}
\DoxyCodeLine{171                   \textcolor{keywordflow}{goto} LBL\_ERR;}
\DoxyCodeLine{172                \}}
\DoxyCodeLine{173                \textcolor{keywordflow}{break};}
\DoxyCodeLine{174 }
\DoxyCodeLine{175            \textcolor{keywordflow}{case} LTC\_ASN1\_INTEGER:}
\DoxyCodeLine{176                z = inlen;}
\DoxyCodeLine{177                \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{der__decode__integer_8c_ac5b0a7020165ada29ba6278fe128599d}{der\_decode\_integer}}(in + x, z, data)) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}}) \{}
\DoxyCodeLine{178                   \textcolor{keywordflow}{if} (!ordered || list[i].optional) \{ \textcolor{keywordflow}{continue}; \}}
\DoxyCodeLine{179                   \textcolor{keywordflow}{goto} LBL\_ERR;}
\DoxyCodeLine{180                \}}
\DoxyCodeLine{181                \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{der__length__integer_8c_af27dfc46ec4a482af05a2265a9d31ca3}{der\_length\_integer}}(data, \&z)) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}}) \{}
\DoxyCodeLine{182                   \textcolor{keywordflow}{goto} LBL\_ERR;}
\DoxyCodeLine{183                \}}
\DoxyCodeLine{184                \textcolor{keywordflow}{break};}
\DoxyCodeLine{185 }
\DoxyCodeLine{186            \textcolor{keywordflow}{case} LTC\_ASN1\_SHORT\_INTEGER:}
\DoxyCodeLine{187                z = inlen;}
\DoxyCodeLine{188                \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{der__decode__short__integer_8c_a1f8c5c4ead2ebe96a1a852329c62154c}{der\_decode\_short\_integer}}(in + x, z, data)) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}}) \{}
\DoxyCodeLine{189                   \textcolor{keywordflow}{if} (!ordered || list[i].optional) \{ \textcolor{keywordflow}{continue}; \}}
\DoxyCodeLine{190                   \textcolor{keywordflow}{goto} LBL\_ERR;}
\DoxyCodeLine{191                \}}
\DoxyCodeLine{192                \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{der__length__short__integer_8c_aa3bac08094cc8142ac313d818cf73fb0}{der\_length\_short\_integer}}(((\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long}*)data)[0], \&z)) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}}) \{}
\DoxyCodeLine{193                   \textcolor{keywordflow}{goto} LBL\_ERR;}
\DoxyCodeLine{194                \}}
\DoxyCodeLine{195 }
\DoxyCodeLine{196                \textcolor{keywordflow}{break};}
\DoxyCodeLine{197 }
\DoxyCodeLine{198            \textcolor{keywordflow}{case} LTC\_ASN1\_BIT\_STRING:}
\DoxyCodeLine{199                z = inlen;}
\DoxyCodeLine{200                \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{der__decode__bit__string_8c_a0a0c371e559e6b455cc4a052d962226f}{der\_decode\_bit\_string}}(in + x, z, data, \&size)) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}}) \{}
\DoxyCodeLine{201                   \textcolor{keywordflow}{if} (!ordered || list[i].optional) \{ \textcolor{keywordflow}{continue}; \}}
\DoxyCodeLine{202                   \textcolor{keywordflow}{goto} LBL\_ERR;}
\DoxyCodeLine{203                \}}
\DoxyCodeLine{204                list[i].size = size;}
\DoxyCodeLine{205                \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{der__length__bit__string_8c_a73416248e2f93535d54603567acc9cfd}{der\_length\_bit\_string}}(size, \&z)) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}}) \{}
\DoxyCodeLine{206                   \textcolor{keywordflow}{goto} LBL\_ERR;}
\DoxyCodeLine{207                \}}
\DoxyCodeLine{208                \textcolor{keywordflow}{break};}
\DoxyCodeLine{209 }
\DoxyCodeLine{210            \textcolor{keywordflow}{case} LTC\_ASN1\_RAW\_BIT\_STRING:}
\DoxyCodeLine{211                z = inlen;}
\DoxyCodeLine{212                \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{der__decode__raw__bit__string_8c_a4e8241401c8f49b3b2dbadd1b8e0eee0}{der\_decode\_raw\_bit\_string}}(in + x, z, data, \&size)) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}}) \{}
\DoxyCodeLine{213                   \textcolor{keywordflow}{if} (!ordered || list[i].optional) \{ \textcolor{keywordflow}{continue}; \}}
\DoxyCodeLine{214                   \textcolor{keywordflow}{goto} LBL\_ERR;}
\DoxyCodeLine{215                \}}
\DoxyCodeLine{216                list[i].size = size;}
\DoxyCodeLine{217                \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{der__length__bit__string_8c_a73416248e2f93535d54603567acc9cfd}{der\_length\_bit\_string}}(size, \&z)) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}}) \{}
\DoxyCodeLine{218                   \textcolor{keywordflow}{goto} LBL\_ERR;}
\DoxyCodeLine{219                \}}
\DoxyCodeLine{220                \textcolor{keywordflow}{break};}
\DoxyCodeLine{221 }
\DoxyCodeLine{222            \textcolor{keywordflow}{case} LTC\_ASN1\_OCTET\_STRING:}
\DoxyCodeLine{223                z = inlen;}
\DoxyCodeLine{224                \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{der__decode__octet__string_8c_af315ce6a951697ede7ec4c9716b5b20b}{der\_decode\_octet\_string}}(in + x, z, data, \&size)) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}}) \{}
\DoxyCodeLine{225                   \textcolor{keywordflow}{if} (!ordered || list[i].optional) \{ \textcolor{keywordflow}{continue}; \}}
\DoxyCodeLine{226                   \textcolor{keywordflow}{goto} LBL\_ERR;}
\DoxyCodeLine{227                \}}
\DoxyCodeLine{228                list[i].size = size;}
\DoxyCodeLine{229                \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{der__length__octet__string_8c_a65b2f3065d3f51608a1dfa3b284a74df}{der\_length\_octet\_string}}(size, \&z)) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}}) \{}
\DoxyCodeLine{230                   \textcolor{keywordflow}{goto} LBL\_ERR;}
\DoxyCodeLine{231                \}}
\DoxyCodeLine{232                \textcolor{keywordflow}{break};}
\DoxyCodeLine{233 }
\DoxyCodeLine{234            \textcolor{keywordflow}{case} LTC\_ASN1\_NULL:}
\DoxyCodeLine{235                \textcolor{keywordflow}{if} (inlen < 2 || in[x] != 0x05 || in[x+1] != 0x00) \{}
\DoxyCodeLine{236                   \textcolor{keywordflow}{if} (!ordered || list[i].optional) \{ \textcolor{keywordflow}{continue}; \}}
\DoxyCodeLine{237                   err = \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06ca980088f10ffe9009aec286038a9e79da}{CRYPT\_INVALID\_PACKET}};}
\DoxyCodeLine{238                   \textcolor{keywordflow}{goto} LBL\_ERR;}
\DoxyCodeLine{239                \}}
\DoxyCodeLine{240                z = 2;}
\DoxyCodeLine{241                \textcolor{keywordflow}{break};}
\DoxyCodeLine{242 }
\DoxyCodeLine{243            \textcolor{keywordflow}{case} LTC\_ASN1\_OBJECT\_IDENTIFIER:}
\DoxyCodeLine{244                z = inlen;}
\DoxyCodeLine{245                \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{der__decode__object__identifier_8c_aee91111fe2b92dca6c83e6c7de36be8f}{der\_decode\_object\_identifier}}(in + x, z, data, \&size)) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}}) \{}
\DoxyCodeLine{246                   \textcolor{keywordflow}{if} (!ordered || list[i].optional) \{ \textcolor{keywordflow}{continue}; \}}
\DoxyCodeLine{247                   \textcolor{keywordflow}{goto} LBL\_ERR;}
\DoxyCodeLine{248                \}}
\DoxyCodeLine{249                list[i].size = size;}
\DoxyCodeLine{250                \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{der__length__object__identifier_8c_ae1fe5b2cd3f20a693cc571a2a8fc9af0}{der\_length\_object\_identifier}}(data, size, \&z)) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}}) \{}
\DoxyCodeLine{251                   \textcolor{keywordflow}{goto} LBL\_ERR;}
\DoxyCodeLine{252                \}}
\DoxyCodeLine{253                \textcolor{keywordflow}{break};}
\DoxyCodeLine{254 }
\DoxyCodeLine{255            \textcolor{keywordflow}{case} LTC\_ASN1\_TELETEX\_STRING:}
\DoxyCodeLine{256                z = inlen;}
\DoxyCodeLine{257                \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{der__decode__teletex__string_8c_a926dc4d05a1a0243569ea85ff85901b6}{der\_decode\_teletex\_string}}(in + x, z, data, \&size)) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}}) \{}
\DoxyCodeLine{258                   \textcolor{keywordflow}{if} (!ordered || list[i].optional) \{ \textcolor{keywordflow}{continue}; \}}
\DoxyCodeLine{259                   \textcolor{keywordflow}{goto} LBL\_ERR;}
\DoxyCodeLine{260                \}}
\DoxyCodeLine{261                list[i].size = size;}
\DoxyCodeLine{262                \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{der__length__teletex__string_8c_a2b3c8aa9d2c26839f9100fdc0286cd93}{der\_length\_teletex\_string}}(data, size, \&z)) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}}) \{}
\DoxyCodeLine{263                   \textcolor{keywordflow}{goto} LBL\_ERR;}
\DoxyCodeLine{264                \}}
\DoxyCodeLine{265                \textcolor{keywordflow}{break};}
\DoxyCodeLine{266 }
\DoxyCodeLine{267            \textcolor{keywordflow}{case} LTC\_ASN1\_IA5\_STRING:}
\DoxyCodeLine{268                z = inlen;}
\DoxyCodeLine{269                \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{der__decode__ia5__string_8c_ac2868573a2a8857a8463337d8411fe79}{der\_decode\_ia5\_string}}(in + x, z, data, \&size)) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}}) \{}
\DoxyCodeLine{270                   \textcolor{keywordflow}{if} (!ordered || list[i].optional) \{ \textcolor{keywordflow}{continue}; \}}
\DoxyCodeLine{271                   \textcolor{keywordflow}{goto} LBL\_ERR;}
\DoxyCodeLine{272                \}}
\DoxyCodeLine{273                list[i].size = size;}
\DoxyCodeLine{274                \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{der__length__ia5__string_8c_a37e6cf2c534040fe726a760956eade04}{der\_length\_ia5\_string}}(data, size, \&z)) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}}) \{}
\DoxyCodeLine{275                   \textcolor{keywordflow}{goto} LBL\_ERR;}
\DoxyCodeLine{276                \}}
\DoxyCodeLine{277                \textcolor{keywordflow}{break};}
\DoxyCodeLine{278 }
\DoxyCodeLine{279            \textcolor{keywordflow}{case} LTC\_ASN1\_PRINTABLE\_STRING:}
\DoxyCodeLine{280                z = inlen;}
\DoxyCodeLine{281                \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{der__decode__printable__string_8c_a0967e5db58c3ce6b0971b5c5097c0d9f}{der\_decode\_printable\_string}}(in + x, z, data, \&size)) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}}) \{}
\DoxyCodeLine{282                   \textcolor{keywordflow}{if} (!ordered || list[i].optional) \{ \textcolor{keywordflow}{continue}; \}}
\DoxyCodeLine{283                   \textcolor{keywordflow}{goto} LBL\_ERR;}
\DoxyCodeLine{284                \}}
\DoxyCodeLine{285                list[i].size = size;}
\DoxyCodeLine{286                \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{der__length__printable__string_8c_ac206210b58e1bac2342a80d26bd802db}{der\_length\_printable\_string}}(data, size, \&z)) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}}) \{}
\DoxyCodeLine{287                   \textcolor{keywordflow}{goto} LBL\_ERR;}
\DoxyCodeLine{288                \}}
\DoxyCodeLine{289                \textcolor{keywordflow}{break};}
\DoxyCodeLine{290 }
\DoxyCodeLine{291            \textcolor{keywordflow}{case} LTC\_ASN1\_UTF8\_STRING:}
\DoxyCodeLine{292                z = inlen;}
\DoxyCodeLine{293                \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{der__decode__utf8__string_8c_afc867f0f02273fac931669abded4cbb3}{der\_decode\_utf8\_string}}(in + x, z, data, \&size)) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}}) \{}
\DoxyCodeLine{294                   \textcolor{keywordflow}{if} (!ordered || list[i].optional) \{ \textcolor{keywordflow}{continue}; \}}
\DoxyCodeLine{295                   \textcolor{keywordflow}{goto} LBL\_ERR;}
\DoxyCodeLine{296                \}}
\DoxyCodeLine{297                list[i].size = size;}
\DoxyCodeLine{298                \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{der__length__utf8__string_8c_aa8b54979c2261c4d703c9464e0bb14c1}{der\_length\_utf8\_string}}(data, size, \&z)) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}}) \{}
\DoxyCodeLine{299                   \textcolor{keywordflow}{goto} LBL\_ERR;}
\DoxyCodeLine{300                \}}
\DoxyCodeLine{301                \textcolor{keywordflow}{break};}
\DoxyCodeLine{302 }
\DoxyCodeLine{303            \textcolor{keywordflow}{case} LTC\_ASN1\_UTCTIME:}
\DoxyCodeLine{304                z = inlen;}
\DoxyCodeLine{305                \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{der__decode__utctime_8c_a228dad2e418af24965b9b16188d61aac}{der\_decode\_utctime}}(in + x, \&z, data)) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}}) \{}
\DoxyCodeLine{306                   \textcolor{keywordflow}{if} (!ordered || list[i].optional) \{ \textcolor{keywordflow}{continue}; \}}
\DoxyCodeLine{307                   \textcolor{keywordflow}{goto} LBL\_ERR;}
\DoxyCodeLine{308                \}}
\DoxyCodeLine{309                \textcolor{keywordflow}{break};}
\DoxyCodeLine{310 }
\DoxyCodeLine{311            \textcolor{keywordflow}{case} LTC\_ASN1\_GENERALIZEDTIME:}
\DoxyCodeLine{312                z = inlen;}
\DoxyCodeLine{313                \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{der__decode__generalizedtime_8c_acca5d83c0dcc2bc67d724318132f66e1}{der\_decode\_generalizedtime}}(in + x, \&z, data)) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}}) \{}
\DoxyCodeLine{314                   \textcolor{keywordflow}{if} (!ordered || list[i].optional) \{ \textcolor{keywordflow}{continue}; \}}
\DoxyCodeLine{315                   \textcolor{keywordflow}{goto} LBL\_ERR;}
\DoxyCodeLine{316                \}}
\DoxyCodeLine{317                \textcolor{keywordflow}{break};}
\DoxyCodeLine{318 }
\DoxyCodeLine{319            \textcolor{keywordflow}{case} LTC\_ASN1\_SET:}
\DoxyCodeLine{320                z = inlen;}
\DoxyCodeLine{321                \textcolor{keywordflow}{if} ((err = der\_decode\_set(in + x, z, data, size)) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}}) \{}
\DoxyCodeLine{322                   \textcolor{keywordflow}{if} (!ordered || list[i].optional) \{ \textcolor{keywordflow}{continue}; \}}
\DoxyCodeLine{323                   \textcolor{keywordflow}{goto} LBL\_ERR;}
\DoxyCodeLine{324                \}}
\DoxyCodeLine{325                \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{der__length__sequence_8c_a46c60ff7d1e17a527913809bffe41546}{der\_length\_sequence}}(data, size, \&z)) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}}) \{}
\DoxyCodeLine{326                   \textcolor{keywordflow}{goto} LBL\_ERR;}
\DoxyCodeLine{327                \}}
\DoxyCodeLine{328                \textcolor{keywordflow}{break};}
\DoxyCodeLine{329 }
\DoxyCodeLine{330            \textcolor{keywordflow}{case} LTC\_ASN1\_SETOF:}
\DoxyCodeLine{331            \textcolor{keywordflow}{case} LTC\_ASN1\_SEQUENCE:}
\DoxyCodeLine{332                \textcolor{comment}{/* detect if we have the right type */}}
\DoxyCodeLine{333                \textcolor{keywordflow}{if} ((type == LTC\_ASN1\_SETOF \&\& (in[x] \& 0x3F) != 0x31) || (type == LTC\_ASN1\_SEQUENCE \&\& (in[x] \& 0x3F) != 0x30)) \{}
\DoxyCodeLine{334                   err = \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06ca980088f10ffe9009aec286038a9e79da}{CRYPT\_INVALID\_PACKET}};}
\DoxyCodeLine{335                   \textcolor{keywordflow}{goto} LBL\_ERR;}
\DoxyCodeLine{336                \}}
\DoxyCodeLine{337 }
\DoxyCodeLine{338                z = inlen;}
\DoxyCodeLine{339                err = \mbox{\hyperlink{der__decode__sequence__ex_8c_a388cbc3f5c404637bc51f9dfb2d4f677}{der\_decode\_sequence\_ex}}(in + x, z, data, size, flags);}
\DoxyCodeLine{340                \textcolor{keywordflow}{if} (err == \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cadf938469ecf1be83eff1b661288fae7a}{CRYPT\_INPUT\_TOO\_LONG}}) \{}
\DoxyCodeLine{341                   seq\_err = \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cadf938469ecf1be83eff1b661288fae7a}{CRYPT\_INPUT\_TOO\_LONG}};}
\DoxyCodeLine{342                   err = \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}};}
\DoxyCodeLine{343                \}}
\DoxyCodeLine{344                \textcolor{keywordflow}{if} (err != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}}) \{}
\DoxyCodeLine{345                   \textcolor{keywordflow}{if} (!ordered || list[i].optional) \{ \textcolor{keywordflow}{continue}; \}}
\DoxyCodeLine{346                   \textcolor{keywordflow}{goto} LBL\_ERR;}
\DoxyCodeLine{347                \}}
\DoxyCodeLine{348                \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{der__length__sequence_8c_a46c60ff7d1e17a527913809bffe41546}{der\_length\_sequence}}(data, size, \&z)) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}}) \{}
\DoxyCodeLine{349                   \textcolor{keywordflow}{goto} LBL\_ERR;}
\DoxyCodeLine{350                \}}
\DoxyCodeLine{351                \textcolor{keywordflow}{break};}
\DoxyCodeLine{352 }
\DoxyCodeLine{353            \textcolor{keywordflow}{case} LTC\_ASN1\_CUSTOM\_TYPE:}
\DoxyCodeLine{354                z = inlen;}
\DoxyCodeLine{355                err = \mbox{\hyperlink{der__decode__custom__type_8c_a698f6c64586707819ebd6f90a14264e8}{der\_decode\_custom\_type}}(in + x, z, \&list[i]);}
\DoxyCodeLine{356                \textcolor{keywordflow}{if} (err == \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cadf938469ecf1be83eff1b661288fae7a}{CRYPT\_INPUT\_TOO\_LONG}}) \{}
\DoxyCodeLine{357                   seq\_err = \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cadf938469ecf1be83eff1b661288fae7a}{CRYPT\_INPUT\_TOO\_LONG}};}
\DoxyCodeLine{358                   err = \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}};}
\DoxyCodeLine{359                \}}
\DoxyCodeLine{360                \textcolor{keywordflow}{if} (err != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}}) \{}
\DoxyCodeLine{361                   \textcolor{keywordflow}{if} (!ordered || list[i].optional) \{ \textcolor{keywordflow}{continue}; \}}
\DoxyCodeLine{362                   \textcolor{keywordflow}{goto} LBL\_ERR;}
\DoxyCodeLine{363                \}}
\DoxyCodeLine{364                \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{der__length__custom__type_8c_aff691792e4f0be46252fad3b9aa4955c}{der\_length\_custom\_type}}(\&list[i], \&z, NULL)) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}}) \{}
\DoxyCodeLine{365                   \textcolor{keywordflow}{goto} LBL\_ERR;}
\DoxyCodeLine{366                \}}
\DoxyCodeLine{367                \textcolor{keywordflow}{break};}
\DoxyCodeLine{368 }
\DoxyCodeLine{369            \textcolor{keywordflow}{case} LTC\_ASN1\_CHOICE:}
\DoxyCodeLine{370                z = inlen;}
\DoxyCodeLine{371                \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{der__decode__choice_8c_abbc3f8406cbf0c2d75b1c801192dcad4}{der\_decode\_choice}}(in + x, \&z, data, size)) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}}) \{}
\DoxyCodeLine{372                   \textcolor{keywordflow}{if} (!ordered || list[i].optional) \{ \textcolor{keywordflow}{continue}; \}}
\DoxyCodeLine{373                   \textcolor{keywordflow}{goto} LBL\_ERR;}
\DoxyCodeLine{374                \}}
\DoxyCodeLine{375                \textcolor{keywordflow}{break};}
\DoxyCodeLine{376 }
\DoxyCodeLine{377            \textcolor{keywordflow}{case} LTC\_ASN1\_EOL:}
\DoxyCodeLine{378                err = \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06ca92aa8bad3930f08d5a188bf72094b066}{CRYPT\_INVALID\_ARG}};}
\DoxyCodeLine{379                \textcolor{keywordflow}{goto} LBL\_ERR;}
\DoxyCodeLine{380        \}}
\DoxyCodeLine{381        x           += z;}
\DoxyCodeLine{382        inlen       -= z;}
\DoxyCodeLine{383        list[i].used = 1;}
\DoxyCodeLine{384        \textcolor{keywordflow}{if} (!ordered) \{}
\DoxyCodeLine{385           \textcolor{comment}{/* restart the decoder */}}
\DoxyCodeLine{386           i = -1;}
\DoxyCodeLine{387        \}}
\DoxyCodeLine{388    \}}
\DoxyCodeLine{389 }
\DoxyCodeLine{390    \textcolor{keywordflow}{for} (i = 0; i < (int)outlen; i++) \{}
\DoxyCodeLine{391       \textcolor{keywordflow}{if} (list[i].used == 0 \&\& list[i].optional == 0) \{}
\DoxyCodeLine{392           err = \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06ca980088f10ffe9009aec286038a9e79da}{CRYPT\_INVALID\_PACKET}};}
\DoxyCodeLine{393           \textcolor{keywordflow}{goto} LBL\_ERR;}
\DoxyCodeLine{394       \}}
\DoxyCodeLine{395    \}}
\DoxyCodeLine{396 }
\DoxyCodeLine{397    \textcolor{keywordflow}{if} (blksize == x \&\& seq\_err == \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}} \&\& inlen == 0) \{}
\DoxyCodeLine{398       \textcolor{comment}{/* everything decoded and no errors in nested sequences */}}
\DoxyCodeLine{399       err = \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}};}
\DoxyCodeLine{400    \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (blksize == x \&\& seq\_err == \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cadf938469ecf1be83eff1b661288fae7a}{CRYPT\_INPUT\_TOO\_LONG}} \&\& inlen == 0) \{}
\DoxyCodeLine{401       \textcolor{comment}{/* a sequence reported too-long input, but now we've decoded everything */}}
\DoxyCodeLine{402       err = \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}};}
\DoxyCodeLine{403    \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (blksize != x \&\& ((flags \& LTC\_DER\_SEQ\_STRICT) == LTC\_DER\_SEQ\_STRICT)) \{}
\DoxyCodeLine{404       err = \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06ca980088f10ffe9009aec286038a9e79da}{CRYPT\_INVALID\_PACKET}};}
\DoxyCodeLine{405    \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{406       err = \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cadf938469ecf1be83eff1b661288fae7a}{CRYPT\_INPUT\_TOO\_LONG}};}
\DoxyCodeLine{407    \}}
\DoxyCodeLine{408 }
\DoxyCodeLine{409 LBL\_ERR:}
\DoxyCodeLine{410    \textcolor{keywordflow}{if} (in\_new != NULL) \{}
\DoxyCodeLine{411       \mbox{\hyperlink{tomcrypt__cfg_8h_a260d66fc0690e0502cf3bfe7b5244b75}{XFREE}}(in\_new);}
\DoxyCodeLine{412    \}}
\DoxyCodeLine{413    \textcolor{keywordflow}{return} err;}
\DoxyCodeLine{414 \}}

\end{DoxyCode}


References C\+R\+Y\+P\+T\+\_\+\+I\+N\+P\+U\+T\+\_\+\+T\+O\+O\+\_\+\+L\+O\+NG, C\+R\+Y\+P\+T\+\_\+\+I\+N\+V\+A\+L\+I\+D\+\_\+\+A\+RG, C\+R\+Y\+P\+T\+\_\+\+I\+N\+V\+A\+L\+I\+D\+\_\+\+P\+A\+C\+K\+ET, C\+R\+Y\+P\+T\+\_\+\+M\+EM, C\+R\+Y\+P\+T\+\_\+\+OK, C\+R\+Y\+P\+T\+\_\+\+P\+K\+\_\+\+A\+S\+N1\+\_\+\+E\+R\+R\+OR, der\+\_\+asn1\+\_\+type\+\_\+to\+\_\+identifier\+\_\+map, der\+\_\+asn1\+\_\+type\+\_\+to\+\_\+identifier\+\_\+map\+\_\+sz, der\+\_\+decode\+\_\+asn1\+\_\+identifier(), der\+\_\+decode\+\_\+asn1\+\_\+length(), der\+\_\+decode\+\_\+bit\+\_\+string(), der\+\_\+decode\+\_\+boolean(), der\+\_\+decode\+\_\+choice(), der\+\_\+decode\+\_\+custom\+\_\+type(), der\+\_\+decode\+\_\+generalizedtime(), der\+\_\+decode\+\_\+ia5\+\_\+string(), der\+\_\+decode\+\_\+integer(), der\+\_\+decode\+\_\+object\+\_\+identifier(), der\+\_\+decode\+\_\+octet\+\_\+string(), der\+\_\+decode\+\_\+printable\+\_\+string(), der\+\_\+decode\+\_\+raw\+\_\+bit\+\_\+string(), der\+\_\+decode\+\_\+sequence\+\_\+ex(), der\+\_\+decode\+\_\+short\+\_\+integer(), der\+\_\+decode\+\_\+teletex\+\_\+string(), der\+\_\+decode\+\_\+utctime(), der\+\_\+decode\+\_\+utf8\+\_\+string(), der\+\_\+length\+\_\+bit\+\_\+string(), der\+\_\+length\+\_\+boolean(), der\+\_\+length\+\_\+custom\+\_\+type(), der\+\_\+length\+\_\+ia5\+\_\+string(), der\+\_\+length\+\_\+integer(), der\+\_\+length\+\_\+object\+\_\+identifier(), der\+\_\+length\+\_\+octet\+\_\+string(), der\+\_\+length\+\_\+printable\+\_\+string(), der\+\_\+length\+\_\+sequence(), der\+\_\+length\+\_\+short\+\_\+integer(), der\+\_\+length\+\_\+teletex\+\_\+string(), der\+\_\+length\+\_\+utf8\+\_\+string(), L\+T\+C\+\_\+\+A\+R\+G\+C\+HK, X\+F\+R\+E\+E(), X\+M\+A\+L\+L\+O\+C(), and X\+M\+E\+M\+C\+P\+Y().



Referenced by der\+\_\+decode\+\_\+custom\+\_\+type(), and der\+\_\+decode\+\_\+sequence\+\_\+ex().

Here is the call graph for this function\+:
% FIG 5
Here is the caller graph for this function\+:
% FIG 6
\mbox{\Hypertarget{tomcrypt__private_8h_ab5141cf36663054d9ec6e46ed6909fce}\label{tomcrypt__private_8h_ab5141cf36663054d9ec6e46ed6909fce}} 
\index{tomcrypt\_private.h@{tomcrypt\_private.h}!der\_decode\_sequence\_multi\_ex@{der\_decode\_sequence\_multi\_ex}}
\index{der\_decode\_sequence\_multi\_ex@{der\_decode\_sequence\_multi\_ex}!tomcrypt\_private.h@{tomcrypt\_private.h}}
\subsubsection{\texorpdfstring{der\_decode\_sequence\_multi\_ex()}{der\_decode\_sequence\_multi\_ex()}}
{\footnotesize\ttfamily int der\+\_\+decode\+\_\+sequence\+\_\+multi\+\_\+ex (\begin{DoxyParamCaption}\item[{const unsigned char $\ast$}]{in,  }\item[{unsigned long}]{inlen,  }\item[{unsigned int}]{flags,  }\item[{}]{... }\end{DoxyParamCaption})}



Decode a S\+E\+Q\+U\+E\+N\+CE type using a VA list. 


\begin{DoxyParams}{Parameters}
{\em in} & Input buffer \\
\hline
{\em inlen} & Length of input in octets \\
\hline
{\em flags} & c.\+f. enum ltc\+\_\+der\+\_\+seq \\
\hline
\end{DoxyParams}
\begin{DoxyRemark}{Remarks}
$<$...$>$ is of the form $<$type, size, data$>$ (int, unsigned long, void$\ast$) 
\end{DoxyRemark}
\begin{DoxyReturn}{Returns}
C\+R\+Y\+P\+T\+\_\+\+OK on success 
\end{DoxyReturn}


Definition at line 167 of file der\+\_\+decode\+\_\+sequence\+\_\+multi.\+c.


\begin{DoxyCode}{0}
\DoxyCodeLine{168 \{}
\DoxyCodeLine{169    va\_list       a1, a2;}
\DoxyCodeLine{170    \textcolor{keywordtype}{int} err;}
\DoxyCodeLine{171 }
\DoxyCodeLine{172    \mbox{\hyperlink{tomcrypt__argchk_8h_a683da3e041e49f196318b6ea951414ba}{LTC\_ARGCHK}}(in    != NULL);}
\DoxyCodeLine{173 }
\DoxyCodeLine{174    va\_start(a1, flags);}
\DoxyCodeLine{175    va\_start(a2, flags);}
\DoxyCodeLine{176 }
\DoxyCodeLine{177    err = \mbox{\hyperlink{der__decode__sequence__multi_8c_a1c505b541a0ed6ddcdccc8ddcef9ed9e}{\_der\_decode\_sequence\_va}}(in, inlen, a1, a2, flags);}
\DoxyCodeLine{178 }
\DoxyCodeLine{179    va\_end(a2);}
\DoxyCodeLine{180    va\_end(a1);}
\DoxyCodeLine{181 }
\DoxyCodeLine{182    \textcolor{keywordflow}{return} err;}
\DoxyCodeLine{183 \}}

\end{DoxyCode}


References \+\_\+der\+\_\+decode\+\_\+sequence\+\_\+va(), and L\+T\+C\+\_\+\+A\+R\+G\+C\+HK.



Referenced by ecc\+\_\+recover\+\_\+key(), and ecc\+\_\+verify\+\_\+hash\+\_\+ex().

Here is the call graph for this function\+:
% FIG 7
Here is the caller graph for this function\+:
% FIG 8
\mbox{\Hypertarget{tomcrypt__private_8h_a093815c0cc44624723a3d668992b3008}\label{tomcrypt__private_8h_a093815c0cc44624723a3d668992b3008}} 
\index{tomcrypt\_private.h@{tomcrypt\_private.h}!der\_encode\_asn1\_identifier@{der\_encode\_asn1\_identifier}}
\index{der\_encode\_asn1\_identifier@{der\_encode\_asn1\_identifier}!tomcrypt\_private.h@{tomcrypt\_private.h}}
\subsubsection{\texorpdfstring{der\_encode\_asn1\_identifier()}{der\_encode\_asn1\_identifier()}}
{\footnotesize\ttfamily int der\+\_\+encode\+\_\+asn1\+\_\+identifier (\begin{DoxyParamCaption}\item[{const ltc\+\_\+asn1\+\_\+list $\ast$}]{id,  }\item[{unsigned char $\ast$}]{out,  }\item[{unsigned long $\ast$}]{outlen }\end{DoxyParamCaption})}



Encode the A\+S\+N.\+1 Identifier. 


\begin{DoxyParams}{Parameters}
{\em id} & The A\+S\+N.\+1 Identifer to encode \\
\hline
{\em out} & Where to write the identifier to \\
\hline
{\em outlen} & \mbox{[}in/out\mbox{]} The size of out available/written \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
C\+R\+Y\+P\+T\+\_\+\+OK if successful 
\end{DoxyReturn}


Definition at line 24 of file der\+\_\+encode\+\_\+asn1\+\_\+identifier.\+c.


\begin{DoxyCode}{0}
\DoxyCodeLine{25 \{}
\DoxyCodeLine{26    \mbox{\hyperlink{tomcrypt__cfg_8h_ab4afaf24b39288a7be6fd03fe8345f61}{ulong64}} tmp;}
\DoxyCodeLine{27    \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} tag\_len;}
\DoxyCodeLine{28 }
\DoxyCodeLine{29    \mbox{\hyperlink{tomcrypt__argchk_8h_a683da3e041e49f196318b6ea951414ba}{LTC\_ARGCHK}}(\textcolor{keywordtype}{id}  != NULL);}
\DoxyCodeLine{30    \mbox{\hyperlink{tomcrypt__argchk_8h_a683da3e041e49f196318b6ea951414ba}{LTC\_ARGCHK}}(outlen != NULL);}
\DoxyCodeLine{31 }
\DoxyCodeLine{32    \textcolor{keywordflow}{if} (id->type != LTC\_ASN1\_CUSTOM\_TYPE) \{}
\DoxyCodeLine{33       \textcolor{keywordflow}{if} ((\textcolor{keywordtype}{unsigned})id->type >= \mbox{\hyperlink{tomcrypt__private_8h_ae8d2a220c8f5b51d2db97b0382a9f206}{der\_asn1\_type\_to\_identifier\_map\_sz}}) \{}
\DoxyCodeLine{34          \textcolor{keywordflow}{return} \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06ca92aa8bad3930f08d5a188bf72094b066}{CRYPT\_INVALID\_ARG}};}
\DoxyCodeLine{35       \}}
\DoxyCodeLine{36       \textcolor{keywordflow}{if} (\mbox{\hyperlink{tomcrypt__private_8h_a6306ca88074facac89ee0f6c04cbf2f2}{der\_asn1\_type\_to\_identifier\_map}}[id->type] == -1) \{}
\DoxyCodeLine{37          \textcolor{keywordflow}{return} \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06ca92aa8bad3930f08d5a188bf72094b066}{CRYPT\_INVALID\_ARG}};}
\DoxyCodeLine{38       \}}
\DoxyCodeLine{39       \textcolor{keywordflow}{if} (out != NULL) \{}
\DoxyCodeLine{40          *out = \mbox{\hyperlink{tomcrypt__private_8h_a6306ca88074facac89ee0f6c04cbf2f2}{der\_asn1\_type\_to\_identifier\_map}}[\textcolor{keywordtype}{id}->type];}
\DoxyCodeLine{41       \}}
\DoxyCodeLine{42       *outlen = 1;}
\DoxyCodeLine{43       \textcolor{keywordflow}{return} \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}};}
\DoxyCodeLine{44    \}}
\DoxyCodeLine{45    \textcolor{keywordflow}{if} (id->klass < LTC\_ASN1\_CL\_UNIVERSAL || id->klass > LTC\_ASN1\_CL\_PRIVATE) \{}
\DoxyCodeLine{46       \textcolor{keywordflow}{return} \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06ca92aa8bad3930f08d5a188bf72094b066}{CRYPT\_INVALID\_ARG}};}
\DoxyCodeLine{47    \}}
\DoxyCodeLine{48    \textcolor{keywordflow}{if} (id->pc < LTC\_ASN1\_PC\_PRIMITIVE || id->pc > LTC\_ASN1\_PC\_CONSTRUCTED) \{}
\DoxyCodeLine{49       \textcolor{keywordflow}{return} \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06ca92aa8bad3930f08d5a188bf72094b066}{CRYPT\_INVALID\_ARG}};}
\DoxyCodeLine{50    \}}
\DoxyCodeLine{51    \textcolor{keywordflow}{if} (id->tag > (ULONG\_MAX >> (8 + 7))) \{}
\DoxyCodeLine{52       \textcolor{keywordflow}{return} \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06ca92aa8bad3930f08d5a188bf72094b066}{CRYPT\_INVALID\_ARG}};}
\DoxyCodeLine{53    \}}
\DoxyCodeLine{54 }
\DoxyCodeLine{55    \textcolor{keywordflow}{if} (out != NULL) \{}
\DoxyCodeLine{56       \textcolor{keywordflow}{if} (*outlen < 1) \{}
\DoxyCodeLine{57          \textcolor{keywordflow}{return} \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06caccd878f5599f3036ffe759dbe1a1ac16}{CRYPT\_BUFFER\_OVERFLOW}};}
\DoxyCodeLine{58       \}}
\DoxyCodeLine{59 }
\DoxyCodeLine{60       out[0] = \textcolor{keywordtype}{id}->klass << 6 | \textcolor{keywordtype}{id}->pc << 5;}
\DoxyCodeLine{61    \}}
\DoxyCodeLine{62 }
\DoxyCodeLine{63    \textcolor{keywordflow}{if} (id->tag < 0x1f) \{}
\DoxyCodeLine{64       \textcolor{keywordflow}{if} (out != NULL) \{}
\DoxyCodeLine{65          out[0] |= \textcolor{keywordtype}{id}->tag \& 0x1f;}
\DoxyCodeLine{66       \}}
\DoxyCodeLine{67       *outlen = 1;}
\DoxyCodeLine{68    \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{69       tag\_len = 0;}
\DoxyCodeLine{70       tmp = \textcolor{keywordtype}{id}->tag;}
\DoxyCodeLine{71       \textcolor{keywordflow}{do} \{}
\DoxyCodeLine{72          tag\_len++;}
\DoxyCodeLine{73          tmp >>= 7;}
\DoxyCodeLine{74       \} \textcolor{keywordflow}{while} (tmp);}
\DoxyCodeLine{75 }
\DoxyCodeLine{76       \textcolor{keywordflow}{if} (out != NULL) \{}
\DoxyCodeLine{77          \textcolor{keywordflow}{if} (*outlen < tag\_len + 1) \{}
\DoxyCodeLine{78             \textcolor{keywordflow}{return} \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06caccd878f5599f3036ffe759dbe1a1ac16}{CRYPT\_BUFFER\_OVERFLOW}};}
\DoxyCodeLine{79          \}}
\DoxyCodeLine{80          out[0] |= 0x1f;}
\DoxyCodeLine{81          \textcolor{keywordflow}{for} (tmp = 1; tmp <= tag\_len; ++tmp) \{}
\DoxyCodeLine{82             out[tmp] = ((\textcolor{keywordtype}{id}->tag >> (7 * (tag\_len - tmp))) \& 0x7f) | 0x80;}
\DoxyCodeLine{83          \}}
\DoxyCodeLine{84          out[tag\_len] \&= ~0x80;}
\DoxyCodeLine{85       \}}
\DoxyCodeLine{86       *outlen = tag\_len + 1;}
\DoxyCodeLine{87    \}}
\DoxyCodeLine{88 }
\DoxyCodeLine{89    \textcolor{keywordflow}{return} \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}};}
\DoxyCodeLine{90 \}}

\end{DoxyCode}


References C\+R\+Y\+P\+T\+\_\+\+B\+U\+F\+F\+E\+R\+\_\+\+O\+V\+E\+R\+F\+L\+OW, C\+R\+Y\+P\+T\+\_\+\+I\+N\+V\+A\+L\+I\+D\+\_\+\+A\+RG, C\+R\+Y\+P\+T\+\_\+\+OK, der\+\_\+asn1\+\_\+type\+\_\+to\+\_\+identifier\+\_\+map, der\+\_\+asn1\+\_\+type\+\_\+to\+\_\+identifier\+\_\+map\+\_\+sz, and L\+T\+C\+\_\+\+A\+R\+G\+C\+HK.



Referenced by der\+\_\+encode\+\_\+custom\+\_\+type(), and der\+\_\+length\+\_\+asn1\+\_\+identifier().

Here is the caller graph for this function\+:
% FIG 9
\mbox{\Hypertarget{tomcrypt__private_8h_ae0b6c1f1188a5aa201aa84de9a659550}\label{tomcrypt__private_8h_ae0b6c1f1188a5aa201aa84de9a659550}} 
\index{tomcrypt\_private.h@{tomcrypt\_private.h}!der\_encode\_asn1\_length@{der\_encode\_asn1\_length}}
\index{der\_encode\_asn1\_length@{der\_encode\_asn1\_length}!tomcrypt\_private.h@{tomcrypt\_private.h}}
\subsubsection{\texorpdfstring{der\_encode\_asn1\_length()}{der\_encode\_asn1\_length()}}
{\footnotesize\ttfamily int der\+\_\+encode\+\_\+asn1\+\_\+length (\begin{DoxyParamCaption}\item[{unsigned long}]{len,  }\item[{unsigned char $\ast$}]{out,  }\item[{unsigned long $\ast$}]{outlen }\end{DoxyParamCaption})}



Encode the A\+S\+N.\+1 length field. 


\begin{DoxyParams}{Parameters}
{\em len} & The length to encode \\
\hline
{\em out} & Where to write the length field to \\
\hline
{\em outlen} & \mbox{[}in/out\mbox{]} The size of out available/written \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
C\+R\+Y\+P\+T\+\_\+\+OK if successful 
\end{DoxyReturn}


Definition at line 24 of file der\+\_\+encode\+\_\+asn1\+\_\+length.\+c.


\begin{DoxyCode}{0}
\DoxyCodeLine{25 \{}
\DoxyCodeLine{26    \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} x, y;}
\DoxyCodeLine{27 }
\DoxyCodeLine{28    \mbox{\hyperlink{tomcrypt__argchk_8h_a683da3e041e49f196318b6ea951414ba}{LTC\_ARGCHK}}(outlen != NULL);}
\DoxyCodeLine{29 }
\DoxyCodeLine{30    x = \mbox{\hyperlink{ocb__init_8c_afed088663f8704004425cdae2120b9b3}{len}};}
\DoxyCodeLine{31    y = 0;}
\DoxyCodeLine{32 }
\DoxyCodeLine{33    \textcolor{keywordflow}{while}(x != 0) \{}
\DoxyCodeLine{34       y++;}
\DoxyCodeLine{35       x >>= 8;}
\DoxyCodeLine{36    \}}
\DoxyCodeLine{37    \textcolor{keywordflow}{if} (y == 0) \{}
\DoxyCodeLine{38       \textcolor{keywordflow}{return} \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06ca001cb5383cce7c4581790abe472e816f}{CRYPT\_PK\_ASN1\_ERROR}};}
\DoxyCodeLine{39    \}}
\DoxyCodeLine{40 }
\DoxyCodeLine{41    \textcolor{keywordflow}{if} (out == NULL) \{}
\DoxyCodeLine{42       \textcolor{keywordflow}{if} (\mbox{\hyperlink{ocb__init_8c_afed088663f8704004425cdae2120b9b3}{len}} < 128) \{}
\DoxyCodeLine{43          x = y;}
\DoxyCodeLine{44       \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{45          x = y + 1;}
\DoxyCodeLine{46       \}}
\DoxyCodeLine{47    \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{48       \textcolor{keywordflow}{if} (*outlen < y) \{}
\DoxyCodeLine{49          \textcolor{keywordflow}{return} \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06caccd878f5599f3036ffe759dbe1a1ac16}{CRYPT\_BUFFER\_OVERFLOW}};}
\DoxyCodeLine{50       \}}
\DoxyCodeLine{51       x = 0;}
\DoxyCodeLine{52       \textcolor{keywordflow}{if} (\mbox{\hyperlink{ocb__init_8c_afed088663f8704004425cdae2120b9b3}{len}} < 128) \{}
\DoxyCodeLine{53          out[x++] = (\textcolor{keywordtype}{unsigned} char)\mbox{\hyperlink{ocb__init_8c_afed088663f8704004425cdae2120b9b3}{len}};}
\DoxyCodeLine{54       \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (\mbox{\hyperlink{ocb__init_8c_afed088663f8704004425cdae2120b9b3}{len}} <= 0xffUL) \{}
\DoxyCodeLine{55          out[x++] = 0x81;}
\DoxyCodeLine{56          out[x++] = (\textcolor{keywordtype}{unsigned} char)\mbox{\hyperlink{ocb__init_8c_afed088663f8704004425cdae2120b9b3}{len}};}
\DoxyCodeLine{57       \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (\mbox{\hyperlink{ocb__init_8c_afed088663f8704004425cdae2120b9b3}{len}} <= 0xffffUL) \{}
\DoxyCodeLine{58          out[x++] = 0x82;}
\DoxyCodeLine{59          out[x++] = (\textcolor{keywordtype}{unsigned} char)((\mbox{\hyperlink{ocb__init_8c_afed088663f8704004425cdae2120b9b3}{len}}>>8UL)\&255);}
\DoxyCodeLine{60          out[x++] = (\textcolor{keywordtype}{unsigned} char)(\mbox{\hyperlink{ocb__init_8c_afed088663f8704004425cdae2120b9b3}{len}}\&255);}
\DoxyCodeLine{61       \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (\mbox{\hyperlink{ocb__init_8c_afed088663f8704004425cdae2120b9b3}{len}} <= 0xffffffUL) \{}
\DoxyCodeLine{62          out[x++] = 0x83;}
\DoxyCodeLine{63          out[x++] = (\textcolor{keywordtype}{unsigned} char)((\mbox{\hyperlink{ocb__init_8c_afed088663f8704004425cdae2120b9b3}{len}}>>16UL)\&255);}
\DoxyCodeLine{64          out[x++] = (\textcolor{keywordtype}{unsigned} char)((\mbox{\hyperlink{ocb__init_8c_afed088663f8704004425cdae2120b9b3}{len}}>>8UL)\&255);}
\DoxyCodeLine{65          out[x++] = (\textcolor{keywordtype}{unsigned} char)(\mbox{\hyperlink{ocb__init_8c_afed088663f8704004425cdae2120b9b3}{len}}\&255);}
\DoxyCodeLine{66 \textcolor{preprocessor}{      \#if ULONG\_MAX != ULLONG\_MAX}}
\DoxyCodeLine{67       \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{68          out[x++] = 0x84;}
\DoxyCodeLine{69          out[x++] = (\textcolor{keywordtype}{unsigned} char)((\mbox{\hyperlink{ocb__init_8c_afed088663f8704004425cdae2120b9b3}{len}}>>24UL)\&255);}
\DoxyCodeLine{70          out[x++] = (\textcolor{keywordtype}{unsigned} char)((\mbox{\hyperlink{ocb__init_8c_afed088663f8704004425cdae2120b9b3}{len}}>>16UL)\&255);}
\DoxyCodeLine{71          out[x++] = (\textcolor{keywordtype}{unsigned} char)((\mbox{\hyperlink{ocb__init_8c_afed088663f8704004425cdae2120b9b3}{len}}>>8UL)\&255);}
\DoxyCodeLine{72          out[x++] = (\textcolor{keywordtype}{unsigned} char)(\mbox{\hyperlink{ocb__init_8c_afed088663f8704004425cdae2120b9b3}{len}}\&255);}
\DoxyCodeLine{73       \}}
\DoxyCodeLine{74 \textcolor{preprocessor}{      \#else}}
\DoxyCodeLine{75       \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (\mbox{\hyperlink{ocb__init_8c_afed088663f8704004425cdae2120b9b3}{len}} <= 0xffffffffUL) \{}
\DoxyCodeLine{76          out[x++] = 0x84;}
\DoxyCodeLine{77          out[x++] = (\textcolor{keywordtype}{unsigned} char)((\mbox{\hyperlink{ocb__init_8c_afed088663f8704004425cdae2120b9b3}{len}}>>24UL)\&255);}
\DoxyCodeLine{78          out[x++] = (\textcolor{keywordtype}{unsigned} char)((\mbox{\hyperlink{ocb__init_8c_afed088663f8704004425cdae2120b9b3}{len}}>>16UL)\&255);}
\DoxyCodeLine{79          out[x++] = (\textcolor{keywordtype}{unsigned} char)((\mbox{\hyperlink{ocb__init_8c_afed088663f8704004425cdae2120b9b3}{len}}>>8UL)\&255);}
\DoxyCodeLine{80          out[x++] = (\textcolor{keywordtype}{unsigned} char)(\mbox{\hyperlink{ocb__init_8c_afed088663f8704004425cdae2120b9b3}{len}}\&255);}
\DoxyCodeLine{81       \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (\mbox{\hyperlink{ocb__init_8c_afed088663f8704004425cdae2120b9b3}{len}} <= 0xffffffffffULL) \{}
\DoxyCodeLine{82          out[x++] = 0x85;}
\DoxyCodeLine{83          out[x++] = (\textcolor{keywordtype}{unsigned} char)((\mbox{\hyperlink{ocb__init_8c_afed088663f8704004425cdae2120b9b3}{len}}>>32ULL)\&255);}
\DoxyCodeLine{84          out[x++] = (\textcolor{keywordtype}{unsigned} char)((\mbox{\hyperlink{ocb__init_8c_afed088663f8704004425cdae2120b9b3}{len}}>>24ULL)\&255);}
\DoxyCodeLine{85          out[x++] = (\textcolor{keywordtype}{unsigned} char)((\mbox{\hyperlink{ocb__init_8c_afed088663f8704004425cdae2120b9b3}{len}}>>16ULL)\&255);}
\DoxyCodeLine{86          out[x++] = (\textcolor{keywordtype}{unsigned} char)((\mbox{\hyperlink{ocb__init_8c_afed088663f8704004425cdae2120b9b3}{len}}>>8ULL)\&255);}
\DoxyCodeLine{87          out[x++] = (\textcolor{keywordtype}{unsigned} char)(\mbox{\hyperlink{ocb__init_8c_afed088663f8704004425cdae2120b9b3}{len}}\&255);}
\DoxyCodeLine{88       \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (\mbox{\hyperlink{ocb__init_8c_afed088663f8704004425cdae2120b9b3}{len}} <= 0xffffffffffffULL) \{}
\DoxyCodeLine{89          out[x++] = 0x86;}
\DoxyCodeLine{90          out[x++] = (\textcolor{keywordtype}{unsigned} char)((\mbox{\hyperlink{ocb__init_8c_afed088663f8704004425cdae2120b9b3}{len}}>>40ULL)\&255);}
\DoxyCodeLine{91          out[x++] = (\textcolor{keywordtype}{unsigned} char)((\mbox{\hyperlink{ocb__init_8c_afed088663f8704004425cdae2120b9b3}{len}}>>32ULL)\&255);}
\DoxyCodeLine{92          out[x++] = (\textcolor{keywordtype}{unsigned} char)((\mbox{\hyperlink{ocb__init_8c_afed088663f8704004425cdae2120b9b3}{len}}>>24ULL)\&255);}
\DoxyCodeLine{93          out[x++] = (\textcolor{keywordtype}{unsigned} char)((\mbox{\hyperlink{ocb__init_8c_afed088663f8704004425cdae2120b9b3}{len}}>>16ULL)\&255);}
\DoxyCodeLine{94          out[x++] = (\textcolor{keywordtype}{unsigned} char)((\mbox{\hyperlink{ocb__init_8c_afed088663f8704004425cdae2120b9b3}{len}}>>8ULL)\&255);}
\DoxyCodeLine{95          out[x++] = (\textcolor{keywordtype}{unsigned} char)(\mbox{\hyperlink{ocb__init_8c_afed088663f8704004425cdae2120b9b3}{len}}\&255);}
\DoxyCodeLine{96       \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (\mbox{\hyperlink{ocb__init_8c_afed088663f8704004425cdae2120b9b3}{len}} <= 0xffffffffffffffULL) \{}
\DoxyCodeLine{97          out[x++] = 0x87;}
\DoxyCodeLine{98          out[x++] = (\textcolor{keywordtype}{unsigned} char)((\mbox{\hyperlink{ocb__init_8c_afed088663f8704004425cdae2120b9b3}{len}}>>48ULL)\&255);}
\DoxyCodeLine{99          out[x++] = (\textcolor{keywordtype}{unsigned} char)((\mbox{\hyperlink{ocb__init_8c_afed088663f8704004425cdae2120b9b3}{len}}>>40ULL)\&255);}
\DoxyCodeLine{100          out[x++] = (\textcolor{keywordtype}{unsigned} char)((\mbox{\hyperlink{ocb__init_8c_afed088663f8704004425cdae2120b9b3}{len}}>>32ULL)\&255);}
\DoxyCodeLine{101          out[x++] = (\textcolor{keywordtype}{unsigned} char)((\mbox{\hyperlink{ocb__init_8c_afed088663f8704004425cdae2120b9b3}{len}}>>24ULL)\&255);}
\DoxyCodeLine{102          out[x++] = (\textcolor{keywordtype}{unsigned} char)((\mbox{\hyperlink{ocb__init_8c_afed088663f8704004425cdae2120b9b3}{len}}>>16ULL)\&255);}
\DoxyCodeLine{103          out[x++] = (\textcolor{keywordtype}{unsigned} char)((\mbox{\hyperlink{ocb__init_8c_afed088663f8704004425cdae2120b9b3}{len}}>>8ULL)\&255);}
\DoxyCodeLine{104          out[x++] = (\textcolor{keywordtype}{unsigned} char)(\mbox{\hyperlink{ocb__init_8c_afed088663f8704004425cdae2120b9b3}{len}}\&255);}
\DoxyCodeLine{105       \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{106          out[x++] = 0x88;}
\DoxyCodeLine{107          out[x++] = (\textcolor{keywordtype}{unsigned} char)((\mbox{\hyperlink{ocb__init_8c_afed088663f8704004425cdae2120b9b3}{len}}>>56ULL)\&255);}
\DoxyCodeLine{108          out[x++] = (\textcolor{keywordtype}{unsigned} char)((\mbox{\hyperlink{ocb__init_8c_afed088663f8704004425cdae2120b9b3}{len}}>>48ULL)\&255);}
\DoxyCodeLine{109          out[x++] = (\textcolor{keywordtype}{unsigned} char)((\mbox{\hyperlink{ocb__init_8c_afed088663f8704004425cdae2120b9b3}{len}}>>40ULL)\&255);}
\DoxyCodeLine{110          out[x++] = (\textcolor{keywordtype}{unsigned} char)((\mbox{\hyperlink{ocb__init_8c_afed088663f8704004425cdae2120b9b3}{len}}>>32ULL)\&255);}
\DoxyCodeLine{111          out[x++] = (\textcolor{keywordtype}{unsigned} char)((\mbox{\hyperlink{ocb__init_8c_afed088663f8704004425cdae2120b9b3}{len}}>>24ULL)\&255);}
\DoxyCodeLine{112          out[x++] = (\textcolor{keywordtype}{unsigned} char)((\mbox{\hyperlink{ocb__init_8c_afed088663f8704004425cdae2120b9b3}{len}}>>16ULL)\&255);}
\DoxyCodeLine{113          out[x++] = (\textcolor{keywordtype}{unsigned} char)((\mbox{\hyperlink{ocb__init_8c_afed088663f8704004425cdae2120b9b3}{len}}>>8ULL)\&255);}
\DoxyCodeLine{114          out[x++] = (\textcolor{keywordtype}{unsigned} char)(\mbox{\hyperlink{ocb__init_8c_afed088663f8704004425cdae2120b9b3}{len}}\&255);}
\DoxyCodeLine{115       \}}
\DoxyCodeLine{116 \textcolor{preprocessor}{      \#endif}}
\DoxyCodeLine{117    \}}
\DoxyCodeLine{118    *outlen = x;}
\DoxyCodeLine{119 }
\DoxyCodeLine{120    \textcolor{keywordflow}{return} \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}};}
\DoxyCodeLine{121 \}}

\end{DoxyCode}


References C\+R\+Y\+P\+T\+\_\+\+B\+U\+F\+F\+E\+R\+\_\+\+O\+V\+E\+R\+F\+L\+OW, C\+R\+Y\+P\+T\+\_\+\+P\+K\+\_\+\+A\+S\+N1\+\_\+\+E\+R\+R\+OR, len, and L\+T\+C\+\_\+\+A\+R\+G\+C\+HK.



Referenced by der\+\_\+encode\+\_\+bit\+\_\+string(), der\+\_\+encode\+\_\+custom\+\_\+type(), der\+\_\+encode\+\_\+ia5\+\_\+string(), der\+\_\+encode\+\_\+integer(), der\+\_\+encode\+\_\+object\+\_\+identifier(), der\+\_\+encode\+\_\+octet\+\_\+string(), der\+\_\+encode\+\_\+printable\+\_\+string(), der\+\_\+encode\+\_\+raw\+\_\+bit\+\_\+string(), der\+\_\+encode\+\_\+sequence\+\_\+ex(), der\+\_\+encode\+\_\+utf8\+\_\+string(), and der\+\_\+length\+\_\+asn1\+\_\+length().

Here is the caller graph for this function\+:
% FIG 10
\mbox{\Hypertarget{tomcrypt__private_8h_a12ee6e955851d0daff84581e3770a807}\label{tomcrypt__private_8h_a12ee6e955851d0daff84581e3770a807}} 
\index{tomcrypt\_private.h@{tomcrypt\_private.h}!der\_length\_asn1\_identifier@{der\_length\_asn1\_identifier}}
\index{der\_length\_asn1\_identifier@{der\_length\_asn1\_identifier}!tomcrypt\_private.h@{tomcrypt\_private.h}}
\subsubsection{\texorpdfstring{der\_length\_asn1\_identifier()}{der\_length\_asn1\_identifier()}}
{\footnotesize\ttfamily int der\+\_\+length\+\_\+asn1\+\_\+identifier (\begin{DoxyParamCaption}\item[{const ltc\+\_\+asn1\+\_\+list $\ast$}]{id,  }\item[{unsigned long $\ast$}]{idlen }\end{DoxyParamCaption})}



Determine the length required when encoding the A\+S\+N.\+1 Identifier. 


\begin{DoxyParams}{Parameters}
{\em id} & The A\+S\+N.\+1 identifier to encode \\
\hline
{\em idlen} & \mbox{[}out\mbox{]} The required length to encode list \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
C\+R\+Y\+P\+T\+\_\+\+OK if successful 
\end{DoxyReturn}


Definition at line 24 of file der\+\_\+length\+\_\+asn1\+\_\+identifier.\+c.


\begin{DoxyCode}{0}
\DoxyCodeLine{25 \{}
\DoxyCodeLine{26    \textcolor{keywordflow}{return} \mbox{\hyperlink{tomcrypt__private_8h_a093815c0cc44624723a3d668992b3008}{der\_encode\_asn1\_identifier}}(\textcolor{keywordtype}{id}, NULL, idlen);}
\DoxyCodeLine{27 \}}

\end{DoxyCode}


References der\+\_\+encode\+\_\+asn1\+\_\+identifier().



Referenced by der\+\_\+encode\+\_\+custom\+\_\+type(), and der\+\_\+length\+\_\+custom\+\_\+type().

Here is the call graph for this function\+:
% FIG 11
Here is the caller graph for this function\+:
% FIG 12
\mbox{\Hypertarget{tomcrypt__private_8h_a8999e23c66cda0d777570e54f3a5c795}\label{tomcrypt__private_8h_a8999e23c66cda0d777570e54f3a5c795}} 
\index{tomcrypt\_private.h@{tomcrypt\_private.h}!der\_length\_asn1\_length@{der\_length\_asn1\_length}}
\index{der\_length\_asn1\_length@{der\_length\_asn1\_length}!tomcrypt\_private.h@{tomcrypt\_private.h}}
\subsubsection{\texorpdfstring{der\_length\_asn1\_length()}{der\_length\_asn1\_length()}}
{\footnotesize\ttfamily int der\+\_\+length\+\_\+asn1\+\_\+length (\begin{DoxyParamCaption}\item[{unsigned long}]{len,  }\item[{unsigned long $\ast$}]{outlen }\end{DoxyParamCaption})}



Determine the length required to encode len in the A\+S\+N.\+1 length field. 


\begin{DoxyParams}{Parameters}
{\em len} & The length to encode \\
\hline
{\em outlen} & \mbox{[}out\mbox{]} The length that\textquotesingle{}s required to store len \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
C\+R\+Y\+P\+T\+\_\+\+OK if successful 
\end{DoxyReturn}


Definition at line 23 of file der\+\_\+length\+\_\+asn1\+\_\+length.\+c.


\begin{DoxyCode}{0}
\DoxyCodeLine{24 \{}
\DoxyCodeLine{25    \textcolor{keywordflow}{return} \mbox{\hyperlink{tomcrypt__private_8h_ae0b6c1f1188a5aa201aa84de9a659550}{der\_encode\_asn1\_length}}(\mbox{\hyperlink{ocb__init_8c_afed088663f8704004425cdae2120b9b3}{len}}, NULL, outlen);}
\DoxyCodeLine{26 \}}

\end{DoxyCode}


References der\+\_\+encode\+\_\+asn1\+\_\+length(), and len.



Referenced by der\+\_\+encode\+\_\+utf8\+\_\+string(), der\+\_\+length\+\_\+bit\+\_\+string(), der\+\_\+length\+\_\+custom\+\_\+type(), der\+\_\+length\+\_\+ia5\+\_\+string(), der\+\_\+length\+\_\+integer(), der\+\_\+length\+\_\+octet\+\_\+string(), der\+\_\+length\+\_\+printable\+\_\+string(), der\+\_\+length\+\_\+sequence\+\_\+ex(), der\+\_\+length\+\_\+short\+\_\+integer(), der\+\_\+length\+\_\+teletex\+\_\+string(), and der\+\_\+length\+\_\+utf8\+\_\+string().

Here is the call graph for this function\+:
% FIG 13
Here is the caller graph for this function\+:
% FIG 14
\mbox{\Hypertarget{tomcrypt__private_8h_ad3804ae56675e41a9d142c62d6c3bb2d}\label{tomcrypt__private_8h_ad3804ae56675e41a9d142c62d6c3bb2d}} 
\index{tomcrypt\_private.h@{tomcrypt\_private.h}!der\_length\_sequence\_ex@{der\_length\_sequence\_ex}}
\index{der\_length\_sequence\_ex@{der\_length\_sequence\_ex}!tomcrypt\_private.h@{tomcrypt\_private.h}}
\subsubsection{\texorpdfstring{der\_length\_sequence\_ex()}{der\_length\_sequence\_ex()}}
{\footnotesize\ttfamily int der\+\_\+length\+\_\+sequence\+\_\+ex (\begin{DoxyParamCaption}\item[{const ltc\+\_\+asn1\+\_\+list $\ast$}]{list,  }\item[{unsigned long}]{inlen,  }\item[{unsigned long $\ast$}]{outlen,  }\item[{unsigned long $\ast$}]{payloadlen }\end{DoxyParamCaption})}



Definition at line 31 of file der\+\_\+length\+\_\+sequence.\+c.


\begin{DoxyCode}{0}
\DoxyCodeLine{33 \{}
\DoxyCodeLine{34    \textcolor{keywordtype}{int}           err;}
\DoxyCodeLine{35    ltc\_asn1\_type type;}
\DoxyCodeLine{36    \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} size, x, y, i;}
\DoxyCodeLine{37    \textcolor{keywordtype}{void}          *data;}
\DoxyCodeLine{38 }
\DoxyCodeLine{39    \mbox{\hyperlink{tomcrypt__argchk_8h_a683da3e041e49f196318b6ea951414ba}{LTC\_ARGCHK}}(list    != NULL);}
\DoxyCodeLine{40    \mbox{\hyperlink{tomcrypt__argchk_8h_a683da3e041e49f196318b6ea951414ba}{LTC\_ARGCHK}}(outlen  != NULL);}
\DoxyCodeLine{41 }
\DoxyCodeLine{42    \textcolor{comment}{/* get size of output that will be required */}}
\DoxyCodeLine{43    y = 0;}
\DoxyCodeLine{44    \textcolor{keywordflow}{for} (i = 0; i < inlen; i++) \{}
\DoxyCodeLine{45        type = list[i].type;}
\DoxyCodeLine{46        size = list[i].size;}
\DoxyCodeLine{47        data = list[i].data;}
\DoxyCodeLine{48 }
\DoxyCodeLine{49        \textcolor{keywordflow}{if} (type == LTC\_ASN1\_EOL) \{}
\DoxyCodeLine{50           \textcolor{keywordflow}{break};}
\DoxyCodeLine{51        \}}
\DoxyCodeLine{52 }
\DoxyCodeLine{53        \textcolor{comment}{/* some items may be optional during import */}}
\DoxyCodeLine{54        \textcolor{keywordflow}{if} (!list[i].used \&\& list[i].optional) \textcolor{keywordflow}{continue};}
\DoxyCodeLine{55 }
\DoxyCodeLine{56        \textcolor{keywordflow}{switch} (type) \{}
\DoxyCodeLine{57            \textcolor{keywordflow}{case} LTC\_ASN1\_BOOLEAN:}
\DoxyCodeLine{58               \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{der__length__boolean_8c_aa90c23682da0279cbe55ea64b2c3e381}{der\_length\_boolean}}(\&x)) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}}) \{}
\DoxyCodeLine{59                  \textcolor{keywordflow}{goto} LBL\_ERR;}
\DoxyCodeLine{60               \}}
\DoxyCodeLine{61               y += x;}
\DoxyCodeLine{62               \textcolor{keywordflow}{break};}
\DoxyCodeLine{63 }
\DoxyCodeLine{64            \textcolor{keywordflow}{case} LTC\_ASN1\_INTEGER:}
\DoxyCodeLine{65                \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{der__length__integer_8c_af27dfc46ec4a482af05a2265a9d31ca3}{der\_length\_integer}}(data, \&x)) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}}) \{}
\DoxyCodeLine{66                   \textcolor{keywordflow}{goto} LBL\_ERR;}
\DoxyCodeLine{67                \}}
\DoxyCodeLine{68                y += x;}
\DoxyCodeLine{69                \textcolor{keywordflow}{break};}
\DoxyCodeLine{70 }
\DoxyCodeLine{71            \textcolor{keywordflow}{case} LTC\_ASN1\_SHORT\_INTEGER:}
\DoxyCodeLine{72                \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{der__length__short__integer_8c_aa3bac08094cc8142ac313d818cf73fb0}{der\_length\_short\_integer}}(*((\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} *)data), \&x)) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}}) \{}
\DoxyCodeLine{73                   \textcolor{keywordflow}{goto} LBL\_ERR;}
\DoxyCodeLine{74                \}}
\DoxyCodeLine{75                y += x;}
\DoxyCodeLine{76                \textcolor{keywordflow}{break};}
\DoxyCodeLine{77 }
\DoxyCodeLine{78            \textcolor{keywordflow}{case} LTC\_ASN1\_BIT\_STRING:}
\DoxyCodeLine{79            \textcolor{keywordflow}{case} LTC\_ASN1\_RAW\_BIT\_STRING:}
\DoxyCodeLine{80                \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{der__length__bit__string_8c_a73416248e2f93535d54603567acc9cfd}{der\_length\_bit\_string}}(size, \&x)) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}}) \{}
\DoxyCodeLine{81                   \textcolor{keywordflow}{goto} LBL\_ERR;}
\DoxyCodeLine{82                \}}
\DoxyCodeLine{83                y += x;}
\DoxyCodeLine{84                \textcolor{keywordflow}{break};}
\DoxyCodeLine{85 }
\DoxyCodeLine{86            \textcolor{keywordflow}{case} LTC\_ASN1\_OCTET\_STRING:}
\DoxyCodeLine{87                \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{der__length__octet__string_8c_a65b2f3065d3f51608a1dfa3b284a74df}{der\_length\_octet\_string}}(size, \&x)) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}}) \{}
\DoxyCodeLine{88                   \textcolor{keywordflow}{goto} LBL\_ERR;}
\DoxyCodeLine{89                \}}
\DoxyCodeLine{90                y += x;}
\DoxyCodeLine{91                \textcolor{keywordflow}{break};}
\DoxyCodeLine{92 }
\DoxyCodeLine{93            \textcolor{keywordflow}{case} LTC\_ASN1\_NULL:}
\DoxyCodeLine{94                y += 2;}
\DoxyCodeLine{95                \textcolor{keywordflow}{break};}
\DoxyCodeLine{96 }
\DoxyCodeLine{97            \textcolor{keywordflow}{case} LTC\_ASN1\_OBJECT\_IDENTIFIER:}
\DoxyCodeLine{98                \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{der__length__object__identifier_8c_ae1fe5b2cd3f20a693cc571a2a8fc9af0}{der\_length\_object\_identifier}}(data, size, \&x)) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}}) \{}
\DoxyCodeLine{99                   \textcolor{keywordflow}{goto} LBL\_ERR;}
\DoxyCodeLine{100                \}}
\DoxyCodeLine{101                y += x;}
\DoxyCodeLine{102                \textcolor{keywordflow}{break};}
\DoxyCodeLine{103 }
\DoxyCodeLine{104            \textcolor{keywordflow}{case} LTC\_ASN1\_IA5\_STRING:}
\DoxyCodeLine{105                \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{der__length__ia5__string_8c_a37e6cf2c534040fe726a760956eade04}{der\_length\_ia5\_string}}(data, size, \&x)) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}}) \{}
\DoxyCodeLine{106                   \textcolor{keywordflow}{goto} LBL\_ERR;}
\DoxyCodeLine{107                \}}
\DoxyCodeLine{108                y += x;}
\DoxyCodeLine{109                \textcolor{keywordflow}{break};}
\DoxyCodeLine{110 }
\DoxyCodeLine{111            \textcolor{keywordflow}{case} LTC\_ASN1\_TELETEX\_STRING:}
\DoxyCodeLine{112                \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{der__length__teletex__string_8c_a2b3c8aa9d2c26839f9100fdc0286cd93}{der\_length\_teletex\_string}}(data, size, \&x)) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}}) \{}
\DoxyCodeLine{113                   \textcolor{keywordflow}{goto} LBL\_ERR;}
\DoxyCodeLine{114                \}}
\DoxyCodeLine{115                y += x;}
\DoxyCodeLine{116                \textcolor{keywordflow}{break};}
\DoxyCodeLine{117 }
\DoxyCodeLine{118            \textcolor{keywordflow}{case} LTC\_ASN1\_PRINTABLE\_STRING:}
\DoxyCodeLine{119                \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{der__length__printable__string_8c_ac206210b58e1bac2342a80d26bd802db}{der\_length\_printable\_string}}(data, size, \&x)) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}}) \{}
\DoxyCodeLine{120                   \textcolor{keywordflow}{goto} LBL\_ERR;}
\DoxyCodeLine{121                \}}
\DoxyCodeLine{122                y += x;}
\DoxyCodeLine{123                \textcolor{keywordflow}{break};}
\DoxyCodeLine{124 }
\DoxyCodeLine{125            \textcolor{keywordflow}{case} LTC\_ASN1\_UTCTIME:}
\DoxyCodeLine{126                \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{der__length__utctime_8c_a666e7656df6985a9eb25794b878ec4e7}{der\_length\_utctime}}(data, \&x)) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}}) \{}
\DoxyCodeLine{127                   \textcolor{keywordflow}{goto} LBL\_ERR;}
\DoxyCodeLine{128                \}}
\DoxyCodeLine{129                y += x;}
\DoxyCodeLine{130                \textcolor{keywordflow}{break};}
\DoxyCodeLine{131 }
\DoxyCodeLine{132            \textcolor{keywordflow}{case} LTC\_ASN1\_GENERALIZEDTIME:}
\DoxyCodeLine{133                \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{der__length__generalizedtime_8c_a63bd3379e9d6aa710a6ddcea3d836754}{der\_length\_generalizedtime}}(data, \&x)) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}}) \{}
\DoxyCodeLine{134                   \textcolor{keywordflow}{goto} LBL\_ERR;}
\DoxyCodeLine{135                \}}
\DoxyCodeLine{136                y += x;}
\DoxyCodeLine{137                \textcolor{keywordflow}{break};}
\DoxyCodeLine{138 }
\DoxyCodeLine{139            \textcolor{keywordflow}{case} LTC\_ASN1\_UTF8\_STRING:}
\DoxyCodeLine{140                \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{der__length__utf8__string_8c_aa8b54979c2261c4d703c9464e0bb14c1}{der\_length\_utf8\_string}}(data, size, \&x)) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}}) \{}
\DoxyCodeLine{141                   \textcolor{keywordflow}{goto} LBL\_ERR;}
\DoxyCodeLine{142                \}}
\DoxyCodeLine{143                y += x;}
\DoxyCodeLine{144                \textcolor{keywordflow}{break};}
\DoxyCodeLine{145 }
\DoxyCodeLine{146            \textcolor{keywordflow}{case} LTC\_ASN1\_CUSTOM\_TYPE:}
\DoxyCodeLine{147                \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{der__length__custom__type_8c_aff691792e4f0be46252fad3b9aa4955c}{der\_length\_custom\_type}}(\&list[i], \&x, NULL)) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}}) \{}
\DoxyCodeLine{148                   \textcolor{keywordflow}{goto} LBL\_ERR;}
\DoxyCodeLine{149                \}}
\DoxyCodeLine{150                y += x;}
\DoxyCodeLine{151                \textcolor{keywordflow}{break};}
\DoxyCodeLine{152 }
\DoxyCodeLine{153            \textcolor{keywordflow}{case} LTC\_ASN1\_SET:}
\DoxyCodeLine{154            \textcolor{keywordflow}{case} LTC\_ASN1\_SETOF:}
\DoxyCodeLine{155            \textcolor{keywordflow}{case} LTC\_ASN1\_SEQUENCE:}
\DoxyCodeLine{156                \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{der__length__sequence_8c_a46c60ff7d1e17a527913809bffe41546}{der\_length\_sequence}}(data, size, \&x)) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}}) \{}
\DoxyCodeLine{157                   \textcolor{keywordflow}{goto} LBL\_ERR;}
\DoxyCodeLine{158                \}}
\DoxyCodeLine{159                y += x;}
\DoxyCodeLine{160                \textcolor{keywordflow}{break};}
\DoxyCodeLine{161 }
\DoxyCodeLine{162            \textcolor{keywordflow}{case} LTC\_ASN1\_CHOICE:}
\DoxyCodeLine{163            \textcolor{keywordflow}{case} LTC\_ASN1\_EOL:}
\DoxyCodeLine{164                err = \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06ca92aa8bad3930f08d5a188bf72094b066}{CRYPT\_INVALID\_ARG}};}
\DoxyCodeLine{165                \textcolor{keywordflow}{goto} LBL\_ERR;}
\DoxyCodeLine{166        \}}
\DoxyCodeLine{167    \}}
\DoxyCodeLine{168 }
\DoxyCodeLine{169    \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{tomcrypt__private_8h_a8999e23c66cda0d777570e54f3a5c795}{der\_length\_asn1\_length}}(y, \&x)) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}}) \{}
\DoxyCodeLine{170       \textcolor{keywordflow}{goto} LBL\_ERR;}
\DoxyCodeLine{171    \}}
\DoxyCodeLine{172 }
\DoxyCodeLine{173    \textcolor{keywordflow}{if} (payloadlen != NULL) \{}
\DoxyCodeLine{174       *payloadlen = y;}
\DoxyCodeLine{175    \}}
\DoxyCodeLine{176 }
\DoxyCodeLine{177    \textcolor{comment}{/* store size */}}
\DoxyCodeLine{178    *outlen = y + x + 1;}
\DoxyCodeLine{179    err     = \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}};}
\DoxyCodeLine{180 }
\DoxyCodeLine{181 LBL\_ERR:}
\DoxyCodeLine{182    \textcolor{keywordflow}{return} err;}
\DoxyCodeLine{183 \}}

\end{DoxyCode}


References C\+R\+Y\+P\+T\+\_\+\+I\+N\+V\+A\+L\+I\+D\+\_\+\+A\+RG, C\+R\+Y\+P\+T\+\_\+\+OK, der\+\_\+length\+\_\+asn1\+\_\+length(), der\+\_\+length\+\_\+bit\+\_\+string(), der\+\_\+length\+\_\+boolean(), der\+\_\+length\+\_\+custom\+\_\+type(), der\+\_\+length\+\_\+generalizedtime(), der\+\_\+length\+\_\+ia5\+\_\+string(), der\+\_\+length\+\_\+integer(), der\+\_\+length\+\_\+object\+\_\+identifier(), der\+\_\+length\+\_\+octet\+\_\+string(), der\+\_\+length\+\_\+printable\+\_\+string(), der\+\_\+length\+\_\+sequence(), der\+\_\+length\+\_\+short\+\_\+integer(), der\+\_\+length\+\_\+teletex\+\_\+string(), der\+\_\+length\+\_\+utctime(), der\+\_\+length\+\_\+utf8\+\_\+string(), and L\+T\+C\+\_\+\+A\+R\+G\+C\+HK.



Referenced by der\+\_\+encode\+\_\+sequence\+\_\+ex(), and der\+\_\+length\+\_\+sequence().

Here is the call graph for this function\+:
% FIG 15
Here is the caller graph for this function\+:
% FIG 16
\mbox{\Hypertarget{tomcrypt__private_8h_ae8e05b29e9cd248f6a81450eefd22163}\label{tomcrypt__private_8h_ae8e05b29e9cd248f6a81450eefd22163}} 
\index{tomcrypt\_private.h@{tomcrypt\_private.h}!der\_teletex\_char\_encode@{der\_teletex\_char\_encode}}
\index{der\_teletex\_char\_encode@{der\_teletex\_char\_encode}!tomcrypt\_private.h@{tomcrypt\_private.h}}
\subsubsection{\texorpdfstring{der\_teletex\_char\_encode()}{der\_teletex\_char\_encode()}}
{\footnotesize\ttfamily int der\+\_\+teletex\+\_\+char\+\_\+encode (\begin{DoxyParamCaption}\item[{int}]{c }\end{DoxyParamCaption})}



Definition at line 141 of file der\+\_\+length\+\_\+teletex\+\_\+string.\+c.


\begin{DoxyCode}{0}
\DoxyCodeLine{142 \{}
\DoxyCodeLine{143    \textcolor{keywordtype}{int} x;}
\DoxyCodeLine{144    \textcolor{keywordflow}{for} (x = 0; x < (int)(\textcolor{keyword}{sizeof}(\mbox{\hyperlink{der__length__teletex__string_8c_a997fea032cb14c722ed96f405c3447ff}{teletex\_table}})/\textcolor{keyword}{sizeof}(\mbox{\hyperlink{der__length__teletex__string_8c_a997fea032cb14c722ed96f405c3447ff}{teletex\_table}}[0])); x++) \{}
\DoxyCodeLine{145        \textcolor{keywordflow}{if} (\mbox{\hyperlink{der__length__teletex__string_8c_a997fea032cb14c722ed96f405c3447ff}{teletex\_table}}[x].\mbox{\hyperlink{der__length__teletex__string_8c_a45a5b7c00a796a23f01673cef1dbe0a9}{code}} == \mbox{\hyperlink{khazad_8c_a86ea50de5a3e0ae87762f4298d35284c}{c}}) \{}
\DoxyCodeLine{146           \textcolor{keywordflow}{return} \mbox{\hyperlink{der__length__teletex__string_8c_a997fea032cb14c722ed96f405c3447ff}{teletex\_table}}[x].value;}
\DoxyCodeLine{147        \}}
\DoxyCodeLine{148    \}}
\DoxyCodeLine{149    \textcolor{keywordflow}{return} -1;}
\DoxyCodeLine{150 \}}

\end{DoxyCode}


References c, code, and teletex\+\_\+table.



Referenced by der\+\_\+length\+\_\+teletex\+\_\+string().

Here is the caller graph for this function\+:
% FIG 17
\mbox{\Hypertarget{tomcrypt__private_8h_ab300884b978bd66022a4003ef5a1f2a1}\label{tomcrypt__private_8h_ab300884b978bd66022a4003ef5a1f2a1}} 
\index{tomcrypt\_private.h@{tomcrypt\_private.h}!der\_teletex\_value\_decode@{der\_teletex\_value\_decode}}
\index{der\_teletex\_value\_decode@{der\_teletex\_value\_decode}!tomcrypt\_private.h@{tomcrypt\_private.h}}
\subsubsection{\texorpdfstring{der\_teletex\_value\_decode()}{der\_teletex\_value\_decode()}}
{\footnotesize\ttfamily int der\+\_\+teletex\+\_\+value\+\_\+decode (\begin{DoxyParamCaption}\item[{int}]{v }\end{DoxyParamCaption})}



Definition at line 152 of file der\+\_\+length\+\_\+teletex\+\_\+string.\+c.


\begin{DoxyCode}{0}
\DoxyCodeLine{153 \{}
\DoxyCodeLine{154    \textcolor{keywordtype}{int} x;}
\DoxyCodeLine{155    \textcolor{keywordflow}{for} (x = 0; x < (int)(\textcolor{keyword}{sizeof}(\mbox{\hyperlink{der__length__teletex__string_8c_a997fea032cb14c722ed96f405c3447ff}{teletex\_table}})/\textcolor{keyword}{sizeof}(\mbox{\hyperlink{der__length__teletex__string_8c_a997fea032cb14c722ed96f405c3447ff}{teletex\_table}}[0])); x++) \{}
\DoxyCodeLine{156        \textcolor{keywordflow}{if} (\mbox{\hyperlink{der__length__teletex__string_8c_a997fea032cb14c722ed96f405c3447ff}{teletex\_table}}[x].\mbox{\hyperlink{der__length__teletex__string_8c_ac4f474c82e82cbb89ca7c36dd52be0ed}{value}} == v) \{}
\DoxyCodeLine{157           \textcolor{keywordflow}{return} \mbox{\hyperlink{der__length__teletex__string_8c_a997fea032cb14c722ed96f405c3447ff}{teletex\_table}}[x].code;}
\DoxyCodeLine{158        \}}
\DoxyCodeLine{159    \}}
\DoxyCodeLine{160    \textcolor{keywordflow}{return} -1;}
\DoxyCodeLine{161 \}}

\end{DoxyCode}


References teletex\+\_\+table, and value.



Referenced by der\+\_\+decode\+\_\+teletex\+\_\+string().

Here is the caller graph for this function\+:
% FIG 18
\mbox{\Hypertarget{tomcrypt__private_8h_a400ea59efe4834eac94e65230dd59822}\label{tomcrypt__private_8h_a400ea59efe4834eac94e65230dd59822}} 
\index{tomcrypt\_private.h@{tomcrypt\_private.h}!der\_utf8\_valid\_char@{der\_utf8\_valid\_char}}
\index{der\_utf8\_valid\_char@{der\_utf8\_valid\_char}!tomcrypt\_private.h@{tomcrypt\_private.h}}
\subsubsection{\texorpdfstring{der\_utf8\_valid\_char()}{der\_utf8\_valid\_char()}}
{\footnotesize\ttfamily int der\+\_\+utf8\+\_\+valid\+\_\+char (\begin{DoxyParamCaption}\item[{const wchar\+\_\+t}]{c }\end{DoxyParamCaption})}



Test whether the given code point is valid character. 


\begin{DoxyParams}{Parameters}
{\em c} & The U\+T\+F-\/8 character to test \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
1 -\/ valid, 0 -\/ invalid 
\end{DoxyReturn}


Definition at line 45 of file der\+\_\+length\+\_\+utf8\+\_\+string.\+c.


\begin{DoxyCode}{0}
\DoxyCodeLine{46 \{}
\DoxyCodeLine{47    \mbox{\hyperlink{tomcrypt__macros_8h_accde4b007facd646a8327f8e64b2d1e0}{LTC\_UNUSED\_PARAM}}(\mbox{\hyperlink{khazad_8c_a86ea50de5a3e0ae87762f4298d35284c}{c}});}
\DoxyCodeLine{48 \textcolor{preprocessor}{\#if !defined(LTC\_WCHAR\_MAX) || LTC\_WCHAR\_MAX > 0xFFFF}}
\DoxyCodeLine{49    \textcolor{keywordflow}{if} (\mbox{\hyperlink{khazad_8c_a86ea50de5a3e0ae87762f4298d35284c}{c}} > 0x10FFFF) \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{50 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{51 \textcolor{preprocessor}{\#if LTC\_WCHAR\_MAX != 0xFFFF \&\& LTC\_WCHAR\_MAX != 0xFFFFFFFF}}
\DoxyCodeLine{52    \textcolor{keywordflow}{if} (\mbox{\hyperlink{khazad_8c_a86ea50de5a3e0ae87762f4298d35284c}{c}} < 0) \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{53 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{54    \textcolor{keywordflow}{return} 1;}
\DoxyCodeLine{55 \}}

\end{DoxyCode}


References c, and L\+T\+C\+\_\+\+U\+N\+U\+S\+E\+D\+\_\+\+P\+A\+R\+AM.



Referenced by der\+\_\+encode\+\_\+utf8\+\_\+string(), and der\+\_\+length\+\_\+utf8\+\_\+string().

Here is the caller graph for this function\+:
% FIG 19
\mbox{\Hypertarget{tomcrypt__private_8h_a88fc16c33e95216e30eae5beb8e92da1}\label{tomcrypt__private_8h_a88fc16c33e95216e30eae5beb8e92da1}} 
\index{tomcrypt\_private.h@{tomcrypt\_private.h}!dh\_check\_pubkey@{dh\_check\_pubkey}}
\index{dh\_check\_pubkey@{dh\_check\_pubkey}!tomcrypt\_private.h@{tomcrypt\_private.h}}
\subsubsection{\texorpdfstring{dh\_check\_pubkey()}{dh\_check\_pubkey()}}
{\footnotesize\ttfamily int dh\+\_\+check\+\_\+pubkey (\begin{DoxyParamCaption}\item[{const dh\+\_\+key $\ast$}]{key }\end{DoxyParamCaption})}



Check DH public key (I\+N\+T\+E\+R\+N\+AL O\+N\+LY, not part of public A\+PI) 


\begin{DoxyParams}{Parameters}
{\em key} & The key you wish to test \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
C\+R\+Y\+P\+T\+\_\+\+OK if successful 
\end{DoxyReturn}


Definition at line 19 of file dh\+\_\+check\+\_\+pubkey.\+c.


\begin{DoxyCode}{0}
\DoxyCodeLine{20 \{}
\DoxyCodeLine{21    \textcolor{keywordtype}{void} *p\_minus1;}
\DoxyCodeLine{22    \mbox{\hyperlink{tomcrypt__cfg_8h_a4e98fa26a5de0ac87e06af901bad57c4}{ltc\_mp\_digit}} digit;}
\DoxyCodeLine{23    \textcolor{keywordtype}{int} i, digit\_count, bits\_set = 0, err;}
\DoxyCodeLine{24 }
\DoxyCodeLine{25    \mbox{\hyperlink{tomcrypt__argchk_8h_a683da3e041e49f196318b6ea951414ba}{LTC\_ARGCHK}}(key != NULL);}
\DoxyCodeLine{26 }
\DoxyCodeLine{27    \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{tomcrypt__private_8h_aff03c4f22c68d651747055048c509cf3}{mp\_init}}(\&p\_minus1)) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}}) \{}
\DoxyCodeLine{28       \textcolor{keywordflow}{return} err;}
\DoxyCodeLine{29    \}}
\DoxyCodeLine{30 }
\DoxyCodeLine{31    \textcolor{comment}{/* avoid: y <= 1 OR y >= p-1 */}}
\DoxyCodeLine{32    \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{tomcrypt__private_8h_a4215ff0d6838acb3d959d3e68c923de7}{mp\_sub\_d}}(key->prime, 1, p\_minus1)) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}}) \{}
\DoxyCodeLine{33       \textcolor{keywordflow}{goto} error;}
\DoxyCodeLine{34    \}}
\DoxyCodeLine{35    \textcolor{keywordflow}{if} (\mbox{\hyperlink{tomcrypt__private_8h_a62ea02fbe7dd2d456e49520264d775ee}{mp\_cmp}}(key->y, p\_minus1) != \mbox{\hyperlink{tomcrypt__math_8h_a42d0c7d4c09793df79660774d3436db2}{LTC\_MP\_LT}} || \mbox{\hyperlink{tomcrypt__private_8h_a6ce44f2e6f872565a468b67d9a93dc28}{mp\_cmp\_d}}(key->y, 1) != \mbox{\hyperlink{tomcrypt__math_8h_adff156a960d44f0f5b67b75ef1f1c29b}{LTC\_MP\_GT}}) \{}
\DoxyCodeLine{36       err = \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06ca92aa8bad3930f08d5a188bf72094b066}{CRYPT\_INVALID\_ARG}};}
\DoxyCodeLine{37       \textcolor{keywordflow}{goto} error;}
\DoxyCodeLine{38    \}}
\DoxyCodeLine{39 }
\DoxyCodeLine{40    \textcolor{comment}{/* public key must have more than one bit set */}}
\DoxyCodeLine{41    digit\_count = \mbox{\hyperlink{tomcrypt__private_8h_ae51a279d51ab72f09d9f97335b8be6c9}{mp\_get\_digit\_count}}(key->y);}
\DoxyCodeLine{42    \textcolor{keywordflow}{for} (i = 0; i < digit\_count \&\& bits\_set < 2; i++) \{}
\DoxyCodeLine{43       digit = \mbox{\hyperlink{tomcrypt__private_8h_a62267879327e26468c45bbd83f7f2669}{mp\_get\_digit}}(key->y, i);}
\DoxyCodeLine{44       \textcolor{keywordflow}{while} (digit > 0) \{}
\DoxyCodeLine{45          \textcolor{keywordflow}{if} (digit \& 1) bits\_set++;}
\DoxyCodeLine{46          digit >>= 1;}
\DoxyCodeLine{47       \}}
\DoxyCodeLine{48    \}}
\DoxyCodeLine{49    \textcolor{keywordflow}{if} (bits\_set > 1) \{}
\DoxyCodeLine{50       err = \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}};}
\DoxyCodeLine{51    \}}
\DoxyCodeLine{52    \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{53       err = \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06ca92aa8bad3930f08d5a188bf72094b066}{CRYPT\_INVALID\_ARG}};}
\DoxyCodeLine{54    \}}
\DoxyCodeLine{55 }
\DoxyCodeLine{56 error:}
\DoxyCodeLine{57    \mbox{\hyperlink{tomcrypt__private_8h_ab05b6b59fa182b81f5f990d5621229f6}{mp\_clear}}(p\_minus1);}
\DoxyCodeLine{58    \textcolor{keywordflow}{return} err;}
\DoxyCodeLine{59 \}}

\end{DoxyCode}


References C\+R\+Y\+P\+T\+\_\+\+I\+N\+V\+A\+L\+I\+D\+\_\+\+A\+RG, C\+R\+Y\+P\+T\+\_\+\+OK, L\+T\+C\+\_\+\+A\+R\+G\+C\+HK, L\+T\+C\+\_\+\+M\+P\+\_\+\+GT, L\+T\+C\+\_\+\+M\+P\+\_\+\+LT, mp\+\_\+clear, mp\+\_\+cmp, mp\+\_\+cmp\+\_\+d, mp\+\_\+get\+\_\+digit, mp\+\_\+get\+\_\+digit\+\_\+count, mp\+\_\+init, and mp\+\_\+sub\+\_\+d.



Referenced by dh\+\_\+generate\+\_\+key(), dh\+\_\+import(), dh\+\_\+set\+\_\+key(), and dh\+\_\+shared\+\_\+secret().

Here is the caller graph for this function\+:
% FIG 20
\mbox{\Hypertarget{tomcrypt__private_8h_a78787aeedd134c0e586d4a42a83c89c2}\label{tomcrypt__private_8h_a78787aeedd134c0e586d4a42a83c89c2}} 
\index{tomcrypt\_private.h@{tomcrypt\_private.h}!dsa\_int\_validate\_pqg@{dsa\_int\_validate\_pqg}}
\index{dsa\_int\_validate\_pqg@{dsa\_int\_validate\_pqg}!tomcrypt\_private.h@{tomcrypt\_private.h}}
\subsubsection{\texorpdfstring{dsa\_int\_validate\_pqg()}{dsa\_int\_validate\_pqg()}}
{\footnotesize\ttfamily int dsa\+\_\+int\+\_\+validate\+\_\+pqg (\begin{DoxyParamCaption}\item[{const dsa\+\_\+key $\ast$}]{key,  }\item[{int $\ast$}]{stat }\end{DoxyParamCaption})}



Non-\/complex part (no primality testing) of the validation of D\+SA params (p, q, g) 


\begin{DoxyParams}{Parameters}
{\em key} & The key to validate \\
\hline
{\em stat} & \mbox{[}out\mbox{]} Result of test, 1==valid, 0==invalid \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
C\+R\+Y\+P\+T\+\_\+\+OK if successful 
\end{DoxyReturn}


Definition at line 50 of file dsa\+\_\+verify\+\_\+key.\+c.


\begin{DoxyCode}{0}
\DoxyCodeLine{51 \{}
\DoxyCodeLine{52    \textcolor{keywordtype}{void} *tmp1, *tmp2;}
\DoxyCodeLine{53    \textcolor{keywordtype}{int}  err;}
\DoxyCodeLine{54 }
\DoxyCodeLine{55    \mbox{\hyperlink{tomcrypt__argchk_8h_a683da3e041e49f196318b6ea951414ba}{LTC\_ARGCHK}}(key  != NULL);}
\DoxyCodeLine{56    \mbox{\hyperlink{tomcrypt__argchk_8h_a683da3e041e49f196318b6ea951414ba}{LTC\_ARGCHK}}(stat != NULL);}
\DoxyCodeLine{57    *stat = 0;}
\DoxyCodeLine{58 }
\DoxyCodeLine{59    \textcolor{comment}{/* check q-order */}}
\DoxyCodeLine{60    \textcolor{keywordflow}{if} ( key->qord >= LTC\_MDSA\_MAX\_GROUP || key->qord <= 15 ||}
\DoxyCodeLine{61         (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long})key->qord >= \mbox{\hyperlink{tomcrypt__private_8h_ad301148bb24f43a8c7003a6976dfaa5a}{mp\_unsigned\_bin\_size}}(key->p) ||}
\DoxyCodeLine{62         (\mbox{\hyperlink{tomcrypt__private_8h_ad301148bb24f43a8c7003a6976dfaa5a}{mp\_unsigned\_bin\_size}}(key->p) - key->qord) >= LTC\_MDSA\_DELTA ) \{}
\DoxyCodeLine{63       \textcolor{keywordflow}{return} \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}};}
\DoxyCodeLine{64    \}}
\DoxyCodeLine{65 }
\DoxyCodeLine{66    \textcolor{comment}{/* FIPS 186-4 chapter 4.1: 1 < g < p */}}
\DoxyCodeLine{67    \textcolor{keywordflow}{if} (\mbox{\hyperlink{tomcrypt__private_8h_a6ce44f2e6f872565a468b67d9a93dc28}{mp\_cmp\_d}}(key->g, 1) != \mbox{\hyperlink{tomcrypt__math_8h_adff156a960d44f0f5b67b75ef1f1c29b}{LTC\_MP\_GT}} || \mbox{\hyperlink{tomcrypt__private_8h_a62ea02fbe7dd2d456e49520264d775ee}{mp\_cmp}}(key->g, key->p) != \mbox{\hyperlink{tomcrypt__math_8h_a42d0c7d4c09793df79660774d3436db2}{LTC\_MP\_LT}}) \{}
\DoxyCodeLine{68       \textcolor{keywordflow}{return} \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}};}
\DoxyCodeLine{69    \}}
\DoxyCodeLine{70 }
\DoxyCodeLine{71    \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{tomcrypt__private_8h_adb6322247b1a4f0347219acab3120bd3}{mp\_init\_multi}}(\&tmp1, \&tmp2, NULL)) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}})        \{ \textcolor{keywordflow}{return} err; \}}
\DoxyCodeLine{72 }
\DoxyCodeLine{73    \textcolor{comment}{/* FIPS 186-4 chapter 4.1: q is a divisor of (p - 1) */}}
\DoxyCodeLine{74    \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{tomcrypt__private_8h_a4215ff0d6838acb3d959d3e68c923de7}{mp\_sub\_d}}(key->p, 1, tmp1)) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}})                \{ \textcolor{keywordflow}{goto} error; \}}
\DoxyCodeLine{75    \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{tomcrypt__private_8h_a861721ee02d3b5d84328090f3058f7c3}{mp\_div}}(tmp1, key->q, tmp1, tmp2)) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}})         \{ \textcolor{keywordflow}{goto} error; \}}
\DoxyCodeLine{76    \textcolor{keywordflow}{if} (\mbox{\hyperlink{tomcrypt__private_8h_a910040068490f9f6e5185c970ab869c9}{mp\_iszero}}(tmp2) != \mbox{\hyperlink{tomcrypt__math_8h_acc2da047f8fb30a3e2b2403aac617fe0}{LTC\_MP\_YES}}) \{}
\DoxyCodeLine{77       err = \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}};}
\DoxyCodeLine{78       \textcolor{keywordflow}{goto} error;}
\DoxyCodeLine{79    \}}
\DoxyCodeLine{80 }
\DoxyCodeLine{81    \textcolor{comment}{/* FIPS 186-4 chapter 4.1: g is a generator of a subgroup of order q in}}
\DoxyCodeLine{82 \textcolor{comment}{    * the multiplicative group of GF(p) - so we make sure that g\string^q mod p = 1}}
\DoxyCodeLine{83 \textcolor{comment}{    */}}
\DoxyCodeLine{84    \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{tomcrypt__private_8h_a4fb1221fbef91bf8163390e3cfb82085}{mp\_exptmod}}(key->g, key->q, key->p, tmp1)) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}}) \{ \textcolor{keywordflow}{goto} error; \}}
\DoxyCodeLine{85    \textcolor{keywordflow}{if} (\mbox{\hyperlink{tomcrypt__private_8h_a6ce44f2e6f872565a468b67d9a93dc28}{mp\_cmp\_d}}(tmp1, 1) != \mbox{\hyperlink{tomcrypt__math_8h_a035a31bde4f31419eb259e36e5776607}{LTC\_MP\_EQ}}) \{}
\DoxyCodeLine{86       err = \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}};}
\DoxyCodeLine{87       \textcolor{keywordflow}{goto} error;}
\DoxyCodeLine{88    \}}
\DoxyCodeLine{89 }
\DoxyCodeLine{90    err   = \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}};}
\DoxyCodeLine{91    *stat = 1;}
\DoxyCodeLine{92 error:}
\DoxyCodeLine{93    \mbox{\hyperlink{tomcrypt__private_8h_aad5c8a3112b3e4613f9efc86692c43cb}{mp\_clear\_multi}}(tmp2, tmp1, NULL);}
\DoxyCodeLine{94    \textcolor{keywordflow}{return} err;}
\DoxyCodeLine{95 \}}

\end{DoxyCode}


References C\+R\+Y\+P\+T\+\_\+\+OK, L\+T\+C\+\_\+\+A\+R\+G\+C\+HK, L\+T\+C\+\_\+\+M\+P\+\_\+\+EQ, L\+T\+C\+\_\+\+M\+P\+\_\+\+GT, L\+T\+C\+\_\+\+M\+P\+\_\+\+LT, L\+T\+C\+\_\+\+M\+P\+\_\+\+Y\+ES, mp\+\_\+clear\+\_\+multi, mp\+\_\+cmp, mp\+\_\+cmp\+\_\+d, mp\+\_\+div, mp\+\_\+exptmod, mp\+\_\+init\+\_\+multi, mp\+\_\+iszero, mp\+\_\+sub\+\_\+d, and mp\+\_\+unsigned\+\_\+bin\+\_\+size.



Referenced by dsa\+\_\+import(), dsa\+\_\+set\+\_\+pqg(), dsa\+\_\+set\+\_\+pqg\+\_\+dsaparam(), and dsa\+\_\+verify\+\_\+key().

Here is the caller graph for this function\+:
% FIG 21
\mbox{\Hypertarget{tomcrypt__private_8h_abdc76d05886a02727e901ad26f2f3e81}\label{tomcrypt__private_8h_abdc76d05886a02727e901ad26f2f3e81}} 
\index{tomcrypt\_private.h@{tomcrypt\_private.h}!dsa\_int\_validate\_primes@{dsa\_int\_validate\_primes}}
\index{dsa\_int\_validate\_primes@{dsa\_int\_validate\_primes}!tomcrypt\_private.h@{tomcrypt\_private.h}}
\subsubsection{\texorpdfstring{dsa\_int\_validate\_primes()}{dsa\_int\_validate\_primes()}}
{\footnotesize\ttfamily int dsa\+\_\+int\+\_\+validate\+\_\+primes (\begin{DoxyParamCaption}\item[{const dsa\+\_\+key $\ast$}]{key,  }\item[{int $\ast$}]{stat }\end{DoxyParamCaption})}



Primality testing of D\+SA params p and q. 


\begin{DoxyParams}{Parameters}
{\em key} & The key to validate \\
\hline
{\em stat} & \mbox{[}out\mbox{]} Result of test, 1==valid, 0==invalid \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
C\+R\+Y\+P\+T\+\_\+\+OK if successful 
\end{DoxyReturn}


Definition at line 104 of file dsa\+\_\+verify\+\_\+key.\+c.


\begin{DoxyCode}{0}
\DoxyCodeLine{105 \{}
\DoxyCodeLine{106    \textcolor{keywordtype}{int} err, res;}
\DoxyCodeLine{107 }
\DoxyCodeLine{108    *stat = 0;}
\DoxyCodeLine{109    \mbox{\hyperlink{tomcrypt__argchk_8h_a683da3e041e49f196318b6ea951414ba}{LTC\_ARGCHK}}(key  != NULL);}
\DoxyCodeLine{110    \mbox{\hyperlink{tomcrypt__argchk_8h_a683da3e041e49f196318b6ea951414ba}{LTC\_ARGCHK}}(stat != NULL);}
\DoxyCodeLine{111 }
\DoxyCodeLine{112    \textcolor{comment}{/* key->q prime? */}}
\DoxyCodeLine{113    \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{tomcrypt__private_8h_ab3681f96d55cf707b92d6254f58ea3de}{mp\_prime\_is\_prime}}(key->q, \mbox{\hyperlink{tomcrypt__math_8h_a65401cc14826c74ce923beb65bde5bf3}{LTC\_MILLER\_RABIN\_REPS}}, \&res)) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}}) \{}
\DoxyCodeLine{114       \textcolor{keywordflow}{return} err;}
\DoxyCodeLine{115    \}}
\DoxyCodeLine{116    \textcolor{keywordflow}{if} (res == \mbox{\hyperlink{tomcrypt__math_8h_a40f1119339954fb273ecb35e48c1d569}{LTC\_MP\_NO}}) \{}
\DoxyCodeLine{117       \textcolor{keywordflow}{return} \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}};}
\DoxyCodeLine{118    \}}
\DoxyCodeLine{119 }
\DoxyCodeLine{120    \textcolor{comment}{/* key->p prime? */}}
\DoxyCodeLine{121    \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{tomcrypt__private_8h_ab3681f96d55cf707b92d6254f58ea3de}{mp\_prime\_is\_prime}}(key->p, \mbox{\hyperlink{tomcrypt__math_8h_a65401cc14826c74ce923beb65bde5bf3}{LTC\_MILLER\_RABIN\_REPS}}, \&res)) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}}) \{}
\DoxyCodeLine{122       \textcolor{keywordflow}{return} err;}
\DoxyCodeLine{123    \}}
\DoxyCodeLine{124    \textcolor{keywordflow}{if} (res == \mbox{\hyperlink{tomcrypt__math_8h_a40f1119339954fb273ecb35e48c1d569}{LTC\_MP\_NO}}) \{}
\DoxyCodeLine{125       \textcolor{keywordflow}{return} \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}};}
\DoxyCodeLine{126    \}}
\DoxyCodeLine{127 }
\DoxyCodeLine{128    *stat = 1;}
\DoxyCodeLine{129    \textcolor{keywordflow}{return} \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}};}
\DoxyCodeLine{130 \}}

\end{DoxyCode}


References C\+R\+Y\+P\+T\+\_\+\+OK, L\+T\+C\+\_\+\+A\+R\+G\+C\+HK, L\+T\+C\+\_\+\+M\+I\+L\+L\+E\+R\+\_\+\+R\+A\+B\+I\+N\+\_\+\+R\+E\+PS, L\+T\+C\+\_\+\+M\+P\+\_\+\+NO, and mp\+\_\+prime\+\_\+is\+\_\+prime.



Referenced by dsa\+\_\+verify\+\_\+key().

Here is the caller graph for this function\+:
% FIG 22
\mbox{\Hypertarget{tomcrypt__private_8h_aa5b2d573863af50ed2f38a00998a1274}\label{tomcrypt__private_8h_aa5b2d573863af50ed2f38a00998a1274}} 
\index{tomcrypt\_private.h@{tomcrypt\_private.h}!dsa\_int\_validate\_xy@{dsa\_int\_validate\_xy}}
\index{dsa\_int\_validate\_xy@{dsa\_int\_validate\_xy}!tomcrypt\_private.h@{tomcrypt\_private.h}}
\subsubsection{\texorpdfstring{dsa\_int\_validate\_xy()}{dsa\_int\_validate\_xy()}}
{\footnotesize\ttfamily int dsa\+\_\+int\+\_\+validate\+\_\+xy (\begin{DoxyParamCaption}\item[{const dsa\+\_\+key $\ast$}]{key,  }\item[{int $\ast$}]{stat }\end{DoxyParamCaption})}



Validation of a D\+SA key (x and y values) 


\begin{DoxyParams}{Parameters}
{\em key} & The key to validate \\
\hline
{\em stat} & \mbox{[}out\mbox{]} Result of test, 1==valid, 0==invalid \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
C\+R\+Y\+P\+T\+\_\+\+OK if successful 
\end{DoxyReturn}


Definition at line 139 of file dsa\+\_\+verify\+\_\+key.\+c.


\begin{DoxyCode}{0}
\DoxyCodeLine{140 \{}
\DoxyCodeLine{141    \textcolor{keywordtype}{void} *tmp;}
\DoxyCodeLine{142    \textcolor{keywordtype}{int}  err;}
\DoxyCodeLine{143 }
\DoxyCodeLine{144    *stat = 0;}
\DoxyCodeLine{145    \mbox{\hyperlink{tomcrypt__argchk_8h_a683da3e041e49f196318b6ea951414ba}{LTC\_ARGCHK}}(key  != NULL);}
\DoxyCodeLine{146    \mbox{\hyperlink{tomcrypt__argchk_8h_a683da3e041e49f196318b6ea951414ba}{LTC\_ARGCHK}}(stat != NULL);}
\DoxyCodeLine{147 }
\DoxyCodeLine{148    \textcolor{comment}{/* 1 < y < p-1 */}}
\DoxyCodeLine{149    \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{tomcrypt__private_8h_aff03c4f22c68d651747055048c509cf3}{mp\_init}}(\&tmp)) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}}) \{}
\DoxyCodeLine{150       \textcolor{keywordflow}{return} err;}
\DoxyCodeLine{151    \}}
\DoxyCodeLine{152    \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{tomcrypt__private_8h_a4215ff0d6838acb3d959d3e68c923de7}{mp\_sub\_d}}(key->p, 1, tmp)) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}}) \{}
\DoxyCodeLine{153       \textcolor{keywordflow}{goto} error;}
\DoxyCodeLine{154    \}}
\DoxyCodeLine{155    \textcolor{keywordflow}{if} (\mbox{\hyperlink{tomcrypt__private_8h_a6ce44f2e6f872565a468b67d9a93dc28}{mp\_cmp\_d}}(key->y, 1) != \mbox{\hyperlink{tomcrypt__math_8h_adff156a960d44f0f5b67b75ef1f1c29b}{LTC\_MP\_GT}} || \mbox{\hyperlink{tomcrypt__private_8h_a62ea02fbe7dd2d456e49520264d775ee}{mp\_cmp}}(key->y, tmp) != \mbox{\hyperlink{tomcrypt__math_8h_a42d0c7d4c09793df79660774d3436db2}{LTC\_MP\_LT}}) \{}
\DoxyCodeLine{156       err = \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}};}
\DoxyCodeLine{157       \textcolor{keywordflow}{goto} error;}
\DoxyCodeLine{158    \}}
\DoxyCodeLine{159 }
\DoxyCodeLine{160    \textcolor{keywordflow}{if} (key->type == \mbox{\hyperlink{tomcrypt__pk_8h_afb69d121a43f5ae8b47e6b83611d9272a7295b3dea2c5277912c6e040e1c96649}{PK\_PRIVATE}}) \{}
\DoxyCodeLine{161       \textcolor{comment}{/* FIPS 186-4 chapter 4.1: 0 < x < q */}}
\DoxyCodeLine{162       \textcolor{keywordflow}{if} (\mbox{\hyperlink{tomcrypt__private_8h_a6ce44f2e6f872565a468b67d9a93dc28}{mp\_cmp\_d}}(key->x, 0) != \mbox{\hyperlink{tomcrypt__math_8h_adff156a960d44f0f5b67b75ef1f1c29b}{LTC\_MP\_GT}} || \mbox{\hyperlink{tomcrypt__private_8h_a62ea02fbe7dd2d456e49520264d775ee}{mp\_cmp}}(key->x, key->q) != \mbox{\hyperlink{tomcrypt__math_8h_a42d0c7d4c09793df79660774d3436db2}{LTC\_MP\_LT}}) \{}
\DoxyCodeLine{163          err = \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}};}
\DoxyCodeLine{164          \textcolor{keywordflow}{goto} error;}
\DoxyCodeLine{165       \}}
\DoxyCodeLine{166       \textcolor{comment}{/* FIPS 186-4 chapter 4.1: y = g\string^x mod p */}}
\DoxyCodeLine{167       \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{tomcrypt__private_8h_a4fb1221fbef91bf8163390e3cfb82085}{mp\_exptmod}}(key->g, key->x, key->p, tmp)) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}}) \{}
\DoxyCodeLine{168          \textcolor{keywordflow}{goto} error;}
\DoxyCodeLine{169       \}}
\DoxyCodeLine{170       \textcolor{keywordflow}{if} (\mbox{\hyperlink{tomcrypt__private_8h_a62ea02fbe7dd2d456e49520264d775ee}{mp\_cmp}}(tmp, key->y) != \mbox{\hyperlink{tomcrypt__math_8h_a035a31bde4f31419eb259e36e5776607}{LTC\_MP\_EQ}}) \{}
\DoxyCodeLine{171          err = \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}};}
\DoxyCodeLine{172          \textcolor{keywordflow}{goto} error;}
\DoxyCodeLine{173       \}}
\DoxyCodeLine{174    \}}
\DoxyCodeLine{175    \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{176       \textcolor{comment}{/* with just a public key we cannot test y = g\string^x mod p therefore we}}
\DoxyCodeLine{177 \textcolor{comment}{       * only test that y\string^q mod p = 1, which makes sure y is in g\string^x mod p}}
\DoxyCodeLine{178 \textcolor{comment}{       */}}
\DoxyCodeLine{179       \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{tomcrypt__private_8h_a4fb1221fbef91bf8163390e3cfb82085}{mp\_exptmod}}(key->y, key->q, key->p, tmp)) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}}) \{}
\DoxyCodeLine{180          \textcolor{keywordflow}{goto} error;}
\DoxyCodeLine{181       \}}
\DoxyCodeLine{182       \textcolor{keywordflow}{if} (\mbox{\hyperlink{tomcrypt__private_8h_a6ce44f2e6f872565a468b67d9a93dc28}{mp\_cmp\_d}}(tmp, 1) != \mbox{\hyperlink{tomcrypt__math_8h_a035a31bde4f31419eb259e36e5776607}{LTC\_MP\_EQ}}) \{}
\DoxyCodeLine{183          err = \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}};}
\DoxyCodeLine{184          \textcolor{keywordflow}{goto} error;}
\DoxyCodeLine{185       \}}
\DoxyCodeLine{186    \}}
\DoxyCodeLine{187 }
\DoxyCodeLine{188    err   = \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}};}
\DoxyCodeLine{189    *stat = 1;}
\DoxyCodeLine{190 error:}
\DoxyCodeLine{191    \mbox{\hyperlink{tomcrypt__private_8h_ab05b6b59fa182b81f5f990d5621229f6}{mp\_clear}}(tmp);}
\DoxyCodeLine{192    \textcolor{keywordflow}{return} err;}
\DoxyCodeLine{193 \}}

\end{DoxyCode}


References C\+R\+Y\+P\+T\+\_\+\+OK, L\+T\+C\+\_\+\+A\+R\+G\+C\+HK, L\+T\+C\+\_\+\+M\+P\+\_\+\+EQ, L\+T\+C\+\_\+\+M\+P\+\_\+\+GT, L\+T\+C\+\_\+\+M\+P\+\_\+\+LT, mp\+\_\+clear, mp\+\_\+cmp, mp\+\_\+cmp\+\_\+d, mp\+\_\+exptmod, mp\+\_\+init, mp\+\_\+sub\+\_\+d, and P\+K\+\_\+\+P\+R\+I\+V\+A\+TE.



Referenced by dsa\+\_\+import(), dsa\+\_\+set\+\_\+key(), and dsa\+\_\+verify\+\_\+key().

Here is the caller graph for this function\+:
% FIG 23
\mbox{\Hypertarget{tomcrypt__private_8h_aa65ad9426232274db6f50ae2ba05a600}\label{tomcrypt__private_8h_aa65ad9426232274db6f50ae2ba05a600}} 
\index{tomcrypt\_private.h@{tomcrypt\_private.h}!ecc\_copy\_curve@{ecc\_copy\_curve}}
\index{ecc\_copy\_curve@{ecc\_copy\_curve}!tomcrypt\_private.h@{tomcrypt\_private.h}}
\subsubsection{\texorpdfstring{ecc\_copy\_curve()}{ecc\_copy\_curve()}}
{\footnotesize\ttfamily int ecc\+\_\+copy\+\_\+curve (\begin{DoxyParamCaption}\item[{const ecc\+\_\+key $\ast$}]{srckey,  }\item[{ecc\+\_\+key $\ast$}]{key }\end{DoxyParamCaption})}



Definition at line 45 of file ecc\+\_\+set\+\_\+curve\+\_\+internal.\+c.


\begin{DoxyCode}{0}
\DoxyCodeLine{46 \{}
\DoxyCodeLine{47    \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} i;}
\DoxyCodeLine{48    \textcolor{keywordtype}{int} err;}
\DoxyCodeLine{49 }
\DoxyCodeLine{50    \mbox{\hyperlink{tomcrypt__argchk_8h_a683da3e041e49f196318b6ea951414ba}{LTC\_ARGCHK}}(key != NULL);}
\DoxyCodeLine{51    \mbox{\hyperlink{tomcrypt__argchk_8h_a683da3e041e49f196318b6ea951414ba}{LTC\_ARGCHK}}(srckey != NULL);}
\DoxyCodeLine{52 }
\DoxyCodeLine{53    \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{tomcrypt__private_8h_adb6322247b1a4f0347219acab3120bd3}{mp\_init\_multi}}(\&key->dp.prime, \&key->dp.order, \&key->dp.A, \&key->dp.B,}
\DoxyCodeLine{54                             \&key->dp.base.x, \&key->dp.base.y, \&key->dp.base.z,}
\DoxyCodeLine{55                             \&key->pubkey.x, \&key->pubkey.y, \&key->pubkey.z, \&key->k,}
\DoxyCodeLine{56                             NULL)) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}}) \{}
\DoxyCodeLine{57       \textcolor{keywordflow}{return} err;}
\DoxyCodeLine{58    \}}
\DoxyCodeLine{59 }
\DoxyCodeLine{60    \textcolor{comment}{/* A, B, order, prime, Gx, Gy */}}
\DoxyCodeLine{61    \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{tomcrypt__private_8h_afbb35bc8f920448d169ddc83a4308840}{mp\_copy}}(srckey->dp.prime,  key->dp.prime )) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}}) \{ \textcolor{keywordflow}{goto} error; \}}
\DoxyCodeLine{62    \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{tomcrypt__private_8h_afbb35bc8f920448d169ddc83a4308840}{mp\_copy}}(srckey->dp.order,  key->dp.order )) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}}) \{ \textcolor{keywordflow}{goto} error; \}}
\DoxyCodeLine{63    \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{tomcrypt__private_8h_afbb35bc8f920448d169ddc83a4308840}{mp\_copy}}(srckey->dp.A,      key->dp.A     )) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}}) \{ \textcolor{keywordflow}{goto} error; \}}
\DoxyCodeLine{64    \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{tomcrypt__private_8h_afbb35bc8f920448d169ddc83a4308840}{mp\_copy}}(srckey->dp.B,      key->dp.B     )) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}}) \{ \textcolor{keywordflow}{goto} error; \}}
\DoxyCodeLine{65    \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{tomcrypt__private_8h_a4b36b54e30a0a87aff57a936b386df7f}{ltc\_ecc\_copy\_point}}(\&srckey->dp.base, \&key->dp.base)) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}}) \{ \textcolor{keywordflow}{goto} error; \}}
\DoxyCodeLine{66    \textcolor{comment}{/* cofactor \& size */}}
\DoxyCodeLine{67    key->dp.cofactor = srckey->dp.cofactor;}
\DoxyCodeLine{68    key->dp.size     = srckey->dp.size;}
\DoxyCodeLine{69    \textcolor{comment}{/* OID */}}
\DoxyCodeLine{70    \textcolor{keywordflow}{if} (srckey->dp.oidlen > 0) \{}
\DoxyCodeLine{71      key->dp.oidlen = srckey->dp.oidlen;}
\DoxyCodeLine{72      \textcolor{keywordflow}{for} (i = 0; i < key->dp.oidlen; i++) key->dp.oid[i] = srckey->dp.oid[i];}
\DoxyCodeLine{73    \}}
\DoxyCodeLine{74    \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{75      \mbox{\hyperlink{ecc__set__curve__internal_8c_a3d657756a1e38d4f275973a9a0f98fd1}{\_ecc\_oid\_lookup}}(key); \textcolor{comment}{/* try to find OID in ltc\_ecc\_curves */}}
\DoxyCodeLine{76    \}}
\DoxyCodeLine{77    \textcolor{comment}{/* success */}}
\DoxyCodeLine{78    \textcolor{keywordflow}{return} \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}};}
\DoxyCodeLine{79 }
\DoxyCodeLine{80 error:}
\DoxyCodeLine{81    \mbox{\hyperlink{ecc__free_8c_a73cd81ea7d3b24f2d9ef309c4b22e3b7}{ecc\_free}}(key);}
\DoxyCodeLine{82    \textcolor{keywordflow}{return} err;}
\DoxyCodeLine{83 \}}

\end{DoxyCode}


References \+\_\+ecc\+\_\+oid\+\_\+lookup(), C\+R\+Y\+P\+T\+\_\+\+OK, ecc\+\_\+free(), L\+T\+C\+\_\+\+A\+R\+G\+C\+HK, ltc\+\_\+ecc\+\_\+copy\+\_\+point(), mp\+\_\+copy, and mp\+\_\+init\+\_\+multi.



Referenced by ecc\+\_\+decrypt\+\_\+key(), ecc\+\_\+encrypt\+\_\+key(), and ecc\+\_\+sign\+\_\+hash\+\_\+ex().

Here is the call graph for this function\+:
% FIG 24
Here is the caller graph for this function\+:
% FIG 25
\mbox{\Hypertarget{tomcrypt__private_8h_a6e24f3e6a3975c4d9e261a6031cab7b5}\label{tomcrypt__private_8h_a6e24f3e6a3975c4d9e261a6031cab7b5}} 
\index{tomcrypt\_private.h@{tomcrypt\_private.h}!ecc\_import\_subject\_public\_key\_info@{ecc\_import\_subject\_public\_key\_info}}
\index{ecc\_import\_subject\_public\_key\_info@{ecc\_import\_subject\_public\_key\_info}!tomcrypt\_private.h@{tomcrypt\_private.h}}
\subsubsection{\texorpdfstring{ecc\_import\_subject\_public\_key\_info()}{ecc\_import\_subject\_public\_key\_info()}}
{\footnotesize\ttfamily int ecc\+\_\+import\+\_\+subject\+\_\+public\+\_\+key\+\_\+info (\begin{DoxyParamCaption}\item[{const unsigned char $\ast$}]{in,  }\item[{unsigned long}]{inlen,  }\item[{ecc\+\_\+key $\ast$}]{key }\end{DoxyParamCaption})}



Definition at line 92 of file ecc\+\_\+import\+\_\+x509.\+c.


\begin{DoxyCode}{0}
\DoxyCodeLine{93 \{}
\DoxyCodeLine{94    \textcolor{keywordtype}{int} err;}
\DoxyCodeLine{95 }
\DoxyCodeLine{96    \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{ecc__import__x509_8c_a95f6b54b054138d6b43afc3876908bad}{\_ecc\_import\_x509\_with\_oid}}(in, inlen, key)) == \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}}) \{}
\DoxyCodeLine{97       \textcolor{keywordflow}{goto} success;}
\DoxyCodeLine{98    \}}
\DoxyCodeLine{99 }
\DoxyCodeLine{100    err = \mbox{\hyperlink{ecc__import__x509_8c_adf48b3ba468c0324055e9413a82d39f5}{\_ecc\_import\_x509\_with\_curve}}(in, inlen, key);}
\DoxyCodeLine{101 }
\DoxyCodeLine{102 success:}
\DoxyCodeLine{103    \textcolor{keywordflow}{return} err;}
\DoxyCodeLine{104 \}}

\end{DoxyCode}


References \+\_\+ecc\+\_\+import\+\_\+x509\+\_\+with\+\_\+curve(), \+\_\+ecc\+\_\+import\+\_\+x509\+\_\+with\+\_\+oid(), and C\+R\+Y\+P\+T\+\_\+\+OK.



Referenced by ecc\+\_\+import\+\_\+openssl(), and ecc\+\_\+import\+\_\+x509().

Here is the call graph for this function\+:
% FIG 26
Here is the caller graph for this function\+:
% FIG 27
\mbox{\Hypertarget{tomcrypt__private_8h_ae380263c82c1fe0cde8dc08e89f7940c}\label{tomcrypt__private_8h_ae380263c82c1fe0cde8dc08e89f7940c}} 
\index{tomcrypt\_private.h@{tomcrypt\_private.h}!ecc\_set\_curve\_by\_size@{ecc\_set\_curve\_by\_size}}
\index{ecc\_set\_curve\_by\_size@{ecc\_set\_curve\_by\_size}!tomcrypt\_private.h@{tomcrypt\_private.h}}
\subsubsection{\texorpdfstring{ecc\_set\_curve\_by\_size()}{ecc\_set\_curve\_by\_size()}}
{\footnotesize\ttfamily int ecc\+\_\+set\+\_\+curve\+\_\+by\+\_\+size (\begin{DoxyParamCaption}\item[{int}]{size,  }\item[{ecc\+\_\+key $\ast$}]{key }\end{DoxyParamCaption})}



Definition at line 50 of file ecc\+\_\+set\+\_\+curve.\+c.


\begin{DoxyCode}{0}
\DoxyCodeLine{51 \{}
\DoxyCodeLine{52    \textcolor{keyword}{const} ltc\_ecc\_curve *cu = NULL;}
\DoxyCodeLine{53    \textcolor{keywordtype}{int} err = \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06ca03c22220d7538be04455cd2aa6ddf9da}{CRYPT\_ERROR}};}
\DoxyCodeLine{54 }
\DoxyCodeLine{55    \textcolor{comment}{/* for compatibility with libtomcrypt-1.17 the sizes below must match the specific curves */}}
\DoxyCodeLine{56    \textcolor{keywordflow}{if} (size <= 14) \{}
\DoxyCodeLine{57       err = \mbox{\hyperlink{ecc__find__curve_8c_ad928083861ba212cb0c270bcf10b0403}{ecc\_find\_curve}}(\textcolor{stringliteral}{"SECP112R1"}, \&cu);}
\DoxyCodeLine{58    \}}
\DoxyCodeLine{59    \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (size <= 16) \{}
\DoxyCodeLine{60       err = \mbox{\hyperlink{ecc__find__curve_8c_ad928083861ba212cb0c270bcf10b0403}{ecc\_find\_curve}}(\textcolor{stringliteral}{"SECP128R1"}, \&cu);}
\DoxyCodeLine{61    \}}
\DoxyCodeLine{62    \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (size <= 20) \{}
\DoxyCodeLine{63       err = \mbox{\hyperlink{ecc__find__curve_8c_ad928083861ba212cb0c270bcf10b0403}{ecc\_find\_curve}}(\textcolor{stringliteral}{"SECP160R1"}, \&cu);}
\DoxyCodeLine{64    \}}
\DoxyCodeLine{65    \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (size <= 24) \{}
\DoxyCodeLine{66       err = \mbox{\hyperlink{ecc__find__curve_8c_ad928083861ba212cb0c270bcf10b0403}{ecc\_find\_curve}}(\textcolor{stringliteral}{"SECP192R1"}, \&cu);}
\DoxyCodeLine{67    \}}
\DoxyCodeLine{68    \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (size <= 28) \{}
\DoxyCodeLine{69       err = \mbox{\hyperlink{ecc__find__curve_8c_ad928083861ba212cb0c270bcf10b0403}{ecc\_find\_curve}}(\textcolor{stringliteral}{"SECP224R1"}, \&cu);}
\DoxyCodeLine{70    \}}
\DoxyCodeLine{71    \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (size <= 32) \{}
\DoxyCodeLine{72       err = \mbox{\hyperlink{ecc__find__curve_8c_ad928083861ba212cb0c270bcf10b0403}{ecc\_find\_curve}}(\textcolor{stringliteral}{"SECP256R1"}, \&cu);}
\DoxyCodeLine{73    \}}
\DoxyCodeLine{74    \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (size <= 48) \{}
\DoxyCodeLine{75       err = \mbox{\hyperlink{ecc__find__curve_8c_ad928083861ba212cb0c270bcf10b0403}{ecc\_find\_curve}}(\textcolor{stringliteral}{"SECP384R1"}, \&cu);}
\DoxyCodeLine{76    \}}
\DoxyCodeLine{77    \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (size <= 66) \{}
\DoxyCodeLine{78       err = \mbox{\hyperlink{ecc__find__curve_8c_ad928083861ba212cb0c270bcf10b0403}{ecc\_find\_curve}}(\textcolor{stringliteral}{"SECP521R1"}, \&cu);}
\DoxyCodeLine{79    \}}
\DoxyCodeLine{80 }
\DoxyCodeLine{81    \textcolor{keywordflow}{if} (err == \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}} \&\& cu != NULL) \textcolor{keywordflow}{return} \mbox{\hyperlink{ecc__set__curve_8c_ae59e3d6f85b87d050df0ece7c6f5c661}{ecc\_set\_curve}}(cu, key);}
\DoxyCodeLine{82 }
\DoxyCodeLine{83    \textcolor{keywordflow}{return} \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06ca92aa8bad3930f08d5a188bf72094b066}{CRYPT\_INVALID\_ARG}};}
\DoxyCodeLine{84 \}}

\end{DoxyCode}


References C\+R\+Y\+P\+T\+\_\+\+E\+R\+R\+OR, C\+R\+Y\+P\+T\+\_\+\+I\+N\+V\+A\+L\+I\+D\+\_\+\+A\+RG, C\+R\+Y\+P\+T\+\_\+\+OK, ecc\+\_\+find\+\_\+curve(), and ecc\+\_\+set\+\_\+curve().



Referenced by ecc\+\_\+ansi\+\_\+x963\+\_\+import\+\_\+ex(), ecc\+\_\+import\+\_\+ex(), and ecc\+\_\+make\+\_\+key().

Here is the call graph for this function\+:
% FIG 28
Here is the caller graph for this function\+:
% FIG 29
\mbox{\Hypertarget{tomcrypt__private_8h_a5058c67d67d65a00c30b08ee3c0149f1}\label{tomcrypt__private_8h_a5058c67d67d65a00c30b08ee3c0149f1}} 
\index{tomcrypt\_private.h@{tomcrypt\_private.h}!ecc\_set\_curve\_from\_mpis@{ecc\_set\_curve\_from\_mpis}}
\index{ecc\_set\_curve\_from\_mpis@{ecc\_set\_curve\_from\_mpis}!tomcrypt\_private.h@{tomcrypt\_private.h}}
\subsubsection{\texorpdfstring{ecc\_set\_curve\_from\_mpis()}{ecc\_set\_curve\_from\_mpis()}}
{\footnotesize\ttfamily int ecc\+\_\+set\+\_\+curve\+\_\+from\+\_\+mpis (\begin{DoxyParamCaption}\item[{void $\ast$}]{a,  }\item[{void $\ast$}]{b,  }\item[{void $\ast$}]{prime,  }\item[{void $\ast$}]{order,  }\item[{void $\ast$}]{gx,  }\item[{void $\ast$}]{gy,  }\item[{unsigned long}]{cofactor,  }\item[{ecc\+\_\+key $\ast$}]{key }\end{DoxyParamCaption})}



Definition at line 85 of file ecc\+\_\+set\+\_\+curve\+\_\+internal.\+c.


\begin{DoxyCode}{0}
\DoxyCodeLine{86 \{}
\DoxyCodeLine{87    \textcolor{keywordtype}{int} err;}
\DoxyCodeLine{88 }
\DoxyCodeLine{89    \mbox{\hyperlink{tomcrypt__argchk_8h_a683da3e041e49f196318b6ea951414ba}{LTC\_ARGCHK}}(key   != NULL);}
\DoxyCodeLine{90    \mbox{\hyperlink{tomcrypt__argchk_8h_a683da3e041e49f196318b6ea951414ba}{LTC\_ARGCHK}}(a     != NULL);}
\DoxyCodeLine{91    \mbox{\hyperlink{tomcrypt__argchk_8h_a683da3e041e49f196318b6ea951414ba}{LTC\_ARGCHK}}(b     != NULL);}
\DoxyCodeLine{92    \mbox{\hyperlink{tomcrypt__argchk_8h_a683da3e041e49f196318b6ea951414ba}{LTC\_ARGCHK}}(prime != NULL);}
\DoxyCodeLine{93    \mbox{\hyperlink{tomcrypt__argchk_8h_a683da3e041e49f196318b6ea951414ba}{LTC\_ARGCHK}}(order != NULL);}
\DoxyCodeLine{94    \mbox{\hyperlink{tomcrypt__argchk_8h_a683da3e041e49f196318b6ea951414ba}{LTC\_ARGCHK}}(gx    != NULL);}
\DoxyCodeLine{95    \mbox{\hyperlink{tomcrypt__argchk_8h_a683da3e041e49f196318b6ea951414ba}{LTC\_ARGCHK}}(gy    != NULL);}
\DoxyCodeLine{96 }
\DoxyCodeLine{97    \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{tomcrypt__private_8h_adb6322247b1a4f0347219acab3120bd3}{mp\_init\_multi}}(\&key->dp.prime, \&key->dp.order, \&key->dp.A, \&key->dp.B,}
\DoxyCodeLine{98                             \&key->dp.base.x, \&key->dp.base.y, \&key->dp.base.z,}
\DoxyCodeLine{99                             \&key->pubkey.x, \&key->pubkey.y, \&key->pubkey.z, \&key->k,}
\DoxyCodeLine{100                             NULL)) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}}) \{}
\DoxyCodeLine{101       \textcolor{keywordflow}{return} err;}
\DoxyCodeLine{102    \}}
\DoxyCodeLine{103 }
\DoxyCodeLine{104    \textcolor{comment}{/* A, B, order, prime, Gx, Gy */}}
\DoxyCodeLine{105    \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{tomcrypt__private_8h_afbb35bc8f920448d169ddc83a4308840}{mp\_copy}}(prime, key->dp.prime )) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}}) \{ \textcolor{keywordflow}{goto} error; \}}
\DoxyCodeLine{106    \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{tomcrypt__private_8h_afbb35bc8f920448d169ddc83a4308840}{mp\_copy}}(order, key->dp.order )) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}}) \{ \textcolor{keywordflow}{goto} error; \}}
\DoxyCodeLine{107    \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{tomcrypt__private_8h_afbb35bc8f920448d169ddc83a4308840}{mp\_copy}}(a,     key->dp.A     )) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}}) \{ \textcolor{keywordflow}{goto} error; \}}
\DoxyCodeLine{108    \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{tomcrypt__private_8h_afbb35bc8f920448d169ddc83a4308840}{mp\_copy}}(b,     key->dp.B     )) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}}) \{ \textcolor{keywordflow}{goto} error; \}}
\DoxyCodeLine{109    \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{tomcrypt__private_8h_afbb35bc8f920448d169ddc83a4308840}{mp\_copy}}(gx,    key->dp.base.x)) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}}) \{ \textcolor{keywordflow}{goto} error; \}}
\DoxyCodeLine{110    \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{tomcrypt__private_8h_afbb35bc8f920448d169ddc83a4308840}{mp\_copy}}(gy,    key->dp.base.y)) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}}) \{ \textcolor{keywordflow}{goto} error; \}}
\DoxyCodeLine{111    \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{tomcrypt__private_8h_a000b0542ef4ecf639ff69895490fdb8f}{mp\_set}}(key->dp.base.z, 1)) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}})      \{ \textcolor{keywordflow}{goto} error; \}}
\DoxyCodeLine{112    \textcolor{comment}{/* cofactor \& size */}}
\DoxyCodeLine{113    key->dp.cofactor = cofactor;}
\DoxyCodeLine{114    key->dp.size = \mbox{\hyperlink{tomcrypt__private_8h_ad301148bb24f43a8c7003a6976dfaa5a}{mp\_unsigned\_bin\_size}}(prime);}
\DoxyCodeLine{115    \textcolor{comment}{/* try to find OID in ltc\_ecc\_curves */}}
\DoxyCodeLine{116    \mbox{\hyperlink{ecc__set__curve__internal_8c_a3d657756a1e38d4f275973a9a0f98fd1}{\_ecc\_oid\_lookup}}(key);}
\DoxyCodeLine{117    \textcolor{comment}{/* success */}}
\DoxyCodeLine{118    \textcolor{keywordflow}{return} \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}};}
\DoxyCodeLine{119 }
\DoxyCodeLine{120 error:}
\DoxyCodeLine{121    \mbox{\hyperlink{ecc__free_8c_a73cd81ea7d3b24f2d9ef309c4b22e3b7}{ecc\_free}}(key);}
\DoxyCodeLine{122    \textcolor{keywordflow}{return} err;}
\DoxyCodeLine{123 \}}

\end{DoxyCode}


References \+\_\+ecc\+\_\+oid\+\_\+lookup(), C\+R\+Y\+P\+T\+\_\+\+OK, ecc\+\_\+free(), L\+T\+C\+\_\+\+A\+R\+G\+C\+HK, mp\+\_\+copy, mp\+\_\+init\+\_\+multi, mp\+\_\+set, and mp\+\_\+unsigned\+\_\+bin\+\_\+size.



Referenced by \+\_\+ecc\+\_\+import\+\_\+private\+\_\+with\+\_\+curve(), \+\_\+ecc\+\_\+import\+\_\+x509\+\_\+with\+\_\+curve(), and ecc\+\_\+import\+\_\+pkcs8().

Here is the call graph for this function\+:
% FIG 30
Here is the caller graph for this function\+:
% FIG 31
\mbox{\Hypertarget{tomcrypt__private_8h_a5921e9a5a19d09bc948281baf09ea128}\label{tomcrypt__private_8h_a5921e9a5a19d09bc948281baf09ea128}} 
\index{tomcrypt\_private.h@{tomcrypt\_private.h}!ecc\_ssh\_ecdsa\_encode\_name@{ecc\_ssh\_ecdsa\_encode\_name}}
\index{ecc\_ssh\_ecdsa\_encode\_name@{ecc\_ssh\_ecdsa\_encode\_name}!tomcrypt\_private.h@{tomcrypt\_private.h}}
\subsubsection{\texorpdfstring{ecc\_ssh\_ecdsa\_encode\_name()}{ecc\_ssh\_ecdsa\_encode\_name()}}
{\footnotesize\ttfamily int ecc\+\_\+ssh\+\_\+ecdsa\+\_\+encode\+\_\+name (\begin{DoxyParamCaption}\item[{char $\ast$}]{buffer,  }\item[{unsigned long $\ast$}]{buflen,  }\item[{const ecc\+\_\+key $\ast$}]{key }\end{DoxyParamCaption})}



Curve/\+O\+ID to S\+S\+H+\+E\+C\+D\+SA name string mapping. 


\begin{DoxyParams}{Parameters}
{\em buffer} & \mbox{[}out\mbox{]} The destination for the name \\
\hline
{\em buflen} & \mbox{[}in/out\mbox{]} The max size and resulting size (including terminator) of the name \\
\hline
{\em key} & A public or private E\+CC key \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
C\+R\+Y\+P\+T\+\_\+\+OK if successful 
\end{DoxyReturn}


Definition at line 24 of file ecc\+\_\+ssh\+\_\+ecdsa\+\_\+encode\+\_\+name.\+c.


\begin{DoxyCode}{0}
\DoxyCodeLine{25 \{}
\DoxyCodeLine{26    \textcolor{keywordtype}{char} oidstr[64];}
\DoxyCodeLine{27    \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} oidlen = \textcolor{keyword}{sizeof}(oidstr);}
\DoxyCodeLine{28    \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} size = 0;}
\DoxyCodeLine{29    \textcolor{keywordtype}{int} err;}
\DoxyCodeLine{30 }
\DoxyCodeLine{31    \mbox{\hyperlink{tomcrypt__argchk_8h_a683da3e041e49f196318b6ea951414ba}{LTC\_ARGCHK}}(buffer != NULL);}
\DoxyCodeLine{32    \mbox{\hyperlink{tomcrypt__argchk_8h_a683da3e041e49f196318b6ea951414ba}{LTC\_ARGCHK}}(buflen != NULL);}
\DoxyCodeLine{33    \mbox{\hyperlink{tomcrypt__argchk_8h_a683da3e041e49f196318b6ea951414ba}{LTC\_ARGCHK}}(key != NULL);}
\DoxyCodeLine{34 }
\DoxyCodeLine{35    \textcolor{comment}{/* Get the OID of the curve */}}
\DoxyCodeLine{36    \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{ecc__get__oid__str_8c_a55d2be4c5b58f6a22c780f10063d2217}{ecc\_get\_oid\_str}}(oidstr, \&oidlen, key)) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}}) \textcolor{keywordflow}{goto} error;}
\DoxyCodeLine{37 }
\DoxyCodeLine{38    \textcolor{comment}{/* Check for three named curves: nistp256, nistp384, nistp521 */}}
\DoxyCodeLine{39    \textcolor{keywordflow}{if} (\mbox{\hyperlink{tomcrypt__cfg_8h_a5d6e3d69e1d3f54de008b963bba3c6b3}{XSTRCMP}}(\textcolor{stringliteral}{"1.2.840.10045.3.1.7"}, oidstr) == 0) \{}
\DoxyCodeLine{40       \textcolor{comment}{/* nistp256 - secp256r1 - OID 1.2.840.10045.3.1.7 */}}
\DoxyCodeLine{41       size = snprintf(buffer, *buflen, \textcolor{stringliteral}{"ecdsa-sha2-nistp256"});}
\DoxyCodeLine{42    \}}
\DoxyCodeLine{43    \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (\mbox{\hyperlink{tomcrypt__cfg_8h_a5d6e3d69e1d3f54de008b963bba3c6b3}{XSTRCMP}}(\textcolor{stringliteral}{"1.3.132.0.34"}, oidstr) == 0) \{}
\DoxyCodeLine{44       \textcolor{comment}{/* nistp384 - secp384r1 - OID 1.3.132.0.34 */}}
\DoxyCodeLine{45       size = snprintf(buffer, *buflen, \textcolor{stringliteral}{"ecdsa-sha2-nistp384"});}
\DoxyCodeLine{46    \}}
\DoxyCodeLine{47    \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (\mbox{\hyperlink{tomcrypt__cfg_8h_a5d6e3d69e1d3f54de008b963bba3c6b3}{XSTRCMP}}(\textcolor{stringliteral}{"1.3.132.0.35"}, oidstr) == 0) \{}
\DoxyCodeLine{48       \textcolor{comment}{/* nistp521 - secp521r1 - OID 1.3.132.0.35 */}}
\DoxyCodeLine{49       size = snprintf(buffer, *buflen, \textcolor{stringliteral}{"ecdsa-sha2-nistp521"});}
\DoxyCodeLine{50    \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{51       \textcolor{comment}{/* Otherwise we use the OID... */}}
\DoxyCodeLine{52       size = snprintf(buffer, *buflen, \textcolor{stringliteral}{"ecdsa-sha2-\%s"}, oidstr);}
\DoxyCodeLine{53    \}}
\DoxyCodeLine{54 }
\DoxyCodeLine{55    \textcolor{comment}{/* snprintf returns size that would have been written, but limits to buflen-1 chars plus terminator */}}
\DoxyCodeLine{56    \textcolor{keywordflow}{if} (size >= *buflen) \{}
\DoxyCodeLine{57       err = \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06caccd878f5599f3036ffe759dbe1a1ac16}{CRYPT\_BUFFER\_OVERFLOW}};}
\DoxyCodeLine{58    \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{59       err = \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}};}
\DoxyCodeLine{60    \}}
\DoxyCodeLine{61    *buflen = size + 1; \textcolor{comment}{/* the string length + NUL byte */}}
\DoxyCodeLine{62 }
\DoxyCodeLine{63 error:}
\DoxyCodeLine{64    \textcolor{keywordflow}{return} err;}
\DoxyCodeLine{65 \}}

\end{DoxyCode}


References C\+R\+Y\+P\+T\+\_\+\+B\+U\+F\+F\+E\+R\+\_\+\+O\+V\+E\+R\+F\+L\+OW, C\+R\+Y\+P\+T\+\_\+\+OK, ecc\+\_\+get\+\_\+oid\+\_\+str(), L\+T\+C\+\_\+\+A\+R\+G\+C\+HK, and X\+S\+T\+R\+C\+M\+P().



Referenced by ecc\+\_\+recover\+\_\+key(), ecc\+\_\+sign\+\_\+hash\+\_\+ex(), and ecc\+\_\+verify\+\_\+hash\+\_\+ex().

Here is the call graph for this function\+:
% FIG 32
Here is the caller graph for this function\+:
% FIG 33
\mbox{\Hypertarget{tomcrypt__private_8h_a4b36b54e30a0a87aff57a936b386df7f}\label{tomcrypt__private_8h_a4b36b54e30a0a87aff57a936b386df7f}} 
\index{tomcrypt\_private.h@{tomcrypt\_private.h}!ltc\_ecc\_copy\_point@{ltc\_ecc\_copy\_point}}
\index{ltc\_ecc\_copy\_point@{ltc\_ecc\_copy\_point}!tomcrypt\_private.h@{tomcrypt\_private.h}}
\subsubsection{\texorpdfstring{ltc\_ecc\_copy\_point()}{ltc\_ecc\_copy\_point()}}
{\footnotesize\ttfamily int ltc\+\_\+ecc\+\_\+copy\+\_\+point (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{tomcrypt__math_8h_a2a6efaeaa795aa54274d7c4fd66b018a}{ecc\+\_\+point}} $\ast$}]{src,  }\item[{\mbox{\hyperlink{tomcrypt__math_8h_a2a6efaeaa795aa54274d7c4fd66b018a}{ecc\+\_\+point}} $\ast$}]{dst }\end{DoxyParamCaption})}



Definition at line 58 of file ltc\+\_\+ecc\+\_\+points.\+c.


\begin{DoxyCode}{0}
\DoxyCodeLine{59 \{}
\DoxyCodeLine{60    \textcolor{keywordtype}{int} err;}
\DoxyCodeLine{61    \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{tomcrypt__math_8h_a3d38c44518c63b7a8abd0938f3d41c65}{ltc\_mp}}.\mbox{\hyperlink{structltc__math__descriptor_a1f4a910f2a962c70c7ef7dae0bc84eef}{copy}}(src->x, dst->x)) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}}) \textcolor{keywordflow}{return} err;}
\DoxyCodeLine{62    \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{tomcrypt__math_8h_a3d38c44518c63b7a8abd0938f3d41c65}{ltc\_mp}}.\mbox{\hyperlink{structltc__math__descriptor_a1f4a910f2a962c70c7ef7dae0bc84eef}{copy}}(src->y, dst->y)) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}}) \textcolor{keywordflow}{return} err;}
\DoxyCodeLine{63    \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{tomcrypt__math_8h_a3d38c44518c63b7a8abd0938f3d41c65}{ltc\_mp}}.\mbox{\hyperlink{structltc__math__descriptor_a1f4a910f2a962c70c7ef7dae0bc84eef}{copy}}(src->z, dst->z)) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}}) \textcolor{keywordflow}{return} err;}
\DoxyCodeLine{64    \textcolor{keywordflow}{return} \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}};}
\DoxyCodeLine{65 \}}

\end{DoxyCode}


References ltc\+\_\+math\+\_\+descriptor\+::copy, C\+R\+Y\+P\+T\+\_\+\+OK, and ltc\+\_\+mp.



Referenced by ecc\+\_\+copy\+\_\+curve(), ecc\+\_\+recover\+\_\+key(), ecc\+\_\+verify\+\_\+hash\+\_\+ex(), ltc\+\_\+ecc\+\_\+mul2add(), ltc\+\_\+ecc\+\_\+mulmod(), ltc\+\_\+ecc\+\_\+projective\+\_\+add\+\_\+point(), and ltc\+\_\+ecc\+\_\+projective\+\_\+dbl\+\_\+point().

Here is the caller graph for this function\+:
% FIG 34
\mbox{\Hypertarget{tomcrypt__private_8h_a4cef83a7c070c94ff78d4df10a7b624f}\label{tomcrypt__private_8h_a4cef83a7c070c94ff78d4df10a7b624f}} 
\index{tomcrypt\_private.h@{tomcrypt\_private.h}!ltc\_ecc\_del\_point@{ltc\_ecc\_del\_point}}
\index{ltc\_ecc\_del\_point@{ltc\_ecc\_del\_point}!tomcrypt\_private.h@{tomcrypt\_private.h}}
\subsubsection{\texorpdfstring{ltc\_ecc\_del\_point()}{ltc\_ecc\_del\_point()}}
{\footnotesize\ttfamily void ltc\+\_\+ecc\+\_\+del\+\_\+point (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{tomcrypt__math_8h_a2a6efaeaa795aa54274d7c4fd66b018a}{ecc\+\_\+point}} $\ast$}]{p }\end{DoxyParamCaption})}



Free an E\+CC point from memory. 


\begin{DoxyParams}{Parameters}
{\em p} & The point to free \\
\hline
\end{DoxyParams}


Definition at line 40 of file ltc\+\_\+ecc\+\_\+points.\+c.


\begin{DoxyCode}{0}
\DoxyCodeLine{41 \{}
\DoxyCodeLine{42    \textcolor{comment}{/* prevents free'ing null arguments */}}
\DoxyCodeLine{43    \textcolor{keywordflow}{if} (p != NULL) \{}
\DoxyCodeLine{44       \mbox{\hyperlink{tomcrypt__private_8h_aad5c8a3112b3e4613f9efc86692c43cb}{mp\_clear\_multi}}(p->x, p->y, p->z, NULL); \textcolor{comment}{/* note: p->z may be NULL but that's ok with this function anyways */}}
\DoxyCodeLine{45       \mbox{\hyperlink{tomcrypt__cfg_8h_a260d66fc0690e0502cf3bfe7b5244b75}{XFREE}}(p);}
\DoxyCodeLine{46    \}}
\DoxyCodeLine{47 \}}

\end{DoxyCode}


References mp\+\_\+clear\+\_\+multi, and X\+F\+R\+E\+E().



Referenced by ecc\+\_\+recover\+\_\+key(), ecc\+\_\+shared\+\_\+secret(), ecc\+\_\+verify\+\_\+hash\+\_\+ex(), ltc\+\_\+ecc\+\_\+mul2add(), ltc\+\_\+ecc\+\_\+mulmod(), and ltc\+\_\+ecc\+\_\+verify\+\_\+key().

Here is the call graph for this function\+:
% FIG 35
Here is the caller graph for this function\+:
% FIG 36
\mbox{\Hypertarget{tomcrypt__private_8h_ae647d3ad2082ac1e6fc81e857c5922b4}\label{tomcrypt__private_8h_ae647d3ad2082ac1e6fc81e857c5922b4}} 
\index{tomcrypt\_private.h@{tomcrypt\_private.h}!ltc\_ecc\_export\_point@{ltc\_ecc\_export\_point}}
\index{ltc\_ecc\_export\_point@{ltc\_ecc\_export\_point}!tomcrypt\_private.h@{tomcrypt\_private.h}}
\subsubsection{\texorpdfstring{ltc\_ecc\_export\_point()}{ltc\_ecc\_export\_point()}}
{\footnotesize\ttfamily int ltc\+\_\+ecc\+\_\+export\+\_\+point (\begin{DoxyParamCaption}\item[{unsigned char $\ast$}]{out,  }\item[{unsigned long $\ast$}]{outlen,  }\item[{void $\ast$}]{x,  }\item[{void $\ast$}]{y,  }\item[{unsigned long}]{size,  }\item[{int}]{compressed }\end{DoxyParamCaption})}



Definition at line 14 of file ltc\+\_\+ecc\+\_\+export\+\_\+point.\+c.


\begin{DoxyCode}{0}
\DoxyCodeLine{15 \{}
\DoxyCodeLine{16    \textcolor{keywordtype}{int} err;}
\DoxyCodeLine{17    \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char} buf[ECC\_BUF\_SIZE];}
\DoxyCodeLine{18    \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} xsize, ysize;}
\DoxyCodeLine{19 }
\DoxyCodeLine{20    \textcolor{keywordflow}{if} (size > \textcolor{keyword}{sizeof}(buf)) \textcolor{keywordflow}{return} \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06caccd878f5599f3036ffe759dbe1a1ac16}{CRYPT\_BUFFER\_OVERFLOW}};}
\DoxyCodeLine{21    \textcolor{keywordflow}{if} ((xsize = \mbox{\hyperlink{tomcrypt__private_8h_ad301148bb24f43a8c7003a6976dfaa5a}{mp\_unsigned\_bin\_size}}(x)) > size) \textcolor{keywordflow}{return} \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06caccd878f5599f3036ffe759dbe1a1ac16}{CRYPT\_BUFFER\_OVERFLOW}};}
\DoxyCodeLine{22    \textcolor{keywordflow}{if} ((ysize = \mbox{\hyperlink{tomcrypt__private_8h_ad301148bb24f43a8c7003a6976dfaa5a}{mp\_unsigned\_bin\_size}}(y)) > size) \textcolor{keywordflow}{return} \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06caccd878f5599f3036ffe759dbe1a1ac16}{CRYPT\_BUFFER\_OVERFLOW}};}
\DoxyCodeLine{23 }
\DoxyCodeLine{24    \textcolor{keywordflow}{if}(compressed) \{}
\DoxyCodeLine{25       \textcolor{keywordflow}{if} (*outlen < (1 + size)) \{}
\DoxyCodeLine{26          *outlen = 1 + size;}
\DoxyCodeLine{27          \textcolor{keywordflow}{return} \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06caccd878f5599f3036ffe759dbe1a1ac16}{CRYPT\_BUFFER\_OVERFLOW}};}
\DoxyCodeLine{28       \}}
\DoxyCodeLine{29       \textcolor{comment}{/* store first byte */}}
\DoxyCodeLine{30       out[0] = \mbox{\hyperlink{tomcrypt__private_8h_a93ed39c257831509afc74f2b6da66ae7}{mp\_isodd}}(y) ? 0x03 : 0x02;}
\DoxyCodeLine{31       \textcolor{comment}{/* pad and store x */}}
\DoxyCodeLine{32       \mbox{\hyperlink{tomcrypt__misc_8h_a63b6e188713790263bfd3612fe8b398f}{zeromem}}(buf, \textcolor{keyword}{sizeof}(buf));}
\DoxyCodeLine{33       \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{tomcrypt__private_8h_a376a4d31dcfeb65c069db0485b9602f8}{mp\_to\_unsigned\_bin}}(x, buf + (size - xsize))) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}}) \textcolor{keywordflow}{return} err;}
\DoxyCodeLine{34       \mbox{\hyperlink{tomcrypt__cfg_8h_a7691dd48d60d5fc6daf2fa7ec4c55e12}{XMEMCPY}}(out+1, buf, size);}
\DoxyCodeLine{35       \textcolor{comment}{/* adjust outlen */}}
\DoxyCodeLine{36       *outlen = 1 + size;}
\DoxyCodeLine{37    \}}
\DoxyCodeLine{38    \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{39       \textcolor{keywordflow}{if} (*outlen < (1 + 2*size)) \{}
\DoxyCodeLine{40          *outlen = 1 + 2*size;}
\DoxyCodeLine{41          \textcolor{keywordflow}{return} \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06caccd878f5599f3036ffe759dbe1a1ac16}{CRYPT\_BUFFER\_OVERFLOW}};}
\DoxyCodeLine{42       \}}
\DoxyCodeLine{43       \textcolor{comment}{/* store byte 0x04 */}}
\DoxyCodeLine{44       out[0] = 0x04;}
\DoxyCodeLine{45       \textcolor{comment}{/* pad and store x */}}
\DoxyCodeLine{46       \mbox{\hyperlink{tomcrypt__misc_8h_a63b6e188713790263bfd3612fe8b398f}{zeromem}}(buf, \textcolor{keyword}{sizeof}(buf));}
\DoxyCodeLine{47       \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{tomcrypt__private_8h_a376a4d31dcfeb65c069db0485b9602f8}{mp\_to\_unsigned\_bin}}(x, buf + (size - xsize))) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}}) \textcolor{keywordflow}{return} err;}
\DoxyCodeLine{48       \mbox{\hyperlink{tomcrypt__cfg_8h_a7691dd48d60d5fc6daf2fa7ec4c55e12}{XMEMCPY}}(out+1, buf, size);}
\DoxyCodeLine{49       \textcolor{comment}{/* pad and store y */}}
\DoxyCodeLine{50       \mbox{\hyperlink{tomcrypt__misc_8h_a63b6e188713790263bfd3612fe8b398f}{zeromem}}(buf, \textcolor{keyword}{sizeof}(buf));}
\DoxyCodeLine{51       \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{tomcrypt__private_8h_a376a4d31dcfeb65c069db0485b9602f8}{mp\_to\_unsigned\_bin}}(y, buf + (size - ysize))) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}}) \textcolor{keywordflow}{return} err;}
\DoxyCodeLine{52       \mbox{\hyperlink{tomcrypt__cfg_8h_a7691dd48d60d5fc6daf2fa7ec4c55e12}{XMEMCPY}}(out+1+size, buf, size);}
\DoxyCodeLine{53       \textcolor{comment}{/* adjust outlen */}}
\DoxyCodeLine{54       *outlen = 1 + 2*size;}
\DoxyCodeLine{55    \}}
\DoxyCodeLine{56    \textcolor{keywordflow}{return} \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}};}
\DoxyCodeLine{57 \}}

\end{DoxyCode}


References C\+R\+Y\+P\+T\+\_\+\+B\+U\+F\+F\+E\+R\+\_\+\+O\+V\+E\+R\+F\+L\+OW, C\+R\+Y\+P\+T\+\_\+\+OK, mp\+\_\+isodd, mp\+\_\+to\+\_\+unsigned\+\_\+bin, mp\+\_\+unsigned\+\_\+bin\+\_\+size, X\+M\+E\+M\+C\+P\+Y(), and zeromem().



Referenced by ecc\+\_\+export\+\_\+openssl(), and ecc\+\_\+get\+\_\+key().

Here is the call graph for this function\+:
% FIG 37
Here is the caller graph for this function\+:
% FIG 38
\mbox{\Hypertarget{tomcrypt__private_8h_aa63889eb69cecc42e44b7dfa9ad9d473}\label{tomcrypt__private_8h_aa63889eb69cecc42e44b7dfa9ad9d473}} 
\index{tomcrypt\_private.h@{tomcrypt\_private.h}!ltc\_ecc\_import\_point@{ltc\_ecc\_import\_point}}
\index{ltc\_ecc\_import\_point@{ltc\_ecc\_import\_point}!tomcrypt\_private.h@{tomcrypt\_private.h}}
\subsubsection{\texorpdfstring{ltc\_ecc\_import\_point()}{ltc\_ecc\_import\_point()}}
{\footnotesize\ttfamily int ltc\+\_\+ecc\+\_\+import\+\_\+point (\begin{DoxyParamCaption}\item[{const unsigned char $\ast$}]{in,  }\item[{unsigned long}]{inlen,  }\item[{void $\ast$}]{prime,  }\item[{void $\ast$}]{a,  }\item[{void $\ast$}]{b,  }\item[{void $\ast$}]{x,  }\item[{void $\ast$}]{y }\end{DoxyParamCaption})}



Definition at line 14 of file ltc\+\_\+ecc\+\_\+import\+\_\+point.\+c.


\begin{DoxyCode}{0}
\DoxyCodeLine{15 \{}
\DoxyCodeLine{16    \textcolor{keywordtype}{int} err;}
\DoxyCodeLine{17    \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} size;}
\DoxyCodeLine{18    \textcolor{keywordtype}{void} *\mbox{\hyperlink{tiger_8c_a65f7891fccbfcf7d08964555630773b3}{t1}}, *\mbox{\hyperlink{tiger_8c_aa4652e2d6053d420dcbea07a113db5fe}{t2}};}
\DoxyCodeLine{19 }
\DoxyCodeLine{20    \textcolor{comment}{/* init key + temporary numbers */}}
\DoxyCodeLine{21    \textcolor{keywordflow}{if} (\mbox{\hyperlink{tomcrypt__private_8h_adb6322247b1a4f0347219acab3120bd3}{mp\_init\_multi}}(\&\mbox{\hyperlink{tiger_8c_a65f7891fccbfcf7d08964555630773b3}{t1}}, \&\mbox{\hyperlink{tiger_8c_aa4652e2d6053d420dcbea07a113db5fe}{t2}}, NULL) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}}) \{}
\DoxyCodeLine{22       \textcolor{keywordflow}{return} \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06ca0ce0d27adc7ea10b74b7ea904b8bfa82}{CRYPT\_MEM}};}
\DoxyCodeLine{23    \}}
\DoxyCodeLine{24 }
\DoxyCodeLine{25    size = \mbox{\hyperlink{tomcrypt__private_8h_ad301148bb24f43a8c7003a6976dfaa5a}{mp\_unsigned\_bin\_size}}(prime);}
\DoxyCodeLine{26 }
\DoxyCodeLine{27    \textcolor{keywordflow}{if} (in[0] == 0x04 \&\& (inlen\&1) \&\& ((inlen-1)>>1) == size) \{}
\DoxyCodeLine{28       \textcolor{comment}{/* read uncompressed point */}}
\DoxyCodeLine{29       \textcolor{comment}{/* load x */}}
\DoxyCodeLine{30       \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{tomcrypt__private_8h_a9e20e2044bb5a279e27512d1e1b65754}{mp\_read\_unsigned\_bin}}(x, (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char} *)in+1, size)) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}})      \{ \textcolor{keywordflow}{goto} cleanup; \}}
\DoxyCodeLine{31       \textcolor{comment}{/* load y */}}
\DoxyCodeLine{32       \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{tomcrypt__private_8h_a9e20e2044bb5a279e27512d1e1b65754}{mp\_read\_unsigned\_bin}}(y, (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char} *)in+1+size, size)) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}}) \{ \textcolor{keywordflow}{goto} cleanup; \}}
\DoxyCodeLine{33    \}}
\DoxyCodeLine{34    \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} ((in[0] == 0x02 || in[0] == 0x03) \&\& (inlen-1) == size \&\& \mbox{\hyperlink{tomcrypt__math_8h_a3d38c44518c63b7a8abd0938f3d41c65}{ltc\_mp}}.\mbox{\hyperlink{structltc__math__descriptor_ae588937a77f227870ff809f5f8f0deb8}{sqrtmod\_prime}} != NULL) \{}
\DoxyCodeLine{35       \textcolor{comment}{/* read compressed point - BEWARE: requires sqrtmod\_prime */}}
\DoxyCodeLine{36       \textcolor{comment}{/* load x */}}
\DoxyCodeLine{37       \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{tomcrypt__private_8h_a9e20e2044bb5a279e27512d1e1b65754}{mp\_read\_unsigned\_bin}}(x, (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char} *)in+1, size)) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}})      \{ \textcolor{keywordflow}{goto} cleanup; \}}
\DoxyCodeLine{38       \textcolor{comment}{/* compute x\string^3 */}}
\DoxyCodeLine{39       \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{tomcrypt__private_8h_aea81d79b5462e99068908d80edb8bd1a}{mp\_sqr}}(x, \mbox{\hyperlink{tiger_8c_a65f7891fccbfcf7d08964555630773b3}{t1}})) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}})                                             \{ \textcolor{keywordflow}{goto} cleanup; \}}
\DoxyCodeLine{40       \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{tomcrypt__private_8h_a0c32b20b84951870c7b09f5b6f2679c9}{mp\_mulmod}}(\mbox{\hyperlink{tiger_8c_a65f7891fccbfcf7d08964555630773b3}{t1}}, x, prime, \mbox{\hyperlink{tiger_8c_a65f7891fccbfcf7d08964555630773b3}{t1}})) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}})                               \{ \textcolor{keywordflow}{goto} cleanup; \}}
\DoxyCodeLine{41       \textcolor{comment}{/* compute x\string^3 + a*x */}}
\DoxyCodeLine{42       \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{tomcrypt__private_8h_a0c32b20b84951870c7b09f5b6f2679c9}{mp\_mulmod}}(a, x, prime, \mbox{\hyperlink{tiger_8c_aa4652e2d6053d420dcbea07a113db5fe}{t2}})) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}})                                \{ \textcolor{keywordflow}{goto} cleanup; \}}
\DoxyCodeLine{43       \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{tomcrypt__private_8h_a175d04f8aeaa1c3895fe14de6cc0d2db}{mp\_add}}(\mbox{\hyperlink{tiger_8c_a65f7891fccbfcf7d08964555630773b3}{t1}}, \mbox{\hyperlink{tiger_8c_aa4652e2d6053d420dcbea07a113db5fe}{t2}}, \mbox{\hyperlink{tiger_8c_a65f7891fccbfcf7d08964555630773b3}{t1}})) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}})                                        \{ \textcolor{keywordflow}{goto} cleanup; \}}
\DoxyCodeLine{44       \textcolor{comment}{/* compute x\string^3 + a*x + b */}}
\DoxyCodeLine{45       \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{tomcrypt__private_8h_a175d04f8aeaa1c3895fe14de6cc0d2db}{mp\_add}}(\mbox{\hyperlink{tiger_8c_a65f7891fccbfcf7d08964555630773b3}{t1}}, b, \mbox{\hyperlink{tiger_8c_a65f7891fccbfcf7d08964555630773b3}{t1}})) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}})                                         \{ \textcolor{keywordflow}{goto} cleanup; \}}
\DoxyCodeLine{46       \textcolor{comment}{/* compute sqrt(x\string^3 + a*x + b) */}}
\DoxyCodeLine{47       \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{tomcrypt__private_8h_af1a090c9979e328596fa37512f519a09}{mp\_sqrtmod\_prime}}(\mbox{\hyperlink{tiger_8c_a65f7891fccbfcf7d08964555630773b3}{t1}}, prime, \mbox{\hyperlink{tiger_8c_aa4652e2d6053d420dcbea07a113db5fe}{t2}})) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}})                           \{ \textcolor{keywordflow}{goto} cleanup; \}}
\DoxyCodeLine{48       \textcolor{comment}{/* adjust y */}}
\DoxyCodeLine{49       \textcolor{keywordflow}{if} ((\mbox{\hyperlink{tomcrypt__private_8h_a93ed39c257831509afc74f2b6da66ae7}{mp\_isodd}}(\mbox{\hyperlink{tiger_8c_aa4652e2d6053d420dcbea07a113db5fe}{t2}}) \&\& in[0] == 0x03) || (!\mbox{\hyperlink{tomcrypt__private_8h_a93ed39c257831509afc74f2b6da66ae7}{mp\_isodd}}(\mbox{\hyperlink{tiger_8c_aa4652e2d6053d420dcbea07a113db5fe}{t2}}) \&\& in[0] == 0x02)) \{}
\DoxyCodeLine{50          \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{tomcrypt__private_8h_ac7deed6f00e289706070b16f98c430fe}{mp\_mod}}(\mbox{\hyperlink{tiger_8c_aa4652e2d6053d420dcbea07a113db5fe}{t2}}, prime, y)) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}})                                   \{ \textcolor{keywordflow}{goto} cleanup; \}}
\DoxyCodeLine{51       \}}
\DoxyCodeLine{52       \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{53          \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{tomcrypt__private_8h_a15e2f6c11b3fcebe885ecc14d759ac01}{mp\_submod}}(prime, \mbox{\hyperlink{tiger_8c_aa4652e2d6053d420dcbea07a113db5fe}{t2}}, prime, y)) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}})                         \{ \textcolor{keywordflow}{goto} cleanup; \}}
\DoxyCodeLine{54       \}}
\DoxyCodeLine{55    \}}
\DoxyCodeLine{56    \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{57       err = \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06ca980088f10ffe9009aec286038a9e79da}{CRYPT\_INVALID\_PACKET}};}
\DoxyCodeLine{58       \textcolor{keywordflow}{goto} cleanup;}
\DoxyCodeLine{59    \}}
\DoxyCodeLine{60 }
\DoxyCodeLine{61    err = \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}};}
\DoxyCodeLine{62 cleanup:}
\DoxyCodeLine{63    \mbox{\hyperlink{tomcrypt__private_8h_aad5c8a3112b3e4613f9efc86692c43cb}{mp\_clear\_multi}}(\mbox{\hyperlink{tiger_8c_a65f7891fccbfcf7d08964555630773b3}{t1}}, \mbox{\hyperlink{tiger_8c_aa4652e2d6053d420dcbea07a113db5fe}{t2}}, NULL);}
\DoxyCodeLine{64    \textcolor{keywordflow}{return} err;}
\DoxyCodeLine{65 \}}

\end{DoxyCode}


References C\+R\+Y\+P\+T\+\_\+\+I\+N\+V\+A\+L\+I\+D\+\_\+\+P\+A\+C\+K\+ET, C\+R\+Y\+P\+T\+\_\+\+M\+EM, C\+R\+Y\+P\+T\+\_\+\+OK, ltc\+\_\+mp, mp\+\_\+add, mp\+\_\+clear\+\_\+multi, mp\+\_\+init\+\_\+multi, mp\+\_\+isodd, mp\+\_\+mod, mp\+\_\+mulmod, mp\+\_\+read\+\_\+unsigned\+\_\+bin, mp\+\_\+sqr, mp\+\_\+sqrtmod\+\_\+prime, mp\+\_\+submod, mp\+\_\+unsigned\+\_\+bin\+\_\+size, ltc\+\_\+math\+\_\+descriptor\+::sqrtmod\+\_\+prime, t1, and t2.



Referenced by \+\_\+ecc\+\_\+import\+\_\+private\+\_\+with\+\_\+curve(), \+\_\+ecc\+\_\+import\+\_\+x509\+\_\+with\+\_\+curve(), ecc\+\_\+import\+\_\+pkcs8(), and ecc\+\_\+set\+\_\+key().

Here is the caller graph for this function\+:
% FIG 39
\mbox{\Hypertarget{tomcrypt__private_8h_affd37f56571ffc28d2c2687a76014b11}\label{tomcrypt__private_8h_affd37f56571ffc28d2c2687a76014b11}} 
\index{tomcrypt\_private.h@{tomcrypt\_private.h}!ltc\_ecc\_is\_point@{ltc\_ecc\_is\_point}}
\index{ltc\_ecc\_is\_point@{ltc\_ecc\_is\_point}!tomcrypt\_private.h@{tomcrypt\_private.h}}
\subsubsection{\texorpdfstring{ltc\_ecc\_is\_point()}{ltc\_ecc\_is\_point()}}
{\footnotesize\ttfamily int ltc\+\_\+ecc\+\_\+is\+\_\+point (\begin{DoxyParamCaption}\item[{const ltc\+\_\+ecc\+\_\+dp $\ast$}]{dp,  }\item[{void $\ast$}]{x,  }\item[{void $\ast$}]{y }\end{DoxyParamCaption})}



Returns whether \mbox{[}x,y\mbox{]} is a point on curve defined by dp. 


\begin{DoxyParams}{Parameters}
{\em dp} & curve parameters \\
\hline
{\em x} & x point coordinate \\
\hline
{\em y} & y point coordinate \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
C\+R\+Y\+P\+T\+\_\+\+OK if valid 
\end{DoxyReturn}


Definition at line 21 of file ltc\+\_\+ecc\+\_\+is\+\_\+point.\+c.


\begin{DoxyCode}{0}
\DoxyCodeLine{22 \{}
\DoxyCodeLine{23   \textcolor{keywordtype}{void} *prime, *a, *b, *\mbox{\hyperlink{tiger_8c_a65f7891fccbfcf7d08964555630773b3}{t1}}, *\mbox{\hyperlink{tiger_8c_aa4652e2d6053d420dcbea07a113db5fe}{t2}};}
\DoxyCodeLine{24   \textcolor{keywordtype}{int} err;}
\DoxyCodeLine{25 }
\DoxyCodeLine{26   prime = dp->prime;}
\DoxyCodeLine{27   b     = dp->B;}
\DoxyCodeLine{28   a     = dp->A;}
\DoxyCodeLine{29 }
\DoxyCodeLine{30   \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{tomcrypt__private_8h_adb6322247b1a4f0347219acab3120bd3}{mp\_init\_multi}}(\&\mbox{\hyperlink{tiger_8c_a65f7891fccbfcf7d08964555630773b3}{t1}}, \&\mbox{\hyperlink{tiger_8c_aa4652e2d6053d420dcbea07a113db5fe}{t2}}, NULL)) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}})  \textcolor{keywordflow}{return} err;}
\DoxyCodeLine{31 }
\DoxyCodeLine{32   \textcolor{comment}{/* compute y\string^2 */}}
\DoxyCodeLine{33   \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{tomcrypt__private_8h_aea81d79b5462e99068908d80edb8bd1a}{mp\_sqr}}(y, \mbox{\hyperlink{tiger_8c_a65f7891fccbfcf7d08964555630773b3}{t1}})) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}})                  \textcolor{keywordflow}{goto} cleanup;}
\DoxyCodeLine{34 }
\DoxyCodeLine{35   \textcolor{comment}{/* compute x\string^3 */}}
\DoxyCodeLine{36   \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{tomcrypt__private_8h_aea81d79b5462e99068908d80edb8bd1a}{mp\_sqr}}(x, \mbox{\hyperlink{tiger_8c_aa4652e2d6053d420dcbea07a113db5fe}{t2}})) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}})                  \textcolor{keywordflow}{goto} cleanup;}
\DoxyCodeLine{37   \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{tomcrypt__private_8h_ac7deed6f00e289706070b16f98c430fe}{mp\_mod}}(\mbox{\hyperlink{tiger_8c_aa4652e2d6053d420dcbea07a113db5fe}{t2}}, prime, \mbox{\hyperlink{tiger_8c_aa4652e2d6053d420dcbea07a113db5fe}{t2}})) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}})          \textcolor{keywordflow}{goto} cleanup;}
\DoxyCodeLine{38   \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{tomcrypt__private_8h_a7606d2423856b32b09245a2fa1ef34ee}{mp\_mul}}(x, \mbox{\hyperlink{tiger_8c_aa4652e2d6053d420dcbea07a113db5fe}{t2}}, \mbox{\hyperlink{tiger_8c_aa4652e2d6053d420dcbea07a113db5fe}{t2}})) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}})              \textcolor{keywordflow}{goto} cleanup;}
\DoxyCodeLine{39 }
\DoxyCodeLine{40   \textcolor{comment}{/* compute y\string^2 - x\string^3 */}}
\DoxyCodeLine{41   \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{tomcrypt__private_8h_ab8d0882c3b58263b638b41fbf110fde8}{mp\_sub}}(\mbox{\hyperlink{tiger_8c_a65f7891fccbfcf7d08964555630773b3}{t1}}, \mbox{\hyperlink{tiger_8c_aa4652e2d6053d420dcbea07a113db5fe}{t2}}, \mbox{\hyperlink{tiger_8c_a65f7891fccbfcf7d08964555630773b3}{t1}})) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}})             \textcolor{keywordflow}{goto} cleanup;}
\DoxyCodeLine{42 }
\DoxyCodeLine{43   \textcolor{comment}{/* compute y\string^2 - x\string^3 - a*x */}}
\DoxyCodeLine{44   \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{tomcrypt__private_8h_a15e2f6c11b3fcebe885ecc14d759ac01}{mp\_submod}}(prime, a, prime, \mbox{\hyperlink{tiger_8c_aa4652e2d6053d420dcbea07a113db5fe}{t2}})) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}}) \textcolor{keywordflow}{goto} cleanup;}
\DoxyCodeLine{45   \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{tomcrypt__private_8h_a0c32b20b84951870c7b09f5b6f2679c9}{mp\_mulmod}}(\mbox{\hyperlink{tiger_8c_aa4652e2d6053d420dcbea07a113db5fe}{t2}}, x, prime, \mbox{\hyperlink{tiger_8c_aa4652e2d6053d420dcbea07a113db5fe}{t2}})) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}})    \textcolor{keywordflow}{goto} cleanup;}
\DoxyCodeLine{46   \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{tomcrypt__private_8h_a3cc86fdd66c67023afe490b3534d459b}{mp\_addmod}}(\mbox{\hyperlink{tiger_8c_a65f7891fccbfcf7d08964555630773b3}{t1}}, \mbox{\hyperlink{tiger_8c_aa4652e2d6053d420dcbea07a113db5fe}{t2}}, prime, \mbox{\hyperlink{tiger_8c_a65f7891fccbfcf7d08964555630773b3}{t1}})) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}})   \textcolor{keywordflow}{goto} cleanup;}
\DoxyCodeLine{47 }
\DoxyCodeLine{48   \textcolor{comment}{/* adjust range (0, prime) */}}
\DoxyCodeLine{49   \textcolor{keywordflow}{while} (\mbox{\hyperlink{tomcrypt__private_8h_a6ce44f2e6f872565a468b67d9a93dc28}{mp\_cmp\_d}}(\mbox{\hyperlink{tiger_8c_a65f7891fccbfcf7d08964555630773b3}{t1}}, 0) == \mbox{\hyperlink{tomcrypt__math_8h_a42d0c7d4c09793df79660774d3436db2}{LTC\_MP\_LT}}) \{}
\DoxyCodeLine{50      \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{tomcrypt__private_8h_a175d04f8aeaa1c3895fe14de6cc0d2db}{mp\_add}}(\mbox{\hyperlink{tiger_8c_a65f7891fccbfcf7d08964555630773b3}{t1}}, prime, \mbox{\hyperlink{tiger_8c_a65f7891fccbfcf7d08964555630773b3}{t1}})) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}})       \textcolor{keywordflow}{goto} cleanup;}
\DoxyCodeLine{51   \}}
\DoxyCodeLine{52   \textcolor{keywordflow}{while} (\mbox{\hyperlink{tomcrypt__private_8h_a62ea02fbe7dd2d456e49520264d775ee}{mp\_cmp}}(\mbox{\hyperlink{tiger_8c_a65f7891fccbfcf7d08964555630773b3}{t1}}, prime) != \mbox{\hyperlink{tomcrypt__math_8h_a42d0c7d4c09793df79660774d3436db2}{LTC\_MP\_LT}}) \{}
\DoxyCodeLine{53      \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{tomcrypt__private_8h_ab8d0882c3b58263b638b41fbf110fde8}{mp\_sub}}(\mbox{\hyperlink{tiger_8c_a65f7891fccbfcf7d08964555630773b3}{t1}}, prime, \mbox{\hyperlink{tiger_8c_a65f7891fccbfcf7d08964555630773b3}{t1}})) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}})       \textcolor{keywordflow}{goto} cleanup;}
\DoxyCodeLine{54   \}}
\DoxyCodeLine{55 }
\DoxyCodeLine{56   \textcolor{comment}{/* compare to b */}}
\DoxyCodeLine{57   \textcolor{keywordflow}{if} (\mbox{\hyperlink{tomcrypt__private_8h_a62ea02fbe7dd2d456e49520264d775ee}{mp\_cmp}}(\mbox{\hyperlink{tiger_8c_a65f7891fccbfcf7d08964555630773b3}{t1}}, b) != \mbox{\hyperlink{tomcrypt__math_8h_a035a31bde4f31419eb259e36e5776607}{LTC\_MP\_EQ}}) \{}
\DoxyCodeLine{58      err = \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06ca980088f10ffe9009aec286038a9e79da}{CRYPT\_INVALID\_PACKET}};}
\DoxyCodeLine{59   \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{60      err = \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}};}
\DoxyCodeLine{61   \}}
\DoxyCodeLine{62 }
\DoxyCodeLine{63 cleanup:}
\DoxyCodeLine{64   \mbox{\hyperlink{tomcrypt__private_8h_aad5c8a3112b3e4613f9efc86692c43cb}{mp\_clear\_multi}}(\mbox{\hyperlink{tiger_8c_a65f7891fccbfcf7d08964555630773b3}{t1}}, \mbox{\hyperlink{tiger_8c_aa4652e2d6053d420dcbea07a113db5fe}{t2}}, NULL);}
\DoxyCodeLine{65   \textcolor{keywordflow}{return} err;}
\DoxyCodeLine{66 \}}

\end{DoxyCode}


References C\+R\+Y\+P\+T\+\_\+\+I\+N\+V\+A\+L\+I\+D\+\_\+\+P\+A\+C\+K\+ET, C\+R\+Y\+P\+T\+\_\+\+OK, L\+T\+C\+\_\+\+M\+P\+\_\+\+EQ, L\+T\+C\+\_\+\+M\+P\+\_\+\+LT, mp\+\_\+add, mp\+\_\+addmod, mp\+\_\+clear\+\_\+multi, mp\+\_\+cmp, mp\+\_\+cmp\+\_\+d, mp\+\_\+init\+\_\+multi, mp\+\_\+mod, mp\+\_\+mul, mp\+\_\+mulmod, mp\+\_\+sqr, mp\+\_\+sub, mp\+\_\+submod, t1, and t2.



Referenced by ltc\+\_\+ecc\+\_\+verify\+\_\+key().

Here is the caller graph for this function\+:
% FIG 40
\mbox{\Hypertarget{tomcrypt__private_8h_a54a2d7d30af25ef341a8aca09269177d}\label{tomcrypt__private_8h_a54a2d7d30af25ef341a8aca09269177d}} 
\index{tomcrypt\_private.h@{tomcrypt\_private.h}!ltc\_ecc\_is\_point\_at\_infinity@{ltc\_ecc\_is\_point\_at\_infinity}}
\index{ltc\_ecc\_is\_point\_at\_infinity@{ltc\_ecc\_is\_point\_at\_infinity}!tomcrypt\_private.h@{tomcrypt\_private.h}}
\subsubsection{\texorpdfstring{ltc\_ecc\_is\_point\_at\_infinity()}{ltc\_ecc\_is\_point\_at\_infinity()}}
{\footnotesize\ttfamily int ltc\+\_\+ecc\+\_\+is\+\_\+point\+\_\+at\+\_\+infinity (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{tomcrypt__math_8h_a2a6efaeaa795aa54274d7c4fd66b018a}{ecc\+\_\+point}} $\ast$}]{P,  }\item[{void $\ast$}]{modulus,  }\item[{int $\ast$}]{retval }\end{DoxyParamCaption})}



Definition at line 18 of file ltc\+\_\+ecc\+\_\+is\+\_\+point\+\_\+at\+\_\+infinity.\+c.


\begin{DoxyCode}{0}
\DoxyCodeLine{19 \{}
\DoxyCodeLine{20    \textcolor{keywordtype}{int} err;}
\DoxyCodeLine{21    \textcolor{keywordtype}{void}  *x3, *y2;}
\DoxyCodeLine{22 }
\DoxyCodeLine{23    \textcolor{comment}{/* trivial case */}}
\DoxyCodeLine{24    \textcolor{keywordflow}{if} (!\mbox{\hyperlink{tomcrypt__private_8h_a910040068490f9f6e5185c970ab869c9}{mp\_iszero}}(P->z)) \{}
\DoxyCodeLine{25       *retval = 0;}
\DoxyCodeLine{26       \textcolor{keywordflow}{return} \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}};}
\DoxyCodeLine{27    \}}
\DoxyCodeLine{28 }
\DoxyCodeLine{29    \textcolor{comment}{/* point (0,0,0) is not at infinity */}}
\DoxyCodeLine{30    \textcolor{keywordflow}{if} (\mbox{\hyperlink{tomcrypt__private_8h_a910040068490f9f6e5185c970ab869c9}{mp\_iszero}}(P->x) \&\& \mbox{\hyperlink{tomcrypt__private_8h_a910040068490f9f6e5185c970ab869c9}{mp\_iszero}}(P->y)) \{}
\DoxyCodeLine{31       *retval = 0;}
\DoxyCodeLine{32       \textcolor{keywordflow}{return} \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}};}
\DoxyCodeLine{33    \}}
\DoxyCodeLine{34 }
\DoxyCodeLine{35    \textcolor{comment}{/* initialize */}}
\DoxyCodeLine{36    \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{tomcrypt__private_8h_adb6322247b1a4f0347219acab3120bd3}{mp\_init\_multi}}(\&x3, \&y2, NULL))      != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}})   \textcolor{keywordflow}{goto} done;}
\DoxyCodeLine{37 }
\DoxyCodeLine{38    \textcolor{comment}{/* compute y\string^2 */}}
\DoxyCodeLine{39    \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{tomcrypt__private_8h_a0c32b20b84951870c7b09f5b6f2679c9}{mp\_mulmod}}(P->y, P->y, modulus, y2)) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}})   \textcolor{keywordflow}{goto} cleanup;}
\DoxyCodeLine{40 }
\DoxyCodeLine{41    \textcolor{comment}{/* compute x\string^3 */}}
\DoxyCodeLine{42    \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{tomcrypt__private_8h_a0c32b20b84951870c7b09f5b6f2679c9}{mp\_mulmod}}(P->x, P->x, modulus, x3)) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}})   \textcolor{keywordflow}{goto} cleanup;}
\DoxyCodeLine{43    \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{tomcrypt__private_8h_a0c32b20b84951870c7b09f5b6f2679c9}{mp\_mulmod}}(P->x, x3, modulus, x3))   != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}})   \textcolor{keywordflow}{goto} cleanup;}
\DoxyCodeLine{44 }
\DoxyCodeLine{45    \textcolor{comment}{/* test y\string^2 == x\string^3 */}}
\DoxyCodeLine{46    err = \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}};}
\DoxyCodeLine{47    \textcolor{keywordflow}{if} ((\mbox{\hyperlink{tomcrypt__private_8h_a62ea02fbe7dd2d456e49520264d775ee}{mp\_cmp}}(x3, y2) == \mbox{\hyperlink{tomcrypt__math_8h_a035a31bde4f31419eb259e36e5776607}{LTC\_MP\_EQ}}) \&\& !\mbox{\hyperlink{tomcrypt__private_8h_a910040068490f9f6e5185c970ab869c9}{mp\_iszero}}(y2)) \{}
\DoxyCodeLine{48       *retval = 1;}
\DoxyCodeLine{49    \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{50       *retval = 0;}
\DoxyCodeLine{51    \}}
\DoxyCodeLine{52 }
\DoxyCodeLine{53 cleanup:}
\DoxyCodeLine{54    \mbox{\hyperlink{tomcrypt__private_8h_aad5c8a3112b3e4613f9efc86692c43cb}{mp\_clear\_multi}}(x3, y2, NULL);}
\DoxyCodeLine{55 done:}
\DoxyCodeLine{56    \textcolor{keywordflow}{return} err;}
\DoxyCodeLine{57 \}}

\end{DoxyCode}


References C\+R\+Y\+P\+T\+\_\+\+OK, L\+T\+C\+\_\+\+M\+P\+\_\+\+EQ, mp\+\_\+clear\+\_\+multi, mp\+\_\+cmp, mp\+\_\+init\+\_\+multi, mp\+\_\+iszero, and mp\+\_\+mulmod.



Referenced by ltc\+\_\+ecc\+\_\+mulmod(), ltc\+\_\+ecc\+\_\+projective\+\_\+add\+\_\+point(), ltc\+\_\+ecc\+\_\+projective\+\_\+dbl\+\_\+point(), ltc\+\_\+ecc\+\_\+verify\+\_\+key(), tfm\+\_\+ecc\+\_\+projective\+\_\+add\+\_\+point(), and tfm\+\_\+ecc\+\_\+projective\+\_\+dbl\+\_\+point().

Here is the caller graph for this function\+:
% FIG 41
\mbox{\Hypertarget{tomcrypt__private_8h_af9f9d49f05241e41e2f8660afdaf7dac}\label{tomcrypt__private_8h_af9f9d49f05241e41e2f8660afdaf7dac}} 
\index{tomcrypt\_private.h@{tomcrypt\_private.h}!ltc\_ecc\_map@{ltc\_ecc\_map}}
\index{ltc\_ecc\_map@{ltc\_ecc\_map}!tomcrypt\_private.h@{tomcrypt\_private.h}}
\subsubsection{\texorpdfstring{ltc\_ecc\_map()}{ltc\_ecc\_map()}}
{\footnotesize\ttfamily int ltc\+\_\+ecc\+\_\+map (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{tomcrypt__math_8h_a2a6efaeaa795aa54274d7c4fd66b018a}{ecc\+\_\+point}} $\ast$}]{P,  }\item[{void $\ast$}]{modulus,  }\item[{void $\ast$}]{mp }\end{DoxyParamCaption})}



Map a projective jacbobian point back to affine space. 


\begin{DoxyParams}{Parameters}
{\em P} & \mbox{[}in/out\mbox{]} The point to map \\
\hline
{\em modulus} & The modulus of the field the E\+CC curve is in \\
\hline
{\em mp} & The \char`\"{}b\char`\"{} value from \mbox{\hyperlink{gmp__desc_8c_a771ef8a9d5b1b2633613bfad28b282c2}{montgomery\+\_\+setup()}} \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
C\+R\+Y\+P\+T\+\_\+\+OK on success 
\end{DoxyReturn}


Definition at line 26 of file ltc\+\_\+ecc\+\_\+map.\+c.


\begin{DoxyCode}{0}
\DoxyCodeLine{27 \{}
\DoxyCodeLine{28    \textcolor{keywordtype}{void} *\mbox{\hyperlink{tiger_8c_a65f7891fccbfcf7d08964555630773b3}{t1}}, *\mbox{\hyperlink{tiger_8c_aa4652e2d6053d420dcbea07a113db5fe}{t2}};}
\DoxyCodeLine{29    \textcolor{keywordtype}{int}   err;}
\DoxyCodeLine{30 }
\DoxyCodeLine{31    \mbox{\hyperlink{tomcrypt__argchk_8h_a683da3e041e49f196318b6ea951414ba}{LTC\_ARGCHK}}(P       != NULL);}
\DoxyCodeLine{32    \mbox{\hyperlink{tomcrypt__argchk_8h_a683da3e041e49f196318b6ea951414ba}{LTC\_ARGCHK}}(modulus != NULL);}
\DoxyCodeLine{33    \mbox{\hyperlink{tomcrypt__argchk_8h_a683da3e041e49f196318b6ea951414ba}{LTC\_ARGCHK}}(mp      != NULL);}
\DoxyCodeLine{34 }
\DoxyCodeLine{35    \textcolor{keywordflow}{if} (\mbox{\hyperlink{tomcrypt__private_8h_a910040068490f9f6e5185c970ab869c9}{mp\_iszero}}(P->z)) \{}
\DoxyCodeLine{36       \textcolor{keywordflow}{return} \mbox{\hyperlink{tomcrypt__private_8h_adc0366a4a0c272b7594bcea0d8fe7ccb}{ltc\_ecc\_set\_point\_xyz}}(0, 0, 1, P);}
\DoxyCodeLine{37    \}}
\DoxyCodeLine{38 }
\DoxyCodeLine{39    \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{tomcrypt__private_8h_adb6322247b1a4f0347219acab3120bd3}{mp\_init\_multi}}(\&\mbox{\hyperlink{tiger_8c_a65f7891fccbfcf7d08964555630773b3}{t1}}, \&\mbox{\hyperlink{tiger_8c_aa4652e2d6053d420dcbea07a113db5fe}{t2}}, NULL)) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}}) \{}
\DoxyCodeLine{40       \textcolor{keywordflow}{return} err;}
\DoxyCodeLine{41    \}}
\DoxyCodeLine{42 }
\DoxyCodeLine{43    \textcolor{comment}{/* first map z back to normal */}}
\DoxyCodeLine{44    \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{tomcrypt__private_8h_a4201ed2dbae154496e1a2ae9ba8aa7a8}{mp\_montgomery\_reduce}}(P->z, modulus, mp)) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}})           \{ \textcolor{keywordflow}{goto} done; \}}
\DoxyCodeLine{45 }
\DoxyCodeLine{46    \textcolor{comment}{/* get 1/z */}}
\DoxyCodeLine{47    \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{tomcrypt__private_8h_a8be707236375351ab194f908c8ba9233}{mp\_invmod}}(P->z, modulus, \mbox{\hyperlink{tiger_8c_a65f7891fccbfcf7d08964555630773b3}{t1}})) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}})                      \{ \textcolor{keywordflow}{goto} done; \}}
\DoxyCodeLine{48 }
\DoxyCodeLine{49    \textcolor{comment}{/* get 1/z\string^2 and 1/z\string^3 */}}
\DoxyCodeLine{50    \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{tomcrypt__private_8h_aea81d79b5462e99068908d80edb8bd1a}{mp\_sqr}}(\mbox{\hyperlink{tiger_8c_a65f7891fccbfcf7d08964555630773b3}{t1}}, \mbox{\hyperlink{tiger_8c_aa4652e2d6053d420dcbea07a113db5fe}{t2}})) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}})                                    \{ \textcolor{keywordflow}{goto} done; \}}
\DoxyCodeLine{51    \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{tomcrypt__private_8h_ac7deed6f00e289706070b16f98c430fe}{mp\_mod}}(\mbox{\hyperlink{tiger_8c_aa4652e2d6053d420dcbea07a113db5fe}{t2}}, modulus, \mbox{\hyperlink{tiger_8c_aa4652e2d6053d420dcbea07a113db5fe}{t2}})) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}})                           \{ \textcolor{keywordflow}{goto} done; \}}
\DoxyCodeLine{52    \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{tomcrypt__private_8h_a7606d2423856b32b09245a2fa1ef34ee}{mp\_mul}}(\mbox{\hyperlink{tiger_8c_a65f7891fccbfcf7d08964555630773b3}{t1}}, \mbox{\hyperlink{tiger_8c_aa4652e2d6053d420dcbea07a113db5fe}{t2}}, \mbox{\hyperlink{tiger_8c_a65f7891fccbfcf7d08964555630773b3}{t1}})) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}})                                \{ \textcolor{keywordflow}{goto} done; \}}
\DoxyCodeLine{53    \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{tomcrypt__private_8h_ac7deed6f00e289706070b16f98c430fe}{mp\_mod}}(\mbox{\hyperlink{tiger_8c_a65f7891fccbfcf7d08964555630773b3}{t1}}, modulus, \mbox{\hyperlink{tiger_8c_a65f7891fccbfcf7d08964555630773b3}{t1}})) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}})                           \{ \textcolor{keywordflow}{goto} done; \}}
\DoxyCodeLine{54 }
\DoxyCodeLine{55    \textcolor{comment}{/* multiply against x/y */}}
\DoxyCodeLine{56    \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{tomcrypt__private_8h_a7606d2423856b32b09245a2fa1ef34ee}{mp\_mul}}(P->x, \mbox{\hyperlink{tiger_8c_aa4652e2d6053d420dcbea07a113db5fe}{t2}}, P->x)) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}})                            \{ \textcolor{keywordflow}{goto} done; \}}
\DoxyCodeLine{57    \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{tomcrypt__private_8h_a4201ed2dbae154496e1a2ae9ba8aa7a8}{mp\_montgomery\_reduce}}(P->x, modulus, mp)) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}})           \{ \textcolor{keywordflow}{goto} done; \}}
\DoxyCodeLine{58    \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{tomcrypt__private_8h_a7606d2423856b32b09245a2fa1ef34ee}{mp\_mul}}(P->y, \mbox{\hyperlink{tiger_8c_a65f7891fccbfcf7d08964555630773b3}{t1}}, P->y)) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}})                            \{ \textcolor{keywordflow}{goto} done; \}}
\DoxyCodeLine{59    \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{tomcrypt__private_8h_a4201ed2dbae154496e1a2ae9ba8aa7a8}{mp\_montgomery\_reduce}}(P->y, modulus, mp)) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}})           \{ \textcolor{keywordflow}{goto} done; \}}
\DoxyCodeLine{60    \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{tomcrypt__private_8h_a000b0542ef4ecf639ff69895490fdb8f}{mp\_set}}(P->z, 1)) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}})                                   \{ \textcolor{keywordflow}{goto} done; \}}
\DoxyCodeLine{61 }
\DoxyCodeLine{62    err = \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}};}
\DoxyCodeLine{63 done:}
\DoxyCodeLine{64    \mbox{\hyperlink{tomcrypt__private_8h_aad5c8a3112b3e4613f9efc86692c43cb}{mp\_clear\_multi}}(\mbox{\hyperlink{tiger_8c_a65f7891fccbfcf7d08964555630773b3}{t1}}, \mbox{\hyperlink{tiger_8c_aa4652e2d6053d420dcbea07a113db5fe}{t2}}, NULL);}
\DoxyCodeLine{65    \textcolor{keywordflow}{return} err;}
\DoxyCodeLine{66 \}}

\end{DoxyCode}


References C\+R\+Y\+P\+T\+\_\+\+OK, L\+T\+C\+\_\+\+A\+R\+G\+C\+HK, ltc\+\_\+ecc\+\_\+set\+\_\+point\+\_\+xyz(), mp\+\_\+clear\+\_\+multi, mp\+\_\+init\+\_\+multi, mp\+\_\+invmod, mp\+\_\+iszero, mp\+\_\+mod, mp\+\_\+montgomery\+\_\+reduce, mp\+\_\+mul, mp\+\_\+set, mp\+\_\+sqr, t1, and t2.



Referenced by ltc\+\_\+ecc\+\_\+mul2add(), and ltc\+\_\+ecc\+\_\+mulmod().

Here is the call graph for this function\+:
% FIG 42
Here is the caller graph for this function\+:
% FIG 43
\mbox{\Hypertarget{tomcrypt__private_8h_a4aaa757939c4f4b54a3db21afc6aef9f}\label{tomcrypt__private_8h_a4aaa757939c4f4b54a3db21afc6aef9f}} 
\index{tomcrypt\_private.h@{tomcrypt\_private.h}!ltc\_ecc\_mul2add@{ltc\_ecc\_mul2add}}
\index{ltc\_ecc\_mul2add@{ltc\_ecc\_mul2add}!tomcrypt\_private.h@{tomcrypt\_private.h}}
\subsubsection{\texorpdfstring{ltc\_ecc\_mul2add()}{ltc\_ecc\_mul2add()}}
{\footnotesize\ttfamily int ltc\+\_\+ecc\+\_\+mul2add (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{tomcrypt__math_8h_a2a6efaeaa795aa54274d7c4fd66b018a}{ecc\+\_\+point}} $\ast$}]{A,  }\item[{void $\ast$}]{kA,  }\item[{const \mbox{\hyperlink{tomcrypt__math_8h_a2a6efaeaa795aa54274d7c4fd66b018a}{ecc\+\_\+point}} $\ast$}]{B,  }\item[{void $\ast$}]{kB,  }\item[{\mbox{\hyperlink{tomcrypt__math_8h_a2a6efaeaa795aa54274d7c4fd66b018a}{ecc\+\_\+point}} $\ast$}]{C,  }\item[{void $\ast$}]{ma,  }\item[{void $\ast$}]{modulus }\end{DoxyParamCaption})}



Computes k\+A$\ast$A + k\+B$\ast$B = C using Shamir\textquotesingle{}s Trick. 


\begin{DoxyParams}{Parameters}
{\em A} & First point to multiply \\
\hline
{\em kA} & What to multiple A by \\
\hline
{\em B} & Second point to multiply \\
\hline
{\em kB} & What to multiple B by \\
\hline
{\em C} & \mbox{[}out\mbox{]} Destination point (can overlap with A or B) \\
\hline
{\em ma} & E\+CC curve parameter a in montgomery form \\
\hline
{\em modulus} & Modulus for curve \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
C\+R\+Y\+P\+T\+\_\+\+OK on success 
\end{DoxyReturn}


Definition at line 31 of file ltc\+\_\+ecc\+\_\+mul2add.\+c.


\begin{DoxyCode}{0}
\DoxyCodeLine{36 \{}
\DoxyCodeLine{37   \mbox{\hyperlink{tomcrypt__math_8h_a2a6efaeaa795aa54274d7c4fd66b018a}{ecc\_point}}     *precomp[16];}
\DoxyCodeLine{38   \textcolor{keywordtype}{unsigned}       bitbufA, bitbufB, lenA, lenB, \mbox{\hyperlink{ocb__init_8c_afed088663f8704004425cdae2120b9b3}{len}}, nA, nB, nibble;}
\DoxyCodeLine{39   \textcolor{keywordtype}{unsigned}       x, y;}
\DoxyCodeLine{40   \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char} *tA, *tB;}
\DoxyCodeLine{41   \textcolor{keywordtype}{int}            err, first;}
\DoxyCodeLine{42   \textcolor{keywordtype}{void}          *mp, *mu;}
\DoxyCodeLine{43 }
\DoxyCodeLine{44   \textcolor{comment}{/* argchks */}}
\DoxyCodeLine{45   \mbox{\hyperlink{tomcrypt__argchk_8h_a683da3e041e49f196318b6ea951414ba}{LTC\_ARGCHK}}(A       != NULL);}
\DoxyCodeLine{46   \mbox{\hyperlink{tomcrypt__argchk_8h_a683da3e041e49f196318b6ea951414ba}{LTC\_ARGCHK}}(B       != NULL);}
\DoxyCodeLine{47   \mbox{\hyperlink{tomcrypt__argchk_8h_a683da3e041e49f196318b6ea951414ba}{LTC\_ARGCHK}}(C       != NULL);}
\DoxyCodeLine{48   \mbox{\hyperlink{tomcrypt__argchk_8h_a683da3e041e49f196318b6ea951414ba}{LTC\_ARGCHK}}(kA      != NULL);}
\DoxyCodeLine{49   \mbox{\hyperlink{tomcrypt__argchk_8h_a683da3e041e49f196318b6ea951414ba}{LTC\_ARGCHK}}(kB      != NULL);}
\DoxyCodeLine{50   \mbox{\hyperlink{tomcrypt__argchk_8h_a683da3e041e49f196318b6ea951414ba}{LTC\_ARGCHK}}(modulus != NULL);}
\DoxyCodeLine{51 }
\DoxyCodeLine{52   \textcolor{comment}{/* allocate memory */}}
\DoxyCodeLine{53   tA = \mbox{\hyperlink{tomcrypt__cfg_8h_a151dda14cd7acae31eaf1102b0cc0685}{XCALLOC}}(1, ECC\_BUF\_SIZE);}
\DoxyCodeLine{54   \textcolor{keywordflow}{if} (tA == NULL) \{}
\DoxyCodeLine{55      \textcolor{keywordflow}{return} \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06ca0ce0d27adc7ea10b74b7ea904b8bfa82}{CRYPT\_MEM}};}
\DoxyCodeLine{56   \}}
\DoxyCodeLine{57   tB = \mbox{\hyperlink{tomcrypt__cfg_8h_a151dda14cd7acae31eaf1102b0cc0685}{XCALLOC}}(1, ECC\_BUF\_SIZE);}
\DoxyCodeLine{58   \textcolor{keywordflow}{if} (tB == NULL) \{}
\DoxyCodeLine{59      \mbox{\hyperlink{tomcrypt__cfg_8h_a260d66fc0690e0502cf3bfe7b5244b75}{XFREE}}(tA);}
\DoxyCodeLine{60      \textcolor{keywordflow}{return} \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06ca0ce0d27adc7ea10b74b7ea904b8bfa82}{CRYPT\_MEM}};}
\DoxyCodeLine{61   \}}
\DoxyCodeLine{62 }
\DoxyCodeLine{63   \textcolor{comment}{/* get sizes */}}
\DoxyCodeLine{64   lenA = \mbox{\hyperlink{tomcrypt__private_8h_ad301148bb24f43a8c7003a6976dfaa5a}{mp\_unsigned\_bin\_size}}(kA);}
\DoxyCodeLine{65   lenB = \mbox{\hyperlink{tomcrypt__private_8h_ad301148bb24f43a8c7003a6976dfaa5a}{mp\_unsigned\_bin\_size}}(kB);}
\DoxyCodeLine{66   \mbox{\hyperlink{ocb__init_8c_afed088663f8704004425cdae2120b9b3}{len}}  = \mbox{\hyperlink{tomcrypt__macros_8h_aacc3ee1a7f283f8ef65cea31f4436a95}{MAX}}(lenA, lenB);}
\DoxyCodeLine{67 }
\DoxyCodeLine{68   \textcolor{comment}{/* sanity check */}}
\DoxyCodeLine{69   \textcolor{keywordflow}{if} ((lenA > ECC\_BUF\_SIZE) || (lenB > ECC\_BUF\_SIZE)) \{}
\DoxyCodeLine{70      err = \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06ca92aa8bad3930f08d5a188bf72094b066}{CRYPT\_INVALID\_ARG}};}
\DoxyCodeLine{71      \textcolor{keywordflow}{goto} ERR\_T;}
\DoxyCodeLine{72   \}}
\DoxyCodeLine{73 }
\DoxyCodeLine{74   \textcolor{comment}{/* extract and justify kA */}}
\DoxyCodeLine{75   \mbox{\hyperlink{tomcrypt__private_8h_a376a4d31dcfeb65c069db0485b9602f8}{mp\_to\_unsigned\_bin}}(kA, (\mbox{\hyperlink{ocb__init_8c_afed088663f8704004425cdae2120b9b3}{len}} - lenA) + tA);}
\DoxyCodeLine{76 }
\DoxyCodeLine{77   \textcolor{comment}{/* extract and justify kB */}}
\DoxyCodeLine{78   \mbox{\hyperlink{tomcrypt__private_8h_a376a4d31dcfeb65c069db0485b9602f8}{mp\_to\_unsigned\_bin}}(kB, (\mbox{\hyperlink{ocb__init_8c_afed088663f8704004425cdae2120b9b3}{len}} - lenB) + tB);}
\DoxyCodeLine{79 }
\DoxyCodeLine{80   \textcolor{comment}{/* allocate the table */}}
\DoxyCodeLine{81   \textcolor{keywordflow}{for} (x = 0; x < 16; x++) \{}
\DoxyCodeLine{82      precomp[x] = \mbox{\hyperlink{tomcrypt__private_8h_a532af6ef2d0f6d1d8cd79e5f81e87cf8}{ltc\_ecc\_new\_point}}();}
\DoxyCodeLine{83      \textcolor{keywordflow}{if} (precomp[x] == NULL) \{}
\DoxyCodeLine{84          \textcolor{keywordflow}{for} (y = 0; y < x; ++y) \{}
\DoxyCodeLine{85             \mbox{\hyperlink{tomcrypt__private_8h_a4cef83a7c070c94ff78d4df10a7b624f}{ltc\_ecc\_del\_point}}(precomp[y]);}
\DoxyCodeLine{86          \}}
\DoxyCodeLine{87          err = \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06ca0ce0d27adc7ea10b74b7ea904b8bfa82}{CRYPT\_MEM}};}
\DoxyCodeLine{88          \textcolor{keywordflow}{goto} ERR\_T;}
\DoxyCodeLine{89      \}}
\DoxyCodeLine{90   \}}
\DoxyCodeLine{91 }
\DoxyCodeLine{92   \textcolor{comment}{/* init montgomery reduction */}}
\DoxyCodeLine{93   \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{tomcrypt__private_8h_a42560b136f9c3cf1411a82a8cae6d954}{mp\_montgomery\_setup}}(modulus, \&mp)) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}}) \{}
\DoxyCodeLine{94       \textcolor{keywordflow}{goto} ERR\_P;}
\DoxyCodeLine{95   \}}
\DoxyCodeLine{96   \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{tomcrypt__private_8h_aff03c4f22c68d651747055048c509cf3}{mp\_init}}(\&mu)) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}}) \{}
\DoxyCodeLine{97       \textcolor{keywordflow}{goto} ERR\_MP;}
\DoxyCodeLine{98   \}}
\DoxyCodeLine{99   \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{tomcrypt__private_8h_a8e30da64ace4410ca56cb110a6fedd19}{mp\_montgomery\_normalization}}(mu, modulus)) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}}) \{}
\DoxyCodeLine{100       \textcolor{keywordflow}{goto} ERR\_MU;}
\DoxyCodeLine{101   \}}
\DoxyCodeLine{102 }
\DoxyCodeLine{103   \textcolor{comment}{/* copy ones ... */}}
\DoxyCodeLine{104   \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{tomcrypt__private_8h_a0c32b20b84951870c7b09f5b6f2679c9}{mp\_mulmod}}(A->x, mu, modulus, precomp[1]->x)) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}})                                         \{ \textcolor{keywordflow}{goto} ERR\_MU; \}}
\DoxyCodeLine{105   \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{tomcrypt__private_8h_a0c32b20b84951870c7b09f5b6f2679c9}{mp\_mulmod}}(A->y, mu, modulus, precomp[1]->y)) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}})                                         \{ \textcolor{keywordflow}{goto} ERR\_MU; \}}
\DoxyCodeLine{106   \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{tomcrypt__private_8h_a0c32b20b84951870c7b09f5b6f2679c9}{mp\_mulmod}}(A->z, mu, modulus, precomp[1]->z)) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}})                                         \{ \textcolor{keywordflow}{goto} ERR\_MU; \}}
\DoxyCodeLine{107 }
\DoxyCodeLine{108   \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{tomcrypt__private_8h_a0c32b20b84951870c7b09f5b6f2679c9}{mp\_mulmod}}(B->x, mu, modulus, precomp[1<<2]->x)) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}})                                      \{ \textcolor{keywordflow}{goto} ERR\_MU; \}}
\DoxyCodeLine{109   \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{tomcrypt__private_8h_a0c32b20b84951870c7b09f5b6f2679c9}{mp\_mulmod}}(B->y, mu, modulus, precomp[1<<2]->y)) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}})                                      \{ \textcolor{keywordflow}{goto} ERR\_MU; \}}
\DoxyCodeLine{110   \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{tomcrypt__private_8h_a0c32b20b84951870c7b09f5b6f2679c9}{mp\_mulmod}}(B->z, mu, modulus, precomp[1<<2]->z)) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}})                                      \{ \textcolor{keywordflow}{goto} ERR\_MU; \}}
\DoxyCodeLine{111 }
\DoxyCodeLine{112   \textcolor{comment}{/* precomp [i,0](A + B) table */}}
\DoxyCodeLine{113   \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{tomcrypt__math_8h_a3d38c44518c63b7a8abd0938f3d41c65}{ltc\_mp}}.\mbox{\hyperlink{structltc__math__descriptor_aeb3ece135c988d56932916b57872e78c}{ecc\_ptdbl}}(precomp[1], precomp[2], ma, modulus, mp)) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}})                           \{ \textcolor{keywordflow}{goto} ERR\_MU; \}}
\DoxyCodeLine{114   \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{tomcrypt__math_8h_a3d38c44518c63b7a8abd0938f3d41c65}{ltc\_mp}}.\mbox{\hyperlink{structltc__math__descriptor_a20678986df75fa338c4267c94b98ae68}{ecc\_ptadd}}(precomp[1], precomp[2], precomp[3], ma, modulus, mp)) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}})               \{ \textcolor{keywordflow}{goto} ERR\_MU; \}}
\DoxyCodeLine{115 }
\DoxyCodeLine{116   \textcolor{comment}{/* precomp [0,i](A + B) table */}}
\DoxyCodeLine{117   \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{tomcrypt__math_8h_a3d38c44518c63b7a8abd0938f3d41c65}{ltc\_mp}}.\mbox{\hyperlink{structltc__math__descriptor_aeb3ece135c988d56932916b57872e78c}{ecc\_ptdbl}}(precomp[1<<2], precomp[2<<2], ma, modulus, mp)) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}})                     \{ \textcolor{keywordflow}{goto} ERR\_MU; \}}
\DoxyCodeLine{118   \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{tomcrypt__math_8h_a3d38c44518c63b7a8abd0938f3d41c65}{ltc\_mp}}.\mbox{\hyperlink{structltc__math__descriptor_a20678986df75fa338c4267c94b98ae68}{ecc\_ptadd}}(precomp[1<<2], precomp[2<<2], precomp[3<<2], ma, modulus, mp)) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}})      \{ \textcolor{keywordflow}{goto} ERR\_MU; \}}
\DoxyCodeLine{119 }
\DoxyCodeLine{120   \textcolor{comment}{/* precomp [i,j](A + B) table (i != 0, j != 0) */}}
\DoxyCodeLine{121   \textcolor{keywordflow}{for} (x = 1; x < 4; x++) \{}
\DoxyCodeLine{122      \textcolor{keywordflow}{for} (y = 1; y < 4; y++) \{}
\DoxyCodeLine{123         \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{tomcrypt__math_8h_a3d38c44518c63b7a8abd0938f3d41c65}{ltc\_mp}}.\mbox{\hyperlink{structltc__math__descriptor_a20678986df75fa338c4267c94b98ae68}{ecc\_ptadd}}(precomp[x], precomp[(y<<2)], precomp[x+(y<<2)], ma, modulus, mp)) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}}) \{ \textcolor{keywordflow}{goto} ERR\_MU; \}}
\DoxyCodeLine{124      \}}
\DoxyCodeLine{125   \}}
\DoxyCodeLine{126 }
\DoxyCodeLine{127   nibble  = 3;}
\DoxyCodeLine{128   first   = 1;}
\DoxyCodeLine{129   bitbufA = tA[0];}
\DoxyCodeLine{130   bitbufB = tB[0];}
\DoxyCodeLine{131 }
\DoxyCodeLine{132   \textcolor{comment}{/* for every byte of the multiplicands */}}
\DoxyCodeLine{133   \textcolor{keywordflow}{for} (x = 0;; ) \{}
\DoxyCodeLine{134      \textcolor{comment}{/* grab a nibble */}}
\DoxyCodeLine{135      \textcolor{keywordflow}{if} (++nibble == 4) \{}
\DoxyCodeLine{136         \textcolor{keywordflow}{if} (x == \mbox{\hyperlink{ocb__init_8c_afed088663f8704004425cdae2120b9b3}{len}}) \textcolor{keywordflow}{break};}
\DoxyCodeLine{137         bitbufA = tA[x];}
\DoxyCodeLine{138         bitbufB = tB[x];}
\DoxyCodeLine{139         nibble  = 0;}
\DoxyCodeLine{140         ++x;}
\DoxyCodeLine{141      \}}
\DoxyCodeLine{142 }
\DoxyCodeLine{143      \textcolor{comment}{/* extract two bits from both, shift/update */}}
\DoxyCodeLine{144      nA = (bitbufA >> 6) \& 0x03;}
\DoxyCodeLine{145      nB = (bitbufB >> 6) \& 0x03;}
\DoxyCodeLine{146      bitbufA = (bitbufA << 2) \& 0xFF;}
\DoxyCodeLine{147      bitbufB = (bitbufB << 2) \& 0xFF;}
\DoxyCodeLine{148 }
\DoxyCodeLine{149      \textcolor{comment}{/* if both zero, if first, continue */}}
\DoxyCodeLine{150      \textcolor{keywordflow}{if} ((nA == 0) \&\& (nB == 0) \&\& (first == 1)) \{}
\DoxyCodeLine{151         \textcolor{keywordflow}{continue};}
\DoxyCodeLine{152      \}}
\DoxyCodeLine{153 }
\DoxyCodeLine{154      \textcolor{comment}{/* double twice, only if this isn't the first */}}
\DoxyCodeLine{155      \textcolor{keywordflow}{if} (first == 0) \{}
\DoxyCodeLine{156         \textcolor{comment}{/* double twice */}}
\DoxyCodeLine{157         \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{tomcrypt__math_8h_a3d38c44518c63b7a8abd0938f3d41c65}{ltc\_mp}}.\mbox{\hyperlink{structltc__math__descriptor_aeb3ece135c988d56932916b57872e78c}{ecc\_ptdbl}}(C, C, ma, modulus, mp)) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}})              \{ \textcolor{keywordflow}{goto} ERR\_MU; \}}
\DoxyCodeLine{158         \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{tomcrypt__math_8h_a3d38c44518c63b7a8abd0938f3d41c65}{ltc\_mp}}.\mbox{\hyperlink{structltc__math__descriptor_aeb3ece135c988d56932916b57872e78c}{ecc\_ptdbl}}(C, C, ma, modulus, mp)) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}})              \{ \textcolor{keywordflow}{goto} ERR\_MU; \}}
\DoxyCodeLine{159      \}}
\DoxyCodeLine{160 }
\DoxyCodeLine{161      \textcolor{comment}{/* if not both zero */}}
\DoxyCodeLine{162      \textcolor{keywordflow}{if} ((nA != 0) || (nB != 0)) \{}
\DoxyCodeLine{163         \textcolor{keywordflow}{if} (first == 1) \{}
\DoxyCodeLine{164            \textcolor{comment}{/* if first, copy from table */}}
\DoxyCodeLine{165            first = 0;}
\DoxyCodeLine{166            \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{tomcrypt__private_8h_a4b36b54e30a0a87aff57a936b386df7f}{ltc\_ecc\_copy\_point}}(precomp[nA + (nB<<2)], C)) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}})      \{ \textcolor{keywordflow}{goto} ERR\_MU; \}}
\DoxyCodeLine{167         \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{168            \textcolor{comment}{/* if not first, add from table */}}
\DoxyCodeLine{169            \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{tomcrypt__math_8h_a3d38c44518c63b7a8abd0938f3d41c65}{ltc\_mp}}.\mbox{\hyperlink{structltc__math__descriptor_a20678986df75fa338c4267c94b98ae68}{ecc\_ptadd}}(C, precomp[nA + (nB<<2)], C, ma, modulus, mp)) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}}) \{ \textcolor{keywordflow}{goto} ERR\_MU; \}}
\DoxyCodeLine{170         \}}
\DoxyCodeLine{171      \}}
\DoxyCodeLine{172   \}}
\DoxyCodeLine{173 }
\DoxyCodeLine{174   \textcolor{comment}{/* reduce to affine */}}
\DoxyCodeLine{175   err = \mbox{\hyperlink{tomcrypt__private_8h_af9f9d49f05241e41e2f8660afdaf7dac}{ltc\_ecc\_map}}(C, modulus, mp);}
\DoxyCodeLine{176 }
\DoxyCodeLine{177   \textcolor{comment}{/* clean up */}}
\DoxyCodeLine{178 ERR\_MU:}
\DoxyCodeLine{179    \mbox{\hyperlink{tomcrypt__private_8h_ab05b6b59fa182b81f5f990d5621229f6}{mp\_clear}}(mu);}
\DoxyCodeLine{180 ERR\_MP:}
\DoxyCodeLine{181    \mbox{\hyperlink{tomcrypt__private_8h_ac1935719c005c8bffb7590628e84c024}{mp\_montgomery\_free}}(mp);}
\DoxyCodeLine{182 ERR\_P:}
\DoxyCodeLine{183    \textcolor{keywordflow}{for} (x = 0; x < 16; x++) \{}
\DoxyCodeLine{184        \mbox{\hyperlink{tomcrypt__private_8h_a4cef83a7c070c94ff78d4df10a7b624f}{ltc\_ecc\_del\_point}}(precomp[x]);}
\DoxyCodeLine{185    \}}
\DoxyCodeLine{186 ERR\_T:}
\DoxyCodeLine{187 \textcolor{preprocessor}{\#ifdef LTC\_CLEAN\_STACK}}
\DoxyCodeLine{188    \mbox{\hyperlink{tomcrypt__misc_8h_a63b6e188713790263bfd3612fe8b398f}{zeromem}}(tA, ECC\_BUF\_SIZE);}
\DoxyCodeLine{189    \mbox{\hyperlink{tomcrypt__misc_8h_a63b6e188713790263bfd3612fe8b398f}{zeromem}}(tB, ECC\_BUF\_SIZE);}
\DoxyCodeLine{190 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{191    \mbox{\hyperlink{tomcrypt__cfg_8h_a260d66fc0690e0502cf3bfe7b5244b75}{XFREE}}(tA);}
\DoxyCodeLine{192    \mbox{\hyperlink{tomcrypt__cfg_8h_a260d66fc0690e0502cf3bfe7b5244b75}{XFREE}}(tB);}
\DoxyCodeLine{193 }
\DoxyCodeLine{194    \textcolor{keywordflow}{return} err;}
\DoxyCodeLine{195 \}}

\end{DoxyCode}


References C\+R\+Y\+P\+T\+\_\+\+I\+N\+V\+A\+L\+I\+D\+\_\+\+A\+RG, C\+R\+Y\+P\+T\+\_\+\+M\+EM, C\+R\+Y\+P\+T\+\_\+\+OK, ltc\+\_\+math\+\_\+descriptor\+::ecc\+\_\+ptadd, ltc\+\_\+math\+\_\+descriptor\+::ecc\+\_\+ptdbl, len, L\+T\+C\+\_\+\+A\+R\+G\+C\+HK, ltc\+\_\+ecc\+\_\+copy\+\_\+point(), ltc\+\_\+ecc\+\_\+del\+\_\+point(), ltc\+\_\+ecc\+\_\+map(), ltc\+\_\+ecc\+\_\+new\+\_\+point(), ltc\+\_\+mp, M\+AX, mp\+\_\+clear, mp\+\_\+init, mp\+\_\+montgomery\+\_\+free, mp\+\_\+montgomery\+\_\+normalization, mp\+\_\+montgomery\+\_\+setup, mp\+\_\+mulmod, mp\+\_\+to\+\_\+unsigned\+\_\+bin, mp\+\_\+unsigned\+\_\+bin\+\_\+size, X\+C\+A\+L\+L\+O\+C(), X\+F\+R\+E\+E(), and zeromem().

Here is the call graph for this function\+:
% FIG 44
\mbox{\Hypertarget{tomcrypt__private_8h_a818e5e4135d8aa58cf09e502e98ccc90}\label{tomcrypt__private_8h_a818e5e4135d8aa58cf09e502e98ccc90}} 
\index{tomcrypt\_private.h@{tomcrypt\_private.h}!ltc\_ecc\_mulmod@{ltc\_ecc\_mulmod}}
\index{ltc\_ecc\_mulmod@{ltc\_ecc\_mulmod}!tomcrypt\_private.h@{tomcrypt\_private.h}}
\subsubsection{\texorpdfstring{ltc\_ecc\_mulmod()}{ltc\_ecc\_mulmod()}}
{\footnotesize\ttfamily int ltc\+\_\+ecc\+\_\+mulmod (\begin{DoxyParamCaption}\item[{void $\ast$}]{k,  }\item[{const \mbox{\hyperlink{tomcrypt__math_8h_a2a6efaeaa795aa54274d7c4fd66b018a}{ecc\+\_\+point}} $\ast$}]{G,  }\item[{\mbox{\hyperlink{tomcrypt__math_8h_a2a6efaeaa795aa54274d7c4fd66b018a}{ecc\+\_\+point}} $\ast$}]{R,  }\item[{void $\ast$}]{a,  }\item[{void $\ast$}]{modulus,  }\item[{int}]{map }\end{DoxyParamCaption})}



Perform a point multiplication (timing resistant) 


\begin{DoxyParams}{Parameters}
{\em k} & The scalar to multiply by \\
\hline
{\em G} & The base point \\
\hline
{\em R} & \mbox{[}out\mbox{]} Destination for kG \\
\hline
{\em a} & E\+CC curve parameter a \\
\hline
{\em modulus} & The modulus of the field the E\+CC curve is in \\
\hline
{\em map} & Boolean whether to map back to affine or not (1==map, 0 == leave in projective) \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
C\+R\+Y\+P\+T\+\_\+\+OK on success 
\end{DoxyReturn}


Definition at line 31 of file ltc\+\_\+ecc\+\_\+mulmod\+\_\+timing.\+c.


\begin{DoxyCode}{0}
\DoxyCodeLine{32 \{}
\DoxyCodeLine{33    \mbox{\hyperlink{tomcrypt__math_8h_a2a6efaeaa795aa54274d7c4fd66b018a}{ecc\_point}} *tG, *M[3];}
\DoxyCodeLine{34    \textcolor{keywordtype}{int}        i, j, err, inf;}
\DoxyCodeLine{35    \textcolor{keywordtype}{void}       *mp = NULL, *mu = NULL, *ma = NULL, *a\_plus3 = NULL;}
\DoxyCodeLine{36    \mbox{\hyperlink{tomcrypt__cfg_8h_a4e98fa26a5de0ac87e06af901bad57c4}{ltc\_mp\_digit}} buf;}
\DoxyCodeLine{37    \textcolor{keywordtype}{int}        bitcnt, mode, digidx;}
\DoxyCodeLine{38 }
\DoxyCodeLine{39    \mbox{\hyperlink{tomcrypt__argchk_8h_a683da3e041e49f196318b6ea951414ba}{LTC\_ARGCHK}}(k       != NULL);}
\DoxyCodeLine{40    \mbox{\hyperlink{tomcrypt__argchk_8h_a683da3e041e49f196318b6ea951414ba}{LTC\_ARGCHK}}(\mbox{\hyperlink{kseed_8c_a542b12af0d18d79eddffd5d5cd08617d}{G}}       != NULL);}
\DoxyCodeLine{41    \mbox{\hyperlink{tomcrypt__argchk_8h_a683da3e041e49f196318b6ea951414ba}{LTC\_ARGCHK}}(\mbox{\hyperlink{khazad_8c_a5c71a5e59a53413cd6c270266d63b031}{R}}       != NULL);}
\DoxyCodeLine{42    \mbox{\hyperlink{tomcrypt__argchk_8h_a683da3e041e49f196318b6ea951414ba}{LTC\_ARGCHK}}(modulus != NULL);}
\DoxyCodeLine{43 }
\DoxyCodeLine{44    \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{tomcrypt__private_8h_a54a2d7d30af25ef341a8aca09269177d}{ltc\_ecc\_is\_point\_at\_infinity}}(\mbox{\hyperlink{kseed_8c_a542b12af0d18d79eddffd5d5cd08617d}{G}}, modulus, \&inf)) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}}) \textcolor{keywordflow}{return} err;}
\DoxyCodeLine{45    \textcolor{keywordflow}{if} (inf) \{}
\DoxyCodeLine{46       \textcolor{comment}{/* return the point at infinity */}}
\DoxyCodeLine{47       \textcolor{keywordflow}{return} \mbox{\hyperlink{tomcrypt__private_8h_adc0366a4a0c272b7594bcea0d8fe7ccb}{ltc\_ecc\_set\_point\_xyz}}(1, 1, 0, \mbox{\hyperlink{khazad_8c_a5c71a5e59a53413cd6c270266d63b031}{R}});}
\DoxyCodeLine{48    \}}
\DoxyCodeLine{49 }
\DoxyCodeLine{50    \textcolor{comment}{/* init montgomery reduction */}}
\DoxyCodeLine{51    \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{tomcrypt__private_8h_a42560b136f9c3cf1411a82a8cae6d954}{mp\_montgomery\_setup}}(modulus, \&mp)) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}})        \{ \textcolor{keywordflow}{goto} error; \}}
\DoxyCodeLine{52    \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{tomcrypt__private_8h_aff03c4f22c68d651747055048c509cf3}{mp\_init}}(\&mu)) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}})                             \{ \textcolor{keywordflow}{goto} error; \}}
\DoxyCodeLine{53    \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{tomcrypt__private_8h_a8e30da64ace4410ca56cb110a6fedd19}{mp\_montgomery\_normalization}}(mu, modulus)) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}}) \{ \textcolor{keywordflow}{goto} error; \}}
\DoxyCodeLine{54 }
\DoxyCodeLine{55    \textcolor{comment}{/* for curves with a == -3 keep ma == NULL */}}
\DoxyCodeLine{56    \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{tomcrypt__private_8h_aff03c4f22c68d651747055048c509cf3}{mp\_init}}(\&a\_plus3)) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}})                        \{ \textcolor{keywordflow}{goto} error; \}}
\DoxyCodeLine{57    \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{tomcrypt__private_8h_a69f09e7351d696b635ffbc9912684ab4}{mp\_add\_d}}(a, 3, a\_plus3)) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}})                  \{ \textcolor{keywordflow}{goto} error; \}}
\DoxyCodeLine{58    \textcolor{keywordflow}{if} (\mbox{\hyperlink{tomcrypt__private_8h_a62ea02fbe7dd2d456e49520264d775ee}{mp\_cmp}}(a\_plus3, modulus) != \mbox{\hyperlink{tomcrypt__math_8h_a035a31bde4f31419eb259e36e5776607}{LTC\_MP\_EQ}}) \{}
\DoxyCodeLine{59       \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{tomcrypt__private_8h_aff03c4f22c68d651747055048c509cf3}{mp\_init}}(\&ma)) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}})                          \{ \textcolor{keywordflow}{goto} error; \}}
\DoxyCodeLine{60       \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{tomcrypt__private_8h_a0c32b20b84951870c7b09f5b6f2679c9}{mp\_mulmod}}(a, mu, modulus, ma)) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}})         \{ \textcolor{keywordflow}{goto} error; \}}
\DoxyCodeLine{61    \}}
\DoxyCodeLine{62 }
\DoxyCodeLine{63    \textcolor{comment}{/* alloc ram for window temps */}}
\DoxyCodeLine{64    \textcolor{keywordflow}{for} (i = 0; i < 3; i++) \{}
\DoxyCodeLine{65       M[i] = \mbox{\hyperlink{tomcrypt__private_8h_a532af6ef2d0f6d1d8cd79e5f81e87cf8}{ltc\_ecc\_new\_point}}();}
\DoxyCodeLine{66       \textcolor{keywordflow}{if} (M[i] == NULL) \{}
\DoxyCodeLine{67          \textcolor{keywordflow}{for} (j = 0; j < i; j++) \{}
\DoxyCodeLine{68              \mbox{\hyperlink{tomcrypt__private_8h_a4cef83a7c070c94ff78d4df10a7b624f}{ltc\_ecc\_del\_point}}(M[j]);}
\DoxyCodeLine{69          \}}
\DoxyCodeLine{70          \mbox{\hyperlink{tomcrypt__private_8h_ab05b6b59fa182b81f5f990d5621229f6}{mp\_clear}}(mu);}
\DoxyCodeLine{71          \mbox{\hyperlink{tomcrypt__private_8h_ac1935719c005c8bffb7590628e84c024}{mp\_montgomery\_free}}(mp);}
\DoxyCodeLine{72          \textcolor{keywordflow}{return} \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06ca0ce0d27adc7ea10b74b7ea904b8bfa82}{CRYPT\_MEM}};}
\DoxyCodeLine{73       \}}
\DoxyCodeLine{74    \}}
\DoxyCodeLine{75 }
\DoxyCodeLine{76    \textcolor{comment}{/* make a copy of G incase R==G */}}
\DoxyCodeLine{77    tG = \mbox{\hyperlink{tomcrypt__private_8h_a532af6ef2d0f6d1d8cd79e5f81e87cf8}{ltc\_ecc\_new\_point}}();}
\DoxyCodeLine{78    \textcolor{keywordflow}{if} (tG == NULL)                                                                   \{ err = \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06ca0ce0d27adc7ea10b74b7ea904b8bfa82}{CRYPT\_MEM}}; \textcolor{keywordflow}{goto} done; \}}
\DoxyCodeLine{79 }
\DoxyCodeLine{80    \textcolor{comment}{/* tG = G  and convert to montgomery */}}
\DoxyCodeLine{81    \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{tomcrypt__private_8h_a0c32b20b84951870c7b09f5b6f2679c9}{mp\_mulmod}}(\mbox{\hyperlink{kseed_8c_a542b12af0d18d79eddffd5d5cd08617d}{G}}->x, mu, modulus, tG->x)) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}})                      \{ \textcolor{keywordflow}{goto} done; \}}
\DoxyCodeLine{82    \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{tomcrypt__private_8h_a0c32b20b84951870c7b09f5b6f2679c9}{mp\_mulmod}}(\mbox{\hyperlink{kseed_8c_a542b12af0d18d79eddffd5d5cd08617d}{G}}->y, mu, modulus, tG->y)) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}})                      \{ \textcolor{keywordflow}{goto} done; \}}
\DoxyCodeLine{83    \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{tomcrypt__private_8h_a0c32b20b84951870c7b09f5b6f2679c9}{mp\_mulmod}}(\mbox{\hyperlink{kseed_8c_a542b12af0d18d79eddffd5d5cd08617d}{G}}->z, mu, modulus, tG->z)) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}})                      \{ \textcolor{keywordflow}{goto} done; \}}
\DoxyCodeLine{84    \mbox{\hyperlink{tomcrypt__private_8h_ab05b6b59fa182b81f5f990d5621229f6}{mp\_clear}}(mu);}
\DoxyCodeLine{85    mu = NULL;}
\DoxyCodeLine{86 }
\DoxyCodeLine{87    \textcolor{comment}{/* calc the M tab */}}
\DoxyCodeLine{88    \textcolor{comment}{/* M[0] == G */}}
\DoxyCodeLine{89    \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{tomcrypt__private_8h_a4b36b54e30a0a87aff57a936b386df7f}{ltc\_ecc\_copy\_point}}(tG, M[0])) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}})                             \{ \textcolor{keywordflow}{goto} done; \}}
\DoxyCodeLine{90    \textcolor{comment}{/* M[1] == 2G */}}
\DoxyCodeLine{91    \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{tomcrypt__math_8h_a3d38c44518c63b7a8abd0938f3d41c65}{ltc\_mp}}.\mbox{\hyperlink{structltc__math__descriptor_aeb3ece135c988d56932916b57872e78c}{ecc\_ptdbl}}(tG, M[1], ma, modulus, mp)) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}})              \{ \textcolor{keywordflow}{goto} done; \}}
\DoxyCodeLine{92 }
\DoxyCodeLine{93    \textcolor{comment}{/* setup sliding window */}}
\DoxyCodeLine{94    mode   = 0;}
\DoxyCodeLine{95    bitcnt = 1;}
\DoxyCodeLine{96    buf    = 0;}
\DoxyCodeLine{97    digidx = \mbox{\hyperlink{tomcrypt__private_8h_ae51a279d51ab72f09d9f97335b8be6c9}{mp\_get\_digit\_count}}(k) - 1;}
\DoxyCodeLine{98 }
\DoxyCodeLine{99    \textcolor{comment}{/* perform ops */}}
\DoxyCodeLine{100    \textcolor{keywordflow}{for} (;;) \{}
\DoxyCodeLine{101      \textcolor{comment}{/* grab next digit as required */}}
\DoxyCodeLine{102       \textcolor{keywordflow}{if} (--bitcnt == 0) \{}
\DoxyCodeLine{103          \textcolor{keywordflow}{if} (digidx == -1) \{}
\DoxyCodeLine{104             \textcolor{keywordflow}{break};}
\DoxyCodeLine{105          \}}
\DoxyCodeLine{106          buf    = \mbox{\hyperlink{tomcrypt__private_8h_a62267879327e26468c45bbd83f7f2669}{mp\_get\_digit}}(k, digidx);}
\DoxyCodeLine{107          bitcnt = (int) \mbox{\hyperlink{tomcrypt__private_8h_ab8e25bc0c3ace6218c5c7d49198405c9}{MP\_DIGIT\_BIT}};}
\DoxyCodeLine{108          --digidx;}
\DoxyCodeLine{109       \}}
\DoxyCodeLine{110 }
\DoxyCodeLine{111       \textcolor{comment}{/* grab the next msb from the ltiplicand */}}
\DoxyCodeLine{112       i = (int)((buf >> (\mbox{\hyperlink{tomcrypt__private_8h_ab8e25bc0c3ace6218c5c7d49198405c9}{MP\_DIGIT\_BIT}} - 1)) \& 1);}
\DoxyCodeLine{113       buf <<= 1;}
\DoxyCodeLine{114 }
\DoxyCodeLine{115       \textcolor{keywordflow}{if} (mode == 0 \&\& i == 0) \{}
\DoxyCodeLine{116          \textcolor{comment}{/* dummy operations */}}
\DoxyCodeLine{117          \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{tomcrypt__math_8h_a3d38c44518c63b7a8abd0938f3d41c65}{ltc\_mp}}.\mbox{\hyperlink{structltc__math__descriptor_a20678986df75fa338c4267c94b98ae68}{ecc\_ptadd}}(M[0], M[1], M[2], ma, modulus, mp)) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}}) \{ \textcolor{keywordflow}{goto} done; \}}
\DoxyCodeLine{118          \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{tomcrypt__math_8h_a3d38c44518c63b7a8abd0938f3d41c65}{ltc\_mp}}.\mbox{\hyperlink{structltc__math__descriptor_aeb3ece135c988d56932916b57872e78c}{ecc\_ptdbl}}(M[1], M[2], ma, modulus, mp)) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}})       \{ \textcolor{keywordflow}{goto} done; \}}
\DoxyCodeLine{119          \textcolor{keywordflow}{continue};}
\DoxyCodeLine{120       \}}
\DoxyCodeLine{121 }
\DoxyCodeLine{122       \textcolor{keywordflow}{if} (mode == 0 \&\& i == 1) \{}
\DoxyCodeLine{123          mode = 1;}
\DoxyCodeLine{124          \textcolor{comment}{/* dummy operations */}}
\DoxyCodeLine{125          \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{tomcrypt__math_8h_a3d38c44518c63b7a8abd0938f3d41c65}{ltc\_mp}}.\mbox{\hyperlink{structltc__math__descriptor_a20678986df75fa338c4267c94b98ae68}{ecc\_ptadd}}(M[0], M[1], M[2], ma, modulus, mp)) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}}) \{ \textcolor{keywordflow}{goto} done; \}}
\DoxyCodeLine{126          \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{tomcrypt__math_8h_a3d38c44518c63b7a8abd0938f3d41c65}{ltc\_mp}}.\mbox{\hyperlink{structltc__math__descriptor_aeb3ece135c988d56932916b57872e78c}{ecc\_ptdbl}}(M[1], M[2], ma, modulus, mp)) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}})       \{ \textcolor{keywordflow}{goto} done; \}}
\DoxyCodeLine{127          \textcolor{keywordflow}{continue};}
\DoxyCodeLine{128       \}}
\DoxyCodeLine{129 }
\DoxyCodeLine{130       \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{tomcrypt__math_8h_a3d38c44518c63b7a8abd0938f3d41c65}{ltc\_mp}}.\mbox{\hyperlink{structltc__math__descriptor_a20678986df75fa338c4267c94b98ae68}{ecc\_ptadd}}(M[0], M[1], M[i\string^1], ma, modulus, mp)) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}})  \{ \textcolor{keywordflow}{goto} done; \}}
\DoxyCodeLine{131       \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{tomcrypt__math_8h_a3d38c44518c63b7a8abd0938f3d41c65}{ltc\_mp}}.\mbox{\hyperlink{structltc__math__descriptor_aeb3ece135c988d56932916b57872e78c}{ecc\_ptdbl}}(M[i], M[i], ma, modulus, mp)) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}})          \{ \textcolor{keywordflow}{goto} done; \}}
\DoxyCodeLine{132    \}}
\DoxyCodeLine{133 }
\DoxyCodeLine{134    \textcolor{comment}{/* copy result out */}}
\DoxyCodeLine{135    \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{tomcrypt__private_8h_a4b36b54e30a0a87aff57a936b386df7f}{ltc\_ecc\_copy\_point}}(M[0], \mbox{\hyperlink{khazad_8c_a5c71a5e59a53413cd6c270266d63b031}{R}})) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}})                              \{ \textcolor{keywordflow}{goto} done; \}}
\DoxyCodeLine{136 }
\DoxyCodeLine{137    \textcolor{comment}{/* map R back from projective space */}}
\DoxyCodeLine{138    \textcolor{keywordflow}{if} (map) \{}
\DoxyCodeLine{139       err = \mbox{\hyperlink{tomcrypt__private_8h_af9f9d49f05241e41e2f8660afdaf7dac}{ltc\_ecc\_map}}(\mbox{\hyperlink{khazad_8c_a5c71a5e59a53413cd6c270266d63b031}{R}}, modulus, mp);}
\DoxyCodeLine{140    \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{141       err = \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}};}
\DoxyCodeLine{142    \}}
\DoxyCodeLine{143 done:}
\DoxyCodeLine{144    \mbox{\hyperlink{tomcrypt__private_8h_a4cef83a7c070c94ff78d4df10a7b624f}{ltc\_ecc\_del\_point}}(tG);}
\DoxyCodeLine{145    \textcolor{keywordflow}{for} (i = 0; i < 3; i++) \{}
\DoxyCodeLine{146        \mbox{\hyperlink{tomcrypt__private_8h_a4cef83a7c070c94ff78d4df10a7b624f}{ltc\_ecc\_del\_point}}(M[i]);}
\DoxyCodeLine{147    \}}
\DoxyCodeLine{148 error:}
\DoxyCodeLine{149    \textcolor{keywordflow}{if} (ma != NULL) \mbox{\hyperlink{tomcrypt__private_8h_ab05b6b59fa182b81f5f990d5621229f6}{mp\_clear}}(ma);}
\DoxyCodeLine{150    \textcolor{keywordflow}{if} (a\_plus3 != NULL) \mbox{\hyperlink{tomcrypt__private_8h_ab05b6b59fa182b81f5f990d5621229f6}{mp\_clear}}(a\_plus3);}
\DoxyCodeLine{151    \textcolor{keywordflow}{if} (mu != NULL) \mbox{\hyperlink{tomcrypt__private_8h_ab05b6b59fa182b81f5f990d5621229f6}{mp\_clear}}(mu);}
\DoxyCodeLine{152    \textcolor{keywordflow}{if} (mp != NULL) \mbox{\hyperlink{tomcrypt__private_8h_ac1935719c005c8bffb7590628e84c024}{mp\_montgomery\_free}}(mp);}
\DoxyCodeLine{153    \textcolor{keywordflow}{return} err;}
\DoxyCodeLine{154 \}}

\end{DoxyCode}


References C\+R\+Y\+P\+T\+\_\+\+M\+EM, C\+R\+Y\+P\+T\+\_\+\+OK, ltc\+\_\+math\+\_\+descriptor\+::ecc\+\_\+ptadd, ltc\+\_\+math\+\_\+descriptor\+::ecc\+\_\+ptdbl, G, L\+T\+C\+\_\+\+A\+R\+G\+C\+HK, ltc\+\_\+ecc\+\_\+copy\+\_\+point(), ltc\+\_\+ecc\+\_\+del\+\_\+point(), ltc\+\_\+ecc\+\_\+is\+\_\+point\+\_\+at\+\_\+infinity(), ltc\+\_\+ecc\+\_\+map(), ltc\+\_\+ecc\+\_\+new\+\_\+point(), ltc\+\_\+ecc\+\_\+set\+\_\+point\+\_\+xyz(), ltc\+\_\+mp, L\+T\+C\+\_\+\+M\+P\+\_\+\+EQ, mp\+\_\+add\+\_\+d, mp\+\_\+clear, mp\+\_\+cmp, M\+P\+\_\+\+D\+I\+G\+I\+T\+\_\+\+B\+IT, mp\+\_\+get\+\_\+digit, mp\+\_\+get\+\_\+digit\+\_\+count, mp\+\_\+init, mp\+\_\+montgomery\+\_\+free, mp\+\_\+montgomery\+\_\+normalization, mp\+\_\+montgomery\+\_\+setup, mp\+\_\+mulmod, and R.



Referenced by ltc\+\_\+ecc\+\_\+verify\+\_\+key().

Here is the call graph for this function\+:
% FIG 45
Here is the caller graph for this function\+:
% FIG 46
\mbox{\Hypertarget{tomcrypt__private_8h_a532af6ef2d0f6d1d8cd79e5f81e87cf8}\label{tomcrypt__private_8h_a532af6ef2d0f6d1d8cd79e5f81e87cf8}} 
\index{tomcrypt\_private.h@{tomcrypt\_private.h}!ltc\_ecc\_new\_point@{ltc\_ecc\_new\_point}}
\index{ltc\_ecc\_new\_point@{ltc\_ecc\_new\_point}!tomcrypt\_private.h@{tomcrypt\_private.h}}
\subsubsection{\texorpdfstring{ltc\_ecc\_new\_point()}{ltc\_ecc\_new\_point()}}
{\footnotesize\ttfamily \mbox{\hyperlink{tomcrypt__math_8h_a2a6efaeaa795aa54274d7c4fd66b018a}{ecc\+\_\+point}}$\ast$ ltc\+\_\+ecc\+\_\+new\+\_\+point (\begin{DoxyParamCaption}\item[{void}]{ }\end{DoxyParamCaption})}



Allocate a new E\+CC point. 

\begin{DoxyReturn}{Returns}
A newly allocated point or N\+U\+LL on error 
\end{DoxyReturn}


Definition at line 23 of file ltc\+\_\+ecc\+\_\+points.\+c.


\begin{DoxyCode}{0}
\DoxyCodeLine{24 \{}
\DoxyCodeLine{25    \mbox{\hyperlink{tomcrypt__math_8h_a2a6efaeaa795aa54274d7c4fd66b018a}{ecc\_point}} *p;}
\DoxyCodeLine{26    p = \mbox{\hyperlink{tomcrypt__cfg_8h_a151dda14cd7acae31eaf1102b0cc0685}{XCALLOC}}(1, \textcolor{keyword}{sizeof}(*p));}
\DoxyCodeLine{27    \textcolor{keywordflow}{if} (p == NULL) \{}
\DoxyCodeLine{28       \textcolor{keywordflow}{return} NULL;}
\DoxyCodeLine{29    \}}
\DoxyCodeLine{30    \textcolor{keywordflow}{if} (\mbox{\hyperlink{tomcrypt__private_8h_adb6322247b1a4f0347219acab3120bd3}{mp\_init\_multi}}(\&p->x, \&p->y, \&p->z, NULL) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}}) \{}
\DoxyCodeLine{31       \mbox{\hyperlink{tomcrypt__cfg_8h_a260d66fc0690e0502cf3bfe7b5244b75}{XFREE}}(p);}
\DoxyCodeLine{32       \textcolor{keywordflow}{return} NULL;}
\DoxyCodeLine{33    \}}
\DoxyCodeLine{34    \textcolor{keywordflow}{return} p;}
\DoxyCodeLine{35 \}}

\end{DoxyCode}


References C\+R\+Y\+P\+T\+\_\+\+OK, mp\+\_\+init\+\_\+multi, X\+C\+A\+L\+L\+O\+C(), and X\+F\+R\+E\+E().



Referenced by ecc\+\_\+recover\+\_\+key(), ecc\+\_\+shared\+\_\+secret(), ecc\+\_\+verify\+\_\+hash\+\_\+ex(), ltc\+\_\+ecc\+\_\+mul2add(), ltc\+\_\+ecc\+\_\+mulmod(), and ltc\+\_\+ecc\+\_\+verify\+\_\+key().

Here is the call graph for this function\+:
% FIG 47
Here is the caller graph for this function\+:
% FIG 48
\mbox{\Hypertarget{tomcrypt__private_8h_a16f3ff8dd19aa2ccc2aab4024927bc93}\label{tomcrypt__private_8h_a16f3ff8dd19aa2ccc2aab4024927bc93}} 
\index{tomcrypt\_private.h@{tomcrypt\_private.h}!ltc\_ecc\_projective\_add\_point@{ltc\_ecc\_projective\_add\_point}}
\index{ltc\_ecc\_projective\_add\_point@{ltc\_ecc\_projective\_add\_point}!tomcrypt\_private.h@{tomcrypt\_private.h}}
\subsubsection{\texorpdfstring{ltc\_ecc\_projective\_add\_point()}{ltc\_ecc\_projective\_add\_point()}}
{\footnotesize\ttfamily int ltc\+\_\+ecc\+\_\+projective\+\_\+add\+\_\+point (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{tomcrypt__math_8h_a2a6efaeaa795aa54274d7c4fd66b018a}{ecc\+\_\+point}} $\ast$}]{P,  }\item[{const \mbox{\hyperlink{tomcrypt__math_8h_a2a6efaeaa795aa54274d7c4fd66b018a}{ecc\+\_\+point}} $\ast$}]{Q,  }\item[{\mbox{\hyperlink{tomcrypt__math_8h_a2a6efaeaa795aa54274d7c4fd66b018a}{ecc\+\_\+point}} $\ast$}]{R,  }\item[{void $\ast$}]{ma,  }\item[{void $\ast$}]{modulus,  }\item[{void $\ast$}]{mp }\end{DoxyParamCaption})}



Add two E\+CC points. 


\begin{DoxyParams}{Parameters}
{\em P} & The point to add \\
\hline
{\em Q} & The point to add \\
\hline
{\em R} & \mbox{[}out\mbox{]} The destination of the double \\
\hline
{\em ma} & E\+CC curve parameter a in montgomery form \\
\hline
{\em modulus} & The modulus of the field the E\+CC curve is in \\
\hline
{\em mp} & The \char`\"{}b\char`\"{} value from \mbox{\hyperlink{gmp__desc_8c_a771ef8a9d5b1b2633613bfad28b282c2}{montgomery\+\_\+setup()}} \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
C\+R\+Y\+P\+T\+\_\+\+OK on success 
\end{DoxyReturn}


Definition at line 29 of file ltc\+\_\+ecc\+\_\+projective\+\_\+add\+\_\+point.\+c.


\begin{DoxyCode}{0}
\DoxyCodeLine{30 \{}
\DoxyCodeLine{31    \textcolor{keywordtype}{void}  *\mbox{\hyperlink{tiger_8c_a65f7891fccbfcf7d08964555630773b3}{t1}}, *\mbox{\hyperlink{tiger_8c_aa4652e2d6053d420dcbea07a113db5fe}{t2}}, *x, *y, *z;}
\DoxyCodeLine{32    \textcolor{keywordtype}{int}    err, inf;}
\DoxyCodeLine{33 }
\DoxyCodeLine{34    \mbox{\hyperlink{tomcrypt__argchk_8h_a683da3e041e49f196318b6ea951414ba}{LTC\_ARGCHK}}(P       != NULL);}
\DoxyCodeLine{35    \mbox{\hyperlink{tomcrypt__argchk_8h_a683da3e041e49f196318b6ea951414ba}{LTC\_ARGCHK}}(Q       != NULL);}
\DoxyCodeLine{36    \mbox{\hyperlink{tomcrypt__argchk_8h_a683da3e041e49f196318b6ea951414ba}{LTC\_ARGCHK}}(\mbox{\hyperlink{khazad_8c_a5c71a5e59a53413cd6c270266d63b031}{R}}       != NULL);}
\DoxyCodeLine{37    \mbox{\hyperlink{tomcrypt__argchk_8h_a683da3e041e49f196318b6ea951414ba}{LTC\_ARGCHK}}(modulus != NULL);}
\DoxyCodeLine{38    \mbox{\hyperlink{tomcrypt__argchk_8h_a683da3e041e49f196318b6ea951414ba}{LTC\_ARGCHK}}(mp      != NULL);}
\DoxyCodeLine{39 }
\DoxyCodeLine{40    \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{tomcrypt__private_8h_adb6322247b1a4f0347219acab3120bd3}{mp\_init\_multi}}(\&\mbox{\hyperlink{tiger_8c_a65f7891fccbfcf7d08964555630773b3}{t1}}, \&\mbox{\hyperlink{tiger_8c_aa4652e2d6053d420dcbea07a113db5fe}{t2}}, \&x, \&y, \&z, NULL)) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}}) \{}
\DoxyCodeLine{41       \textcolor{keywordflow}{return} err;}
\DoxyCodeLine{42    \}}
\DoxyCodeLine{43 }
\DoxyCodeLine{44    \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{tomcrypt__private_8h_a54a2d7d30af25ef341a8aca09269177d}{ltc\_ecc\_is\_point\_at\_infinity}}(P, modulus, \&inf)) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}}) \textcolor{keywordflow}{return} err;}
\DoxyCodeLine{45    \textcolor{keywordflow}{if} (inf) \{}
\DoxyCodeLine{46       \textcolor{comment}{/* P is point at infinity >> Result = Q */}}
\DoxyCodeLine{47       err = \mbox{\hyperlink{tomcrypt__private_8h_a4b36b54e30a0a87aff57a936b386df7f}{ltc\_ecc\_copy\_point}}(Q, \mbox{\hyperlink{khazad_8c_a5c71a5e59a53413cd6c270266d63b031}{R}});}
\DoxyCodeLine{48       \textcolor{keywordflow}{goto} done;}
\DoxyCodeLine{49    \}}
\DoxyCodeLine{50 }
\DoxyCodeLine{51    \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{tomcrypt__private_8h_a54a2d7d30af25ef341a8aca09269177d}{ltc\_ecc\_is\_point\_at\_infinity}}(Q, modulus, \&inf)) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}}) \textcolor{keywordflow}{return} err;}
\DoxyCodeLine{52    \textcolor{keywordflow}{if} (inf) \{}
\DoxyCodeLine{53       \textcolor{comment}{/* Q is point at infinity >> Result = P */}}
\DoxyCodeLine{54       err = \mbox{\hyperlink{tomcrypt__private_8h_a4b36b54e30a0a87aff57a936b386df7f}{ltc\_ecc\_copy\_point}}(P, \mbox{\hyperlink{khazad_8c_a5c71a5e59a53413cd6c270266d63b031}{R}});}
\DoxyCodeLine{55       \textcolor{keywordflow}{goto} done;}
\DoxyCodeLine{56    \}}
\DoxyCodeLine{57 }
\DoxyCodeLine{58    \textcolor{keywordflow}{if} ((\mbox{\hyperlink{tomcrypt__private_8h_a62ea02fbe7dd2d456e49520264d775ee}{mp\_cmp}}(P->x, Q->x) == \mbox{\hyperlink{tomcrypt__math_8h_a035a31bde4f31419eb259e36e5776607}{LTC\_MP\_EQ}}) \&\& (\mbox{\hyperlink{tomcrypt__private_8h_a62ea02fbe7dd2d456e49520264d775ee}{mp\_cmp}}(P->z, Q->z) == \mbox{\hyperlink{tomcrypt__math_8h_a035a31bde4f31419eb259e36e5776607}{LTC\_MP\_EQ}})) \{}
\DoxyCodeLine{59       \textcolor{keywordflow}{if} (\mbox{\hyperlink{tomcrypt__private_8h_a62ea02fbe7dd2d456e49520264d775ee}{mp\_cmp}}(P->y, Q->y) == \mbox{\hyperlink{tomcrypt__math_8h_a035a31bde4f31419eb259e36e5776607}{LTC\_MP\_EQ}}) \{}
\DoxyCodeLine{60          \textcolor{comment}{/* here P = Q >> Result = 2 * P (use doubling) */}}
\DoxyCodeLine{61          \mbox{\hyperlink{tomcrypt__private_8h_aad5c8a3112b3e4613f9efc86692c43cb}{mp\_clear\_multi}}(\mbox{\hyperlink{tiger_8c_a65f7891fccbfcf7d08964555630773b3}{t1}}, \mbox{\hyperlink{tiger_8c_aa4652e2d6053d420dcbea07a113db5fe}{t2}}, x, y, z, NULL);}
\DoxyCodeLine{62          \textcolor{keywordflow}{return} \mbox{\hyperlink{tomcrypt__private_8h_af9bdd0d8d602ef3b300b11d19d7bc33a}{ltc\_ecc\_projective\_dbl\_point}}(P, \mbox{\hyperlink{khazad_8c_a5c71a5e59a53413cd6c270266d63b031}{R}}, ma, modulus, mp);}
\DoxyCodeLine{63       \}}
\DoxyCodeLine{64       \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{tomcrypt__private_8h_ab8d0882c3b58263b638b41fbf110fde8}{mp\_sub}}(modulus, Q->y, \mbox{\hyperlink{tiger_8c_a65f7891fccbfcf7d08964555630773b3}{t1}})) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}})                       \{ \textcolor{keywordflow}{goto} done; \}}
\DoxyCodeLine{65       \textcolor{keywordflow}{if} (\mbox{\hyperlink{tomcrypt__private_8h_a62ea02fbe7dd2d456e49520264d775ee}{mp\_cmp}}(P->y, \mbox{\hyperlink{tiger_8c_a65f7891fccbfcf7d08964555630773b3}{t1}}) == \mbox{\hyperlink{tomcrypt__math_8h_a035a31bde4f31419eb259e36e5776607}{LTC\_MP\_EQ}}) \{}
\DoxyCodeLine{66          \textcolor{comment}{/* here Q = -P >>> Result = the point at infinity */}}
\DoxyCodeLine{67          err = \mbox{\hyperlink{tomcrypt__private_8h_adc0366a4a0c272b7594bcea0d8fe7ccb}{ltc\_ecc\_set\_point\_xyz}}(1, 1, 0, \mbox{\hyperlink{khazad_8c_a5c71a5e59a53413cd6c270266d63b031}{R}});}
\DoxyCodeLine{68          \textcolor{keywordflow}{goto} done;}
\DoxyCodeLine{69       \}}
\DoxyCodeLine{70    \}}
\DoxyCodeLine{71 }
\DoxyCodeLine{72    \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{tomcrypt__private_8h_afbb35bc8f920448d169ddc83a4308840}{mp\_copy}}(P->x, x)) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}})                                   \{ \textcolor{keywordflow}{goto} done; \}}
\DoxyCodeLine{73    \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{tomcrypt__private_8h_afbb35bc8f920448d169ddc83a4308840}{mp\_copy}}(P->y, y)) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}})                                   \{ \textcolor{keywordflow}{goto} done; \}}
\DoxyCodeLine{74    \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{tomcrypt__private_8h_afbb35bc8f920448d169ddc83a4308840}{mp\_copy}}(P->z, z)) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}})                                   \{ \textcolor{keywordflow}{goto} done; \}}
\DoxyCodeLine{75 }
\DoxyCodeLine{76    \textcolor{comment}{/* if Z is one then these are no-operations */}}
\DoxyCodeLine{77    \textcolor{keywordflow}{if} (Q->z != NULL) \{}
\DoxyCodeLine{78       \textcolor{comment}{/* T1 = Z' * Z' */}}
\DoxyCodeLine{79       \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{tomcrypt__private_8h_aea81d79b5462e99068908d80edb8bd1a}{mp\_sqr}}(Q->z, \mbox{\hyperlink{tiger_8c_a65f7891fccbfcf7d08964555630773b3}{t1}})) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}})                                \{ \textcolor{keywordflow}{goto} done; \}}
\DoxyCodeLine{80       \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{tomcrypt__private_8h_a4201ed2dbae154496e1a2ae9ba8aa7a8}{mp\_montgomery\_reduce}}(\mbox{\hyperlink{tiger_8c_a65f7891fccbfcf7d08964555630773b3}{t1}}, modulus, mp)) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}})           \{ \textcolor{keywordflow}{goto} done; \}}
\DoxyCodeLine{81       \textcolor{comment}{/* X = X * T1 */}}
\DoxyCodeLine{82       \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{tomcrypt__private_8h_a7606d2423856b32b09245a2fa1ef34ee}{mp\_mul}}(\mbox{\hyperlink{tiger_8c_a65f7891fccbfcf7d08964555630773b3}{t1}}, x, x)) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}})                                \{ \textcolor{keywordflow}{goto} done; \}}
\DoxyCodeLine{83       \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{tomcrypt__private_8h_a4201ed2dbae154496e1a2ae9ba8aa7a8}{mp\_montgomery\_reduce}}(x, modulus, mp)) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}})            \{ \textcolor{keywordflow}{goto} done; \}}
\DoxyCodeLine{84       \textcolor{comment}{/* T1 = Z' * T1 */}}
\DoxyCodeLine{85       \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{tomcrypt__private_8h_a7606d2423856b32b09245a2fa1ef34ee}{mp\_mul}}(Q->z, \mbox{\hyperlink{tiger_8c_a65f7891fccbfcf7d08964555630773b3}{t1}}, \mbox{\hyperlink{tiger_8c_a65f7891fccbfcf7d08964555630773b3}{t1}})) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}})                            \{ \textcolor{keywordflow}{goto} done; \}}
\DoxyCodeLine{86       \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{tomcrypt__private_8h_a4201ed2dbae154496e1a2ae9ba8aa7a8}{mp\_montgomery\_reduce}}(\mbox{\hyperlink{tiger_8c_a65f7891fccbfcf7d08964555630773b3}{t1}}, modulus, mp)) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}})           \{ \textcolor{keywordflow}{goto} done; \}}
\DoxyCodeLine{87       \textcolor{comment}{/* Y = Y * T1 */}}
\DoxyCodeLine{88       \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{tomcrypt__private_8h_a7606d2423856b32b09245a2fa1ef34ee}{mp\_mul}}(\mbox{\hyperlink{tiger_8c_a65f7891fccbfcf7d08964555630773b3}{t1}}, y, y)) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}})                                \{ \textcolor{keywordflow}{goto} done; \}}
\DoxyCodeLine{89       \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{tomcrypt__private_8h_a4201ed2dbae154496e1a2ae9ba8aa7a8}{mp\_montgomery\_reduce}}(y, modulus, mp)) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}})            \{ \textcolor{keywordflow}{goto} done; \}}
\DoxyCodeLine{90    \}}
\DoxyCodeLine{91 }
\DoxyCodeLine{92    \textcolor{comment}{/* T1 = Z*Z */}}
\DoxyCodeLine{93    \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{tomcrypt__private_8h_aea81d79b5462e99068908d80edb8bd1a}{mp\_sqr}}(z, \mbox{\hyperlink{tiger_8c_a65f7891fccbfcf7d08964555630773b3}{t1}})) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}})                                      \{ \textcolor{keywordflow}{goto} done; \}}
\DoxyCodeLine{94    \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{tomcrypt__private_8h_a4201ed2dbae154496e1a2ae9ba8aa7a8}{mp\_montgomery\_reduce}}(\mbox{\hyperlink{tiger_8c_a65f7891fccbfcf7d08964555630773b3}{t1}}, modulus, mp)) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}})              \{ \textcolor{keywordflow}{goto} done; \}}
\DoxyCodeLine{95    \textcolor{comment}{/* T2 = X' * T1 */}}
\DoxyCodeLine{96    \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{tomcrypt__private_8h_a7606d2423856b32b09245a2fa1ef34ee}{mp\_mul}}(Q->x, \mbox{\hyperlink{tiger_8c_a65f7891fccbfcf7d08964555630773b3}{t1}}, \mbox{\hyperlink{tiger_8c_aa4652e2d6053d420dcbea07a113db5fe}{t2}})) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}})                               \{ \textcolor{keywordflow}{goto} done; \}}
\DoxyCodeLine{97    \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{tomcrypt__private_8h_a4201ed2dbae154496e1a2ae9ba8aa7a8}{mp\_montgomery\_reduce}}(\mbox{\hyperlink{tiger_8c_aa4652e2d6053d420dcbea07a113db5fe}{t2}}, modulus, mp)) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}})              \{ \textcolor{keywordflow}{goto} done; \}}
\DoxyCodeLine{98    \textcolor{comment}{/* T1 = Z * T1 */}}
\DoxyCodeLine{99    \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{tomcrypt__private_8h_a7606d2423856b32b09245a2fa1ef34ee}{mp\_mul}}(z, \mbox{\hyperlink{tiger_8c_a65f7891fccbfcf7d08964555630773b3}{t1}}, \mbox{\hyperlink{tiger_8c_a65f7891fccbfcf7d08964555630773b3}{t1}})) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}})                                  \{ \textcolor{keywordflow}{goto} done; \}}
\DoxyCodeLine{100    \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{tomcrypt__private_8h_a4201ed2dbae154496e1a2ae9ba8aa7a8}{mp\_montgomery\_reduce}}(\mbox{\hyperlink{tiger_8c_a65f7891fccbfcf7d08964555630773b3}{t1}}, modulus, mp)) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}})              \{ \textcolor{keywordflow}{goto} done; \}}
\DoxyCodeLine{101    \textcolor{comment}{/* T1 = Y' * T1 */}}
\DoxyCodeLine{102    \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{tomcrypt__private_8h_a7606d2423856b32b09245a2fa1ef34ee}{mp\_mul}}(Q->y, \mbox{\hyperlink{tiger_8c_a65f7891fccbfcf7d08964555630773b3}{t1}}, \mbox{\hyperlink{tiger_8c_a65f7891fccbfcf7d08964555630773b3}{t1}})) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}})                               \{ \textcolor{keywordflow}{goto} done; \}}
\DoxyCodeLine{103    \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{tomcrypt__private_8h_a4201ed2dbae154496e1a2ae9ba8aa7a8}{mp\_montgomery\_reduce}}(\mbox{\hyperlink{tiger_8c_a65f7891fccbfcf7d08964555630773b3}{t1}}, modulus, mp)) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}})              \{ \textcolor{keywordflow}{goto} done; \}}
\DoxyCodeLine{104 }
\DoxyCodeLine{105    \textcolor{comment}{/* Y = Y - T1 */}}
\DoxyCodeLine{106    \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{tomcrypt__private_8h_ab8d0882c3b58263b638b41fbf110fde8}{mp\_sub}}(y, \mbox{\hyperlink{tiger_8c_a65f7891fccbfcf7d08964555630773b3}{t1}}, y)) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}})                                   \{ \textcolor{keywordflow}{goto} done; \}}
\DoxyCodeLine{107    \textcolor{keywordflow}{if} (\mbox{\hyperlink{tomcrypt__private_8h_a6ce44f2e6f872565a468b67d9a93dc28}{mp\_cmp\_d}}(y, 0) == \mbox{\hyperlink{tomcrypt__math_8h_a42d0c7d4c09793df79660774d3436db2}{LTC\_MP\_LT}}) \{}
\DoxyCodeLine{108       \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{tomcrypt__private_8h_a175d04f8aeaa1c3895fe14de6cc0d2db}{mp\_add}}(y, modulus, y)) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}})                           \{ \textcolor{keywordflow}{goto} done; \}}
\DoxyCodeLine{109    \}}
\DoxyCodeLine{110    \textcolor{comment}{/* T1 = 2T1 */}}
\DoxyCodeLine{111    \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{tomcrypt__private_8h_a175d04f8aeaa1c3895fe14de6cc0d2db}{mp\_add}}(\mbox{\hyperlink{tiger_8c_a65f7891fccbfcf7d08964555630773b3}{t1}}, \mbox{\hyperlink{tiger_8c_a65f7891fccbfcf7d08964555630773b3}{t1}}, \mbox{\hyperlink{tiger_8c_a65f7891fccbfcf7d08964555630773b3}{t1}})) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}})                                 \{ \textcolor{keywordflow}{goto} done; \}}
\DoxyCodeLine{112    \textcolor{keywordflow}{if} (\mbox{\hyperlink{tomcrypt__private_8h_a62ea02fbe7dd2d456e49520264d775ee}{mp\_cmp}}(\mbox{\hyperlink{tiger_8c_a65f7891fccbfcf7d08964555630773b3}{t1}}, modulus) != \mbox{\hyperlink{tomcrypt__math_8h_a42d0c7d4c09793df79660774d3436db2}{LTC\_MP\_LT}}) \{}
\DoxyCodeLine{113       \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{tomcrypt__private_8h_ab8d0882c3b58263b638b41fbf110fde8}{mp\_sub}}(\mbox{\hyperlink{tiger_8c_a65f7891fccbfcf7d08964555630773b3}{t1}}, modulus, \mbox{\hyperlink{tiger_8c_a65f7891fccbfcf7d08964555630773b3}{t1}})) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}})                         \{ \textcolor{keywordflow}{goto} done; \}}
\DoxyCodeLine{114    \}}
\DoxyCodeLine{115    \textcolor{comment}{/* T1 = Y + T1 */}}
\DoxyCodeLine{116    \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{tomcrypt__private_8h_a175d04f8aeaa1c3895fe14de6cc0d2db}{mp\_add}}(\mbox{\hyperlink{tiger_8c_a65f7891fccbfcf7d08964555630773b3}{t1}}, y, \mbox{\hyperlink{tiger_8c_a65f7891fccbfcf7d08964555630773b3}{t1}})) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}})                                  \{ \textcolor{keywordflow}{goto} done; \}}
\DoxyCodeLine{117    \textcolor{keywordflow}{if} (\mbox{\hyperlink{tomcrypt__private_8h_a62ea02fbe7dd2d456e49520264d775ee}{mp\_cmp}}(\mbox{\hyperlink{tiger_8c_a65f7891fccbfcf7d08964555630773b3}{t1}}, modulus) != \mbox{\hyperlink{tomcrypt__math_8h_a42d0c7d4c09793df79660774d3436db2}{LTC\_MP\_LT}}) \{}
\DoxyCodeLine{118       \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{tomcrypt__private_8h_ab8d0882c3b58263b638b41fbf110fde8}{mp\_sub}}(\mbox{\hyperlink{tiger_8c_a65f7891fccbfcf7d08964555630773b3}{t1}}, modulus, \mbox{\hyperlink{tiger_8c_a65f7891fccbfcf7d08964555630773b3}{t1}})) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}})                         \{ \textcolor{keywordflow}{goto} done; \}}
\DoxyCodeLine{119    \}}
\DoxyCodeLine{120    \textcolor{comment}{/* X = X - T2 */}}
\DoxyCodeLine{121    \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{tomcrypt__private_8h_ab8d0882c3b58263b638b41fbf110fde8}{mp\_sub}}(x, \mbox{\hyperlink{tiger_8c_aa4652e2d6053d420dcbea07a113db5fe}{t2}}, x)) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}})                                   \{ \textcolor{keywordflow}{goto} done; \}}
\DoxyCodeLine{122    \textcolor{keywordflow}{if} (\mbox{\hyperlink{tomcrypt__private_8h_a6ce44f2e6f872565a468b67d9a93dc28}{mp\_cmp\_d}}(x, 0) == \mbox{\hyperlink{tomcrypt__math_8h_a42d0c7d4c09793df79660774d3436db2}{LTC\_MP\_LT}}) \{}
\DoxyCodeLine{123       \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{tomcrypt__private_8h_a175d04f8aeaa1c3895fe14de6cc0d2db}{mp\_add}}(x, modulus, x)) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}})                           \{ \textcolor{keywordflow}{goto} done; \}}
\DoxyCodeLine{124    \}}
\DoxyCodeLine{125    \textcolor{comment}{/* T2 = 2T2 */}}
\DoxyCodeLine{126    \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{tomcrypt__private_8h_a175d04f8aeaa1c3895fe14de6cc0d2db}{mp\_add}}(\mbox{\hyperlink{tiger_8c_aa4652e2d6053d420dcbea07a113db5fe}{t2}}, \mbox{\hyperlink{tiger_8c_aa4652e2d6053d420dcbea07a113db5fe}{t2}}, \mbox{\hyperlink{tiger_8c_aa4652e2d6053d420dcbea07a113db5fe}{t2}})) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}})                                 \{ \textcolor{keywordflow}{goto} done; \}}
\DoxyCodeLine{127    \textcolor{keywordflow}{if} (\mbox{\hyperlink{tomcrypt__private_8h_a62ea02fbe7dd2d456e49520264d775ee}{mp\_cmp}}(\mbox{\hyperlink{tiger_8c_aa4652e2d6053d420dcbea07a113db5fe}{t2}}, modulus) != \mbox{\hyperlink{tomcrypt__math_8h_a42d0c7d4c09793df79660774d3436db2}{LTC\_MP\_LT}}) \{}
\DoxyCodeLine{128       \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{tomcrypt__private_8h_ab8d0882c3b58263b638b41fbf110fde8}{mp\_sub}}(\mbox{\hyperlink{tiger_8c_aa4652e2d6053d420dcbea07a113db5fe}{t2}}, modulus, \mbox{\hyperlink{tiger_8c_aa4652e2d6053d420dcbea07a113db5fe}{t2}})) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}})                         \{ \textcolor{keywordflow}{goto} done; \}}
\DoxyCodeLine{129    \}}
\DoxyCodeLine{130    \textcolor{comment}{/* T2 = X + T2 */}}
\DoxyCodeLine{131    \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{tomcrypt__private_8h_a175d04f8aeaa1c3895fe14de6cc0d2db}{mp\_add}}(\mbox{\hyperlink{tiger_8c_aa4652e2d6053d420dcbea07a113db5fe}{t2}}, x, \mbox{\hyperlink{tiger_8c_aa4652e2d6053d420dcbea07a113db5fe}{t2}})) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}})                                  \{ \textcolor{keywordflow}{goto} done; \}}
\DoxyCodeLine{132    \textcolor{keywordflow}{if} (\mbox{\hyperlink{tomcrypt__private_8h_a62ea02fbe7dd2d456e49520264d775ee}{mp\_cmp}}(\mbox{\hyperlink{tiger_8c_aa4652e2d6053d420dcbea07a113db5fe}{t2}}, modulus) != \mbox{\hyperlink{tomcrypt__math_8h_a42d0c7d4c09793df79660774d3436db2}{LTC\_MP\_LT}}) \{}
\DoxyCodeLine{133       \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{tomcrypt__private_8h_ab8d0882c3b58263b638b41fbf110fde8}{mp\_sub}}(\mbox{\hyperlink{tiger_8c_aa4652e2d6053d420dcbea07a113db5fe}{t2}}, modulus, \mbox{\hyperlink{tiger_8c_aa4652e2d6053d420dcbea07a113db5fe}{t2}})) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}})                         \{ \textcolor{keywordflow}{goto} done; \}}
\DoxyCodeLine{134    \}}
\DoxyCodeLine{135 }
\DoxyCodeLine{136    \textcolor{comment}{/* if Z' != 1 */}}
\DoxyCodeLine{137    \textcolor{keywordflow}{if} (Q->z != NULL) \{}
\DoxyCodeLine{138       \textcolor{comment}{/* Z = Z * Z' */}}
\DoxyCodeLine{139       \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{tomcrypt__private_8h_a7606d2423856b32b09245a2fa1ef34ee}{mp\_mul}}(z, Q->z, z)) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}})                              \{ \textcolor{keywordflow}{goto} done; \}}
\DoxyCodeLine{140       \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{tomcrypt__private_8h_a4201ed2dbae154496e1a2ae9ba8aa7a8}{mp\_montgomery\_reduce}}(z, modulus, mp)) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}})            \{ \textcolor{keywordflow}{goto} done; \}}
\DoxyCodeLine{141    \}}
\DoxyCodeLine{142 }
\DoxyCodeLine{143    \textcolor{comment}{/* Z = Z * X */}}
\DoxyCodeLine{144    \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{tomcrypt__private_8h_a7606d2423856b32b09245a2fa1ef34ee}{mp\_mul}}(z, x, z)) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}})                                    \{ \textcolor{keywordflow}{goto} done; \}}
\DoxyCodeLine{145    \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{tomcrypt__private_8h_a4201ed2dbae154496e1a2ae9ba8aa7a8}{mp\_montgomery\_reduce}}(z, modulus, mp)) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}})               \{ \textcolor{keywordflow}{goto} done; \}}
\DoxyCodeLine{146 }
\DoxyCodeLine{147    \textcolor{comment}{/* T1 = T1 * X  */}}
\DoxyCodeLine{148    \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{tomcrypt__private_8h_a7606d2423856b32b09245a2fa1ef34ee}{mp\_mul}}(\mbox{\hyperlink{tiger_8c_a65f7891fccbfcf7d08964555630773b3}{t1}}, x, \mbox{\hyperlink{tiger_8c_a65f7891fccbfcf7d08964555630773b3}{t1}})) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}})                                  \{ \textcolor{keywordflow}{goto} done; \}}
\DoxyCodeLine{149    \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{tomcrypt__private_8h_a4201ed2dbae154496e1a2ae9ba8aa7a8}{mp\_montgomery\_reduce}}(\mbox{\hyperlink{tiger_8c_a65f7891fccbfcf7d08964555630773b3}{t1}}, modulus, mp)) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}})              \{ \textcolor{keywordflow}{goto} done; \}}
\DoxyCodeLine{150    \textcolor{comment}{/* X = X * X */}}
\DoxyCodeLine{151    \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{tomcrypt__private_8h_aea81d79b5462e99068908d80edb8bd1a}{mp\_sqr}}(x, x)) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}})                                       \{ \textcolor{keywordflow}{goto} done; \}}
\DoxyCodeLine{152    \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{tomcrypt__private_8h_a4201ed2dbae154496e1a2ae9ba8aa7a8}{mp\_montgomery\_reduce}}(x, modulus, mp)) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}})               \{ \textcolor{keywordflow}{goto} done; \}}
\DoxyCodeLine{153    \textcolor{comment}{/* T2 = T2 * x */}}
\DoxyCodeLine{154    \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{tomcrypt__private_8h_a7606d2423856b32b09245a2fa1ef34ee}{mp\_mul}}(\mbox{\hyperlink{tiger_8c_aa4652e2d6053d420dcbea07a113db5fe}{t2}}, x, \mbox{\hyperlink{tiger_8c_aa4652e2d6053d420dcbea07a113db5fe}{t2}})) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}})                                  \{ \textcolor{keywordflow}{goto} done; \}}
\DoxyCodeLine{155    \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{tomcrypt__private_8h_a4201ed2dbae154496e1a2ae9ba8aa7a8}{mp\_montgomery\_reduce}}(\mbox{\hyperlink{tiger_8c_aa4652e2d6053d420dcbea07a113db5fe}{t2}}, modulus, mp)) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}})              \{ \textcolor{keywordflow}{goto} done; \}}
\DoxyCodeLine{156    \textcolor{comment}{/* T1 = T1 * X  */}}
\DoxyCodeLine{157    \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{tomcrypt__private_8h_a7606d2423856b32b09245a2fa1ef34ee}{mp\_mul}}(\mbox{\hyperlink{tiger_8c_a65f7891fccbfcf7d08964555630773b3}{t1}}, x, \mbox{\hyperlink{tiger_8c_a65f7891fccbfcf7d08964555630773b3}{t1}})) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}})                                  \{ \textcolor{keywordflow}{goto} done; \}}
\DoxyCodeLine{158    \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{tomcrypt__private_8h_a4201ed2dbae154496e1a2ae9ba8aa7a8}{mp\_montgomery\_reduce}}(\mbox{\hyperlink{tiger_8c_a65f7891fccbfcf7d08964555630773b3}{t1}}, modulus, mp)) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}})              \{ \textcolor{keywordflow}{goto} done; \}}
\DoxyCodeLine{159 }
\DoxyCodeLine{160    \textcolor{comment}{/* X = Y*Y */}}
\DoxyCodeLine{161    \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{tomcrypt__private_8h_aea81d79b5462e99068908d80edb8bd1a}{mp\_sqr}}(y, x)) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}})                                       \{ \textcolor{keywordflow}{goto} done; \}}
\DoxyCodeLine{162    \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{tomcrypt__private_8h_a4201ed2dbae154496e1a2ae9ba8aa7a8}{mp\_montgomery\_reduce}}(x, modulus, mp)) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}})               \{ \textcolor{keywordflow}{goto} done; \}}
\DoxyCodeLine{163    \textcolor{comment}{/* X = X - T2 */}}
\DoxyCodeLine{164    \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{tomcrypt__private_8h_ab8d0882c3b58263b638b41fbf110fde8}{mp\_sub}}(x, \mbox{\hyperlink{tiger_8c_aa4652e2d6053d420dcbea07a113db5fe}{t2}}, x)) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}})                                   \{ \textcolor{keywordflow}{goto} done; \}}
\DoxyCodeLine{165    \textcolor{keywordflow}{if} (\mbox{\hyperlink{tomcrypt__private_8h_a6ce44f2e6f872565a468b67d9a93dc28}{mp\_cmp\_d}}(x, 0) == \mbox{\hyperlink{tomcrypt__math_8h_a42d0c7d4c09793df79660774d3436db2}{LTC\_MP\_LT}}) \{}
\DoxyCodeLine{166       \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{tomcrypt__private_8h_a175d04f8aeaa1c3895fe14de6cc0d2db}{mp\_add}}(x, modulus, x)) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}})                           \{ \textcolor{keywordflow}{goto} done; \}}
\DoxyCodeLine{167    \}}
\DoxyCodeLine{168 }
\DoxyCodeLine{169    \textcolor{comment}{/* T2 = T2 - X */}}
\DoxyCodeLine{170    \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{tomcrypt__private_8h_ab8d0882c3b58263b638b41fbf110fde8}{mp\_sub}}(\mbox{\hyperlink{tiger_8c_aa4652e2d6053d420dcbea07a113db5fe}{t2}}, x, \mbox{\hyperlink{tiger_8c_aa4652e2d6053d420dcbea07a113db5fe}{t2}})) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}})                                  \{ \textcolor{keywordflow}{goto} done; \}}
\DoxyCodeLine{171    \textcolor{keywordflow}{if} (\mbox{\hyperlink{tomcrypt__private_8h_a6ce44f2e6f872565a468b67d9a93dc28}{mp\_cmp\_d}}(\mbox{\hyperlink{tiger_8c_aa4652e2d6053d420dcbea07a113db5fe}{t2}}, 0) == \mbox{\hyperlink{tomcrypt__math_8h_a42d0c7d4c09793df79660774d3436db2}{LTC\_MP\_LT}}) \{}
\DoxyCodeLine{172       \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{tomcrypt__private_8h_a175d04f8aeaa1c3895fe14de6cc0d2db}{mp\_add}}(\mbox{\hyperlink{tiger_8c_aa4652e2d6053d420dcbea07a113db5fe}{t2}}, modulus, \mbox{\hyperlink{tiger_8c_aa4652e2d6053d420dcbea07a113db5fe}{t2}})) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}})                         \{ \textcolor{keywordflow}{goto} done; \}}
\DoxyCodeLine{173    \}}
\DoxyCodeLine{174    \textcolor{comment}{/* T2 = T2 - X */}}
\DoxyCodeLine{175    \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{tomcrypt__private_8h_ab8d0882c3b58263b638b41fbf110fde8}{mp\_sub}}(\mbox{\hyperlink{tiger_8c_aa4652e2d6053d420dcbea07a113db5fe}{t2}}, x, \mbox{\hyperlink{tiger_8c_aa4652e2d6053d420dcbea07a113db5fe}{t2}})) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}})                                  \{ \textcolor{keywordflow}{goto} done; \}}
\DoxyCodeLine{176    \textcolor{keywordflow}{if} (\mbox{\hyperlink{tomcrypt__private_8h_a6ce44f2e6f872565a468b67d9a93dc28}{mp\_cmp\_d}}(\mbox{\hyperlink{tiger_8c_aa4652e2d6053d420dcbea07a113db5fe}{t2}}, 0) == \mbox{\hyperlink{tomcrypt__math_8h_a42d0c7d4c09793df79660774d3436db2}{LTC\_MP\_LT}}) \{}
\DoxyCodeLine{177       \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{tomcrypt__private_8h_a175d04f8aeaa1c3895fe14de6cc0d2db}{mp\_add}}(\mbox{\hyperlink{tiger_8c_aa4652e2d6053d420dcbea07a113db5fe}{t2}}, modulus, \mbox{\hyperlink{tiger_8c_aa4652e2d6053d420dcbea07a113db5fe}{t2}})) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}})                         \{ \textcolor{keywordflow}{goto} done; \}}
\DoxyCodeLine{178    \}}
\DoxyCodeLine{179    \textcolor{comment}{/* T2 = T2 * Y */}}
\DoxyCodeLine{180    \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{tomcrypt__private_8h_a7606d2423856b32b09245a2fa1ef34ee}{mp\_mul}}(\mbox{\hyperlink{tiger_8c_aa4652e2d6053d420dcbea07a113db5fe}{t2}}, y, \mbox{\hyperlink{tiger_8c_aa4652e2d6053d420dcbea07a113db5fe}{t2}})) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}})                                  \{ \textcolor{keywordflow}{goto} done; \}}
\DoxyCodeLine{181    \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{tomcrypt__private_8h_a4201ed2dbae154496e1a2ae9ba8aa7a8}{mp\_montgomery\_reduce}}(\mbox{\hyperlink{tiger_8c_aa4652e2d6053d420dcbea07a113db5fe}{t2}}, modulus, mp)) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}})              \{ \textcolor{keywordflow}{goto} done; \}}
\DoxyCodeLine{182    \textcolor{comment}{/* Y = T2 - T1 */}}
\DoxyCodeLine{183    \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{tomcrypt__private_8h_ab8d0882c3b58263b638b41fbf110fde8}{mp\_sub}}(\mbox{\hyperlink{tiger_8c_aa4652e2d6053d420dcbea07a113db5fe}{t2}}, \mbox{\hyperlink{tiger_8c_a65f7891fccbfcf7d08964555630773b3}{t1}}, y)) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}})                                  \{ \textcolor{keywordflow}{goto} done; \}}
\DoxyCodeLine{184    \textcolor{keywordflow}{if} (\mbox{\hyperlink{tomcrypt__private_8h_a6ce44f2e6f872565a468b67d9a93dc28}{mp\_cmp\_d}}(y, 0) == \mbox{\hyperlink{tomcrypt__math_8h_a42d0c7d4c09793df79660774d3436db2}{LTC\_MP\_LT}}) \{}
\DoxyCodeLine{185       \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{tomcrypt__private_8h_a175d04f8aeaa1c3895fe14de6cc0d2db}{mp\_add}}(y, modulus, y)) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}})                           \{ \textcolor{keywordflow}{goto} done; \}}
\DoxyCodeLine{186    \}}
\DoxyCodeLine{187    \textcolor{comment}{/* Y = Y/2 */}}
\DoxyCodeLine{188    \textcolor{keywordflow}{if} (\mbox{\hyperlink{tomcrypt__private_8h_a93ed39c257831509afc74f2b6da66ae7}{mp\_isodd}}(y)) \{}
\DoxyCodeLine{189       \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{tomcrypt__private_8h_a175d04f8aeaa1c3895fe14de6cc0d2db}{mp\_add}}(y, modulus, y)) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}})                           \{ \textcolor{keywordflow}{goto} done; \}}
\DoxyCodeLine{190    \}}
\DoxyCodeLine{191    \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{tomcrypt__private_8h_aec841464b436981f5758a49c561f39fe}{mp\_div\_2}}(y, y)) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}})                                     \{ \textcolor{keywordflow}{goto} done; \}}
\DoxyCodeLine{192 }
\DoxyCodeLine{193    \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{tomcrypt__private_8h_afbb35bc8f920448d169ddc83a4308840}{mp\_copy}}(x, \mbox{\hyperlink{khazad_8c_a5c71a5e59a53413cd6c270266d63b031}{R}}->x)) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}})                                   \{ \textcolor{keywordflow}{goto} done; \}}
\DoxyCodeLine{194    \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{tomcrypt__private_8h_afbb35bc8f920448d169ddc83a4308840}{mp\_copy}}(y, \mbox{\hyperlink{khazad_8c_a5c71a5e59a53413cd6c270266d63b031}{R}}->y)) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}})                                   \{ \textcolor{keywordflow}{goto} done; \}}
\DoxyCodeLine{195    \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{tomcrypt__private_8h_afbb35bc8f920448d169ddc83a4308840}{mp\_copy}}(z, \mbox{\hyperlink{khazad_8c_a5c71a5e59a53413cd6c270266d63b031}{R}}->z)) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}})                                   \{ \textcolor{keywordflow}{goto} done; \}}
\DoxyCodeLine{196 }
\DoxyCodeLine{197    err = \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}};}
\DoxyCodeLine{198 done:}
\DoxyCodeLine{199    \mbox{\hyperlink{tomcrypt__private_8h_aad5c8a3112b3e4613f9efc86692c43cb}{mp\_clear\_multi}}(\mbox{\hyperlink{tiger_8c_a65f7891fccbfcf7d08964555630773b3}{t1}}, \mbox{\hyperlink{tiger_8c_aa4652e2d6053d420dcbea07a113db5fe}{t2}}, x, y, z, NULL);}
\DoxyCodeLine{200    \textcolor{keywordflow}{return} err;}
\DoxyCodeLine{201 \}}

\end{DoxyCode}


References C\+R\+Y\+P\+T\+\_\+\+OK, L\+T\+C\+\_\+\+A\+R\+G\+C\+HK, ltc\+\_\+ecc\+\_\+copy\+\_\+point(), ltc\+\_\+ecc\+\_\+is\+\_\+point\+\_\+at\+\_\+infinity(), ltc\+\_\+ecc\+\_\+projective\+\_\+dbl\+\_\+point(), ltc\+\_\+ecc\+\_\+set\+\_\+point\+\_\+xyz(), L\+T\+C\+\_\+\+M\+P\+\_\+\+EQ, L\+T\+C\+\_\+\+M\+P\+\_\+\+LT, mp\+\_\+add, mp\+\_\+clear\+\_\+multi, mp\+\_\+cmp, mp\+\_\+cmp\+\_\+d, mp\+\_\+copy, mp\+\_\+div\+\_\+2, mp\+\_\+init\+\_\+multi, mp\+\_\+isodd, mp\+\_\+montgomery\+\_\+reduce, mp\+\_\+mul, mp\+\_\+sqr, mp\+\_\+sub, R, t1, and t2.

Here is the call graph for this function\+:
% FIG 49
\mbox{\Hypertarget{tomcrypt__private_8h_af9bdd0d8d602ef3b300b11d19d7bc33a}\label{tomcrypt__private_8h_af9bdd0d8d602ef3b300b11d19d7bc33a}} 
\index{tomcrypt\_private.h@{tomcrypt\_private.h}!ltc\_ecc\_projective\_dbl\_point@{ltc\_ecc\_projective\_dbl\_point}}
\index{ltc\_ecc\_projective\_dbl\_point@{ltc\_ecc\_projective\_dbl\_point}!tomcrypt\_private.h@{tomcrypt\_private.h}}
\subsubsection{\texorpdfstring{ltc\_ecc\_projective\_dbl\_point()}{ltc\_ecc\_projective\_dbl\_point()}}
{\footnotesize\ttfamily int ltc\+\_\+ecc\+\_\+projective\+\_\+dbl\+\_\+point (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{tomcrypt__math_8h_a2a6efaeaa795aa54274d7c4fd66b018a}{ecc\+\_\+point}} $\ast$}]{P,  }\item[{\mbox{\hyperlink{tomcrypt__math_8h_a2a6efaeaa795aa54274d7c4fd66b018a}{ecc\+\_\+point}} $\ast$}]{R,  }\item[{void $\ast$}]{ma,  }\item[{void $\ast$}]{modulus,  }\item[{void $\ast$}]{mp }\end{DoxyParamCaption})}



Double an E\+CC point. 


\begin{DoxyParams}{Parameters}
{\em P} & The point to double \\
\hline
{\em R} & \mbox{[}out\mbox{]} The destination of the double \\
\hline
{\em ma} & E\+CC curve parameter a in montgomery form \\
\hline
{\em modulus} & The modulus of the field the E\+CC curve is in \\
\hline
{\em mp} & The \char`\"{}b\char`\"{} value from \mbox{\hyperlink{gmp__desc_8c_a771ef8a9d5b1b2633613bfad28b282c2}{montgomery\+\_\+setup()}} \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
C\+R\+Y\+P\+T\+\_\+\+OK on success 
\end{DoxyReturn}


Definition at line 46 of file ltc\+\_\+ecc\+\_\+projective\+\_\+dbl\+\_\+point.\+c.


\begin{DoxyCode}{0}
\DoxyCodeLine{47 \{}
\DoxyCodeLine{48    \textcolor{keywordtype}{void} *\mbox{\hyperlink{tiger_8c_a65f7891fccbfcf7d08964555630773b3}{t1}}, *\mbox{\hyperlink{tiger_8c_aa4652e2d6053d420dcbea07a113db5fe}{t2}};}
\DoxyCodeLine{49    \textcolor{keywordtype}{int}   err, inf;}
\DoxyCodeLine{50 }
\DoxyCodeLine{51    \mbox{\hyperlink{tomcrypt__argchk_8h_a683da3e041e49f196318b6ea951414ba}{LTC\_ARGCHK}}(P       != NULL);}
\DoxyCodeLine{52    \mbox{\hyperlink{tomcrypt__argchk_8h_a683da3e041e49f196318b6ea951414ba}{LTC\_ARGCHK}}(\mbox{\hyperlink{khazad_8c_a5c71a5e59a53413cd6c270266d63b031}{R}}       != NULL);}
\DoxyCodeLine{53    \mbox{\hyperlink{tomcrypt__argchk_8h_a683da3e041e49f196318b6ea951414ba}{LTC\_ARGCHK}}(modulus != NULL);}
\DoxyCodeLine{54    \mbox{\hyperlink{tomcrypt__argchk_8h_a683da3e041e49f196318b6ea951414ba}{LTC\_ARGCHK}}(mp      != NULL);}
\DoxyCodeLine{55 }
\DoxyCodeLine{56    \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{tomcrypt__private_8h_adb6322247b1a4f0347219acab3120bd3}{mp\_init\_multi}}(\&\mbox{\hyperlink{tiger_8c_a65f7891fccbfcf7d08964555630773b3}{t1}}, \&\mbox{\hyperlink{tiger_8c_aa4652e2d6053d420dcbea07a113db5fe}{t2}}, NULL)) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}}) \{}
\DoxyCodeLine{57       \textcolor{keywordflow}{return} err;}
\DoxyCodeLine{58    \}}
\DoxyCodeLine{59 }
\DoxyCodeLine{60    \textcolor{keywordflow}{if} (P != \mbox{\hyperlink{khazad_8c_a5c71a5e59a53413cd6c270266d63b031}{R}}) \{}
\DoxyCodeLine{61       \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{tomcrypt__private_8h_a4b36b54e30a0a87aff57a936b386df7f}{ltc\_ecc\_copy\_point}}(P, \mbox{\hyperlink{khazad_8c_a5c71a5e59a53413cd6c270266d63b031}{R}})) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}})                           \{ \textcolor{keywordflow}{goto} done; \}}
\DoxyCodeLine{62    \}}
\DoxyCodeLine{63 }
\DoxyCodeLine{64    \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{tomcrypt__private_8h_a54a2d7d30af25ef341a8aca09269177d}{ltc\_ecc\_is\_point\_at\_infinity}}(P, modulus, \&inf)) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}}) \textcolor{keywordflow}{return} err;}
\DoxyCodeLine{65    \textcolor{keywordflow}{if} (inf) \{}
\DoxyCodeLine{66       \textcolor{comment}{/* if P is point at infinity >> Result = point at infinity */}}
\DoxyCodeLine{67       err = \mbox{\hyperlink{tomcrypt__private_8h_adc0366a4a0c272b7594bcea0d8fe7ccb}{ltc\_ecc\_set\_point\_xyz}}(1, 1, 0, \mbox{\hyperlink{khazad_8c_a5c71a5e59a53413cd6c270266d63b031}{R}});}
\DoxyCodeLine{68       \textcolor{keywordflow}{goto} done;}
\DoxyCodeLine{69    \}}
\DoxyCodeLine{70 }
\DoxyCodeLine{71    \textcolor{comment}{/* t1 = Z * Z */}}
\DoxyCodeLine{72    \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{tomcrypt__private_8h_aea81d79b5462e99068908d80edb8bd1a}{mp\_sqr}}(\mbox{\hyperlink{khazad_8c_a5c71a5e59a53413cd6c270266d63b031}{R}}->z, \mbox{\hyperlink{tiger_8c_a65f7891fccbfcf7d08964555630773b3}{t1}})) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}})                                      \{ \textcolor{keywordflow}{goto} done; \}}
\DoxyCodeLine{73    \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{tomcrypt__private_8h_a4201ed2dbae154496e1a2ae9ba8aa7a8}{mp\_montgomery\_reduce}}(\mbox{\hyperlink{tiger_8c_a65f7891fccbfcf7d08964555630773b3}{t1}}, modulus, mp)) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}})                 \{ \textcolor{keywordflow}{goto} done; \}}
\DoxyCodeLine{74    \textcolor{comment}{/* Z = Y * Z */}}
\DoxyCodeLine{75    \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{tomcrypt__private_8h_a7606d2423856b32b09245a2fa1ef34ee}{mp\_mul}}(\mbox{\hyperlink{khazad_8c_a5c71a5e59a53413cd6c270266d63b031}{R}}->z, \mbox{\hyperlink{khazad_8c_a5c71a5e59a53413cd6c270266d63b031}{R}}->y, \mbox{\hyperlink{khazad_8c_a5c71a5e59a53413cd6c270266d63b031}{R}}->z)) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}})                              \{ \textcolor{keywordflow}{goto} done; \}}
\DoxyCodeLine{76    \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{tomcrypt__private_8h_a4201ed2dbae154496e1a2ae9ba8aa7a8}{mp\_montgomery\_reduce}}(\mbox{\hyperlink{khazad_8c_a5c71a5e59a53413cd6c270266d63b031}{R}}->z, modulus, mp)) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}})               \{ \textcolor{keywordflow}{goto} done; \}}
\DoxyCodeLine{77    \textcolor{comment}{/* Z = 2Z */}}
\DoxyCodeLine{78    \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{tomcrypt__private_8h_a175d04f8aeaa1c3895fe14de6cc0d2db}{mp\_add}}(\mbox{\hyperlink{khazad_8c_a5c71a5e59a53413cd6c270266d63b031}{R}}->z, \mbox{\hyperlink{khazad_8c_a5c71a5e59a53413cd6c270266d63b031}{R}}->z, \mbox{\hyperlink{khazad_8c_a5c71a5e59a53413cd6c270266d63b031}{R}}->z)) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}})                              \{ \textcolor{keywordflow}{goto} done; \}}
\DoxyCodeLine{79    \textcolor{keywordflow}{if} (\mbox{\hyperlink{tomcrypt__private_8h_a62ea02fbe7dd2d456e49520264d775ee}{mp\_cmp}}(\mbox{\hyperlink{khazad_8c_a5c71a5e59a53413cd6c270266d63b031}{R}}->z, modulus) != \mbox{\hyperlink{tomcrypt__math_8h_a42d0c7d4c09793df79660774d3436db2}{LTC\_MP\_LT}}) \{}
\DoxyCodeLine{80       \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{tomcrypt__private_8h_ab8d0882c3b58263b638b41fbf110fde8}{mp\_sub}}(\mbox{\hyperlink{khazad_8c_a5c71a5e59a53413cd6c270266d63b031}{R}}->z, modulus, \mbox{\hyperlink{khazad_8c_a5c71a5e59a53413cd6c270266d63b031}{R}}->z)) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}})                        \{ \textcolor{keywordflow}{goto} done; \}}
\DoxyCodeLine{81    \}}
\DoxyCodeLine{82 }
\DoxyCodeLine{83    \textcolor{keywordflow}{if} (ma == NULL) \{ \textcolor{comment}{/* special case for curves with a == -3 (10\% faster than general case) */}}
\DoxyCodeLine{84       \textcolor{comment}{/* T2 = X - T1 */}}
\DoxyCodeLine{85       \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{tomcrypt__private_8h_ab8d0882c3b58263b638b41fbf110fde8}{mp\_sub}}(\mbox{\hyperlink{khazad_8c_a5c71a5e59a53413cd6c270266d63b031}{R}}->x, \mbox{\hyperlink{tiger_8c_a65f7891fccbfcf7d08964555630773b3}{t1}}, \mbox{\hyperlink{tiger_8c_aa4652e2d6053d420dcbea07a113db5fe}{t2}})) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}})                               \{ \textcolor{keywordflow}{goto} done; \}}
\DoxyCodeLine{86       \textcolor{keywordflow}{if} (\mbox{\hyperlink{tomcrypt__private_8h_a6ce44f2e6f872565a468b67d9a93dc28}{mp\_cmp\_d}}(\mbox{\hyperlink{tiger_8c_aa4652e2d6053d420dcbea07a113db5fe}{t2}}, 0) == \mbox{\hyperlink{tomcrypt__math_8h_a42d0c7d4c09793df79660774d3436db2}{LTC\_MP\_LT}}) \{}
\DoxyCodeLine{87          \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{tomcrypt__private_8h_a175d04f8aeaa1c3895fe14de6cc0d2db}{mp\_add}}(\mbox{\hyperlink{tiger_8c_aa4652e2d6053d420dcbea07a113db5fe}{t2}}, modulus, \mbox{\hyperlink{tiger_8c_aa4652e2d6053d420dcbea07a113db5fe}{t2}})) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}})                         \{ \textcolor{keywordflow}{goto} done; \}}
\DoxyCodeLine{88       \}}
\DoxyCodeLine{89       \textcolor{comment}{/* T1 = X + T1 */}}
\DoxyCodeLine{90       \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{tomcrypt__private_8h_a175d04f8aeaa1c3895fe14de6cc0d2db}{mp\_add}}(\mbox{\hyperlink{tiger_8c_a65f7891fccbfcf7d08964555630773b3}{t1}}, \mbox{\hyperlink{khazad_8c_a5c71a5e59a53413cd6c270266d63b031}{R}}->x, \mbox{\hyperlink{tiger_8c_a65f7891fccbfcf7d08964555630773b3}{t1}})) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}})                               \{ \textcolor{keywordflow}{goto} done; \}}
\DoxyCodeLine{91       \textcolor{keywordflow}{if} (\mbox{\hyperlink{tomcrypt__private_8h_a62ea02fbe7dd2d456e49520264d775ee}{mp\_cmp}}(\mbox{\hyperlink{tiger_8c_a65f7891fccbfcf7d08964555630773b3}{t1}}, modulus) != \mbox{\hyperlink{tomcrypt__math_8h_a42d0c7d4c09793df79660774d3436db2}{LTC\_MP\_LT}}) \{}
\DoxyCodeLine{92          \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{tomcrypt__private_8h_ab8d0882c3b58263b638b41fbf110fde8}{mp\_sub}}(\mbox{\hyperlink{tiger_8c_a65f7891fccbfcf7d08964555630773b3}{t1}}, modulus, \mbox{\hyperlink{tiger_8c_a65f7891fccbfcf7d08964555630773b3}{t1}})) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}})                         \{ \textcolor{keywordflow}{goto} done; \}}
\DoxyCodeLine{93       \}}
\DoxyCodeLine{94       \textcolor{comment}{/* T2 = T1 * T2 */}}
\DoxyCodeLine{95       \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{tomcrypt__private_8h_a7606d2423856b32b09245a2fa1ef34ee}{mp\_mul}}(\mbox{\hyperlink{tiger_8c_a65f7891fccbfcf7d08964555630773b3}{t1}}, \mbox{\hyperlink{tiger_8c_aa4652e2d6053d420dcbea07a113db5fe}{t2}}, \mbox{\hyperlink{tiger_8c_aa4652e2d6053d420dcbea07a113db5fe}{t2}})) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}})                                 \{ \textcolor{keywordflow}{goto} done; \}}
\DoxyCodeLine{96       \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{tomcrypt__private_8h_a4201ed2dbae154496e1a2ae9ba8aa7a8}{mp\_montgomery\_reduce}}(\mbox{\hyperlink{tiger_8c_aa4652e2d6053d420dcbea07a113db5fe}{t2}}, modulus, mp)) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}})              \{ \textcolor{keywordflow}{goto} done; \}}
\DoxyCodeLine{97       \textcolor{comment}{/* T1 = 2T2 */}}
\DoxyCodeLine{98       \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{tomcrypt__private_8h_a175d04f8aeaa1c3895fe14de6cc0d2db}{mp\_add}}(\mbox{\hyperlink{tiger_8c_aa4652e2d6053d420dcbea07a113db5fe}{t2}}, \mbox{\hyperlink{tiger_8c_aa4652e2d6053d420dcbea07a113db5fe}{t2}}, \mbox{\hyperlink{tiger_8c_a65f7891fccbfcf7d08964555630773b3}{t1}})) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}})                                 \{ \textcolor{keywordflow}{goto} done; \}}
\DoxyCodeLine{99       \textcolor{keywordflow}{if} (\mbox{\hyperlink{tomcrypt__private_8h_a62ea02fbe7dd2d456e49520264d775ee}{mp\_cmp}}(\mbox{\hyperlink{tiger_8c_a65f7891fccbfcf7d08964555630773b3}{t1}}, modulus) != \mbox{\hyperlink{tomcrypt__math_8h_a42d0c7d4c09793df79660774d3436db2}{LTC\_MP\_LT}}) \{}
\DoxyCodeLine{100          \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{tomcrypt__private_8h_ab8d0882c3b58263b638b41fbf110fde8}{mp\_sub}}(\mbox{\hyperlink{tiger_8c_a65f7891fccbfcf7d08964555630773b3}{t1}}, modulus, \mbox{\hyperlink{tiger_8c_a65f7891fccbfcf7d08964555630773b3}{t1}})) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}})                         \{ \textcolor{keywordflow}{goto} done; \}}
\DoxyCodeLine{101       \}}
\DoxyCodeLine{102       \textcolor{comment}{/* T1 = T1 + T2 */}}
\DoxyCodeLine{103       \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{tomcrypt__private_8h_a175d04f8aeaa1c3895fe14de6cc0d2db}{mp\_add}}(\mbox{\hyperlink{tiger_8c_a65f7891fccbfcf7d08964555630773b3}{t1}}, \mbox{\hyperlink{tiger_8c_aa4652e2d6053d420dcbea07a113db5fe}{t2}}, \mbox{\hyperlink{tiger_8c_a65f7891fccbfcf7d08964555630773b3}{t1}})) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}})                                 \{ \textcolor{keywordflow}{goto} done; \}}
\DoxyCodeLine{104       \textcolor{keywordflow}{if} (\mbox{\hyperlink{tomcrypt__private_8h_a62ea02fbe7dd2d456e49520264d775ee}{mp\_cmp}}(\mbox{\hyperlink{tiger_8c_a65f7891fccbfcf7d08964555630773b3}{t1}}, modulus) != \mbox{\hyperlink{tomcrypt__math_8h_a42d0c7d4c09793df79660774d3436db2}{LTC\_MP\_LT}}) \{}
\DoxyCodeLine{105          \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{tomcrypt__private_8h_ab8d0882c3b58263b638b41fbf110fde8}{mp\_sub}}(\mbox{\hyperlink{tiger_8c_a65f7891fccbfcf7d08964555630773b3}{t1}}, modulus, \mbox{\hyperlink{tiger_8c_a65f7891fccbfcf7d08964555630773b3}{t1}})) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}})                         \{ \textcolor{keywordflow}{goto} done; \}}
\DoxyCodeLine{106       \}}
\DoxyCodeLine{107    \}}
\DoxyCodeLine{108    \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{109       \textcolor{comment}{/* T2 = T1 * T1 */}}
\DoxyCodeLine{110       \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{tomcrypt__private_8h_aea81d79b5462e99068908d80edb8bd1a}{mp\_sqr}}(\mbox{\hyperlink{tiger_8c_a65f7891fccbfcf7d08964555630773b3}{t1}}, \mbox{\hyperlink{tiger_8c_aa4652e2d6053d420dcbea07a113db5fe}{t2}})) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}})                                     \{ \textcolor{keywordflow}{goto} done; \}}
\DoxyCodeLine{111       \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{tomcrypt__private_8h_a4201ed2dbae154496e1a2ae9ba8aa7a8}{mp\_montgomery\_reduce}}(\mbox{\hyperlink{tiger_8c_aa4652e2d6053d420dcbea07a113db5fe}{t2}}, modulus, mp)) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}})              \{ \textcolor{keywordflow}{goto} done; \}}
\DoxyCodeLine{112       \textcolor{comment}{/* T1 = T2 * a */}}
\DoxyCodeLine{113       \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{tomcrypt__private_8h_a7606d2423856b32b09245a2fa1ef34ee}{mp\_mul}}(\mbox{\hyperlink{tiger_8c_aa4652e2d6053d420dcbea07a113db5fe}{t2}}, ma, \mbox{\hyperlink{tiger_8c_a65f7891fccbfcf7d08964555630773b3}{t1}})) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}})                                 \{ \textcolor{keywordflow}{goto} done; \}}
\DoxyCodeLine{114       \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{tomcrypt__private_8h_a4201ed2dbae154496e1a2ae9ba8aa7a8}{mp\_montgomery\_reduce}}(\mbox{\hyperlink{tiger_8c_a65f7891fccbfcf7d08964555630773b3}{t1}}, modulus, mp)) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}})              \{ \textcolor{keywordflow}{goto} done; \}}
\DoxyCodeLine{115       \textcolor{comment}{/* T2 = X * X */}}
\DoxyCodeLine{116       \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{tomcrypt__private_8h_aea81d79b5462e99068908d80edb8bd1a}{mp\_sqr}}(\mbox{\hyperlink{khazad_8c_a5c71a5e59a53413cd6c270266d63b031}{R}}->x, \mbox{\hyperlink{tiger_8c_aa4652e2d6053d420dcbea07a113db5fe}{t2}})) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}})                                   \{ \textcolor{keywordflow}{goto} done; \}}
\DoxyCodeLine{117       \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{tomcrypt__private_8h_a4201ed2dbae154496e1a2ae9ba8aa7a8}{mp\_montgomery\_reduce}}(\mbox{\hyperlink{tiger_8c_aa4652e2d6053d420dcbea07a113db5fe}{t2}}, modulus, mp)) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}})              \{ \textcolor{keywordflow}{goto} done; \}}
\DoxyCodeLine{118       \textcolor{comment}{/* T1 = T2 + T1 */}}
\DoxyCodeLine{119       \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{tomcrypt__private_8h_a175d04f8aeaa1c3895fe14de6cc0d2db}{mp\_add}}(\mbox{\hyperlink{tiger_8c_a65f7891fccbfcf7d08964555630773b3}{t1}}, \mbox{\hyperlink{tiger_8c_aa4652e2d6053d420dcbea07a113db5fe}{t2}}, \mbox{\hyperlink{tiger_8c_a65f7891fccbfcf7d08964555630773b3}{t1}})) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}})                                 \{ \textcolor{keywordflow}{goto} done; \}}
\DoxyCodeLine{120       \textcolor{keywordflow}{if} (\mbox{\hyperlink{tomcrypt__private_8h_a62ea02fbe7dd2d456e49520264d775ee}{mp\_cmp}}(\mbox{\hyperlink{tiger_8c_a65f7891fccbfcf7d08964555630773b3}{t1}}, modulus) != \mbox{\hyperlink{tomcrypt__math_8h_a42d0c7d4c09793df79660774d3436db2}{LTC\_MP\_LT}}) \{}
\DoxyCodeLine{121          \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{tomcrypt__private_8h_ab8d0882c3b58263b638b41fbf110fde8}{mp\_sub}}(\mbox{\hyperlink{tiger_8c_a65f7891fccbfcf7d08964555630773b3}{t1}}, modulus, \mbox{\hyperlink{tiger_8c_a65f7891fccbfcf7d08964555630773b3}{t1}})) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}})                         \{ \textcolor{keywordflow}{goto} done; \}}
\DoxyCodeLine{122       \}}
\DoxyCodeLine{123       \textcolor{comment}{/* T1 = T2 + T1 */}}
\DoxyCodeLine{124       \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{tomcrypt__private_8h_a175d04f8aeaa1c3895fe14de6cc0d2db}{mp\_add}}(\mbox{\hyperlink{tiger_8c_a65f7891fccbfcf7d08964555630773b3}{t1}}, \mbox{\hyperlink{tiger_8c_aa4652e2d6053d420dcbea07a113db5fe}{t2}}, \mbox{\hyperlink{tiger_8c_a65f7891fccbfcf7d08964555630773b3}{t1}})) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}})                                 \{ \textcolor{keywordflow}{goto} done; \}}
\DoxyCodeLine{125       \textcolor{keywordflow}{if} (\mbox{\hyperlink{tomcrypt__private_8h_a62ea02fbe7dd2d456e49520264d775ee}{mp\_cmp}}(\mbox{\hyperlink{tiger_8c_a65f7891fccbfcf7d08964555630773b3}{t1}}, modulus) != \mbox{\hyperlink{tomcrypt__math_8h_a42d0c7d4c09793df79660774d3436db2}{LTC\_MP\_LT}}) \{}
\DoxyCodeLine{126          \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{tomcrypt__private_8h_ab8d0882c3b58263b638b41fbf110fde8}{mp\_sub}}(\mbox{\hyperlink{tiger_8c_a65f7891fccbfcf7d08964555630773b3}{t1}}, modulus, \mbox{\hyperlink{tiger_8c_a65f7891fccbfcf7d08964555630773b3}{t1}})) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}})                         \{ \textcolor{keywordflow}{goto} done; \}}
\DoxyCodeLine{127       \}}
\DoxyCodeLine{128       \textcolor{comment}{/* T1 = T2 + T1 */}}
\DoxyCodeLine{129       \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{tomcrypt__private_8h_a175d04f8aeaa1c3895fe14de6cc0d2db}{mp\_add}}(\mbox{\hyperlink{tiger_8c_a65f7891fccbfcf7d08964555630773b3}{t1}}, \mbox{\hyperlink{tiger_8c_aa4652e2d6053d420dcbea07a113db5fe}{t2}}, \mbox{\hyperlink{tiger_8c_a65f7891fccbfcf7d08964555630773b3}{t1}})) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}})                                 \{ \textcolor{keywordflow}{goto} done; \}}
\DoxyCodeLine{130       \textcolor{keywordflow}{if} (\mbox{\hyperlink{tomcrypt__private_8h_a62ea02fbe7dd2d456e49520264d775ee}{mp\_cmp}}(\mbox{\hyperlink{tiger_8c_a65f7891fccbfcf7d08964555630773b3}{t1}}, modulus) != \mbox{\hyperlink{tomcrypt__math_8h_a42d0c7d4c09793df79660774d3436db2}{LTC\_MP\_LT}}) \{}
\DoxyCodeLine{131          \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{tomcrypt__private_8h_ab8d0882c3b58263b638b41fbf110fde8}{mp\_sub}}(\mbox{\hyperlink{tiger_8c_a65f7891fccbfcf7d08964555630773b3}{t1}}, modulus, \mbox{\hyperlink{tiger_8c_a65f7891fccbfcf7d08964555630773b3}{t1}})) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}})                         \{ \textcolor{keywordflow}{goto} done; \}}
\DoxyCodeLine{132       \}}
\DoxyCodeLine{133    \}}
\DoxyCodeLine{134 }
\DoxyCodeLine{135    \textcolor{comment}{/* Y = 2Y */}}
\DoxyCodeLine{136    \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{tomcrypt__private_8h_a175d04f8aeaa1c3895fe14de6cc0d2db}{mp\_add}}(\mbox{\hyperlink{khazad_8c_a5c71a5e59a53413cd6c270266d63b031}{R}}->y, \mbox{\hyperlink{khazad_8c_a5c71a5e59a53413cd6c270266d63b031}{R}}->y, \mbox{\hyperlink{khazad_8c_a5c71a5e59a53413cd6c270266d63b031}{R}}->y)) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}})                              \{ \textcolor{keywordflow}{goto} done; \}}
\DoxyCodeLine{137    \textcolor{keywordflow}{if} (\mbox{\hyperlink{tomcrypt__private_8h_a62ea02fbe7dd2d456e49520264d775ee}{mp\_cmp}}(\mbox{\hyperlink{khazad_8c_a5c71a5e59a53413cd6c270266d63b031}{R}}->y, modulus) != \mbox{\hyperlink{tomcrypt__math_8h_a42d0c7d4c09793df79660774d3436db2}{LTC\_MP\_LT}}) \{}
\DoxyCodeLine{138       \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{tomcrypt__private_8h_ab8d0882c3b58263b638b41fbf110fde8}{mp\_sub}}(\mbox{\hyperlink{khazad_8c_a5c71a5e59a53413cd6c270266d63b031}{R}}->y, modulus, \mbox{\hyperlink{khazad_8c_a5c71a5e59a53413cd6c270266d63b031}{R}}->y)) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}})                        \{ \textcolor{keywordflow}{goto} done; \}}
\DoxyCodeLine{139    \}}
\DoxyCodeLine{140    \textcolor{comment}{/* Y = Y * Y */}}
\DoxyCodeLine{141    \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{tomcrypt__private_8h_aea81d79b5462e99068908d80edb8bd1a}{mp\_sqr}}(\mbox{\hyperlink{khazad_8c_a5c71a5e59a53413cd6c270266d63b031}{R}}->y, \mbox{\hyperlink{khazad_8c_a5c71a5e59a53413cd6c270266d63b031}{R}}->y)) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}})                                    \{ \textcolor{keywordflow}{goto} done; \}}
\DoxyCodeLine{142    \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{tomcrypt__private_8h_a4201ed2dbae154496e1a2ae9ba8aa7a8}{mp\_montgomery\_reduce}}(\mbox{\hyperlink{khazad_8c_a5c71a5e59a53413cd6c270266d63b031}{R}}->y, modulus, mp)) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}})               \{ \textcolor{keywordflow}{goto} done; \}}
\DoxyCodeLine{143    \textcolor{comment}{/* T2 = Y * Y */}}
\DoxyCodeLine{144    \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{tomcrypt__private_8h_aea81d79b5462e99068908d80edb8bd1a}{mp\_sqr}}(\mbox{\hyperlink{khazad_8c_a5c71a5e59a53413cd6c270266d63b031}{R}}->y, \mbox{\hyperlink{tiger_8c_aa4652e2d6053d420dcbea07a113db5fe}{t2}})) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}})                                      \{ \textcolor{keywordflow}{goto} done; \}}
\DoxyCodeLine{145    \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{tomcrypt__private_8h_a4201ed2dbae154496e1a2ae9ba8aa7a8}{mp\_montgomery\_reduce}}(\mbox{\hyperlink{tiger_8c_aa4652e2d6053d420dcbea07a113db5fe}{t2}}, modulus, mp)) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}})                 \{ \textcolor{keywordflow}{goto} done; \}}
\DoxyCodeLine{146    \textcolor{comment}{/* T2 = T2/2 */}}
\DoxyCodeLine{147    \textcolor{keywordflow}{if} (\mbox{\hyperlink{tomcrypt__private_8h_a93ed39c257831509afc74f2b6da66ae7}{mp\_isodd}}(\mbox{\hyperlink{tiger_8c_aa4652e2d6053d420dcbea07a113db5fe}{t2}})) \{}
\DoxyCodeLine{148       \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{tomcrypt__private_8h_a175d04f8aeaa1c3895fe14de6cc0d2db}{mp\_add}}(\mbox{\hyperlink{tiger_8c_aa4652e2d6053d420dcbea07a113db5fe}{t2}}, modulus, \mbox{\hyperlink{tiger_8c_aa4652e2d6053d420dcbea07a113db5fe}{t2}})) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}})                            \{ \textcolor{keywordflow}{goto} done; \}}
\DoxyCodeLine{149    \}}
\DoxyCodeLine{150    \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{tomcrypt__private_8h_aec841464b436981f5758a49c561f39fe}{mp\_div\_2}}(\mbox{\hyperlink{tiger_8c_aa4652e2d6053d420dcbea07a113db5fe}{t2}}, \mbox{\hyperlink{tiger_8c_aa4652e2d6053d420dcbea07a113db5fe}{t2}})) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}})                                      \{ \textcolor{keywordflow}{goto} done; \}}
\DoxyCodeLine{151    \textcolor{comment}{/* Y = Y * X */}}
\DoxyCodeLine{152    \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{tomcrypt__private_8h_a7606d2423856b32b09245a2fa1ef34ee}{mp\_mul}}(\mbox{\hyperlink{khazad_8c_a5c71a5e59a53413cd6c270266d63b031}{R}}->y, \mbox{\hyperlink{khazad_8c_a5c71a5e59a53413cd6c270266d63b031}{R}}->x, \mbox{\hyperlink{khazad_8c_a5c71a5e59a53413cd6c270266d63b031}{R}}->y)) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}})                              \{ \textcolor{keywordflow}{goto} done; \}}
\DoxyCodeLine{153    \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{tomcrypt__private_8h_a4201ed2dbae154496e1a2ae9ba8aa7a8}{mp\_montgomery\_reduce}}(\mbox{\hyperlink{khazad_8c_a5c71a5e59a53413cd6c270266d63b031}{R}}->y, modulus, mp)) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}})               \{ \textcolor{keywordflow}{goto} done; \}}
\DoxyCodeLine{154 }
\DoxyCodeLine{155    \textcolor{comment}{/* X  = T1 * T1 */}}
\DoxyCodeLine{156    \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{tomcrypt__private_8h_aea81d79b5462e99068908d80edb8bd1a}{mp\_sqr}}(\mbox{\hyperlink{tiger_8c_a65f7891fccbfcf7d08964555630773b3}{t1}}, \mbox{\hyperlink{khazad_8c_a5c71a5e59a53413cd6c270266d63b031}{R}}->x)) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}})                                      \{ \textcolor{keywordflow}{goto} done; \}}
\DoxyCodeLine{157    \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{tomcrypt__private_8h_a4201ed2dbae154496e1a2ae9ba8aa7a8}{mp\_montgomery\_reduce}}(\mbox{\hyperlink{khazad_8c_a5c71a5e59a53413cd6c270266d63b031}{R}}->x, modulus, mp)) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}})               \{ \textcolor{keywordflow}{goto} done; \}}
\DoxyCodeLine{158    \textcolor{comment}{/* X = X - Y */}}
\DoxyCodeLine{159    \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{tomcrypt__private_8h_ab8d0882c3b58263b638b41fbf110fde8}{mp\_sub}}(\mbox{\hyperlink{khazad_8c_a5c71a5e59a53413cd6c270266d63b031}{R}}->x, \mbox{\hyperlink{khazad_8c_a5c71a5e59a53413cd6c270266d63b031}{R}}->y, \mbox{\hyperlink{khazad_8c_a5c71a5e59a53413cd6c270266d63b031}{R}}->x)) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}})                              \{ \textcolor{keywordflow}{goto} done; \}}
\DoxyCodeLine{160    \textcolor{keywordflow}{if} (\mbox{\hyperlink{tomcrypt__private_8h_a6ce44f2e6f872565a468b67d9a93dc28}{mp\_cmp\_d}}(\mbox{\hyperlink{khazad_8c_a5c71a5e59a53413cd6c270266d63b031}{R}}->x, 0) == \mbox{\hyperlink{tomcrypt__math_8h_a42d0c7d4c09793df79660774d3436db2}{LTC\_MP\_LT}}) \{}
\DoxyCodeLine{161       \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{tomcrypt__private_8h_a175d04f8aeaa1c3895fe14de6cc0d2db}{mp\_add}}(\mbox{\hyperlink{khazad_8c_a5c71a5e59a53413cd6c270266d63b031}{R}}->x, modulus, \mbox{\hyperlink{khazad_8c_a5c71a5e59a53413cd6c270266d63b031}{R}}->x)) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}})                        \{ \textcolor{keywordflow}{goto} done; \}}
\DoxyCodeLine{162    \}}
\DoxyCodeLine{163    \textcolor{comment}{/* X = X - Y */}}
\DoxyCodeLine{164    \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{tomcrypt__private_8h_ab8d0882c3b58263b638b41fbf110fde8}{mp\_sub}}(\mbox{\hyperlink{khazad_8c_a5c71a5e59a53413cd6c270266d63b031}{R}}->x, \mbox{\hyperlink{khazad_8c_a5c71a5e59a53413cd6c270266d63b031}{R}}->y, \mbox{\hyperlink{khazad_8c_a5c71a5e59a53413cd6c270266d63b031}{R}}->x)) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}})                              \{ \textcolor{keywordflow}{goto} done; \}}
\DoxyCodeLine{165    \textcolor{keywordflow}{if} (\mbox{\hyperlink{tomcrypt__private_8h_a6ce44f2e6f872565a468b67d9a93dc28}{mp\_cmp\_d}}(\mbox{\hyperlink{khazad_8c_a5c71a5e59a53413cd6c270266d63b031}{R}}->x, 0) == \mbox{\hyperlink{tomcrypt__math_8h_a42d0c7d4c09793df79660774d3436db2}{LTC\_MP\_LT}}) \{}
\DoxyCodeLine{166       \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{tomcrypt__private_8h_a175d04f8aeaa1c3895fe14de6cc0d2db}{mp\_add}}(\mbox{\hyperlink{khazad_8c_a5c71a5e59a53413cd6c270266d63b031}{R}}->x, modulus, \mbox{\hyperlink{khazad_8c_a5c71a5e59a53413cd6c270266d63b031}{R}}->x)) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}})                        \{ \textcolor{keywordflow}{goto} done; \}}
\DoxyCodeLine{167    \}}
\DoxyCodeLine{168 }
\DoxyCodeLine{169    \textcolor{comment}{/* Y = Y - X */}}
\DoxyCodeLine{170    \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{tomcrypt__private_8h_ab8d0882c3b58263b638b41fbf110fde8}{mp\_sub}}(\mbox{\hyperlink{khazad_8c_a5c71a5e59a53413cd6c270266d63b031}{R}}->y, \mbox{\hyperlink{khazad_8c_a5c71a5e59a53413cd6c270266d63b031}{R}}->x, \mbox{\hyperlink{khazad_8c_a5c71a5e59a53413cd6c270266d63b031}{R}}->y)) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}})                              \{ \textcolor{keywordflow}{goto} done; \}}
\DoxyCodeLine{171    \textcolor{keywordflow}{if} (\mbox{\hyperlink{tomcrypt__private_8h_a6ce44f2e6f872565a468b67d9a93dc28}{mp\_cmp\_d}}(\mbox{\hyperlink{khazad_8c_a5c71a5e59a53413cd6c270266d63b031}{R}}->y, 0) == \mbox{\hyperlink{tomcrypt__math_8h_a42d0c7d4c09793df79660774d3436db2}{LTC\_MP\_LT}}) \{}
\DoxyCodeLine{172       \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{tomcrypt__private_8h_a175d04f8aeaa1c3895fe14de6cc0d2db}{mp\_add}}(\mbox{\hyperlink{khazad_8c_a5c71a5e59a53413cd6c270266d63b031}{R}}->y, modulus, \mbox{\hyperlink{khazad_8c_a5c71a5e59a53413cd6c270266d63b031}{R}}->y)) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}})                        \{ \textcolor{keywordflow}{goto} done; \}}
\DoxyCodeLine{173    \}}
\DoxyCodeLine{174    \textcolor{comment}{/* Y = Y * T1 */}}
\DoxyCodeLine{175    \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{tomcrypt__private_8h_a7606d2423856b32b09245a2fa1ef34ee}{mp\_mul}}(\mbox{\hyperlink{khazad_8c_a5c71a5e59a53413cd6c270266d63b031}{R}}->y, \mbox{\hyperlink{tiger_8c_a65f7891fccbfcf7d08964555630773b3}{t1}}, \mbox{\hyperlink{khazad_8c_a5c71a5e59a53413cd6c270266d63b031}{R}}->y)) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}})                                \{ \textcolor{keywordflow}{goto} done; \}}
\DoxyCodeLine{176    \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{tomcrypt__private_8h_a4201ed2dbae154496e1a2ae9ba8aa7a8}{mp\_montgomery\_reduce}}(\mbox{\hyperlink{khazad_8c_a5c71a5e59a53413cd6c270266d63b031}{R}}->y, modulus, mp)) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}})               \{ \textcolor{keywordflow}{goto} done; \}}
\DoxyCodeLine{177    \textcolor{comment}{/* Y = Y - T2 */}}
\DoxyCodeLine{178    \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{tomcrypt__private_8h_ab8d0882c3b58263b638b41fbf110fde8}{mp\_sub}}(\mbox{\hyperlink{khazad_8c_a5c71a5e59a53413cd6c270266d63b031}{R}}->y, \mbox{\hyperlink{tiger_8c_aa4652e2d6053d420dcbea07a113db5fe}{t2}}, \mbox{\hyperlink{khazad_8c_a5c71a5e59a53413cd6c270266d63b031}{R}}->y)) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}})                                \{ \textcolor{keywordflow}{goto} done; \}}
\DoxyCodeLine{179    \textcolor{keywordflow}{if} (\mbox{\hyperlink{tomcrypt__private_8h_a6ce44f2e6f872565a468b67d9a93dc28}{mp\_cmp\_d}}(\mbox{\hyperlink{khazad_8c_a5c71a5e59a53413cd6c270266d63b031}{R}}->y, 0) == \mbox{\hyperlink{tomcrypt__math_8h_a42d0c7d4c09793df79660774d3436db2}{LTC\_MP\_LT}}) \{}
\DoxyCodeLine{180       \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{tomcrypt__private_8h_a175d04f8aeaa1c3895fe14de6cc0d2db}{mp\_add}}(\mbox{\hyperlink{khazad_8c_a5c71a5e59a53413cd6c270266d63b031}{R}}->y, modulus, \mbox{\hyperlink{khazad_8c_a5c71a5e59a53413cd6c270266d63b031}{R}}->y)) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}})                        \{ \textcolor{keywordflow}{goto} done; \}}
\DoxyCodeLine{181    \}}
\DoxyCodeLine{182 }
\DoxyCodeLine{183    err = \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}};}
\DoxyCodeLine{184 done:}
\DoxyCodeLine{185    \mbox{\hyperlink{tomcrypt__private_8h_aad5c8a3112b3e4613f9efc86692c43cb}{mp\_clear\_multi}}(\mbox{\hyperlink{tiger_8c_aa4652e2d6053d420dcbea07a113db5fe}{t2}}, \mbox{\hyperlink{tiger_8c_a65f7891fccbfcf7d08964555630773b3}{t1}}, NULL);}
\DoxyCodeLine{186    \textcolor{keywordflow}{return} err;}
\DoxyCodeLine{187 \}}

\end{DoxyCode}


References C\+R\+Y\+P\+T\+\_\+\+OK, L\+T\+C\+\_\+\+A\+R\+G\+C\+HK, ltc\+\_\+ecc\+\_\+copy\+\_\+point(), ltc\+\_\+ecc\+\_\+is\+\_\+point\+\_\+at\+\_\+infinity(), ltc\+\_\+ecc\+\_\+set\+\_\+point\+\_\+xyz(), L\+T\+C\+\_\+\+M\+P\+\_\+\+LT, mp\+\_\+add, mp\+\_\+clear\+\_\+multi, mp\+\_\+cmp, mp\+\_\+cmp\+\_\+d, mp\+\_\+div\+\_\+2, mp\+\_\+init\+\_\+multi, mp\+\_\+isodd, mp\+\_\+montgomery\+\_\+reduce, mp\+\_\+mul, mp\+\_\+sqr, mp\+\_\+sub, R, t1, and t2.



Referenced by ltc\+\_\+ecc\+\_\+projective\+\_\+add\+\_\+point().

Here is the call graph for this function\+:
% FIG 50
Here is the caller graph for this function\+:
% FIG 51
\mbox{\Hypertarget{tomcrypt__private_8h_adc0366a4a0c272b7594bcea0d8fe7ccb}\label{tomcrypt__private_8h_adc0366a4a0c272b7594bcea0d8fe7ccb}} 
\index{tomcrypt\_private.h@{tomcrypt\_private.h}!ltc\_ecc\_set\_point\_xyz@{ltc\_ecc\_set\_point\_xyz}}
\index{ltc\_ecc\_set\_point\_xyz@{ltc\_ecc\_set\_point\_xyz}!tomcrypt\_private.h@{tomcrypt\_private.h}}
\subsubsection{\texorpdfstring{ltc\_ecc\_set\_point\_xyz()}{ltc\_ecc\_set\_point\_xyz()}}
{\footnotesize\ttfamily int ltc\+\_\+ecc\+\_\+set\+\_\+point\+\_\+xyz (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{tomcrypt__cfg_8h_a4e98fa26a5de0ac87e06af901bad57c4}{ltc\+\_\+mp\+\_\+digit}}}]{x,  }\item[{\mbox{\hyperlink{tomcrypt__cfg_8h_a4e98fa26a5de0ac87e06af901bad57c4}{ltc\+\_\+mp\+\_\+digit}}}]{y,  }\item[{\mbox{\hyperlink{tomcrypt__cfg_8h_a4e98fa26a5de0ac87e06af901bad57c4}{ltc\+\_\+mp\+\_\+digit}}}]{z,  }\item[{\mbox{\hyperlink{tomcrypt__math_8h_a2a6efaeaa795aa54274d7c4fd66b018a}{ecc\+\_\+point}} $\ast$}]{p }\end{DoxyParamCaption})}



Definition at line 49 of file ltc\+\_\+ecc\+\_\+points.\+c.


\begin{DoxyCode}{0}
\DoxyCodeLine{50 \{}
\DoxyCodeLine{51    \textcolor{keywordtype}{int} err;}
\DoxyCodeLine{52    \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{tomcrypt__math_8h_a3d38c44518c63b7a8abd0938f3d41c65}{ltc\_mp}}.\mbox{\hyperlink{structltc__math__descriptor_ad306f25bb0a78e082f0c3baf85c4f44c}{set\_int}}(p->x, x)) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}}) \textcolor{keywordflow}{return} err;}
\DoxyCodeLine{53    \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{tomcrypt__math_8h_a3d38c44518c63b7a8abd0938f3d41c65}{ltc\_mp}}.\mbox{\hyperlink{structltc__math__descriptor_ad306f25bb0a78e082f0c3baf85c4f44c}{set\_int}}(p->y, y)) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}}) \textcolor{keywordflow}{return} err;}
\DoxyCodeLine{54    \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{tomcrypt__math_8h_a3d38c44518c63b7a8abd0938f3d41c65}{ltc\_mp}}.\mbox{\hyperlink{structltc__math__descriptor_ad306f25bb0a78e082f0c3baf85c4f44c}{set\_int}}(p->z, z)) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}}) \textcolor{keywordflow}{return} err;}
\DoxyCodeLine{55    \textcolor{keywordflow}{return} \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}};}
\DoxyCodeLine{56 \}}

\end{DoxyCode}


References C\+R\+Y\+P\+T\+\_\+\+OK, ltc\+\_\+mp, and ltc\+\_\+math\+\_\+descriptor\+::set\+\_\+int.



Referenced by ltc\+\_\+ecc\+\_\+map(), ltc\+\_\+ecc\+\_\+mulmod(), ltc\+\_\+ecc\+\_\+projective\+\_\+add\+\_\+point(), and ltc\+\_\+ecc\+\_\+projective\+\_\+dbl\+\_\+point().

Here is the caller graph for this function\+:
% FIG 52
\mbox{\Hypertarget{tomcrypt__private_8h_ac0dfaf009d9b0101291727341a20bb40}\label{tomcrypt__private_8h_ac0dfaf009d9b0101291727341a20bb40}} 
\index{tomcrypt\_private.h@{tomcrypt\_private.h}!ltc\_ecc\_verify\_key@{ltc\_ecc\_verify\_key}}
\index{ltc\_ecc\_verify\_key@{ltc\_ecc\_verify\_key}!tomcrypt\_private.h@{tomcrypt\_private.h}}
\subsubsection{\texorpdfstring{ltc\_ecc\_verify\_key()}{ltc\_ecc\_verify\_key()}}
{\footnotesize\ttfamily int ltc\+\_\+ecc\+\_\+verify\+\_\+key (\begin{DoxyParamCaption}\item[{const ecc\+\_\+key $\ast$}]{key }\end{DoxyParamCaption})}



Verify a key according to A\+N\+SI spec. 


\begin{DoxyParams}{Parameters}
{\em key} & The key to validate \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
C\+R\+Y\+P\+T\+\_\+\+OK if successful 
\end{DoxyReturn}


Definition at line 22 of file ltc\+\_\+ecc\+\_\+verify\+\_\+key.\+c.


\begin{DoxyCode}{0}
\DoxyCodeLine{23 \{}
\DoxyCodeLine{24    \textcolor{keywordtype}{int} err, inf;}
\DoxyCodeLine{25    \mbox{\hyperlink{tomcrypt__math_8h_a2a6efaeaa795aa54274d7c4fd66b018a}{ecc\_point}} *point;}
\DoxyCodeLine{26    \textcolor{keywordtype}{void} *prime = key->dp.prime;}
\DoxyCodeLine{27    \textcolor{keywordtype}{void} *order = key->dp.order;}
\DoxyCodeLine{28    \textcolor{keywordtype}{void} *a     = key->dp.A;}
\DoxyCodeLine{29 }
\DoxyCodeLine{30    \textcolor{comment}{/* Test 1: Are the x and y points of the public key in the field? */}}
\DoxyCodeLine{31    \textcolor{keywordflow}{if} (\mbox{\hyperlink{tomcrypt__math_8h_a3d38c44518c63b7a8abd0938f3d41c65}{ltc\_mp}}.\mbox{\hyperlink{structltc__math__descriptor_a5b3038e00644c477282802863619323b}{compare\_d}}(key->pubkey.z, 1) == \mbox{\hyperlink{tomcrypt__math_8h_a035a31bde4f31419eb259e36e5776607}{LTC\_MP\_EQ}}) \{}
\DoxyCodeLine{32       \textcolor{keywordflow}{if} ((\mbox{\hyperlink{tomcrypt__math_8h_a3d38c44518c63b7a8abd0938f3d41c65}{ltc\_mp}}.\mbox{\hyperlink{structltc__math__descriptor_afa00530838786ca9b52a21a2c00f0f57}{compare}}(key->pubkey.x, prime) != \mbox{\hyperlink{tomcrypt__math_8h_a42d0c7d4c09793df79660774d3436db2}{LTC\_MP\_LT}}) ||}
\DoxyCodeLine{33           (\mbox{\hyperlink{tomcrypt__math_8h_a3d38c44518c63b7a8abd0938f3d41c65}{ltc\_mp}}.\mbox{\hyperlink{structltc__math__descriptor_afa00530838786ca9b52a21a2c00f0f57}{compare}}(key->pubkey.y, prime) != \mbox{\hyperlink{tomcrypt__math_8h_a42d0c7d4c09793df79660774d3436db2}{LTC\_MP\_LT}}) ||}
\DoxyCodeLine{34           (\mbox{\hyperlink{tomcrypt__math_8h_a3d38c44518c63b7a8abd0938f3d41c65}{ltc\_mp}}.\mbox{\hyperlink{structltc__math__descriptor_a5b3038e00644c477282802863619323b}{compare\_d}}(key->pubkey.x, 0) == \mbox{\hyperlink{tomcrypt__math_8h_a42d0c7d4c09793df79660774d3436db2}{LTC\_MP\_LT}}) ||}
\DoxyCodeLine{35           (\mbox{\hyperlink{tomcrypt__math_8h_a3d38c44518c63b7a8abd0938f3d41c65}{ltc\_mp}}.\mbox{\hyperlink{structltc__math__descriptor_a5b3038e00644c477282802863619323b}{compare\_d}}(key->pubkey.y, 0) == \mbox{\hyperlink{tomcrypt__math_8h_a42d0c7d4c09793df79660774d3436db2}{LTC\_MP\_LT}}) ||}
\DoxyCodeLine{36           (\mbox{\hyperlink{tomcrypt__private_8h_a910040068490f9f6e5185c970ab869c9}{mp\_iszero}}(key->pubkey.x) \&\& \mbox{\hyperlink{tomcrypt__private_8h_a910040068490f9f6e5185c970ab869c9}{mp\_iszero}}(key->pubkey.y))}
\DoxyCodeLine{37          )}
\DoxyCodeLine{38       \{}
\DoxyCodeLine{39          err = \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06ca980088f10ffe9009aec286038a9e79da}{CRYPT\_INVALID\_PACKET}};}
\DoxyCodeLine{40          \textcolor{keywordflow}{goto} done2;}
\DoxyCodeLine{41       \}}
\DoxyCodeLine{42    \}}
\DoxyCodeLine{43 }
\DoxyCodeLine{44    \textcolor{comment}{/* Test 2: is the public key on the curve? */}}
\DoxyCodeLine{45    \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{tomcrypt__private_8h_affd37f56571ffc28d2c2687a76014b11}{ltc\_ecc\_is\_point}}(\&key->dp, key->pubkey.x, key->pubkey.y)) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}})      \{ \textcolor{keywordflow}{goto} done2; \}}
\DoxyCodeLine{46 }
\DoxyCodeLine{47    \textcolor{comment}{/* Test 3: does nG = O? (n = order, O = point at infinity, G = public key) */}}
\DoxyCodeLine{48    point = \mbox{\hyperlink{tomcrypt__private_8h_a532af6ef2d0f6d1d8cd79e5f81e87cf8}{ltc\_ecc\_new\_point}}();}
\DoxyCodeLine{49    \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{tomcrypt__private_8h_a818e5e4135d8aa58cf09e502e98ccc90}{ltc\_ecc\_mulmod}}(order, \&(key->pubkey), point, a, prime, 1)) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}})     \{ \textcolor{keywordflow}{goto} done1; \}}
\DoxyCodeLine{50 }
\DoxyCodeLine{51    err = \mbox{\hyperlink{tomcrypt__private_8h_a54a2d7d30af25ef341a8aca09269177d}{ltc\_ecc\_is\_point\_at\_infinity}}(point, prime, \&inf);}
\DoxyCodeLine{52    \textcolor{keywordflow}{if} (err != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}} || inf) \{}
\DoxyCodeLine{53       err = \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06ca03c22220d7538be04455cd2aa6ddf9da}{CRYPT\_ERROR}};}
\DoxyCodeLine{54    \}}
\DoxyCodeLine{55    \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{56       err = \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}};}
\DoxyCodeLine{57    \}}
\DoxyCodeLine{58 }
\DoxyCodeLine{59 done1:}
\DoxyCodeLine{60    \mbox{\hyperlink{tomcrypt__private_8h_a4cef83a7c070c94ff78d4df10a7b624f}{ltc\_ecc\_del\_point}}(point);}
\DoxyCodeLine{61 done2:}
\DoxyCodeLine{62    \textcolor{keywordflow}{return} err;}
\DoxyCodeLine{63 \}}

\end{DoxyCode}


References ltc\+\_\+math\+\_\+descriptor\+::compare, ltc\+\_\+math\+\_\+descriptor\+::compare\+\_\+d, C\+R\+Y\+P\+T\+\_\+\+E\+R\+R\+OR, C\+R\+Y\+P\+T\+\_\+\+I\+N\+V\+A\+L\+I\+D\+\_\+\+P\+A\+C\+K\+ET, C\+R\+Y\+P\+T\+\_\+\+OK, ltc\+\_\+ecc\+\_\+del\+\_\+point(), ltc\+\_\+ecc\+\_\+is\+\_\+point(), ltc\+\_\+ecc\+\_\+is\+\_\+point\+\_\+at\+\_\+infinity(), ltc\+\_\+ecc\+\_\+mulmod(), ltc\+\_\+ecc\+\_\+new\+\_\+point(), ltc\+\_\+mp, L\+T\+C\+\_\+\+M\+P\+\_\+\+EQ, L\+T\+C\+\_\+\+M\+P\+\_\+\+LT, and mp\+\_\+iszero.



Referenced by ecc\+\_\+import\+\_\+ex(), ecc\+\_\+recover\+\_\+key(), and ecc\+\_\+set\+\_\+key().

Here is the call graph for this function\+:
% FIG 53
Here is the caller graph for this function\+:
% FIG 54
\mbox{\Hypertarget{tomcrypt__private_8h_ac4af92f890be670e795a758ec452b402}\label{tomcrypt__private_8h_ac4af92f890be670e795a758ec452b402}} 
\index{tomcrypt\_private.h@{tomcrypt\_private.h}!ocb3\_int\_ntz@{ocb3\_int\_ntz}}
\index{ocb3\_int\_ntz@{ocb3\_int\_ntz}!tomcrypt\_private.h@{tomcrypt\_private.h}}
\subsubsection{\texorpdfstring{ocb3\_int\_ntz()}{ocb3\_int\_ntz()}}
{\footnotesize\ttfamily int ocb3\+\_\+int\+\_\+ntz (\begin{DoxyParamCaption}\item[{unsigned long}]{x }\end{DoxyParamCaption})}



Returns the number of leading zero bits \mbox{[}from lsb up\mbox{]} (internal function) 


\begin{DoxyParams}{Parameters}
{\em x} & The 32-\/bit value to observe \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
The number of bits \mbox{[}from the lsb up\mbox{]} that are zero 
\end{DoxyReturn}


Definition at line 23 of file ocb3\+\_\+int\+\_\+ntz.\+c.


\begin{DoxyCode}{0}
\DoxyCodeLine{24 \{}
\DoxyCodeLine{25    \textcolor{keywordtype}{int} \mbox{\hyperlink{khazad_8c_a86ea50de5a3e0ae87762f4298d35284c}{c}};}
\DoxyCodeLine{26    x \&= 0xFFFFFFFFUL;}
\DoxyCodeLine{27    \mbox{\hyperlink{khazad_8c_a86ea50de5a3e0ae87762f4298d35284c}{c}} = 0;}
\DoxyCodeLine{28    \textcolor{keywordflow}{while} ((x \& 1) == 0) \{}
\DoxyCodeLine{29       ++\mbox{\hyperlink{khazad_8c_a86ea50de5a3e0ae87762f4298d35284c}{c}};}
\DoxyCodeLine{30       x >>= 1;}
\DoxyCodeLine{31    \}}
\DoxyCodeLine{32    \textcolor{keywordflow}{return} \mbox{\hyperlink{khazad_8c_a86ea50de5a3e0ae87762f4298d35284c}{c}};}
\DoxyCodeLine{33 \}}

\end{DoxyCode}


References c.



Referenced by \+\_\+ocb3\+\_\+int\+\_\+aad\+\_\+add\+\_\+block(), ocb3\+\_\+decrypt(), and ocb3\+\_\+encrypt().

Here is the caller graph for this function\+:
% FIG 55
\mbox{\Hypertarget{tomcrypt__private_8h_a5bf6caa4615657cdfd8f8941620a987c}\label{tomcrypt__private_8h_a5bf6caa4615657cdfd8f8941620a987c}} 
\index{tomcrypt\_private.h@{tomcrypt\_private.h}!ocb3\_int\_xor\_blocks@{ocb3\_int\_xor\_blocks}}
\index{ocb3\_int\_xor\_blocks@{ocb3\_int\_xor\_blocks}!tomcrypt\_private.h@{tomcrypt\_private.h}}
\subsubsection{\texorpdfstring{ocb3\_int\_xor\_blocks()}{ocb3\_int\_xor\_blocks()}}
{\footnotesize\ttfamily void ocb3\+\_\+int\+\_\+xor\+\_\+blocks (\begin{DoxyParamCaption}\item[{unsigned char $\ast$}]{out,  }\item[{const unsigned char $\ast$}]{block\+\_\+a,  }\item[{const unsigned char $\ast$}]{block\+\_\+b,  }\item[{unsigned long}]{block\+\_\+len }\end{DoxyParamCaption})}



Compute xor for two blocks of bytes \textquotesingle{}out = block\+\_\+a X\+OR block\+\_\+b\textquotesingle{} (internal function) 


\begin{DoxyParams}{Parameters}
{\em out} & The block of bytes (output) \\
\hline
{\em block\+\_\+a} & The block of bytes (input) \\
\hline
{\em block\+\_\+b} & The block of bytes (input) \\
\hline
{\em block\+\_\+len} & The size of block\+\_\+a, block\+\_\+b, out \\
\hline
\end{DoxyParams}


Definition at line 25 of file ocb3\+\_\+int\+\_\+xor\+\_\+blocks.\+c.


\begin{DoxyCode}{0}
\DoxyCodeLine{26 \{}
\DoxyCodeLine{27    \textcolor{keywordtype}{int} x;}
\DoxyCodeLine{28    \textcolor{keywordflow}{if} (out == block\_a) \{}
\DoxyCodeLine{29      \textcolor{keywordflow}{for} (x = 0; x < (int)block\_len; x++) out[x] \string^= block\_b[x];}
\DoxyCodeLine{30    \}}
\DoxyCodeLine{31    \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{32      \textcolor{keywordflow}{for} (x = 0; x < (int)block\_len; x++) out[x] = block\_a[x] \string^ block\_b[x];}
\DoxyCodeLine{33    \}}
\DoxyCodeLine{34 \}}

\end{DoxyCode}


Referenced by \+\_\+ocb3\+\_\+int\+\_\+aad\+\_\+add\+\_\+block(), ocb3\+\_\+decrypt(), ocb3\+\_\+decrypt\+\_\+last(), ocb3\+\_\+done(), ocb3\+\_\+encrypt(), ocb3\+\_\+encrypt\+\_\+last(), and ocb3\+\_\+init().

Here is the caller graph for this function\+:
% FIG 56
\mbox{\Hypertarget{tomcrypt__private_8h_a3573423ba7eb454bb5f969ee9b580024}\label{tomcrypt__private_8h_a3573423ba7eb454bb5f969ee9b580024}} 
\index{tomcrypt\_private.h@{tomcrypt\_private.h}!pbes1\_extract@{pbes1\_extract}}
\index{pbes1\_extract@{pbes1\_extract}!tomcrypt\_private.h@{tomcrypt\_private.h}}
\subsubsection{\texorpdfstring{pbes1\_extract()}{pbes1\_extract()}}
{\footnotesize\ttfamily int pbes1\+\_\+extract (\begin{DoxyParamCaption}\item[{const ltc\+\_\+asn1\+\_\+list $\ast$}]{s,  }\item[{\mbox{\hyperlink{structpbes__arg}{pbes\+\_\+arg}} $\ast$}]{res }\end{DoxyParamCaption})}



Extract P\+B\+E\+S1 parameters. 


\begin{DoxyParams}{Parameters}
{\em s} & The start of the sequence with potential P\+B\+E\+S1 parameters \\
\hline
{\em res} & Pointer to where the extracted parameters should be stored \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
C\+R\+Y\+P\+T\+\_\+\+OK on success 
\end{DoxyReturn}


Definition at line 94 of file pbes1.\+c.


\begin{DoxyCode}{0}
\DoxyCodeLine{95 \{}
\DoxyCodeLine{96    \textcolor{keywordtype}{int} err;}
\DoxyCodeLine{97 }
\DoxyCodeLine{98    \mbox{\hyperlink{tomcrypt__argchk_8h_a683da3e041e49f196318b6ea951414ba}{LTC\_ARGCHK}}(s   != NULL);}
\DoxyCodeLine{99    \mbox{\hyperlink{tomcrypt__argchk_8h_a683da3e041e49f196318b6ea951414ba}{LTC\_ARGCHK}}(res != NULL);}
\DoxyCodeLine{100 }
\DoxyCodeLine{101    \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{pbes1_8c_ae603bc6c7e6913beec5714350041adc6}{\_pbes1\_from\_oid}}(s, \&res->\mbox{\hyperlink{structpbes__arg_a6879b93a34abc3b85c42fea0b0e92156}{type}})) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}}) \textcolor{keywordflow}{return} err;}
\DoxyCodeLine{102 }
\DoxyCodeLine{103    \textcolor{keywordflow}{if} (!\mbox{\hyperlink{tomcrypt__private_8h_a896c8b07a35ff2799061855f08a8325a}{LTC\_ASN1\_IS\_TYPE}}(s->next, LTC\_ASN1\_SEQUENCE) ||}
\DoxyCodeLine{104        !\mbox{\hyperlink{tomcrypt__private_8h_a896c8b07a35ff2799061855f08a8325a}{LTC\_ASN1\_IS\_TYPE}}(s->next->child, LTC\_ASN1\_OCTET\_STRING) ||}
\DoxyCodeLine{105        !\mbox{\hyperlink{tomcrypt__private_8h_a896c8b07a35ff2799061855f08a8325a}{LTC\_ASN1\_IS\_TYPE}}(s->next->child->next, LTC\_ASN1\_INTEGER)) \{}
\DoxyCodeLine{106       \textcolor{keywordflow}{return} \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06ca980088f10ffe9009aec286038a9e79da}{CRYPT\_INVALID\_PACKET}};}
\DoxyCodeLine{107    \}}
\DoxyCodeLine{108    \textcolor{comment}{/* PBES1: encrypted pkcs8 - pbeWithMD5AndDES-CBC:}}
\DoxyCodeLine{109 \textcolor{comment}{    *  0:d=0  hl=4 l= 329 cons: SEQUENCE}}
\DoxyCodeLine{110 \textcolor{comment}{    *  4:d=1  hl=2 l=  27 cons:   SEQUENCE}}
\DoxyCodeLine{111 \textcolor{comment}{    *  6:d=2  hl=2 l=   9 prim:     OBJECT             :pbeWithMD5AndDES-CBC (== 1.2.840.113549.1.5.3) (== *s)}}
\DoxyCodeLine{112 \textcolor{comment}{    * 17:d=2  hl=2 l=  14 cons:     SEQUENCE           (== *lalgparam)}}
\DoxyCodeLine{113 \textcolor{comment}{    * 19:d=3  hl=2 l=   8 prim:       OCTET STRING     [HEX DUMP]:8EDF749A06CCDE51 (== salt)}}
\DoxyCodeLine{114 \textcolor{comment}{    * 29:d=3  hl=2 l=   2 prim:       INTEGER          :0800  (== iterations)}}
\DoxyCodeLine{115 \textcolor{comment}{    * 33:d=1  hl=4 l= 296 prim:   OCTET STRING         :bytes (== encrypted data)}}
\DoxyCodeLine{116 \textcolor{comment}{    */}}
\DoxyCodeLine{117    res->\mbox{\hyperlink{structpbes__arg_a356304efb7c4b45d06779905fd254797}{salt}} = s->next->child;}
\DoxyCodeLine{118    res->\mbox{\hyperlink{structpbes__arg_a78b52a8d8572e6947ebe909b51490ec6}{iterations}} = \mbox{\hyperlink{tomcrypt__private_8h_a4e68c807adc159c7553da37ce38196b2}{mp\_get\_int}}(s->next->child->next->data);}
\DoxyCodeLine{119 }
\DoxyCodeLine{120    \textcolor{keywordflow}{return} \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}};}
\DoxyCodeLine{121 \}}

\end{DoxyCode}


References \+\_\+pbes1\+\_\+from\+\_\+oid(), C\+R\+Y\+P\+T\+\_\+\+I\+N\+V\+A\+L\+I\+D\+\_\+\+P\+A\+C\+K\+ET, C\+R\+Y\+P\+T\+\_\+\+OK, pbes\+\_\+arg\+::iterations, L\+T\+C\+\_\+\+A\+R\+G\+C\+HK, L\+T\+C\+\_\+\+A\+S\+N1\+\_\+\+I\+S\+\_\+\+T\+Y\+PE, mp\+\_\+get\+\_\+int, pbes\+\_\+arg\+::salt, and pbes\+\_\+arg\+::type.



Referenced by pkcs8\+\_\+decode\+\_\+flexi().

Here is the call graph for this function\+:
% FIG 57
Here is the caller graph for this function\+:
% FIG 58
\mbox{\Hypertarget{tomcrypt__private_8h_a741f04fef81b90c03eeba79d1d680273}\label{tomcrypt__private_8h_a741f04fef81b90c03eeba79d1d680273}} 
\index{tomcrypt\_private.h@{tomcrypt\_private.h}!pbes2\_extract@{pbes2\_extract}}
\index{pbes2\_extract@{pbes2\_extract}!tomcrypt\_private.h@{tomcrypt\_private.h}}
\subsubsection{\texorpdfstring{pbes2\_extract()}{pbes2\_extract()}}
{\footnotesize\ttfamily int pbes2\+\_\+extract (\begin{DoxyParamCaption}\item[{const ltc\+\_\+asn1\+\_\+list $\ast$}]{s,  }\item[{\mbox{\hyperlink{structpbes__arg}{pbes\+\_\+arg}} $\ast$}]{res }\end{DoxyParamCaption})}



Extract P\+B\+E\+S2 parameters. 


\begin{DoxyParams}{Parameters}
{\em s} & The start of the sequence with potential P\+B\+E\+S2 parameters \\
\hline
{\em res} & Pointer to where the extracted parameters should be stored \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
C\+R\+Y\+P\+T\+\_\+\+OK on success 
\end{DoxyReturn}


Definition at line 84 of file pbes2.\+c.


\begin{DoxyCode}{0}
\DoxyCodeLine{85 \{}
\DoxyCodeLine{86    \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} klen;}
\DoxyCodeLine{87    ltc\_asn1\_list *lkdf, *lenc, *loptseq, *liter, *lhmac;}
\DoxyCodeLine{88    \textcolor{keywordtype}{int} err;}
\DoxyCodeLine{89 }
\DoxyCodeLine{90    \mbox{\hyperlink{tomcrypt__argchk_8h_a683da3e041e49f196318b6ea951414ba}{LTC\_ARGCHK}}(s   != NULL);}
\DoxyCodeLine{91    \mbox{\hyperlink{tomcrypt__argchk_8h_a683da3e041e49f196318b6ea951414ba}{LTC\_ARGCHK}}(res != NULL);}
\DoxyCodeLine{92 }
\DoxyCodeLine{93    \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{tomcrypt__private_8h_aaa860b1fbc776e0760df8934a6aa245a}{pk\_oid\_cmp\_with\_asn1}}(\mbox{\hyperlink{pbes2_8c_a44eda0598ba3b6bfd85a19991094dff9}{\_oid\_pbes2}}, s)) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}}) \textcolor{keywordflow}{return} err;}
\DoxyCodeLine{94 }
\DoxyCodeLine{95    \textcolor{keywordflow}{if} (!\mbox{\hyperlink{tomcrypt__private_8h_a896c8b07a35ff2799061855f08a8325a}{LTC\_ASN1\_IS\_TYPE}}(s->next, LTC\_ASN1\_SEQUENCE) ||}
\DoxyCodeLine{96        !\mbox{\hyperlink{tomcrypt__private_8h_a896c8b07a35ff2799061855f08a8325a}{LTC\_ASN1\_IS\_TYPE}}(s->next->child, LTC\_ASN1\_SEQUENCE) ||}
\DoxyCodeLine{97        !\mbox{\hyperlink{tomcrypt__private_8h_a896c8b07a35ff2799061855f08a8325a}{LTC\_ASN1\_IS\_TYPE}}(s->next->child->child, LTC\_ASN1\_OBJECT\_IDENTIFIER) ||}
\DoxyCodeLine{98        !\mbox{\hyperlink{tomcrypt__private_8h_a896c8b07a35ff2799061855f08a8325a}{LTC\_ASN1\_IS\_TYPE}}(s->next->child->child->next, LTC\_ASN1\_SEQUENCE) ||}
\DoxyCodeLine{99        !\mbox{\hyperlink{tomcrypt__private_8h_a896c8b07a35ff2799061855f08a8325a}{LTC\_ASN1\_IS\_TYPE}}(s->next->child->next, LTC\_ASN1\_SEQUENCE) ||}
\DoxyCodeLine{100        !\mbox{\hyperlink{tomcrypt__private_8h_a896c8b07a35ff2799061855f08a8325a}{LTC\_ASN1\_IS\_TYPE}}(s->next->child->next->child, LTC\_ASN1\_OBJECT\_IDENTIFIER)) \{}
\DoxyCodeLine{101       \textcolor{keywordflow}{return} \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06ca980088f10ffe9009aec286038a9e79da}{CRYPT\_INVALID\_PACKET}};}
\DoxyCodeLine{102    \}}
\DoxyCodeLine{103    \textcolor{comment}{/* PBES2: encrypted pkcs8 - PBES2+PBKDF2+des-ede3-cbc:}}
\DoxyCodeLine{104 \textcolor{comment}{    *  0:d=0  hl=4 l= 380 cons: SEQUENCE}}
\DoxyCodeLine{105 \textcolor{comment}{    *  4:d=1  hl=2 l=  78 cons:   SEQUENCE}}
\DoxyCodeLine{106 \textcolor{comment}{    *  6:d=2  hl=2 l=   9 prim:     OBJECT             :PBES2 (== 1.2.840.113549.1.5.13) (== *s)}}
\DoxyCodeLine{107 \textcolor{comment}{    * 17:d=2  hl=2 l=  65 cons:     SEQUENCE}}
\DoxyCodeLine{108 \textcolor{comment}{    * 19:d=3  hl=2 l=  41 cons:       SEQUENCE}}
\DoxyCodeLine{109 \textcolor{comment}{    * 21:d=4  hl=2 l=   9 prim:         OBJECT         :PBKDF2 (== *lkdf)}}
\DoxyCodeLine{110 \textcolor{comment}{    * 32:d=4  hl=2 l=  28 cons:         SEQUENCE}}
\DoxyCodeLine{111 \textcolor{comment}{    * 34:d=5  hl=2 l=   8 prim:           OCTET STRING [HEX DUMP]:28BA4ABF6AA76A3D (== res->salt)}}
\DoxyCodeLine{112 \textcolor{comment}{    * 44:d=5  hl=2 l=   2 prim:           INTEGER      :0800 (== res->iterations, *liter)}}
\DoxyCodeLine{113 \textcolor{comment}{    * 48:d=5  hl=2 l=  12 cons:           SEQUENCE     (== *loptseq   - this sequence is optional, may be missing)}}
\DoxyCodeLine{114 \textcolor{comment}{    * 50:d=6  hl=2 l=   8 prim:             OBJECT     :hmacWithSHA256 (== *lhmac)}}
\DoxyCodeLine{115 \textcolor{comment}{    * 60:d=6  hl=2 l=   0 prim:             NULL}}
\DoxyCodeLine{116 \textcolor{comment}{    * 62:d=3  hl=2 l=  20 cons:       SEQUENCE}}
\DoxyCodeLine{117 \textcolor{comment}{    * 64:d=4  hl=2 l=   8 prim:         OBJECT         :des-ede3-cbc (== *lenc)}}
\DoxyCodeLine{118 \textcolor{comment}{    * 74:d=4  hl=2 l=   8 prim:         OCTET STRING   [HEX DUMP]:B1404C4688DC9A5A}}
\DoxyCodeLine{119 \textcolor{comment}{    * 84:d=1  hl=4 l= 296 prim:   OCTET STRING         :bytes (== encrypted data)}}
\DoxyCodeLine{120 \textcolor{comment}{    */}}
\DoxyCodeLine{121    lkdf = s->next->child->child;}
\DoxyCodeLine{122    lenc = s->next->child->next->child;}
\DoxyCodeLine{123 }
\DoxyCodeLine{124    \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{tomcrypt__private_8h_aaa860b1fbc776e0760df8934a6aa245a}{pk\_oid\_cmp\_with\_asn1}}(\mbox{\hyperlink{pbes2_8c_a5c2b966969310bd02cc0337f5120afec}{\_oid\_pbkdf2}}, lkdf)) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}}) \textcolor{keywordflow}{return} err;}
\DoxyCodeLine{125 }
\DoxyCodeLine{126    \textcolor{keywordflow}{if} (!\mbox{\hyperlink{tomcrypt__private_8h_a896c8b07a35ff2799061855f08a8325a}{LTC\_ASN1\_IS\_TYPE}}(lkdf->next, LTC\_ASN1\_SEQUENCE) ||}
\DoxyCodeLine{127        !\mbox{\hyperlink{tomcrypt__private_8h_a896c8b07a35ff2799061855f08a8325a}{LTC\_ASN1\_IS\_TYPE}}(lkdf->next->child, LTC\_ASN1\_OCTET\_STRING) ||}
\DoxyCodeLine{128        !\mbox{\hyperlink{tomcrypt__private_8h_a896c8b07a35ff2799061855f08a8325a}{LTC\_ASN1\_IS\_TYPE}}(lkdf->next->child->next, LTC\_ASN1\_INTEGER)) \{}
\DoxyCodeLine{129       \textcolor{keywordflow}{return} \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06ca980088f10ffe9009aec286038a9e79da}{CRYPT\_INVALID\_PACKET}};}
\DoxyCodeLine{130    \}}
\DoxyCodeLine{131 }
\DoxyCodeLine{132    liter = lkdf->next->child->next;}
\DoxyCodeLine{133    loptseq = liter->next;}
\DoxyCodeLine{134    res->\mbox{\hyperlink{structpbes__arg_a356304efb7c4b45d06779905fd254797}{salt}} = lkdf->next->child;}
\DoxyCodeLine{135    res->\mbox{\hyperlink{structpbes__arg_a78b52a8d8572e6947ebe909b51490ec6}{iterations}} = \mbox{\hyperlink{tomcrypt__private_8h_a4e68c807adc159c7553da37ce38196b2}{mp\_get\_int}}(liter->data);}
\DoxyCodeLine{136 }
\DoxyCodeLine{137    \textcolor{comment}{/* There's an optional INTEGER keyLength after the iterations, skip that if it's there.}}
\DoxyCodeLine{138 \textcolor{comment}{    * c.f. RFC 2898 A.2 PBKDF2 */}}
\DoxyCodeLine{139    \textcolor{keywordflow}{if}(\mbox{\hyperlink{tomcrypt__private_8h_a896c8b07a35ff2799061855f08a8325a}{LTC\_ASN1\_IS\_TYPE}}(loptseq, LTC\_ASN1\_INTEGER)) \{}
\DoxyCodeLine{140       loptseq = loptseq->next;}
\DoxyCodeLine{141    \}}
\DoxyCodeLine{142 }
\DoxyCodeLine{143    \textcolor{comment}{/* this sequence is optional */}}
\DoxyCodeLine{144    lhmac = NULL;}
\DoxyCodeLine{145    \textcolor{keywordflow}{if} (\mbox{\hyperlink{tomcrypt__private_8h_a896c8b07a35ff2799061855f08a8325a}{LTC\_ASN1\_IS\_TYPE}}(loptseq, LTC\_ASN1\_SEQUENCE) \&\&}
\DoxyCodeLine{146        \mbox{\hyperlink{tomcrypt__private_8h_a896c8b07a35ff2799061855f08a8325a}{LTC\_ASN1\_IS\_TYPE}}(loptseq->child, LTC\_ASN1\_OBJECT\_IDENTIFIER)) \{}
\DoxyCodeLine{147       lhmac = loptseq->child;}
\DoxyCodeLine{148    \}}
\DoxyCodeLine{149    \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{pbes2_8c_a6d172113e8d3bf8ef62690a35a2bbf52}{\_pbes2\_from\_oid}}(lenc, lhmac, \&res->\mbox{\hyperlink{structpbes__arg_a6879b93a34abc3b85c42fea0b0e92156}{type}})) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}}) \textcolor{keywordflow}{return} err;}
\DoxyCodeLine{150 }
\DoxyCodeLine{151    \textcolor{keywordflow}{if} (\mbox{\hyperlink{tomcrypt__private_8h_a896c8b07a35ff2799061855f08a8325a}{LTC\_ASN1\_IS\_TYPE}}(lenc->next, LTC\_ASN1\_OCTET\_STRING)) \{}
\DoxyCodeLine{152       \textcolor{comment}{/* 'NON-RC2'-CBC */}}
\DoxyCodeLine{153       res->\mbox{\hyperlink{structpbes__arg_aeecdb7fb21b9beacfa5adf1f715eb9fd}{iv}} = lenc->next;}
\DoxyCodeLine{154    \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (\mbox{\hyperlink{tomcrypt__private_8h_a896c8b07a35ff2799061855f08a8325a}{LTC\_ASN1\_IS\_TYPE}}(lenc->next, LTC\_ASN1\_SEQUENCE)) \{}
\DoxyCodeLine{155       \textcolor{comment}{/* RC2-CBC is a bit special ...}}
\DoxyCodeLine{156 \textcolor{comment}{       *}}
\DoxyCodeLine{157 \textcolor{comment}{       * RC2-CBC-Parameter ::= SEQUENCE \{}}
\DoxyCodeLine{158 \textcolor{comment}{       *     rc2ParameterVersion INTEGER OPTIONAL,}}
\DoxyCodeLine{159 \textcolor{comment}{       *     iv OCTET STRING (SIZE(8)) \}}}
\DoxyCodeLine{160 \textcolor{comment}{       */}}
\DoxyCodeLine{161       \textcolor{keywordflow}{if} (\mbox{\hyperlink{tomcrypt__private_8h_a896c8b07a35ff2799061855f08a8325a}{LTC\_ASN1\_IS\_TYPE}}(lenc->next->child, LTC\_ASN1\_INTEGER) \&\&}
\DoxyCodeLine{162           \mbox{\hyperlink{tomcrypt__private_8h_a896c8b07a35ff2799061855f08a8325a}{LTC\_ASN1\_IS\_TYPE}}(lenc->next->child->next, LTC\_ASN1\_OCTET\_STRING)) \{}
\DoxyCodeLine{163          klen = \mbox{\hyperlink{tomcrypt__private_8h_a4e68c807adc159c7553da37ce38196b2}{mp\_get\_int}}(lenc->next->child->data);}
\DoxyCodeLine{164          res->\mbox{\hyperlink{structpbes__arg_aeecdb7fb21b9beacfa5adf1f715eb9fd}{iv}}   = lenc->next->child->next;}
\DoxyCodeLine{165          \textcolor{comment}{/*}}
\DoxyCodeLine{166 \textcolor{comment}{          * Effective Key Bits         Encoding}}
\DoxyCodeLine{167 \textcolor{comment}{          *         40                    160}}
\DoxyCodeLine{168 \textcolor{comment}{          *         64                    120}}
\DoxyCodeLine{169 \textcolor{comment}{          *        128                     58}}
\DoxyCodeLine{170 \textcolor{comment}{          *       b >= 256                  b}}
\DoxyCodeLine{171 \textcolor{comment}{          */}}
\DoxyCodeLine{172          \textcolor{keywordflow}{switch} (klen) \{}
\DoxyCodeLine{173             \textcolor{keywordflow}{case} 160:}
\DoxyCodeLine{174                res->\mbox{\hyperlink{structpbes__arg_ac59e419107215d6c89e2d9789a0c49f4}{key\_bits}} = 40;}
\DoxyCodeLine{175                \textcolor{keywordflow}{break};}
\DoxyCodeLine{176             \textcolor{keywordflow}{case} 120:}
\DoxyCodeLine{177                res->\mbox{\hyperlink{structpbes__arg_ac59e419107215d6c89e2d9789a0c49f4}{key\_bits}} = 64;}
\DoxyCodeLine{178                \textcolor{keywordflow}{break};}
\DoxyCodeLine{179             \textcolor{keywordflow}{case} 58:}
\DoxyCodeLine{180                res->\mbox{\hyperlink{structpbes__arg_ac59e419107215d6c89e2d9789a0c49f4}{key\_bits}} = 128;}
\DoxyCodeLine{181                \textcolor{keywordflow}{break};}
\DoxyCodeLine{182             \textcolor{keywordflow}{default}:}
\DoxyCodeLine{183                \textcolor{comment}{/* We don't handle undefined Key Bits */}}
\DoxyCodeLine{184                \textcolor{keywordflow}{if} (klen < 256) \textcolor{keywordflow}{return} \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06caafed43f3b625e72191e08e65b4bb5e02}{CRYPT\_INVALID\_KEYSIZE}};}
\DoxyCodeLine{185 }
\DoxyCodeLine{186                res->\mbox{\hyperlink{structpbes__arg_ac59e419107215d6c89e2d9789a0c49f4}{key\_bits}} = klen;}
\DoxyCodeLine{187                \textcolor{keywordflow}{break};}
\DoxyCodeLine{188          \}}
\DoxyCodeLine{189       \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (\mbox{\hyperlink{tomcrypt__private_8h_a896c8b07a35ff2799061855f08a8325a}{LTC\_ASN1\_IS\_TYPE}}(lenc->next->child, LTC\_ASN1\_OCTET\_STRING)) \{}
\DoxyCodeLine{190          res->\mbox{\hyperlink{structpbes__arg_aeecdb7fb21b9beacfa5adf1f715eb9fd}{iv}}   = lenc->next->child;}
\DoxyCodeLine{191          \textcolor{comment}{/*}}
\DoxyCodeLine{192 \textcolor{comment}{          * If the rc2ParameterVersion field is omitted, the "effective key bits"}}
\DoxyCodeLine{193 \textcolor{comment}{          * defaults to 32.}}
\DoxyCodeLine{194 \textcolor{comment}{          */}}
\DoxyCodeLine{195          res->\mbox{\hyperlink{structpbes__arg_ac59e419107215d6c89e2d9789a0c49f4}{key\_bits}} = 32;}
\DoxyCodeLine{196       \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{197          \textcolor{keywordflow}{return} \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06ca980088f10ffe9009aec286038a9e79da}{CRYPT\_INVALID\_PACKET}};}
\DoxyCodeLine{198       \}}
\DoxyCodeLine{199    \}}
\DoxyCodeLine{200 }
\DoxyCodeLine{201    \textcolor{keywordflow}{return} \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}};}
\DoxyCodeLine{202 \}}

\end{DoxyCode}


References \+\_\+oid\+\_\+pbes2, \+\_\+oid\+\_\+pbkdf2, \+\_\+pbes2\+\_\+from\+\_\+oid(), C\+R\+Y\+P\+T\+\_\+\+I\+N\+V\+A\+L\+I\+D\+\_\+\+K\+E\+Y\+S\+I\+ZE, C\+R\+Y\+P\+T\+\_\+\+I\+N\+V\+A\+L\+I\+D\+\_\+\+P\+A\+C\+K\+ET, C\+R\+Y\+P\+T\+\_\+\+OK, pbes\+\_\+arg\+::iterations, pbes\+\_\+arg\+::iv, pbes\+\_\+arg\+::key\+\_\+bits, L\+T\+C\+\_\+\+A\+R\+G\+C\+HK, L\+T\+C\+\_\+\+A\+S\+N1\+\_\+\+I\+S\+\_\+\+T\+Y\+PE, mp\+\_\+get\+\_\+int, pk\+\_\+oid\+\_\+cmp\+\_\+with\+\_\+asn1(), pbes\+\_\+arg\+::salt, and pbes\+\_\+arg\+::type.



Referenced by pkcs8\+\_\+decode\+\_\+flexi().

Here is the call graph for this function\+:
% FIG 59
Here is the caller graph for this function\+:
% FIG 60
\mbox{\Hypertarget{tomcrypt__private_8h_a7df0f8ba7d5d6b9752a7bb9c5e3f7081}\label{tomcrypt__private_8h_a7df0f8ba7d5d6b9752a7bb9c5e3f7081}} 
\index{tomcrypt\_private.h@{tomcrypt\_private.h}!pbes\_decrypt@{pbes\_decrypt}}
\index{pbes\_decrypt@{pbes\_decrypt}!tomcrypt\_private.h@{tomcrypt\_private.h}}
\subsubsection{\texorpdfstring{pbes\_decrypt()}{pbes\_decrypt()}}
{\footnotesize\ttfamily int pbes\+\_\+decrypt (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{structpbes__arg}{pbes\+\_\+arg}} $\ast$}]{arg,  }\item[{unsigned char $\ast$}]{dec\+\_\+data,  }\item[{unsigned long $\ast$}]{dec\+\_\+size }\end{DoxyParamCaption})}



Decrypt Data encrypted via either P\+B\+E\+S1 or P\+B\+E\+S2. 


\begin{DoxyParams}{Parameters}
{\em arg} & The according P\+B\+ES parameters \\
\hline
{\em dec\+\_\+data} & \mbox{[}out\mbox{]} The decrypted data \\
\hline
{\em dec\+\_\+size} & \mbox{[}in/out\mbox{]} The length of the encrypted resp. decrypted data \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
C\+R\+Y\+P\+T\+\_\+\+OK on success 
\end{DoxyReturn}


Definition at line 21 of file pbes.\+c.


\begin{DoxyCode}{0}
\DoxyCodeLine{22 \{}
\DoxyCodeLine{23    \textcolor{keywordtype}{int} err, hid, cid;}
\DoxyCodeLine{24    \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char} k[32], *iv;}
\DoxyCodeLine{25    \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} klen, keylen, dlen;}
\DoxyCodeLine{26    \textcolor{keywordtype}{long} diff;}
\DoxyCodeLine{27    symmetric\_CBC cbc;}
\DoxyCodeLine{28 }
\DoxyCodeLine{29    \mbox{\hyperlink{tomcrypt__argchk_8h_a683da3e041e49f196318b6ea951414ba}{LTC\_ARGCHK}}(arg           != NULL);}
\DoxyCodeLine{30    \mbox{\hyperlink{tomcrypt__argchk_8h_a683da3e041e49f196318b6ea951414ba}{LTC\_ARGCHK}}(arg->\mbox{\hyperlink{structpbes__arg_a6879b93a34abc3b85c42fea0b0e92156}{type}}.\mbox{\hyperlink{structpbes__properties_a6edc1f4ee556a89b6812d0be927b1547}{kdf}} != NULL);}
\DoxyCodeLine{31    \mbox{\hyperlink{tomcrypt__argchk_8h_a683da3e041e49f196318b6ea951414ba}{LTC\_ARGCHK}}(dec\_data      != NULL);}
\DoxyCodeLine{32    \mbox{\hyperlink{tomcrypt__argchk_8h_a683da3e041e49f196318b6ea951414ba}{LTC\_ARGCHK}}(dec\_size      != NULL);}
\DoxyCodeLine{33 }
\DoxyCodeLine{34    hid = \mbox{\hyperlink{tomcrypt__hash_8h_a1818254b9c8f09047af3b66ea7f5852b}{find\_hash}}(arg->\mbox{\hyperlink{structpbes__arg_a6879b93a34abc3b85c42fea0b0e92156}{type}}.\mbox{\hyperlink{structpbes__properties_ae2a9b6e73cee94acd3d082641c2b6ea8}{h}});}
\DoxyCodeLine{35    \textcolor{keywordflow}{if} (hid == -1) \textcolor{keywordflow}{return} \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cae729ddc4864ea7e12e9865bf6264642d}{CRYPT\_INVALID\_HASH}};}
\DoxyCodeLine{36    cid = \mbox{\hyperlink{tomcrypt__cipher_8h_af5c3882342fd65a17239cd04bfdf44e2}{find\_cipher}}(arg->\mbox{\hyperlink{structpbes__arg_a6879b93a34abc3b85c42fea0b0e92156}{type}}.\mbox{\hyperlink{structpbes__properties_a821664389b9d7c6de99aeb7593beb48c}{c}});}
\DoxyCodeLine{37    \textcolor{keywordflow}{if} (cid == -1) \textcolor{keywordflow}{return} \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06ca302b958f5664adeb427c22f57c9d90a4}{CRYPT\_INVALID\_CIPHER}};}
\DoxyCodeLine{38 }
\DoxyCodeLine{39    klen = arg->\mbox{\hyperlink{structpbes__arg_a6879b93a34abc3b85c42fea0b0e92156}{type}}.\mbox{\hyperlink{structpbes__properties_ad29dce0a2ea0da6e3007fbf220383ae4}{keylen}};}
\DoxyCodeLine{40 }
\DoxyCodeLine{41    \textcolor{comment}{/* RC2 special case */}}
\DoxyCodeLine{42    \textcolor{keywordflow}{if} (arg->\mbox{\hyperlink{structpbes__arg_ac59e419107215d6c89e2d9789a0c49f4}{key\_bits}} != 0) \{}
\DoxyCodeLine{43       \textcolor{comment}{/* We can't handle odd lengths of Key Bits */}}
\DoxyCodeLine{44       \textcolor{keywordflow}{if} ((arg->\mbox{\hyperlink{structpbes__arg_ac59e419107215d6c89e2d9789a0c49f4}{key\_bits}} \% 8) != 0) \textcolor{keywordflow}{return} \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06caafed43f3b625e72191e08e65b4bb5e02}{CRYPT\_INVALID\_KEYSIZE}};}
\DoxyCodeLine{45       \textcolor{comment}{/* Internally we use bytes, not bits */}}
\DoxyCodeLine{46       klen = arg->\mbox{\hyperlink{structpbes__arg_ac59e419107215d6c89e2d9789a0c49f4}{key\_bits}} / 8;}
\DoxyCodeLine{47    \}}
\DoxyCodeLine{48    keylen = klen;}
\DoxyCodeLine{49 }
\DoxyCodeLine{50    \textcolor{keywordflow}{if} (arg->\mbox{\hyperlink{structpbes__arg_aeecdb7fb21b9beacfa5adf1f715eb9fd}{iv}} != NULL) \{}
\DoxyCodeLine{51       iv = arg->\mbox{\hyperlink{structpbes__arg_aeecdb7fb21b9beacfa5adf1f715eb9fd}{iv}}->data;}
\DoxyCodeLine{52    \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{53       iv = k + klen;}
\DoxyCodeLine{54       klen += arg->\mbox{\hyperlink{structpbes__arg_a6879b93a34abc3b85c42fea0b0e92156}{type}}.\mbox{\hyperlink{structpbes__properties_a62ec0e2217643f5e3a52684b067f5dc2}{blocklen}};}
\DoxyCodeLine{55    \}}
\DoxyCodeLine{56 }
\DoxyCodeLine{57    \textcolor{keywordflow}{if} (klen > \textcolor{keyword}{sizeof}(k)) \textcolor{keywordflow}{return} \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06ca92aa8bad3930f08d5a188bf72094b066}{CRYPT\_INVALID\_ARG}};}
\DoxyCodeLine{58 }
\DoxyCodeLine{59    \textcolor{keywordflow}{if} ((err = arg->\mbox{\hyperlink{structpbes__arg_a6879b93a34abc3b85c42fea0b0e92156}{type}}.\mbox{\hyperlink{structpbes__properties_a6edc1f4ee556a89b6812d0be927b1547}{kdf}}(arg->\mbox{\hyperlink{structpbes__arg_a146b6c8875be0a3ac9f426327e83186a}{pwd}}, arg->\mbox{\hyperlink{structpbes__arg_a6f7f1324f1acfd51dcc7c1e334db7e0a}{pwdlen}}, arg->\mbox{\hyperlink{structpbes__arg_a356304efb7c4b45d06779905fd254797}{salt}}->data, arg->\mbox{\hyperlink{structpbes__arg_a356304efb7c4b45d06779905fd254797}{salt}}->size, arg->\mbox{\hyperlink{structpbes__arg_a78b52a8d8572e6947ebe909b51490ec6}{iterations}}, hid, k, \&klen)) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}}) \textcolor{keywordflow}{goto} LBL\_ERROR;}
\DoxyCodeLine{60    \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{cbc__start_8c_abba6632aa97f200faf29cdb7f5d99eee}{cbc\_start}}(cid, iv, k, keylen, 0, \&cbc)) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}}) \textcolor{keywordflow}{goto} LBL\_ERROR;}
\DoxyCodeLine{61    \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{cbc__decrypt_8c_a370774a78d86e94ee3dee504dc15773f}{cbc\_decrypt}}(arg->\mbox{\hyperlink{structpbes__arg_a8e69f095d7a7e8f5fad6fa49ea2d0d00}{enc\_data}}->data, dec\_data, arg->\mbox{\hyperlink{structpbes__arg_a8e69f095d7a7e8f5fad6fa49ea2d0d00}{enc\_data}}->size, \&cbc)) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}}) \textcolor{keywordflow}{goto} LBL\_ERROR;}
\DoxyCodeLine{62    \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{cbc__done_8c_a13f57f4d9801877029527e4ad3a2dd5f}{cbc\_done}}(\&cbc)) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}}) \textcolor{keywordflow}{goto} LBL\_ERROR;}
\DoxyCodeLine{63    dlen = arg->\mbox{\hyperlink{structpbes__arg_a8e69f095d7a7e8f5fad6fa49ea2d0d00}{enc\_data}}->size;}
\DoxyCodeLine{64    \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{padding__depad_8c_a82df175ea5c72fef7e519125bbe9fb89}{padding\_depad}}(dec\_data, \&dlen, LTC\_PAD\_PKCS7)) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}}) \textcolor{keywordflow}{goto} LBL\_ERROR;}
\DoxyCodeLine{65    diff = (long)arg->\mbox{\hyperlink{structpbes__arg_a8e69f095d7a7e8f5fad6fa49ea2d0d00}{enc\_data}}->size - (\textcolor{keywordtype}{long})dlen;}
\DoxyCodeLine{66    \textcolor{keywordflow}{if} ((diff <= 0) || (diff > \mbox{\hyperlink{tomcrypt__cipher_8h_a47d36a5949d990da7da81e79c44820fb}{cipher\_descriptor}}[cid].\mbox{\hyperlink{structltc__cipher__descriptor_afa2af7325fd3a834910dd92e8c9acf49}{block\_length}})) \{}
\DoxyCodeLine{67       err = \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06caee3022c2372277db42c7d43310bcb43b}{CRYPT\_PK\_INVALID\_PADDING}};}
\DoxyCodeLine{68       \textcolor{keywordflow}{goto} LBL\_ERROR;}
\DoxyCodeLine{69    \}}
\DoxyCodeLine{70    *dec\_size = dlen;}
\DoxyCodeLine{71    \textcolor{keywordflow}{return} \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}};}
\DoxyCodeLine{72 }
\DoxyCodeLine{73 LBL\_ERROR:}
\DoxyCodeLine{74    \mbox{\hyperlink{tomcrypt__misc_8h_a63b6e188713790263bfd3612fe8b398f}{zeromem}}(k, \textcolor{keyword}{sizeof}(k));}
\DoxyCodeLine{75    \mbox{\hyperlink{tomcrypt__misc_8h_a63b6e188713790263bfd3612fe8b398f}{zeromem}}(dec\_data, *dec\_size);}
\DoxyCodeLine{76    \textcolor{keywordflow}{return} err;}
\DoxyCodeLine{77 \}}

\end{DoxyCode}


References ltc\+\_\+cipher\+\_\+descriptor\+::block\+\_\+length, pbes\+\_\+properties\+::blocklen, pbes\+\_\+properties\+::c, cbc\+\_\+decrypt(), cbc\+\_\+done(), cbc\+\_\+start(), cipher\+\_\+descriptor, C\+R\+Y\+P\+T\+\_\+\+I\+N\+V\+A\+L\+I\+D\+\_\+\+A\+RG, C\+R\+Y\+P\+T\+\_\+\+I\+N\+V\+A\+L\+I\+D\+\_\+\+C\+I\+P\+H\+ER, C\+R\+Y\+P\+T\+\_\+\+I\+N\+V\+A\+L\+I\+D\+\_\+\+H\+A\+SH, C\+R\+Y\+P\+T\+\_\+\+I\+N\+V\+A\+L\+I\+D\+\_\+\+K\+E\+Y\+S\+I\+ZE, C\+R\+Y\+P\+T\+\_\+\+OK, C\+R\+Y\+P\+T\+\_\+\+P\+K\+\_\+\+I\+N\+V\+A\+L\+I\+D\+\_\+\+P\+A\+D\+D\+I\+NG, pbes\+\_\+arg\+::enc\+\_\+data, find\+\_\+cipher(), find\+\_\+hash(), pbes\+\_\+properties\+::h, pbes\+\_\+arg\+::iterations, pbes\+\_\+arg\+::iv, pbes\+\_\+properties\+::kdf, pbes\+\_\+arg\+::key\+\_\+bits, pbes\+\_\+properties\+::keylen, L\+T\+C\+\_\+\+A\+R\+G\+C\+HK, padding\+\_\+depad(), pbes\+\_\+arg\+::pwd, pbes\+\_\+arg\+::pwdlen, pbes\+\_\+arg\+::salt, pbes\+\_\+arg\+::type, and zeromem().



Referenced by pkcs8\+\_\+decode\+\_\+flexi().

Here is the call graph for this function\+:
% FIG 61
Here is the caller graph for this function\+:
% FIG 62
\mbox{\Hypertarget{tomcrypt__private_8h_acff5b3d0c6e1145e07d1a3ff53fadce5}\label{tomcrypt__private_8h_acff5b3d0c6e1145e07d1a3ff53fadce5}} 
\index{tomcrypt\_private.h@{tomcrypt\_private.h}!pk\_get\_oid@{pk\_get\_oid}}
\index{pk\_get\_oid@{pk\_get\_oid}!tomcrypt\_private.h@{tomcrypt\_private.h}}
\subsubsection{\texorpdfstring{pk\_get\_oid()}{pk\_get\_oid()}}
{\footnotesize\ttfamily int pk\+\_\+get\+\_\+oid (\begin{DoxyParamCaption}\item[{enum \mbox{\hyperlink{tomcrypt__private_8h_a981c610adcaa77d61adb80dde41a044b}{ltc\+\_\+oid\+\_\+id}}}]{id,  }\item[{const char $\ast$$\ast$}]{st }\end{DoxyParamCaption})}



Definition at line 29 of file pk\+\_\+get\+\_\+oid.\+c.


\begin{DoxyCode}{0}
\DoxyCodeLine{30 \{}
\DoxyCodeLine{31    \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} i;}
\DoxyCodeLine{32    \mbox{\hyperlink{tomcrypt__argchk_8h_a683da3e041e49f196318b6ea951414ba}{LTC\_ARGCHK}}(st != NULL);}
\DoxyCodeLine{33    \textcolor{keywordflow}{for} (i = 0; i < \textcolor{keyword}{sizeof}(\mbox{\hyperlink{pk__get__oid_8c_aa1b71c293ec0a64799ecb075399a82bd}{pka\_oids}})/\textcolor{keyword}{sizeof}(\mbox{\hyperlink{pk__get__oid_8c_aa1b71c293ec0a64799ecb075399a82bd}{pka\_oids}}[0]); ++i) \{}
\DoxyCodeLine{34       \textcolor{keywordflow}{if} (\mbox{\hyperlink{pk__get__oid_8c_aa1b71c293ec0a64799ecb075399a82bd}{pka\_oids}}[i].\textcolor{keywordtype}{id} == \textcolor{keywordtype}{id}) \{}
\DoxyCodeLine{35          *st = \mbox{\hyperlink{pk__get__oid_8c_aa1b71c293ec0a64799ecb075399a82bd}{pka\_oids}}[i].\mbox{\hyperlink{structoid__table__entry_ae3be974f1f46a4a102d3bab52ef0cf36}{oid}};}
\DoxyCodeLine{36          \textcolor{keywordflow}{return} \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}};}
\DoxyCodeLine{37       \}}
\DoxyCodeLine{38    \}}
\DoxyCodeLine{39    \textcolor{keywordflow}{return} \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06ca92aa8bad3930f08d5a188bf72094b066}{CRYPT\_INVALID\_ARG}};}
\DoxyCodeLine{40 \}}

\end{DoxyCode}


References C\+R\+Y\+P\+T\+\_\+\+I\+N\+V\+A\+L\+I\+D\+\_\+\+A\+RG, C\+R\+Y\+P\+T\+\_\+\+OK, L\+T\+C\+\_\+\+A\+R\+G\+C\+HK, oid\+\_\+table\+\_\+entry\+::oid, and pka\+\_\+oids.



Referenced by ecc\+\_\+export\+\_\+openssl(), ecc\+\_\+import\+\_\+pkcs8(), rsa\+\_\+import\+\_\+pkcs8(), x509\+\_\+decode\+\_\+subject\+\_\+public\+\_\+key\+\_\+info(), and x509\+\_\+encode\+\_\+subject\+\_\+public\+\_\+key\+\_\+info().

Here is the caller graph for this function\+:
% FIG 63
\mbox{\Hypertarget{tomcrypt__private_8h_aaa860b1fbc776e0760df8934a6aa245a}\label{tomcrypt__private_8h_aaa860b1fbc776e0760df8934a6aa245a}} 
\index{tomcrypt\_private.h@{tomcrypt\_private.h}!pk\_oid\_cmp\_with\_asn1@{pk\_oid\_cmp\_with\_asn1}}
\index{pk\_oid\_cmp\_with\_asn1@{pk\_oid\_cmp\_with\_asn1}!tomcrypt\_private.h@{tomcrypt\_private.h}}
\subsubsection{\texorpdfstring{pk\_oid\_cmp\_with\_asn1()}{pk\_oid\_cmp\_with\_asn1()}}
{\footnotesize\ttfamily int pk\+\_\+oid\+\_\+cmp\+\_\+with\+\_\+asn1 (\begin{DoxyParamCaption}\item[{const char $\ast$}]{o1,  }\item[{const ltc\+\_\+asn1\+\_\+list $\ast$}]{o2 }\end{DoxyParamCaption})}



Definition at line 41 of file pk\+\_\+oid\+\_\+cmp.\+c.


\begin{DoxyCode}{0}
\DoxyCodeLine{42 \{}
\DoxyCodeLine{43    \textcolor{keywordflow}{if} (o1 == NULL || o2 == NULL) \textcolor{keywordflow}{return} \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06ca03c22220d7538be04455cd2aa6ddf9da}{CRYPT\_ERROR}};}
\DoxyCodeLine{44 }
\DoxyCodeLine{45    \textcolor{keywordflow}{if} (o2->type != LTC\_ASN1\_OBJECT\_IDENTIFIER) \textcolor{keywordflow}{return} \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06ca92aa8bad3930f08d5a188bf72094b066}{CRYPT\_INVALID\_ARG}};}
\DoxyCodeLine{46 }
\DoxyCodeLine{47    \textcolor{keywordflow}{return} \mbox{\hyperlink{pk__oid__cmp_8c_a4283c0cfa77d37ab8add0b7c531d3d6f}{pk\_oid\_cmp\_with\_ulong}}(o1, o2->data, o2->size);}
\DoxyCodeLine{48 \}}

\end{DoxyCode}


References C\+R\+Y\+P\+T\+\_\+\+E\+R\+R\+OR, C\+R\+Y\+P\+T\+\_\+\+I\+N\+V\+A\+L\+I\+D\+\_\+\+A\+RG, and pk\+\_\+oid\+\_\+cmp\+\_\+with\+\_\+ulong().



Referenced by \+\_\+pbes1\+\_\+from\+\_\+oid(), \+\_\+pbes2\+\_\+from\+\_\+oid(), ecc\+\_\+import\+\_\+pkcs8(), pbes2\+\_\+extract(), rsa\+\_\+import\+\_\+pkcs8(), and x509\+\_\+decode\+\_\+subject\+\_\+public\+\_\+key\+\_\+info().

Here is the call graph for this function\+:
% FIG 64
Here is the caller graph for this function\+:
% FIG 65
\mbox{\Hypertarget{tomcrypt__private_8h_a4283c0cfa77d37ab8add0b7c531d3d6f}\label{tomcrypt__private_8h_a4283c0cfa77d37ab8add0b7c531d3d6f}} 
\index{tomcrypt\_private.h@{tomcrypt\_private.h}!pk\_oid\_cmp\_with\_ulong@{pk\_oid\_cmp\_with\_ulong}}
\index{pk\_oid\_cmp\_with\_ulong@{pk\_oid\_cmp\_with\_ulong}!tomcrypt\_private.h@{tomcrypt\_private.h}}
\subsubsection{\texorpdfstring{pk\_oid\_cmp\_with\_ulong()}{pk\_oid\_cmp\_with\_ulong()}}
{\footnotesize\ttfamily int pk\+\_\+oid\+\_\+cmp\+\_\+with\+\_\+ulong (\begin{DoxyParamCaption}\item[{const char $\ast$}]{o1,  }\item[{const unsigned long $\ast$}]{o2,  }\item[{unsigned long}]{o2size }\end{DoxyParamCaption})}



Definition at line 17 of file pk\+\_\+oid\+\_\+cmp.\+c.


\begin{DoxyCode}{0}
\DoxyCodeLine{18 \{}
\DoxyCodeLine{19    \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} i;}
\DoxyCodeLine{20    \textcolor{keywordtype}{char} tmp[256] = \{ 0 \};}
\DoxyCodeLine{21    \textcolor{keywordtype}{int} err;}
\DoxyCodeLine{22 }
\DoxyCodeLine{23    \textcolor{keywordflow}{if} (o1 == NULL || o2 == NULL) \textcolor{keywordflow}{return} \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06ca03c22220d7538be04455cd2aa6ddf9da}{CRYPT\_ERROR}};}
\DoxyCodeLine{24 }
\DoxyCodeLine{25    i = \textcolor{keyword}{sizeof}(tmp);}
\DoxyCodeLine{26    \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{tomcrypt__private_8h_a5ead1435fcad3d1f1842a6419079f036}{pk\_oid\_num\_to\_str}}(o2, o2size, tmp, \&i)) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}}) \{}
\DoxyCodeLine{27       \textcolor{keywordflow}{return} err;}
\DoxyCodeLine{28    \}}
\DoxyCodeLine{29 }
\DoxyCodeLine{30    \textcolor{keywordflow}{if} (\mbox{\hyperlink{tomcrypt__cfg_8h_a5d6e3d69e1d3f54de008b963bba3c6b3}{XSTRCMP}}(o1, tmp) != 0) \{}
\DoxyCodeLine{31       \textcolor{keywordflow}{return} \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06ca18dac5b6ef2e90712e2ae43c4734f00d}{CRYPT\_PK\_INVALID\_TYPE}};}
\DoxyCodeLine{32    \}}
\DoxyCodeLine{33 }
\DoxyCodeLine{34    \textcolor{keywordflow}{return} \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}};}
\DoxyCodeLine{35 \}}

\end{DoxyCode}


References C\+R\+Y\+P\+T\+\_\+\+E\+R\+R\+OR, C\+R\+Y\+P\+T\+\_\+\+OK, C\+R\+Y\+P\+T\+\_\+\+P\+K\+\_\+\+I\+N\+V\+A\+L\+I\+D\+\_\+\+T\+Y\+PE, pk\+\_\+oid\+\_\+num\+\_\+to\+\_\+str(), and X\+S\+T\+R\+C\+M\+P().



Referenced by ecc\+\_\+recover\+\_\+key(), ecc\+\_\+sign\+\_\+hash\+\_\+ex(), ecc\+\_\+verify\+\_\+hash\+\_\+ex(), and pk\+\_\+oid\+\_\+cmp\+\_\+with\+\_\+asn1().

Here is the call graph for this function\+:
% FIG 66
Here is the caller graph for this function\+:
% FIG 67
\mbox{\Hypertarget{tomcrypt__private_8h_a5ead1435fcad3d1f1842a6419079f036}\label{tomcrypt__private_8h_a5ead1435fcad3d1f1842a6419079f036}} 
\index{tomcrypt\_private.h@{tomcrypt\_private.h}!pk\_oid\_num\_to\_str@{pk\_oid\_num\_to\_str}}
\index{pk\_oid\_num\_to\_str@{pk\_oid\_num\_to\_str}!tomcrypt\_private.h@{tomcrypt\_private.h}}
\subsubsection{\texorpdfstring{pk\_oid\_num\_to\_str()}{pk\_oid\_num\_to\_str()}}
{\footnotesize\ttfamily int pk\+\_\+oid\+\_\+num\+\_\+to\+\_\+str (\begin{DoxyParamCaption}\item[{const unsigned long $\ast$}]{oid,  }\item[{unsigned long}]{oidlen,  }\item[{char $\ast$}]{O\+ID,  }\item[{unsigned long $\ast$}]{outlen }\end{DoxyParamCaption})}



Definition at line 50 of file pk\+\_\+oid\+\_\+str.\+c.


\begin{DoxyCode}{0}
\DoxyCodeLine{51 \{}
\DoxyCodeLine{52    \textcolor{keywordtype}{int} i;}
\DoxyCodeLine{53    \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} j, k;}
\DoxyCodeLine{54    \textcolor{keywordtype}{char} tmp[256] = \{ 0 \};}
\DoxyCodeLine{55 }
\DoxyCodeLine{56    \mbox{\hyperlink{tomcrypt__argchk_8h_a683da3e041e49f196318b6ea951414ba}{LTC\_ARGCHK}}(oid != NULL);}
\DoxyCodeLine{57    \mbox{\hyperlink{tomcrypt__argchk_8h_a683da3e041e49f196318b6ea951414ba}{LTC\_ARGCHK}}(\mbox{\hyperlink{ecc__find__curve_8c_a3b9aae9990e63034f7d199729f025b23}{OID}} != NULL);}
\DoxyCodeLine{58    \mbox{\hyperlink{tomcrypt__argchk_8h_a683da3e041e49f196318b6ea951414ba}{LTC\_ARGCHK}}(outlen != NULL);}
\DoxyCodeLine{59 }
\DoxyCodeLine{60    \textcolor{keywordflow}{for} (i = oidlen - 1, k = 0; i >= 0; i--) \{}
\DoxyCodeLine{61       j = oid[i];}
\DoxyCodeLine{62       \textcolor{keywordflow}{if} (j == 0) \{}
\DoxyCodeLine{63          tmp[k] = \textcolor{charliteral}{'0'};}
\DoxyCodeLine{64          \textcolor{keywordflow}{if} (++k >= \textcolor{keyword}{sizeof}(tmp)) \textcolor{keywordflow}{return} \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06ca03c22220d7538be04455cd2aa6ddf9da}{CRYPT\_ERROR}};}
\DoxyCodeLine{65       \}}
\DoxyCodeLine{66       \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{67          \textcolor{keywordflow}{while} (j > 0) \{}
\DoxyCodeLine{68             tmp[k] = \textcolor{charliteral}{'0'} + (j \% 10);}
\DoxyCodeLine{69             \textcolor{keywordflow}{if} (++k >= \textcolor{keyword}{sizeof}(tmp)) \textcolor{keywordflow}{return} \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06ca03c22220d7538be04455cd2aa6ddf9da}{CRYPT\_ERROR}};}
\DoxyCodeLine{70             j /= 10;}
\DoxyCodeLine{71          \}}
\DoxyCodeLine{72       \}}
\DoxyCodeLine{73       \textcolor{keywordflow}{if} (i > 0) \{}
\DoxyCodeLine{74         tmp[k] = \textcolor{charliteral}{'.'};}
\DoxyCodeLine{75         \textcolor{keywordflow}{if} (++k >= \textcolor{keyword}{sizeof}(tmp)) \textcolor{keywordflow}{return} \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06ca03c22220d7538be04455cd2aa6ddf9da}{CRYPT\_ERROR}};}
\DoxyCodeLine{76       \}}
\DoxyCodeLine{77    \}}
\DoxyCodeLine{78    \textcolor{keywordflow}{if} (*outlen < k + 1) \{}
\DoxyCodeLine{79       *outlen = k + 1;}
\DoxyCodeLine{80       \textcolor{keywordflow}{return} \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06caccd878f5599f3036ffe759dbe1a1ac16}{CRYPT\_BUFFER\_OVERFLOW}};}
\DoxyCodeLine{81    \}}
\DoxyCodeLine{82    \textcolor{keywordflow}{for} (j = 0; j < k; j++) \mbox{\hyperlink{ecc__find__curve_8c_a3b9aae9990e63034f7d199729f025b23}{OID}}[j] = tmp[k - j - 1];}
\DoxyCodeLine{83    \mbox{\hyperlink{ecc__find__curve_8c_a3b9aae9990e63034f7d199729f025b23}{OID}}[k] = \textcolor{charliteral}{'\(\backslash\)0'};}
\DoxyCodeLine{84    *outlen = k; \textcolor{comment}{/* the length without terminating NUL byte */}}
\DoxyCodeLine{85    \textcolor{keywordflow}{return} \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}};}
\DoxyCodeLine{86 \}}

\end{DoxyCode}


References C\+R\+Y\+P\+T\+\_\+\+B\+U\+F\+F\+E\+R\+\_\+\+O\+V\+E\+R\+F\+L\+OW, C\+R\+Y\+P\+T\+\_\+\+E\+R\+R\+OR, C\+R\+Y\+P\+T\+\_\+\+OK, L\+T\+C\+\_\+\+A\+R\+G\+C\+HK, and O\+ID.



Referenced by \+\_\+ecc\+\_\+import\+\_\+private\+\_\+with\+\_\+oid(), \+\_\+ecc\+\_\+import\+\_\+x509\+\_\+with\+\_\+oid(), ecc\+\_\+get\+\_\+oid\+\_\+str(), ecc\+\_\+import\+\_\+pkcs8(), and pk\+\_\+oid\+\_\+cmp\+\_\+with\+\_\+ulong().

Here is the caller graph for this function\+:
% FIG 68
\mbox{\Hypertarget{tomcrypt__private_8h_ad99c87d19f50f703708d36a931fe5df6}\label{tomcrypt__private_8h_ad99c87d19f50f703708d36a931fe5df6}} 
\index{tomcrypt\_private.h@{tomcrypt\_private.h}!pk\_oid\_str\_to\_num@{pk\_oid\_str\_to\_num}}
\index{pk\_oid\_str\_to\_num@{pk\_oid\_str\_to\_num}!tomcrypt\_private.h@{tomcrypt\_private.h}}
\subsubsection{\texorpdfstring{pk\_oid\_str\_to\_num()}{pk\_oid\_str\_to\_num()}}
{\footnotesize\ttfamily int pk\+\_\+oid\+\_\+str\+\_\+to\+\_\+num (\begin{DoxyParamCaption}\item[{const char $\ast$}]{O\+ID,  }\item[{unsigned long $\ast$}]{oid,  }\item[{unsigned long $\ast$}]{oidlen }\end{DoxyParamCaption})}



Definition at line 12 of file pk\+\_\+oid\+\_\+str.\+c.


\begin{DoxyCode}{0}
\DoxyCodeLine{13 \{}
\DoxyCodeLine{14    \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} i, j, limit, OID\_len, oid\_j;}
\DoxyCodeLine{15 }
\DoxyCodeLine{16    \mbox{\hyperlink{tomcrypt__argchk_8h_a683da3e041e49f196318b6ea951414ba}{LTC\_ARGCHK}}(oidlen != NULL);}
\DoxyCodeLine{17 }
\DoxyCodeLine{18    limit = *oidlen;}
\DoxyCodeLine{19    *oidlen = 0; \textcolor{comment}{/* make sure that we return zero oidlen on error */}}
\DoxyCodeLine{20    \textcolor{keywordflow}{for} (i = 0; i < limit; i++) oid[i] = 0;}
\DoxyCodeLine{21 }
\DoxyCodeLine{22    \textcolor{keywordflow}{if} (\mbox{\hyperlink{ecc__find__curve_8c_a3b9aae9990e63034f7d199729f025b23}{OID}} == NULL) \textcolor{keywordflow}{return} \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}};}
\DoxyCodeLine{23 }
\DoxyCodeLine{24    OID\_len = strlen(\mbox{\hyperlink{ecc__find__curve_8c_a3b9aae9990e63034f7d199729f025b23}{OID}});}
\DoxyCodeLine{25    \textcolor{keywordflow}{if} (OID\_len == 0) \textcolor{keywordflow}{return} \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}};}
\DoxyCodeLine{26 }
\DoxyCodeLine{27    \textcolor{keywordflow}{for} (i = 0, j = 0; i < OID\_len; i++) \{}
\DoxyCodeLine{28       \textcolor{keywordflow}{if} (\mbox{\hyperlink{ecc__find__curve_8c_a3b9aae9990e63034f7d199729f025b23}{OID}}[i] == \textcolor{charliteral}{'.'}) \{}
\DoxyCodeLine{29          \textcolor{keywordflow}{if} (++j >= limit) \textcolor{keywordflow}{continue};}
\DoxyCodeLine{30       \}}
\DoxyCodeLine{31       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} ((\mbox{\hyperlink{ecc__find__curve_8c_a3b9aae9990e63034f7d199729f025b23}{OID}}[i] >= \textcolor{charliteral}{'0'}) \&\& (\mbox{\hyperlink{ecc__find__curve_8c_a3b9aae9990e63034f7d199729f025b23}{OID}}[i] <= \textcolor{charliteral}{'9'})) \{}
\DoxyCodeLine{32          \textcolor{keywordflow}{if} ((j >= limit) || (oid == NULL)) \textcolor{keywordflow}{continue};}
\DoxyCodeLine{33          oid\_j = oid[j];}
\DoxyCodeLine{34          oid[j] = oid[j] * 10 + (\mbox{\hyperlink{ecc__find__curve_8c_a3b9aae9990e63034f7d199729f025b23}{OID}}[i] - \textcolor{charliteral}{'0'});}
\DoxyCodeLine{35          \textcolor{keywordflow}{if} (oid[j] < oid\_j) \textcolor{keywordflow}{return} \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06ca3a147cc0bbea3f8779364ad00c2678b4}{CRYPT\_OVERFLOW}};}
\DoxyCodeLine{36       \}}
\DoxyCodeLine{37       \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{38          \textcolor{keywordflow}{return} \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06ca03c22220d7538be04455cd2aa6ddf9da}{CRYPT\_ERROR}};}
\DoxyCodeLine{39       \}}
\DoxyCodeLine{40    \}}
\DoxyCodeLine{41    \textcolor{keywordflow}{if} (j == 0) \textcolor{keywordflow}{return} \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06ca03c22220d7538be04455cd2aa6ddf9da}{CRYPT\_ERROR}};}
\DoxyCodeLine{42    \textcolor{keywordflow}{if} (j >= limit) \{}
\DoxyCodeLine{43       *oidlen = j;}
\DoxyCodeLine{44       \textcolor{keywordflow}{return} \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06caccd878f5599f3036ffe759dbe1a1ac16}{CRYPT\_BUFFER\_OVERFLOW}};}
\DoxyCodeLine{45    \}}
\DoxyCodeLine{46    *oidlen = j + 1;}
\DoxyCodeLine{47    \textcolor{keywordflow}{return} \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}};}
\DoxyCodeLine{48 \}}

\end{DoxyCode}


References C\+R\+Y\+P\+T\+\_\+\+B\+U\+F\+F\+E\+R\+\_\+\+O\+V\+E\+R\+F\+L\+OW, C\+R\+Y\+P\+T\+\_\+\+E\+R\+R\+OR, C\+R\+Y\+P\+T\+\_\+\+OK, C\+R\+Y\+P\+T\+\_\+\+O\+V\+E\+R\+F\+L\+OW, L\+T\+C\+\_\+\+A\+R\+G\+C\+HK, and O\+ID.



Referenced by \+\_\+ecc\+\_\+oid\+\_\+lookup(), ecc\+\_\+export\+\_\+openssl(), ecc\+\_\+set\+\_\+curve(), and x509\+\_\+encode\+\_\+subject\+\_\+public\+\_\+key\+\_\+info().

Here is the caller graph for this function\+:
% FIG 69
\mbox{\Hypertarget{tomcrypt__private_8h_a362c9fba9251fa6d35445f4ccae24fe8}\label{tomcrypt__private_8h_a362c9fba9251fa6d35445f4ccae24fe8}} 
\index{tomcrypt\_private.h@{tomcrypt\_private.h}!pkcs12\_kdf@{pkcs12\_kdf}}
\index{pkcs12\_kdf@{pkcs12\_kdf}!tomcrypt\_private.h@{tomcrypt\_private.h}}
\subsubsection{\texorpdfstring{pkcs12\_kdf()}{pkcs12\_kdf()}}
{\footnotesize\ttfamily int pkcs12\+\_\+kdf (\begin{DoxyParamCaption}\item[{int}]{hash\+\_\+id,  }\item[{const unsigned char $\ast$}]{pw,  }\item[{unsigned long}]{pwlen,  }\item[{const unsigned char $\ast$}]{salt,  }\item[{unsigned long}]{saltlen,  }\item[{unsigned int}]{iterations,  }\item[{unsigned char}]{purpose,  }\item[{unsigned char $\ast$}]{out,  }\item[{unsigned long}]{outlen }\end{DoxyParamCaption})}



Definition at line 14 of file pkcs12\+\_\+kdf.\+c.


\begin{DoxyCode}{0}
\DoxyCodeLine{19 \{}
\DoxyCodeLine{20    \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} u = \mbox{\hyperlink{tomcrypt__hash_8h_ab0e4f02e30a47da79baa9240e79cde92}{hash\_descriptor}}[hash\_id].\mbox{\hyperlink{structltc__hash__descriptor_a49bd027653ff21408cb2661748d719ef}{hashsize}};}
\DoxyCodeLine{21    \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} v = \mbox{\hyperlink{tomcrypt__hash_8h_ab0e4f02e30a47da79baa9240e79cde92}{hash\_descriptor}}[hash\_id].\mbox{\hyperlink{structltc__hash__descriptor_ad0ac47c32e536997b59a5571acae2251}{blocksize}};}
\DoxyCodeLine{22    \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} \mbox{\hyperlink{khazad_8c_a86ea50de5a3e0ae87762f4298d35284c}{c}} = (outlen + u - 1) / u;}
\DoxyCodeLine{23    \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} Slen = ((saltlen + v - 1) / v) * v;}
\DoxyCodeLine{24    \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} Plen = ((pwlen + v - 1) / v) * v;}
\DoxyCodeLine{25    \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} k = (Plen + Slen) / v;}
\DoxyCodeLine{26    \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} Alen, keylen = 0;}
\DoxyCodeLine{27    \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} tmp, i, j, n;}
\DoxyCodeLine{28    \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char} ch;}
\DoxyCodeLine{29    \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char} D[\mbox{\hyperlink{tomcrypt_8h_ab59933beebb2b857c992b93cf53f0d10}{MAXBLOCKSIZE}}], A[\mbox{\hyperlink{tomcrypt_8h_ab59933beebb2b857c992b93cf53f0d10}{MAXBLOCKSIZE}}], B[\mbox{\hyperlink{tomcrypt_8h_ab59933beebb2b857c992b93cf53f0d10}{MAXBLOCKSIZE}}];}
\DoxyCodeLine{30    \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char} *\mbox{\hyperlink{md5_8c_ac0eafdc9ee161b71e7af98af736952fd}{I}}, *key;}
\DoxyCodeLine{31    \textcolor{keywordtype}{int} err = \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06ca03c22220d7538be04455cd2aa6ddf9da}{CRYPT\_ERROR}};}
\DoxyCodeLine{32 }
\DoxyCodeLine{33    \mbox{\hyperlink{tomcrypt__argchk_8h_a683da3e041e49f196318b6ea951414ba}{LTC\_ARGCHK}}(pw   != NULL);}
\DoxyCodeLine{34    \mbox{\hyperlink{tomcrypt__argchk_8h_a683da3e041e49f196318b6ea951414ba}{LTC\_ARGCHK}}(salt != NULL);}
\DoxyCodeLine{35    \mbox{\hyperlink{tomcrypt__argchk_8h_a683da3e041e49f196318b6ea951414ba}{LTC\_ARGCHK}}(out  != NULL);}
\DoxyCodeLine{36 }
\DoxyCodeLine{37    key = \mbox{\hyperlink{tomcrypt__cfg_8h_af363355f38fbaacdefacf270436ae1c9}{XMALLOC}}(u * \mbox{\hyperlink{khazad_8c_a86ea50de5a3e0ae87762f4298d35284c}{c}});}
\DoxyCodeLine{38    \mbox{\hyperlink{md5_8c_ac0eafdc9ee161b71e7af98af736952fd}{I}}   = \mbox{\hyperlink{tomcrypt__cfg_8h_af363355f38fbaacdefacf270436ae1c9}{XMALLOC}}(Plen + Slen);}
\DoxyCodeLine{39    \textcolor{keywordflow}{if} (key == NULL || \mbox{\hyperlink{md5_8c_ac0eafdc9ee161b71e7af98af736952fd}{I}} == NULL) \textcolor{keywordflow}{goto} DONE;}
\DoxyCodeLine{40    \mbox{\hyperlink{tomcrypt__misc_8h_a63b6e188713790263bfd3612fe8b398f}{zeromem}}(key, u * \mbox{\hyperlink{khazad_8c_a86ea50de5a3e0ae87762f4298d35284c}{c}});}
\DoxyCodeLine{41 }
\DoxyCodeLine{42    \textcolor{keywordflow}{for} (i = 0; i < v;    i++) D[i] = purpose;              \textcolor{comment}{/* D - diversifier */}}
\DoxyCodeLine{43    \textcolor{keywordflow}{for} (i = 0; i < Slen; i++) \mbox{\hyperlink{md5_8c_ac0eafdc9ee161b71e7af98af736952fd}{I}}[i] = salt[i \% saltlen];}
\DoxyCodeLine{44    \textcolor{keywordflow}{for} (i = 0; i < Plen; i++) \mbox{\hyperlink{md5_8c_ac0eafdc9ee161b71e7af98af736952fd}{I}}[Slen + i] = pw[i \% pwlen]; \textcolor{comment}{/* I = Salt || Pass */}}
\DoxyCodeLine{45 }
\DoxyCodeLine{46    \textcolor{keywordflow}{for} (i = 0; i < \mbox{\hyperlink{khazad_8c_a86ea50de5a3e0ae87762f4298d35284c}{c}}; i++) \{}
\DoxyCodeLine{47       Alen = \textcolor{keyword}{sizeof}(A);}
\DoxyCodeLine{48       err = \mbox{\hyperlink{hash__memory__multi_8c_a85566393d0f13710bafc9501361eff06}{hash\_memory\_multi}}(hash\_id, A, \&Alen, D, v, \mbox{\hyperlink{md5_8c_ac0eafdc9ee161b71e7af98af736952fd}{I}}, Slen + Plen, NULL); \textcolor{comment}{/* A = HASH(D || I) */}}
\DoxyCodeLine{49       \textcolor{keywordflow}{if} (err != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}}) \textcolor{keywordflow}{goto} DONE;}
\DoxyCodeLine{50       \textcolor{keywordflow}{for} (j = 1; j < iterations; j++) \{}
\DoxyCodeLine{51          err = \mbox{\hyperlink{hash__memory_8c_a8672bf28488595ef1519a6754498869c}{hash\_memory}}(hash\_id, A, Alen, A, \&Alen); \textcolor{comment}{/* A = HASH(A) */}}
\DoxyCodeLine{52          \textcolor{keywordflow}{if} (err != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}}) \textcolor{keywordflow}{goto} DONE;}
\DoxyCodeLine{53       \}}
\DoxyCodeLine{54       \textcolor{comment}{/* fill buffer B with A */}}
\DoxyCodeLine{55       \textcolor{keywordflow}{for} (j = 0; j < v; j++) B[j] = A[j \% Alen];}
\DoxyCodeLine{56       \textcolor{comment}{/* B += 1 */}}
\DoxyCodeLine{57       \textcolor{keywordflow}{for} (j = v; j > 0; j--) \{}
\DoxyCodeLine{58          \textcolor{keywordflow}{if} (++B[j - 1] != 0) \textcolor{keywordflow}{break};}
\DoxyCodeLine{59       \}}
\DoxyCodeLine{60       \textcolor{comment}{/* I\_n += B */}}
\DoxyCodeLine{61       \textcolor{keywordflow}{for} (n = 0; n < k; n++) \{}
\DoxyCodeLine{62          ch = 0;}
\DoxyCodeLine{63          \textcolor{keywordflow}{for} (j = v; j > 0; j--) \{}
\DoxyCodeLine{64             tmp = \mbox{\hyperlink{md5_8c_ac0eafdc9ee161b71e7af98af736952fd}{I}}[n * v + j - 1] + B[j - 1] + ch;}
\DoxyCodeLine{65             ch = (\textcolor{keywordtype}{unsigned} char)((tmp >> 8) \& 0xFF);}
\DoxyCodeLine{66             \mbox{\hyperlink{md5_8c_ac0eafdc9ee161b71e7af98af736952fd}{I}}[n * v + j - 1] = (\textcolor{keywordtype}{unsigned} char)(tmp \& 0xFF);}
\DoxyCodeLine{67          \}}
\DoxyCodeLine{68       \}}
\DoxyCodeLine{69       \textcolor{comment}{/* store derived key block */}}
\DoxyCodeLine{70       \mbox{\hyperlink{tomcrypt__cfg_8h_a7691dd48d60d5fc6daf2fa7ec4c55e12}{XMEMCPY}}(\&key[keylen], A, Alen);}
\DoxyCodeLine{71       keylen += Alen;}
\DoxyCodeLine{72    \}}
\DoxyCodeLine{73 }
\DoxyCodeLine{74    \mbox{\hyperlink{tomcrypt__cfg_8h_a7691dd48d60d5fc6daf2fa7ec4c55e12}{XMEMCPY}}(out, key, outlen);}
\DoxyCodeLine{75    err = \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}};}
\DoxyCodeLine{76 DONE:}
\DoxyCodeLine{77    \textcolor{keywordflow}{if} (\mbox{\hyperlink{md5_8c_ac0eafdc9ee161b71e7af98af736952fd}{I}}) \{}
\DoxyCodeLine{78       \mbox{\hyperlink{tomcrypt__misc_8h_a63b6e188713790263bfd3612fe8b398f}{zeromem}}(\mbox{\hyperlink{md5_8c_ac0eafdc9ee161b71e7af98af736952fd}{I}}, Plen + Slen);}
\DoxyCodeLine{79       \mbox{\hyperlink{tomcrypt__cfg_8h_a260d66fc0690e0502cf3bfe7b5244b75}{XFREE}}(\mbox{\hyperlink{md5_8c_ac0eafdc9ee161b71e7af98af736952fd}{I}});}
\DoxyCodeLine{80    \}}
\DoxyCodeLine{81    \textcolor{keywordflow}{if} (key) \{}
\DoxyCodeLine{82       \mbox{\hyperlink{tomcrypt__misc_8h_a63b6e188713790263bfd3612fe8b398f}{zeromem}}(key, u * \mbox{\hyperlink{khazad_8c_a86ea50de5a3e0ae87762f4298d35284c}{c}});}
\DoxyCodeLine{83       \mbox{\hyperlink{tomcrypt__cfg_8h_a260d66fc0690e0502cf3bfe7b5244b75}{XFREE}}(key);}
\DoxyCodeLine{84    \}}
\DoxyCodeLine{85    \textcolor{keywordflow}{return} err;}
\DoxyCodeLine{86 \}}

\end{DoxyCode}


References ltc\+\_\+hash\+\_\+descriptor\+::blocksize, c, C\+R\+Y\+P\+T\+\_\+\+E\+R\+R\+OR, C\+R\+Y\+P\+T\+\_\+\+OK, hash\+\_\+descriptor, hash\+\_\+memory(), hash\+\_\+memory\+\_\+multi(), ltc\+\_\+hash\+\_\+descriptor\+::hashsize, I, L\+T\+C\+\_\+\+A\+R\+G\+C\+HK, M\+A\+X\+B\+L\+O\+C\+K\+S\+I\+ZE, X\+F\+R\+E\+E(), X\+M\+A\+L\+L\+O\+C(), X\+M\+E\+M\+C\+P\+Y(), and zeromem().



Referenced by \+\_\+pkcs\+\_\+12\+\_\+wrap().

Here is the call graph for this function\+:
% FIG 70
Here is the caller graph for this function\+:
% FIG 71
\mbox{\Hypertarget{tomcrypt__private_8h_af7de8585646f421393f3c744654ae587}\label{tomcrypt__private_8h_af7de8585646f421393f3c744654ae587}} 
\index{tomcrypt\_private.h@{tomcrypt\_private.h}!pkcs12\_utf8\_to\_utf16@{pkcs12\_utf8\_to\_utf16}}
\index{pkcs12\_utf8\_to\_utf16@{pkcs12\_utf8\_to\_utf16}!tomcrypt\_private.h@{tomcrypt\_private.h}}
\subsubsection{\texorpdfstring{pkcs12\_utf8\_to\_utf16()}{pkcs12\_utf8\_to\_utf16()}}
{\footnotesize\ttfamily int pkcs12\+\_\+utf8\+\_\+to\+\_\+utf16 (\begin{DoxyParamCaption}\item[{const unsigned char $\ast$}]{in,  }\item[{unsigned long}]{inlen,  }\item[{unsigned char $\ast$}]{out,  }\item[{unsigned long $\ast$}]{outlen }\end{DoxyParamCaption})}



Definition at line 14 of file pkcs12\+\_\+utf8\+\_\+to\+\_\+utf16.\+c.


\begin{DoxyCode}{0}
\DoxyCodeLine{15                                                                           \{}
\DoxyCodeLine{16    \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} \mbox{\hyperlink{ocb__init_8c_afed088663f8704004425cdae2120b9b3}{len}} = 0;}
\DoxyCodeLine{17    \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char}* in\_end = in + inlen;}
\DoxyCodeLine{18    \textcolor{keyword}{const} \mbox{\hyperlink{tomcrypt__cfg_8h_a1f20274bb048d3c8a916b261dfff9567}{ulong32}} offset[6] = \{}
\DoxyCodeLine{19       0x00000000UL, 0x00003080UL, 0x000E2080UL,}
\DoxyCodeLine{20       0x03C82080UL, 0xFA082080UL, 0x82082080UL}
\DoxyCodeLine{21    \};}
\DoxyCodeLine{22    \textcolor{keywordtype}{int} err = \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06ca03c22220d7538be04455cd2aa6ddf9da}{CRYPT\_ERROR}};}
\DoxyCodeLine{23 }
\DoxyCodeLine{24    \mbox{\hyperlink{tomcrypt__argchk_8h_a683da3e041e49f196318b6ea951414ba}{LTC\_ARGCHK}}(in     != NULL);}
\DoxyCodeLine{25    \mbox{\hyperlink{tomcrypt__argchk_8h_a683da3e041e49f196318b6ea951414ba}{LTC\_ARGCHK}}(out    != NULL);}
\DoxyCodeLine{26    \mbox{\hyperlink{tomcrypt__argchk_8h_a683da3e041e49f196318b6ea951414ba}{LTC\_ARGCHK}}(outlen != NULL);}
\DoxyCodeLine{27 }
\DoxyCodeLine{28    \textcolor{keywordflow}{while} (in < in\_end) \{}
\DoxyCodeLine{29       \mbox{\hyperlink{tomcrypt__cfg_8h_a1f20274bb048d3c8a916b261dfff9567}{ulong32}} ch = 0;}
\DoxyCodeLine{30       \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{short} extra = 0; \textcolor{comment}{/* 0 */}}
\DoxyCodeLine{31       \textcolor{keywordflow}{if} (*in >= 192) extra++;  \textcolor{comment}{/* 1 */}}
\DoxyCodeLine{32       \textcolor{keywordflow}{if} (*in >= 224) extra++;  \textcolor{comment}{/* 2 */}}
\DoxyCodeLine{33       \textcolor{keywordflow}{if} (*in >= 240) extra++;  \textcolor{comment}{/* 3 */}}
\DoxyCodeLine{34       \textcolor{keywordflow}{if} (*in >= 248) extra++;  \textcolor{comment}{/* 4 */}}
\DoxyCodeLine{35       \textcolor{keywordflow}{if} (*in >= 252) extra++;  \textcolor{comment}{/* 5 */}}
\DoxyCodeLine{36       \textcolor{keywordflow}{if} (in + extra >= in\_end) \textcolor{keywordflow}{goto} ERROR;}
\DoxyCodeLine{37       \textcolor{keywordflow}{switch} (extra) \{}
\DoxyCodeLine{38          \textcolor{keywordflow}{case} 5: ch += *in++; ch <<= 6;}
\DoxyCodeLine{39          \textcolor{comment}{/* FALLTHROUGH */}}
\DoxyCodeLine{40          \textcolor{keywordflow}{case} 4: ch += *in++; ch <<= 6;}
\DoxyCodeLine{41          \textcolor{comment}{/* FALLTHROUGH */}}
\DoxyCodeLine{42          \textcolor{keywordflow}{case} 3: ch += *in++; ch <<= 6;}
\DoxyCodeLine{43          \textcolor{comment}{/* FALLTHROUGH */}}
\DoxyCodeLine{44          \textcolor{keywordflow}{case} 2: ch += *in++; ch <<= 6;}
\DoxyCodeLine{45          \textcolor{comment}{/* FALLTHROUGH */}}
\DoxyCodeLine{46          \textcolor{keywordflow}{case} 1: ch += *in++; ch <<= 6;}
\DoxyCodeLine{47          \textcolor{comment}{/* FALLTHROUGH */}}
\DoxyCodeLine{48          \textcolor{keywordflow}{case} 0: ch += *in++;}
\DoxyCodeLine{49       \}}
\DoxyCodeLine{50       ch -= offset[extra];}
\DoxyCodeLine{51       \textcolor{keywordflow}{if} (ch > 0xFFFF) \textcolor{keywordflow}{goto} ERROR;}
\DoxyCodeLine{52       \textcolor{keywordflow}{if} (*outlen >= \mbox{\hyperlink{ocb__init_8c_afed088663f8704004425cdae2120b9b3}{len}} + 2) \{}
\DoxyCodeLine{53          out[\mbox{\hyperlink{ocb__init_8c_afed088663f8704004425cdae2120b9b3}{len}}] = (\textcolor{keywordtype}{unsigned} short)((ch >> 8) \& 0xFF);}
\DoxyCodeLine{54          out[\mbox{\hyperlink{ocb__init_8c_afed088663f8704004425cdae2120b9b3}{len}} + 1] = (\textcolor{keywordtype}{unsigned} char)(ch \& 0xFF);}
\DoxyCodeLine{55       \}}
\DoxyCodeLine{56       \mbox{\hyperlink{ocb__init_8c_afed088663f8704004425cdae2120b9b3}{len}} += 2;}
\DoxyCodeLine{57    \}}
\DoxyCodeLine{58 }
\DoxyCodeLine{59    err = \mbox{\hyperlink{ocb__init_8c_afed088663f8704004425cdae2120b9b3}{len}} > *outlen ? \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06caccd878f5599f3036ffe759dbe1a1ac16}{CRYPT\_BUFFER\_OVERFLOW}} : \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}};}
\DoxyCodeLine{60    *outlen = \mbox{\hyperlink{ocb__init_8c_afed088663f8704004425cdae2120b9b3}{len}};}
\DoxyCodeLine{61 ERROR:}
\DoxyCodeLine{62    \textcolor{keywordflow}{return} err;}
\DoxyCodeLine{63 \}}

\end{DoxyCode}


References C\+R\+Y\+P\+T\+\_\+\+B\+U\+F\+F\+E\+R\+\_\+\+O\+V\+E\+R\+F\+L\+OW, C\+R\+Y\+P\+T\+\_\+\+E\+R\+R\+OR, C\+R\+Y\+P\+T\+\_\+\+OK, len, and L\+T\+C\+\_\+\+A\+R\+G\+C\+HK.



Referenced by \+\_\+pkcs\+\_\+12\+\_\+wrap().

Here is the caller graph for this function\+:
% FIG 72
\mbox{\Hypertarget{tomcrypt__private_8h_a1b0d8fcf234d94638b2554ccea725003}\label{tomcrypt__private_8h_a1b0d8fcf234d94638b2554ccea725003}} 
\index{tomcrypt\_private.h@{tomcrypt\_private.h}!pkcs8\_decode\_flexi@{pkcs8\_decode\_flexi}}
\index{pkcs8\_decode\_flexi@{pkcs8\_decode\_flexi}!tomcrypt\_private.h@{tomcrypt\_private.h}}
\subsubsection{\texorpdfstring{pkcs8\_decode\_flexi()}{pkcs8\_decode\_flexi()}}
{\footnotesize\ttfamily int pkcs8\+\_\+decode\+\_\+flexi (\begin{DoxyParamCaption}\item[{const unsigned char $\ast$}]{in,  }\item[{unsigned long}]{inlen,  }\item[{const void $\ast$}]{pwd,  }\item[{unsigned long}]{pwdlen,  }\item[{ltc\+\_\+asn1\+\_\+list $\ast$$\ast$}]{decoded\+\_\+list }\end{DoxyParamCaption})}



P\+K\+CS\#8 decrypt if necessary \& flexi-\/decode. 


\begin{DoxyParams}{Parameters}
{\em in} & Pointer to the A\+S\+N.\+1 encoded input data \\
\hline
{\em inlen} & Length of the input data \\
\hline
{\em pwd} & Pointer to the password that was used when encrypting \\
\hline
{\em pwdlen} & Length of the password \\
\hline
{\em decoded\+\_\+list} & Pointer to a pointer for the flexi-\/decoded list \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
C\+R\+Y\+P\+T\+\_\+\+OK on success 
\end{DoxyReturn}


Definition at line 23 of file pkcs8\+\_\+decode\+\_\+flexi.\+c.


\begin{DoxyCode}{0}
\DoxyCodeLine{26 \{}
\DoxyCodeLine{27    \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} \mbox{\hyperlink{ocb__init_8c_afed088663f8704004425cdae2120b9b3}{len}} = inlen;}
\DoxyCodeLine{28    \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} dec\_size;}
\DoxyCodeLine{29    \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char} *dec\_data = NULL;}
\DoxyCodeLine{30    ltc\_asn1\_list *l = NULL;}
\DoxyCodeLine{31    \textcolor{keywordtype}{int} err;}
\DoxyCodeLine{32 }
\DoxyCodeLine{33    \mbox{\hyperlink{tomcrypt__argchk_8h_a683da3e041e49f196318b6ea951414ba}{LTC\_ARGCHK}}(in           != NULL);}
\DoxyCodeLine{34    \mbox{\hyperlink{tomcrypt__argchk_8h_a683da3e041e49f196318b6ea951414ba}{LTC\_ARGCHK}}(decoded\_list != NULL);}
\DoxyCodeLine{35 }
\DoxyCodeLine{36    *decoded\_list = NULL;}
\DoxyCodeLine{37    \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{der__decode__sequence__flexi_8c_acec68888a6eae3b64f54b37cfb43d9b1}{der\_decode\_sequence\_flexi}}(in, \&\mbox{\hyperlink{ocb__init_8c_afed088663f8704004425cdae2120b9b3}{len}}, \&l)) == \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}}) \{}
\DoxyCodeLine{38       \textcolor{comment}{/* the following "if" detects whether it is encrypted or not */}}
\DoxyCodeLine{39       \textcolor{comment}{/* PKCS8 Setup}}
\DoxyCodeLine{40 \textcolor{comment}{       *  0:d=0  hl=4 l= 380 cons: SEQUENCE}}
\DoxyCodeLine{41 \textcolor{comment}{       *  4:d=1  hl=2 l=  78 cons:   SEQUENCE}}
\DoxyCodeLine{42 \textcolor{comment}{       *  6:d=2  hl=2 l=   9 prim:     OBJECT             :OID indicating PBES1 or PBES2 (== *lalgoid)}}
\DoxyCodeLine{43 \textcolor{comment}{       * 17:d=2  hl=2 l=  65 cons:     SEQUENCE}}
\DoxyCodeLine{44 \textcolor{comment}{       *     Stuff in between is dependent on whether it's PBES1 or PBES2}}
\DoxyCodeLine{45 \textcolor{comment}{       * 84:d=1  hl=4 l= 296 prim:   OCTET STRING         :bytes (== encrypted data)}}
\DoxyCodeLine{46 \textcolor{comment}{       */}}
\DoxyCodeLine{47       \textcolor{keywordflow}{if} (l->type == LTC\_ASN1\_SEQUENCE \&\&}
\DoxyCodeLine{48           \mbox{\hyperlink{tomcrypt__private_8h_a896c8b07a35ff2799061855f08a8325a}{LTC\_ASN1\_IS\_TYPE}}(l->child, LTC\_ASN1\_SEQUENCE) \&\&}
\DoxyCodeLine{49           \mbox{\hyperlink{tomcrypt__private_8h_a896c8b07a35ff2799061855f08a8325a}{LTC\_ASN1\_IS\_TYPE}}(l->child->child, LTC\_ASN1\_OBJECT\_IDENTIFIER) \&\&}
\DoxyCodeLine{50           \mbox{\hyperlink{tomcrypt__private_8h_a896c8b07a35ff2799061855f08a8325a}{LTC\_ASN1\_IS\_TYPE}}(l->child->child->next, LTC\_ASN1\_SEQUENCE) \&\&}
\DoxyCodeLine{51           \mbox{\hyperlink{tomcrypt__private_8h_a896c8b07a35ff2799061855f08a8325a}{LTC\_ASN1\_IS\_TYPE}}(l->child->next, LTC\_ASN1\_OCTET\_STRING)) \{}
\DoxyCodeLine{52          ltc\_asn1\_list *lalgoid = l->child->child;}
\DoxyCodeLine{53          \mbox{\hyperlink{structpbes__arg}{pbes\_arg}} pbes;}
\DoxyCodeLine{54 }
\DoxyCodeLine{55          \mbox{\hyperlink{tomcrypt__cfg_8h_aa3c34a6f6c61de7da9258b5a30e32c2f}{XMEMSET}}(\&pbes, 0, \textcolor{keyword}{sizeof}(pbes));}
\DoxyCodeLine{56 }
\DoxyCodeLine{57          \textcolor{keywordflow}{if} (\mbox{\hyperlink{tomcrypt__private_8h_a3573423ba7eb454bb5f969ee9b580024}{pbes1\_extract}}(lalgoid, \&pbes) == \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}}) \{}
\DoxyCodeLine{58             \textcolor{comment}{/* Successfully extracted PBES1 parameters */}}
\DoxyCodeLine{59          \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (\mbox{\hyperlink{tomcrypt__private_8h_a741f04fef81b90c03eeba79d1d680273}{pbes2\_extract}}(lalgoid, \&pbes) == \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}}) \{}
\DoxyCodeLine{60             \textcolor{comment}{/* Successfully extracted PBES2 parameters */}}
\DoxyCodeLine{61          \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{62             \textcolor{comment}{/* unsupported encryption */}}
\DoxyCodeLine{63             err = \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06ca980088f10ffe9009aec286038a9e79da}{CRYPT\_INVALID\_PACKET}};}
\DoxyCodeLine{64             \textcolor{keywordflow}{goto} LBL\_DONE;}
\DoxyCodeLine{65          \}}
\DoxyCodeLine{66 }
\DoxyCodeLine{67          pbes.\mbox{\hyperlink{structpbes__arg_a8e69f095d7a7e8f5fad6fa49ea2d0d00}{enc\_data}} = l->child->next;}
\DoxyCodeLine{68          pbes.\mbox{\hyperlink{structpbes__arg_a146b6c8875be0a3ac9f426327e83186a}{pwd}} = pwd;}
\DoxyCodeLine{69          pbes.\mbox{\hyperlink{structpbes__arg_a6f7f1324f1acfd51dcc7c1e334db7e0a}{pwdlen}} = pwdlen;}
\DoxyCodeLine{70 }
\DoxyCodeLine{71          dec\_size = pbes.\mbox{\hyperlink{structpbes__arg_a8e69f095d7a7e8f5fad6fa49ea2d0d00}{enc\_data}}->size;}
\DoxyCodeLine{72          \textcolor{keywordflow}{if} ((dec\_data = \mbox{\hyperlink{tomcrypt__cfg_8h_af363355f38fbaacdefacf270436ae1c9}{XMALLOC}}(dec\_size)) == NULL) \{}
\DoxyCodeLine{73             err = \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06ca0ce0d27adc7ea10b74b7ea904b8bfa82}{CRYPT\_MEM}};}
\DoxyCodeLine{74             \textcolor{keywordflow}{goto} LBL\_DONE;}
\DoxyCodeLine{75          \}}
\DoxyCodeLine{76 }
\DoxyCodeLine{77          \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{tomcrypt__private_8h_a7df0f8ba7d5d6b9752a7bb9c5e3f7081}{pbes\_decrypt}}(\&pbes, dec\_data, \&dec\_size)) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}}) \textcolor{keywordflow}{goto} LBL\_DONE;}
\DoxyCodeLine{78 }
\DoxyCodeLine{79          der\_free\_sequence\_flexi(l);}
\DoxyCodeLine{80          l = NULL;}
\DoxyCodeLine{81          err = \mbox{\hyperlink{der__decode__sequence__flexi_8c_acec68888a6eae3b64f54b37cfb43d9b1}{der\_decode\_sequence\_flexi}}(dec\_data, \&dec\_size, \&l);}
\DoxyCodeLine{82          \textcolor{keywordflow}{if} (err != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}}) \textcolor{keywordflow}{goto} LBL\_DONE;}
\DoxyCodeLine{83          *decoded\_list = l;}
\DoxyCodeLine{84       \}}
\DoxyCodeLine{85       \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{86          \textcolor{comment}{/* not encrypted */}}
\DoxyCodeLine{87          err = \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}};}
\DoxyCodeLine{88          *decoded\_list = l;}
\DoxyCodeLine{89       \}}
\DoxyCodeLine{90       \textcolor{comment}{/* Set l to NULL so it won't be free'd */}}
\DoxyCodeLine{91       l = NULL;}
\DoxyCodeLine{92    \}}
\DoxyCodeLine{93 }
\DoxyCodeLine{94 LBL\_DONE:}
\DoxyCodeLine{95    \textcolor{keywordflow}{if} (l) der\_free\_sequence\_flexi(l);}
\DoxyCodeLine{96    \textcolor{keywordflow}{if} (dec\_data) \{}
\DoxyCodeLine{97       \mbox{\hyperlink{tomcrypt__misc_8h_a63b6e188713790263bfd3612fe8b398f}{zeromem}}(dec\_data, dec\_size);}
\DoxyCodeLine{98       \mbox{\hyperlink{tomcrypt__cfg_8h_a260d66fc0690e0502cf3bfe7b5244b75}{XFREE}}(dec\_data);}
\DoxyCodeLine{99    \}}
\DoxyCodeLine{100    \textcolor{keywordflow}{return} err;}
\DoxyCodeLine{101 \}}

\end{DoxyCode}


References C\+R\+Y\+P\+T\+\_\+\+I\+N\+V\+A\+L\+I\+D\+\_\+\+P\+A\+C\+K\+ET, C\+R\+Y\+P\+T\+\_\+\+M\+EM, C\+R\+Y\+P\+T\+\_\+\+OK, der\+\_\+decode\+\_\+sequence\+\_\+flexi(), pbes\+\_\+arg\+::enc\+\_\+data, len, L\+T\+C\+\_\+\+A\+R\+G\+C\+HK, L\+T\+C\+\_\+\+A\+S\+N1\+\_\+\+I\+S\+\_\+\+T\+Y\+PE, pbes1\+\_\+extract(), pbes2\+\_\+extract(), pbes\+\_\+decrypt(), pbes\+\_\+arg\+::pwd, pbes\+\_\+arg\+::pwdlen, X\+F\+R\+E\+E(), X\+M\+A\+L\+L\+O\+C(), X\+M\+E\+M\+S\+E\+T(), and zeromem().



Referenced by ecc\+\_\+import\+\_\+pkcs8(), and rsa\+\_\+import\+\_\+pkcs8().

Here is the call graph for this function\+:
% FIG 73
Here is the caller graph for this function\+:
% FIG 74
\mbox{\Hypertarget{tomcrypt__private_8h_a5a58a92a44e093e5b35960f7b92a6eb9}\label{tomcrypt__private_8h_a5a58a92a44e093e5b35960f7b92a6eb9}} 
\index{tomcrypt\_private.h@{tomcrypt\_private.h}!rand\_bn\_bits@{rand\_bn\_bits}}
\index{rand\_bn\_bits@{rand\_bn\_bits}!tomcrypt\_private.h@{tomcrypt\_private.h}}
\subsubsection{\texorpdfstring{rand\_bn\_bits()}{rand\_bn\_bits()}}
{\footnotesize\ttfamily int rand\+\_\+bn\+\_\+bits (\begin{DoxyParamCaption}\item[{void $\ast$}]{N,  }\item[{int}]{bits,  }\item[{\mbox{\hyperlink{structprng__state}{prng\+\_\+state}} $\ast$}]{prng,  }\item[{int}]{wprng }\end{DoxyParamCaption})}



Generate a random number N with given bitlength (note\+: M\+SB can be 0) 



Definition at line 16 of file rand\+\_\+bn.\+c.


\begin{DoxyCode}{0}
\DoxyCodeLine{17 \{}
\DoxyCodeLine{18    \textcolor{keywordtype}{int} res, bytes;}
\DoxyCodeLine{19    \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char} *buf, \mbox{\hyperlink{gcm__gf__mult_8c_a3a2325b458f400e186d773b14e6c1ed9}{mask}};}
\DoxyCodeLine{20 }
\DoxyCodeLine{21    \mbox{\hyperlink{tomcrypt__argchk_8h_a683da3e041e49f196318b6ea951414ba}{LTC\_ARGCHK}}(\mbox{\hyperlink{sober128__stream_8c_a0240ac851181b84ac374872dc5434ee4}{N}} != NULL);}
\DoxyCodeLine{22    \mbox{\hyperlink{tomcrypt__argchk_8h_a683da3e041e49f196318b6ea951414ba}{LTC\_ARGCHK}}(bits > 1);}
\DoxyCodeLine{23 }
\DoxyCodeLine{24    \textcolor{comment}{/* check PRNG */}}
\DoxyCodeLine{25    \textcolor{keywordflow}{if} ((res = \mbox{\hyperlink{tomcrypt__prng_8h_a7e4a212c1a29a3b8bb4f8d5a34676a1e}{prng\_is\_valid}}(wprng)) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}}) \textcolor{keywordflow}{return} res;}
\DoxyCodeLine{26 }
\DoxyCodeLine{27    bytes = (bits+7) >> 3;}
\DoxyCodeLine{28    \mbox{\hyperlink{gcm__gf__mult_8c_a3a2325b458f400e186d773b14e6c1ed9}{mask}} = 0xff << (8 - bits \% 8);}
\DoxyCodeLine{29 }
\DoxyCodeLine{30    \textcolor{comment}{/* allocate buffer */}}
\DoxyCodeLine{31    \textcolor{keywordflow}{if} ((buf = \mbox{\hyperlink{tomcrypt__cfg_8h_a151dda14cd7acae31eaf1102b0cc0685}{XCALLOC}}(1, bytes)) == NULL) \textcolor{keywordflow}{return} \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06ca0ce0d27adc7ea10b74b7ea904b8bfa82}{CRYPT\_MEM}};}
\DoxyCodeLine{32 }
\DoxyCodeLine{33    \textcolor{comment}{/* generate random bytes */}}
\DoxyCodeLine{34    \textcolor{keywordflow}{if} (\mbox{\hyperlink{tomcrypt__prng_8h_ac03ee9f603bf966f3afb3f6be156239b}{prng\_descriptor}}[wprng].read(buf, bytes, prng) != (\textcolor{keywordtype}{unsigned} long)bytes) \{}
\DoxyCodeLine{35       res = \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06ca68eea82b3b71f23031cd94b10c920bf3}{CRYPT\_ERROR\_READPRNG}};}
\DoxyCodeLine{36       \textcolor{keywordflow}{goto} cleanup;}
\DoxyCodeLine{37    \}}
\DoxyCodeLine{38    \textcolor{comment}{/* mask bits */}}
\DoxyCodeLine{39    buf[0] \&= ~\mbox{\hyperlink{gcm__gf__mult_8c_a3a2325b458f400e186d773b14e6c1ed9}{mask}};}
\DoxyCodeLine{40    \textcolor{comment}{/* load value */}}
\DoxyCodeLine{41    \textcolor{keywordflow}{if} ((res = \mbox{\hyperlink{tomcrypt__private_8h_a9e20e2044bb5a279e27512d1e1b65754}{mp\_read\_unsigned\_bin}}(\mbox{\hyperlink{sober128__stream_8c_a0240ac851181b84ac374872dc5434ee4}{N}}, buf, bytes)) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}}) \textcolor{keywordflow}{goto} cleanup;}
\DoxyCodeLine{42 }
\DoxyCodeLine{43    res = \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}};}
\DoxyCodeLine{44 }
\DoxyCodeLine{45 cleanup:}
\DoxyCodeLine{46 \textcolor{preprocessor}{\#ifdef LTC\_CLEAN\_STACK}}
\DoxyCodeLine{47    \mbox{\hyperlink{tomcrypt__misc_8h_a63b6e188713790263bfd3612fe8b398f}{zeromem}}(buf, bytes);}
\DoxyCodeLine{48 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{49    \mbox{\hyperlink{tomcrypt__cfg_8h_a260d66fc0690e0502cf3bfe7b5244b75}{XFREE}}(buf);}
\DoxyCodeLine{50    \textcolor{keywordflow}{return} res;}
\DoxyCodeLine{51 \}}

\end{DoxyCode}


References C\+R\+Y\+P\+T\+\_\+\+E\+R\+R\+O\+R\+\_\+\+R\+E\+A\+D\+P\+R\+NG, C\+R\+Y\+P\+T\+\_\+\+M\+EM, C\+R\+Y\+P\+T\+\_\+\+OK, L\+T\+C\+\_\+\+A\+R\+G\+C\+HK, mask, mp\+\_\+read\+\_\+unsigned\+\_\+bin, N, prng\+\_\+descriptor, prng\+\_\+is\+\_\+valid(), X\+C\+A\+L\+L\+O\+C(), X\+F\+R\+E\+E(), and zeromem().



Referenced by \+\_\+dsa\+\_\+make\+\_\+params(), dsa\+\_\+sign\+\_\+hash\+\_\+raw(), and rand\+\_\+bn\+\_\+upto().

Here is the call graph for this function\+:
% FIG 75
Here is the caller graph for this function\+:
% FIG 76
\mbox{\Hypertarget{tomcrypt__private_8h_a8050acf530841fb2da3b667204039856}\label{tomcrypt__private_8h_a8050acf530841fb2da3b667204039856}} 
\index{tomcrypt\_private.h@{tomcrypt\_private.h}!rand\_bn\_upto@{rand\_bn\_upto}}
\index{rand\_bn\_upto@{rand\_bn\_upto}!tomcrypt\_private.h@{tomcrypt\_private.h}}
\subsubsection{\texorpdfstring{rand\_bn\_upto()}{rand\_bn\_upto()}}
{\footnotesize\ttfamily int rand\+\_\+bn\+\_\+upto (\begin{DoxyParamCaption}\item[{void $\ast$}]{N,  }\item[{void $\ast$}]{limit,  }\item[{\mbox{\hyperlink{structprng__state}{prng\+\_\+state}} $\ast$}]{prng,  }\item[{int}]{wprng }\end{DoxyParamCaption})}



Generate a random number N in a range\+: 1 $<$= N $<$ limit. 



Definition at line 56 of file rand\+\_\+bn.\+c.


\begin{DoxyCode}{0}
\DoxyCodeLine{57 \{}
\DoxyCodeLine{58    \textcolor{keywordtype}{int} res, bits;}
\DoxyCodeLine{59 }
\DoxyCodeLine{60    \mbox{\hyperlink{tomcrypt__argchk_8h_a683da3e041e49f196318b6ea951414ba}{LTC\_ARGCHK}}(\mbox{\hyperlink{sober128__stream_8c_a0240ac851181b84ac374872dc5434ee4}{N}} != NULL);}
\DoxyCodeLine{61    \mbox{\hyperlink{tomcrypt__argchk_8h_a683da3e041e49f196318b6ea951414ba}{LTC\_ARGCHK}}(limit != NULL);}
\DoxyCodeLine{62 }
\DoxyCodeLine{63    bits = \mbox{\hyperlink{tomcrypt__private_8h_afa1671e20e699f66319ed2e8d9119e7e}{mp\_count\_bits}}(limit);}
\DoxyCodeLine{64    \textcolor{keywordflow}{do} \{}
\DoxyCodeLine{65      res = \mbox{\hyperlink{rand__bn_8c_a5a58a92a44e093e5b35960f7b92a6eb9}{rand\_bn\_bits}}(\mbox{\hyperlink{sober128__stream_8c_a0240ac851181b84ac374872dc5434ee4}{N}}, bits, prng, wprng);}
\DoxyCodeLine{66      \textcolor{keywordflow}{if} (res != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}}) \textcolor{keywordflow}{return} res;}
\DoxyCodeLine{67    \} \textcolor{keywordflow}{while} (\mbox{\hyperlink{tomcrypt__private_8h_a6ce44f2e6f872565a468b67d9a93dc28}{mp\_cmp\_d}}(\mbox{\hyperlink{sober128__stream_8c_a0240ac851181b84ac374872dc5434ee4}{N}}, 0) != \mbox{\hyperlink{tomcrypt__math_8h_adff156a960d44f0f5b67b75ef1f1c29b}{LTC\_MP\_GT}} || \mbox{\hyperlink{tomcrypt__private_8h_a62ea02fbe7dd2d456e49520264d775ee}{mp\_cmp}}(\mbox{\hyperlink{sober128__stream_8c_a0240ac851181b84ac374872dc5434ee4}{N}}, limit) != \mbox{\hyperlink{tomcrypt__math_8h_a42d0c7d4c09793df79660774d3436db2}{LTC\_MP\_LT}});}
\DoxyCodeLine{68 }
\DoxyCodeLine{69    \textcolor{keywordflow}{return} \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}};}
\DoxyCodeLine{70 \}}

\end{DoxyCode}


References C\+R\+Y\+P\+T\+\_\+\+OK, L\+T\+C\+\_\+\+A\+R\+G\+C\+HK, L\+T\+C\+\_\+\+M\+P\+\_\+\+GT, L\+T\+C\+\_\+\+M\+P\+\_\+\+LT, mp\+\_\+cmp, mp\+\_\+cmp\+\_\+d, mp\+\_\+count\+\_\+bits, N, and rand\+\_\+bn\+\_\+bits().



Referenced by dsa\+\_\+encrypt\+\_\+key(), dsa\+\_\+generate\+\_\+key(), ecc\+\_\+generate\+\_\+key(), and ecc\+\_\+sign\+\_\+hash\+\_\+ex().

Here is the call graph for this function\+:
% FIG 77
Here is the caller graph for this function\+:
% FIG 78
\mbox{\Hypertarget{tomcrypt__private_8h_aec241d5f502a71d5a72188a42d6be5f0}\label{tomcrypt__private_8h_aec241d5f502a71d5a72188a42d6be5f0}} 
\index{tomcrypt\_private.h@{tomcrypt\_private.h}!x509\_decode\_subject\_public\_key\_info@{x509\_decode\_subject\_public\_key\_info}}
\index{x509\_decode\_subject\_public\_key\_info@{x509\_decode\_subject\_public\_key\_info}!tomcrypt\_private.h@{tomcrypt\_private.h}}
\subsubsection{\texorpdfstring{x509\_decode\_subject\_public\_key\_info()}{x509\_decode\_subject\_public\_key\_info()}}
{\footnotesize\ttfamily int x509\+\_\+decode\+\_\+subject\+\_\+public\+\_\+key\+\_\+info (\begin{DoxyParamCaption}\item[{const unsigned char $\ast$}]{in,  }\item[{unsigned long}]{inlen,  }\item[{unsigned int}]{algorithm,  }\item[{void $\ast$}]{public\+\_\+key,  }\item[{unsigned long $\ast$}]{public\+\_\+key\+\_\+len,  }\item[{ltc\+\_\+asn1\+\_\+type}]{parameters\+\_\+type,  }\item[{ltc\+\_\+asn1\+\_\+list $\ast$}]{parameters,  }\item[{unsigned long $\ast$}]{parameters\+\_\+len }\end{DoxyParamCaption})}



Decode a Subject\+Public\+Key\+Info. 


\begin{DoxyParams}{Parameters}
{\em in} & The input buffer \\
\hline
{\em inlen} & The length of the input buffer \\
\hline
{\em algorithm} & One out of the enum \#public\+\_\+key\+\_\+algorithms \\
\hline
{\em public\+\_\+key} & The buffer for the public key \\
\hline
{\em public\+\_\+key\+\_\+len} & \mbox{[}in/out\mbox{]} The length of the public key buffer and the written length \\
\hline
{\em parameters\+\_\+type} & The parameters\textquotesingle{} type out of the enum ltc\+\_\+asn1\+\_\+type \\
\hline
{\em parameters} & The parameters to include \\
\hline
{\em parameters\+\_\+len} & \mbox{[}in/out\mbox{]}The number of parameters to include \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
C\+R\+Y\+P\+T\+\_\+\+OK on success 
\end{DoxyReturn}


Definition at line 40 of file x509\+\_\+decode\+\_\+subject\+\_\+public\+\_\+key\+\_\+info.\+c.


\begin{DoxyCode}{0}
\DoxyCodeLine{43 \{}
\DoxyCodeLine{44    \textcolor{keywordtype}{int} err;}
\DoxyCodeLine{45    \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} \mbox{\hyperlink{ocb__init_8c_afed088663f8704004425cdae2120b9b3}{len}}, alg\_id\_num;}
\DoxyCodeLine{46    \textcolor{keyword}{const} \textcolor{keywordtype}{char}* oid;}
\DoxyCodeLine{47    \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char} *tmpbuf;}
\DoxyCodeLine{48    \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long}  tmpoid[16];}
\DoxyCodeLine{49    ltc\_asn1\_list alg\_id[2];}
\DoxyCodeLine{50    ltc\_asn1\_list subject\_pubkey[2];}
\DoxyCodeLine{51 }
\DoxyCodeLine{52    \mbox{\hyperlink{tomcrypt__argchk_8h_a683da3e041e49f196318b6ea951414ba}{LTC\_ARGCHK}}(in    != NULL);}
\DoxyCodeLine{53    \mbox{\hyperlink{tomcrypt__argchk_8h_a683da3e041e49f196318b6ea951414ba}{LTC\_ARGCHK}}(inlen != 0);}
\DoxyCodeLine{54    \mbox{\hyperlink{tomcrypt__argchk_8h_a683da3e041e49f196318b6ea951414ba}{LTC\_ARGCHK}}(public\_key\_len != NULL);}
\DoxyCodeLine{55    \textcolor{keywordflow}{if} (parameters\_type != LTC\_ASN1\_EOL) \{}
\DoxyCodeLine{56       \mbox{\hyperlink{tomcrypt__argchk_8h_a683da3e041e49f196318b6ea951414ba}{LTC\_ARGCHK}}(parameters\_len != NULL);}
\DoxyCodeLine{57    \}}
\DoxyCodeLine{58 }
\DoxyCodeLine{59    err = \mbox{\hyperlink{tomcrypt__private_8h_acff5b3d0c6e1145e07d1a3ff53fadce5}{pk\_get\_oid}}(algorithm, \&oid);}
\DoxyCodeLine{60    \textcolor{keywordflow}{if} (err != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}}) \{}
\DoxyCodeLine{61         \textcolor{keywordflow}{return} err;}
\DoxyCodeLine{62    \}}
\DoxyCodeLine{63 }
\DoxyCodeLine{64    \textcolor{comment}{/* see if the OpenSSL DER format RSA public key will work */}}
\DoxyCodeLine{65    tmpbuf = \mbox{\hyperlink{tomcrypt__cfg_8h_a151dda14cd7acae31eaf1102b0cc0685}{XCALLOC}}(1, inlen);}
\DoxyCodeLine{66    \textcolor{keywordflow}{if} (tmpbuf == NULL) \{}
\DoxyCodeLine{67        err = \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06ca0ce0d27adc7ea10b74b7ea904b8bfa82}{CRYPT\_MEM}};}
\DoxyCodeLine{68        \textcolor{keywordflow}{goto} LBL\_ERR;}
\DoxyCodeLine{69    \}}
\DoxyCodeLine{70 }
\DoxyCodeLine{71    \textcolor{comment}{/* this includes the internal hash ID and optional params (NULL in this case) */}}
\DoxyCodeLine{72    LTC\_SET\_ASN1(alg\_id, 0, LTC\_ASN1\_OBJECT\_IDENTIFIER, tmpoid, \textcolor{keyword}{sizeof}(tmpoid)/\textcolor{keyword}{sizeof}(tmpoid[0]));}
\DoxyCodeLine{73    \textcolor{keywordflow}{if} (parameters\_type == LTC\_ASN1\_EOL) \{}
\DoxyCodeLine{74       alg\_id\_num = 1;}
\DoxyCodeLine{75    \}}
\DoxyCodeLine{76    \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{77       LTC\_SET\_ASN1(alg\_id, 1, parameters\_type, parameters, *parameters\_len);}
\DoxyCodeLine{78       alg\_id\_num = 2;}
\DoxyCodeLine{79    \}}
\DoxyCodeLine{80 }
\DoxyCodeLine{81    \textcolor{comment}{/* the actual format of the SSL DER key is odd, it stores a RSAPublicKey}}
\DoxyCodeLine{82 \textcolor{comment}{    * in a **BIT** string ... so we have to extract it then proceed to convert bit to octet}}
\DoxyCodeLine{83 \textcolor{comment}{    */}}
\DoxyCodeLine{84    LTC\_SET\_ASN1(subject\_pubkey, 0, LTC\_ASN1\_SEQUENCE, alg\_id, alg\_id\_num);}
\DoxyCodeLine{85    LTC\_SET\_ASN1(subject\_pubkey, 1, LTC\_ASN1\_RAW\_BIT\_STRING, tmpbuf, inlen*8U);}
\DoxyCodeLine{86 }
\DoxyCodeLine{87    err=der\_decode\_sequence(in, inlen, subject\_pubkey, 2UL);}
\DoxyCodeLine{88    \textcolor{keywordflow}{if} (err != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}}) \{}
\DoxyCodeLine{89            \textcolor{keywordflow}{goto} LBL\_ERR;}
\DoxyCodeLine{90    \}}
\DoxyCodeLine{91    \textcolor{keywordflow}{if} (parameters\_type != LTC\_ASN1\_EOL) \{}
\DoxyCodeLine{92       *parameters\_len = alg\_id[1].size;}
\DoxyCodeLine{93    \}}
\DoxyCodeLine{94 }
\DoxyCodeLine{95    \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{tomcrypt__private_8h_aaa860b1fbc776e0760df8934a6aa245a}{pk\_oid\_cmp\_with\_asn1}}(oid, \&alg\_id[0])) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}}) \{}
\DoxyCodeLine{96       \textcolor{comment}{/* OID mismatch */}}
\DoxyCodeLine{97       \textcolor{keywordflow}{goto} LBL\_ERR;}
\DoxyCodeLine{98    \}}
\DoxyCodeLine{99 }
\DoxyCodeLine{100    \mbox{\hyperlink{ocb__init_8c_afed088663f8704004425cdae2120b9b3}{len}} = subject\_pubkey[1].size/8;}
\DoxyCodeLine{101    \textcolor{keywordflow}{if} (*public\_key\_len >= \mbox{\hyperlink{ocb__init_8c_afed088663f8704004425cdae2120b9b3}{len}}) \{}
\DoxyCodeLine{102        \mbox{\hyperlink{tomcrypt__cfg_8h_a7691dd48d60d5fc6daf2fa7ec4c55e12}{XMEMCPY}}(public\_key, subject\_pubkey[1].data, \mbox{\hyperlink{ocb__init_8c_afed088663f8704004425cdae2120b9b3}{len}});}
\DoxyCodeLine{103        *public\_key\_len = \mbox{\hyperlink{ocb__init_8c_afed088663f8704004425cdae2120b9b3}{len}};}
\DoxyCodeLine{104     \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{105         *public\_key\_len = \mbox{\hyperlink{ocb__init_8c_afed088663f8704004425cdae2120b9b3}{len}};}
\DoxyCodeLine{106         err = \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06caccd878f5599f3036ffe759dbe1a1ac16}{CRYPT\_BUFFER\_OVERFLOW}};}
\DoxyCodeLine{107         \textcolor{keywordflow}{goto} LBL\_ERR;}
\DoxyCodeLine{108     \}}
\DoxyCodeLine{109 }
\DoxyCodeLine{110     err = \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}};}
\DoxyCodeLine{111 }
\DoxyCodeLine{112 LBL\_ERR:}
\DoxyCodeLine{113 }
\DoxyCodeLine{114     \mbox{\hyperlink{tomcrypt__cfg_8h_a260d66fc0690e0502cf3bfe7b5244b75}{XFREE}}(tmpbuf);}
\DoxyCodeLine{115 }
\DoxyCodeLine{116     \textcolor{keywordflow}{return} err;}
\DoxyCodeLine{117 \}}

\end{DoxyCode}


References C\+R\+Y\+P\+T\+\_\+\+B\+U\+F\+F\+E\+R\+\_\+\+O\+V\+E\+R\+F\+L\+OW, C\+R\+Y\+P\+T\+\_\+\+M\+EM, C\+R\+Y\+P\+T\+\_\+\+OK, len, L\+T\+C\+\_\+\+A\+R\+G\+C\+HK, pk\+\_\+get\+\_\+oid(), pk\+\_\+oid\+\_\+cmp\+\_\+with\+\_\+asn1(), X\+C\+A\+L\+L\+O\+C(), X\+F\+R\+E\+E(), and X\+M\+E\+M\+C\+P\+Y().



Referenced by \+\_\+ecc\+\_\+import\+\_\+x509\+\_\+with\+\_\+curve(), \+\_\+ecc\+\_\+import\+\_\+x509\+\_\+with\+\_\+oid(), dsa\+\_\+import(), rsa\+\_\+import(), and rsa\+\_\+import\+\_\+x509().

Here is the call graph for this function\+:
% FIG 79
Here is the caller graph for this function\+:
% FIG 80
\mbox{\Hypertarget{tomcrypt__private_8h_a69644f00dd0825d15c8c799c46ef6ece}\label{tomcrypt__private_8h_a69644f00dd0825d15c8c799c46ef6ece}} 
\index{tomcrypt\_private.h@{tomcrypt\_private.h}!x509\_encode\_subject\_public\_key\_info@{x509\_encode\_subject\_public\_key\_info}}
\index{x509\_encode\_subject\_public\_key\_info@{x509\_encode\_subject\_public\_key\_info}!tomcrypt\_private.h@{tomcrypt\_private.h}}
\subsubsection{\texorpdfstring{x509\_encode\_subject\_public\_key\_info()}{x509\_encode\_subject\_public\_key\_info()}}
{\footnotesize\ttfamily int x509\+\_\+encode\+\_\+subject\+\_\+public\+\_\+key\+\_\+info (\begin{DoxyParamCaption}\item[{unsigned char $\ast$}]{out,  }\item[{unsigned long $\ast$}]{outlen,  }\item[{unsigned int}]{algorithm,  }\item[{const void $\ast$}]{public\+\_\+key,  }\item[{unsigned long}]{public\+\_\+key\+\_\+len,  }\item[{ltc\+\_\+asn1\+\_\+type}]{parameters\+\_\+type,  }\item[{ltc\+\_\+asn1\+\_\+list $\ast$}]{parameters,  }\item[{unsigned long}]{parameters\+\_\+len }\end{DoxyParamCaption})}



Encode a Subject\+Public\+Key\+Info. 


\begin{DoxyParams}{Parameters}
{\em out} & The output buffer \\
\hline
{\em outlen} & \mbox{[}in/out\mbox{]} Length of buffer and resulting length of output \\
\hline
{\em algorithm} & One out of the enum \#public\+\_\+key\+\_\+algorithms \\
\hline
{\em public\+\_\+key} & The buffer for the public key \\
\hline
{\em public\+\_\+key\+\_\+len} & The length of the public key buffer \\
\hline
{\em parameters\+\_\+type} & The parameters\textquotesingle{} type out of the enum ltc\+\_\+asn1\+\_\+type \\
\hline
{\em parameters} & The parameters to include \\
\hline
{\em parameters\+\_\+len} & The number of parameters to include \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
C\+R\+Y\+P\+T\+\_\+\+OK on success 
\end{DoxyReturn}


Definition at line 40 of file x509\+\_\+encode\+\_\+subject\+\_\+public\+\_\+key\+\_\+info.\+c.


\begin{DoxyCode}{0}
\DoxyCodeLine{43 \{}
\DoxyCodeLine{44    \textcolor{keywordtype}{int}           err;}
\DoxyCodeLine{45    ltc\_asn1\_list alg\_id[2];}
\DoxyCodeLine{46    \textcolor{keyword}{const} \textcolor{keywordtype}{char} *\mbox{\hyperlink{ecc__find__curve_8c_a3b9aae9990e63034f7d199729f025b23}{OID}};}
\DoxyCodeLine{47    \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} oid[16], oidlen;}
\DoxyCodeLine{48 }
\DoxyCodeLine{49    \mbox{\hyperlink{tomcrypt__argchk_8h_a683da3e041e49f196318b6ea951414ba}{LTC\_ARGCHK}}(out    != NULL);}
\DoxyCodeLine{50    \mbox{\hyperlink{tomcrypt__argchk_8h_a683da3e041e49f196318b6ea951414ba}{LTC\_ARGCHK}}(outlen != NULL);}
\DoxyCodeLine{51 }
\DoxyCodeLine{52    \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{tomcrypt__private_8h_acff5b3d0c6e1145e07d1a3ff53fadce5}{pk\_get\_oid}}(algorithm, \&\mbox{\hyperlink{ecc__find__curve_8c_a3b9aae9990e63034f7d199729f025b23}{OID}})) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}}) \{}
\DoxyCodeLine{53         \textcolor{keywordflow}{return} err;}
\DoxyCodeLine{54    \}}
\DoxyCodeLine{55 }
\DoxyCodeLine{56    oidlen = \textcolor{keyword}{sizeof}(oid)/\textcolor{keyword}{sizeof}(oid[0]);}
\DoxyCodeLine{57    \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{tomcrypt__private_8h_ad99c87d19f50f703708d36a931fe5df6}{pk\_oid\_str\_to\_num}}(\mbox{\hyperlink{ecc__find__curve_8c_a3b9aae9990e63034f7d199729f025b23}{OID}}, oid, \&oidlen)) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}}) \{}
\DoxyCodeLine{58       \textcolor{keywordflow}{return} err;}
\DoxyCodeLine{59    \}}
\DoxyCodeLine{60 }
\DoxyCodeLine{61    LTC\_SET\_ASN1(alg\_id, 0, LTC\_ASN1\_OBJECT\_IDENTIFIER, oid,        oidlen);}
\DoxyCodeLine{62    LTC\_SET\_ASN1(alg\_id, 1, parameters\_type,            parameters, parameters\_len);}
\DoxyCodeLine{63 }
\DoxyCodeLine{64    \textcolor{keywordflow}{return} \mbox{\hyperlink{der__encode__sequence__multi_8c_a1a5a69543a5c89f81560b52d6f11b8c5}{der\_encode\_sequence\_multi}}(out, outlen,}
\DoxyCodeLine{65         LTC\_ASN1\_SEQUENCE, (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long})\textcolor{keyword}{sizeof}(alg\_id)/\textcolor{keyword}{sizeof}(alg\_id[0]), alg\_id,}
\DoxyCodeLine{66         LTC\_ASN1\_RAW\_BIT\_STRING, public\_key\_len*8U, public\_key,}
\DoxyCodeLine{67         LTC\_ASN1\_EOL,     0UL, NULL);}
\DoxyCodeLine{68 }
\DoxyCodeLine{69 \}}

\end{DoxyCode}


References C\+R\+Y\+P\+T\+\_\+\+OK, der\+\_\+encode\+\_\+sequence\+\_\+multi(), L\+T\+C\+\_\+\+A\+R\+G\+C\+HK, O\+ID, pk\+\_\+get\+\_\+oid(), and pk\+\_\+oid\+\_\+str\+\_\+to\+\_\+num().



Referenced by dsa\+\_\+export(), ecc\+\_\+export\+\_\+openssl(), and rsa\+\_\+export().

Here is the call graph for this function\+:
% FIG 81
Here is the caller graph for this function\+:
% FIG 82


\subsection{Variable Documentation}
\mbox{\Hypertarget{tomcrypt__private_8h_a411f77ba949e37dca9c1ef1e43127cb1}\label{tomcrypt__private_8h_a411f77ba949e37dca9c1ef1e43127cb1}} 
\index{tomcrypt\_private.h@{tomcrypt\_private.h}!der\_asn1\_tag\_to\_type\_map@{der\_asn1\_tag\_to\_type\_map}}
\index{der\_asn1\_tag\_to\_type\_map@{der\_asn1\_tag\_to\_type\_map}!tomcrypt\_private.h@{tomcrypt\_private.h}}
\subsubsection{\texorpdfstring{der\_asn1\_tag\_to\_type\_map}{der\_asn1\_tag\_to\_type\_map}}
{\footnotesize\ttfamily const ltc\+\_\+asn1\+\_\+type der\+\_\+asn1\+\_\+tag\+\_\+to\+\_\+type\+\_\+map\mbox{[}$\,$\mbox{]}}



A Map from A\+S\+N.\+1 Tags to ltc\+\_\+asn1\+\_\+type. 



Definition at line 120 of file der\+\_\+asn1\+\_\+maps.\+c.



Referenced by der\+\_\+decode\+\_\+asn1\+\_\+identifier().

\mbox{\Hypertarget{tomcrypt__private_8h_a6ad32891f744af2b205041ad6dc5bce0}\label{tomcrypt__private_8h_a6ad32891f744af2b205041ad6dc5bce0}} 
\index{tomcrypt\_private.h@{tomcrypt\_private.h}!der\_asn1\_tag\_to\_type\_map\_sz@{der\_asn1\_tag\_to\_type\_map\_sz}}
\index{der\_asn1\_tag\_to\_type\_map\_sz@{der\_asn1\_tag\_to\_type\_map\_sz}!tomcrypt\_private.h@{tomcrypt\_private.h}}
\subsubsection{\texorpdfstring{der\_asn1\_tag\_to\_type\_map\_sz}{der\_asn1\_tag\_to\_type\_map\_sz}}
{\footnotesize\ttfamily const unsigned long der\+\_\+asn1\+\_\+tag\+\_\+to\+\_\+type\+\_\+map\+\_\+sz}



Definition at line 161 of file der\+\_\+asn1\+\_\+maps.\+c.



Referenced by der\+\_\+decode\+\_\+asn1\+\_\+identifier().

\mbox{\Hypertarget{tomcrypt__private_8h_a6306ca88074facac89ee0f6c04cbf2f2}\label{tomcrypt__private_8h_a6306ca88074facac89ee0f6c04cbf2f2}} 
\index{tomcrypt\_private.h@{tomcrypt\_private.h}!der\_asn1\_type\_to\_identifier\_map@{der\_asn1\_type\_to\_identifier\_map}}
\index{der\_asn1\_type\_to\_identifier\_map@{der\_asn1\_type\_to\_identifier\_map}!tomcrypt\_private.h@{tomcrypt\_private.h}}
\subsubsection{\texorpdfstring{der\_asn1\_type\_to\_identifier\_map}{der\_asn1\_type\_to\_identifier\_map}}
{\footnotesize\ttfamily const int der\+\_\+asn1\+\_\+type\+\_\+to\+\_\+identifier\+\_\+map\mbox{[}$\,$\mbox{]}}



A Map from ltc\+\_\+asn1\+\_\+type to the regularly used A\+S\+N.\+1 identifier. 



Definition at line 21 of file der\+\_\+asn1\+\_\+maps.\+c.



Referenced by \+\_\+ltc\+\_\+to\+\_\+asn1(), der\+\_\+decode\+\_\+custom\+\_\+type\+\_\+ex(), and der\+\_\+encode\+\_\+asn1\+\_\+identifier().

\mbox{\Hypertarget{tomcrypt__private_8h_ae8d2a220c8f5b51d2db97b0382a9f206}\label{tomcrypt__private_8h_ae8d2a220c8f5b51d2db97b0382a9f206}} 
\index{tomcrypt\_private.h@{tomcrypt\_private.h}!der\_asn1\_type\_to\_identifier\_map\_sz@{der\_asn1\_type\_to\_identifier\_map\_sz}}
\index{der\_asn1\_type\_to\_identifier\_map\_sz@{der\_asn1\_type\_to\_identifier\_map\_sz}!tomcrypt\_private.h@{tomcrypt\_private.h}}
\subsubsection{\texorpdfstring{der\_asn1\_type\_to\_identifier\_map\_sz}{der\_asn1\_type\_to\_identifier\_map\_sz}}
{\footnotesize\ttfamily const unsigned long der\+\_\+asn1\+\_\+type\+\_\+to\+\_\+identifier\+\_\+map\+\_\+sz}



Definition at line 48 of file der\+\_\+asn1\+\_\+maps.\+c.



Referenced by der\+\_\+decode\+\_\+custom\+\_\+type\+\_\+ex(), and der\+\_\+encode\+\_\+asn1\+\_\+identifier().

\mbox{\Hypertarget{tomcrypt__private_8h_a45c19266abadb7a8a27dc330b000cfc4}\label{tomcrypt__private_8h_a45c19266abadb7a8a27dc330b000cfc4}} 
\index{tomcrypt\_private.h@{tomcrypt\_private.h}!ltc\_dh\_sets@{ltc\_dh\_sets}}
\index{ltc\_dh\_sets@{ltc\_dh\_sets}!tomcrypt\_private.h@{tomcrypt\_private.h}}
\subsubsection{\texorpdfstring{ltc\_dh\_sets}{ltc\_dh\_sets}}
{\footnotesize\ttfamily const \mbox{\hyperlink{structltc__dh__set__type}{ltc\+\_\+dh\+\_\+set\+\_\+type}} ltc\+\_\+dh\+\_\+sets\mbox{[}$\,$\mbox{]}}



Definition at line 15 of file dh.\+c.



Referenced by dh\+\_\+set\+\_\+pg\+\_\+groupsize().

