\hypertarget{tomcrypt__prng_8h}{}\section{M\+:/\+Office/!\+Doutorado/0. Repositorio\+S\+V\+N/\+H\+A\+M\+S\+T\+E\+R\+\_\+\+Prototype/branches/\+J\+I\+N\+T2018/include/libtomcrypt-\/develop/src/headers/tomcrypt\+\_\+prng.h File Reference}
\label{tomcrypt__prng_8h}\index{M:/Office/"!Doutorado/0. RepositorioSVN/HAMSTER\_Prototype/branches/JINT2018/include/libtomcrypt-\/develop/src/headers/tomcrypt\_prng.h@{M:/Office/"!Doutorado/0. RepositorioSVN/HAMSTER\_Prototype/branches/JINT2018/include/libtomcrypt-\/develop/src/headers/tomcrypt\_prng.h}}
This graph shows which files directly or indirectly include this file\+:
% FIG 0
\subsection*{Data Structures}
\begin{DoxyCompactItemize}
\item 
struct \mbox{\hyperlink{structprng__state}{prng\+\_\+state}}
\item 
struct \mbox{\hyperlink{structltc__prng__descriptor}{ltc\+\_\+prng\+\_\+descriptor}}
\begin{DoxyCompactList}\small\item\em P\+R\+NG descriptor. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
int \mbox{\hyperlink{tomcrypt__prng_8h_a53cfb5c7551b314e634a08e8be20a69c}{find\+\_\+prng}} (const char $\ast$name)
\begin{DoxyCompactList}\small\item\em Find a registered P\+R\+NG by name. \end{DoxyCompactList}\item 
int \mbox{\hyperlink{tomcrypt__prng_8h_a075b0025b7c09b69bb5cb1b9ff32dfee}{register\+\_\+prng}} (const struct \mbox{\hyperlink{structltc__prng__descriptor}{ltc\+\_\+prng\+\_\+descriptor}} $\ast$prng)
\begin{DoxyCompactList}\small\item\em Register a P\+R\+NG with the descriptor table. \end{DoxyCompactList}\item 
int \mbox{\hyperlink{tomcrypt__prng_8h_ab51832cb0a438973a7033a80085b329d}{unregister\+\_\+prng}} (const struct \mbox{\hyperlink{structltc__prng__descriptor}{ltc\+\_\+prng\+\_\+descriptor}} $\ast$prng)
\begin{DoxyCompactList}\small\item\em Unregister a P\+R\+NG from the descriptor table. \end{DoxyCompactList}\item 
int \mbox{\hyperlink{tomcrypt__prng_8h_add92eee71e65b8a649c5ff9817c5ad95}{register\+\_\+all\+\_\+prngs}} (void)
\item 
int \mbox{\hyperlink{tomcrypt__prng_8h_a7e4a212c1a29a3b8bb4f8d5a34676a1e}{prng\+\_\+is\+\_\+valid}} (int idx)
\item 
unsigned long \mbox{\hyperlink{tomcrypt__prng_8h_ace80a0f11a76e7ebd59c2188b2ec2520}{rng\+\_\+get\+\_\+bytes}} (unsigned char $\ast$out, unsigned long outlen, void($\ast$callback)(void))
\begin{DoxyCompactList}\small\item\em Read the system R\+NG. \end{DoxyCompactList}\item 
int \mbox{\hyperlink{tomcrypt__prng_8h_a97e605483ea5f5f9ea4067dafae5801b}{rng\+\_\+make\+\_\+prng}} (int bits, int wprng, \mbox{\hyperlink{structprng__state}{prng\+\_\+state}} $\ast$prng, void($\ast$callback)(void))
\begin{DoxyCompactList}\small\item\em Create a P\+R\+NG from a R\+NG. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Variables}
\begin{DoxyCompactItemize}
\item 
struct \mbox{\hyperlink{structltc__prng__descriptor}{ltc\+\_\+prng\+\_\+descriptor}} \mbox{\hyperlink{tomcrypt__prng_8h_ac03ee9f603bf966f3afb3f6be156239b}{prng\+\_\+descriptor}} \mbox{[}$\,$\mbox{]}
\end{DoxyCompactItemize}


\subsection{Function Documentation}
\mbox{\Hypertarget{tomcrypt__prng_8h_a53cfb5c7551b314e634a08e8be20a69c}\label{tomcrypt__prng_8h_a53cfb5c7551b314e634a08e8be20a69c}} 
\index{tomcrypt\_prng.h@{tomcrypt\_prng.h}!find\_prng@{find\_prng}}
\index{find\_prng@{find\_prng}!tomcrypt\_prng.h@{tomcrypt\_prng.h}}
\subsubsection{\texorpdfstring{find\_prng()}{find\_prng()}}
{\footnotesize\ttfamily int find\+\_\+prng (\begin{DoxyParamCaption}\item[{const char $\ast$}]{name }\end{DoxyParamCaption})}



Find a registered P\+R\+NG by name. 


\begin{DoxyParams}{Parameters}
{\em name} & The name of the P\+R\+NG to look for \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
$>$= 0 if found, -\/1 if not present 
\end{DoxyReturn}


Definition at line 21 of file crypt\+\_\+find\+\_\+prng.\+c.


\begin{DoxyCode}{0}
\DoxyCodeLine{22 \{}
\DoxyCodeLine{23    \textcolor{keywordtype}{int} x;}
\DoxyCodeLine{24    \mbox{\hyperlink{tomcrypt__argchk_8h_a683da3e041e49f196318b6ea951414ba}{LTC\_ARGCHK}}(name != NULL);}
\DoxyCodeLine{25    \mbox{\hyperlink{tomcrypt__custom_8h_a427a107414e4d775fbf23f4a499f4a31}{LTC\_MUTEX\_LOCK}}(\&ltc\_prng\_mutex);}
\DoxyCodeLine{26    \textcolor{keywordflow}{for} (x = 0; x < \mbox{\hyperlink{tomcrypt_8h_a9ad1b4a1e4f7381611cfd2ae6620a727}{TAB\_SIZE}}; x++) \{}
\DoxyCodeLine{27        \textcolor{keywordflow}{if} ((\mbox{\hyperlink{tomcrypt__prng_8h_ac03ee9f603bf966f3afb3f6be156239b}{prng\_descriptor}}[x].name != NULL) \&\& \mbox{\hyperlink{tomcrypt__cfg_8h_a5d6e3d69e1d3f54de008b963bba3c6b3}{XSTRCMP}}(\mbox{\hyperlink{tomcrypt__prng_8h_ac03ee9f603bf966f3afb3f6be156239b}{prng\_descriptor}}[x].name, name) == 0) \{}
\DoxyCodeLine{28           \mbox{\hyperlink{tomcrypt__custom_8h_acdf267be91b178b4fafe8f992d57a7f1}{LTC\_MUTEX\_UNLOCK}}(\&ltc\_prng\_mutex);}
\DoxyCodeLine{29           \textcolor{keywordflow}{return} x;}
\DoxyCodeLine{30        \}}
\DoxyCodeLine{31    \}}
\DoxyCodeLine{32    \mbox{\hyperlink{tomcrypt__custom_8h_acdf267be91b178b4fafe8f992d57a7f1}{LTC\_MUTEX\_UNLOCK}}(\&ltc\_prng\_mutex);}
\DoxyCodeLine{33    \textcolor{keywordflow}{return} -1;}
\DoxyCodeLine{34 \}}

\end{DoxyCode}


References L\+T\+C\+\_\+\+A\+R\+G\+C\+HK, L\+T\+C\+\_\+\+M\+U\+T\+E\+X\+\_\+\+L\+O\+CK, L\+T\+C\+\_\+\+M\+U\+T\+E\+X\+\_\+\+U\+N\+L\+O\+CK, prng\+\_\+descriptor, T\+A\+B\+\_\+\+S\+I\+ZE, and X\+S\+T\+R\+C\+M\+P().

Here is the call graph for this function\+:
% FIG 1
\mbox{\Hypertarget{tomcrypt__prng_8h_a7e4a212c1a29a3b8bb4f8d5a34676a1e}\label{tomcrypt__prng_8h_a7e4a212c1a29a3b8bb4f8d5a34676a1e}} 
\index{tomcrypt\_prng.h@{tomcrypt\_prng.h}!prng\_is\_valid@{prng\_is\_valid}}
\index{prng\_is\_valid@{prng\_is\_valid}!tomcrypt\_prng.h@{tomcrypt\_prng.h}}
\subsubsection{\texorpdfstring{prng\_is\_valid()}{prng\_is\_valid()}}
{\footnotesize\ttfamily int prng\+\_\+is\+\_\+valid (\begin{DoxyParamCaption}\item[{int}]{idx }\end{DoxyParamCaption})}



Definition at line 21 of file crypt\+\_\+prng\+\_\+is\+\_\+valid.\+c.


\begin{DoxyCode}{0}
\DoxyCodeLine{22 \{}
\DoxyCodeLine{23    \mbox{\hyperlink{tomcrypt__custom_8h_a427a107414e4d775fbf23f4a499f4a31}{LTC\_MUTEX\_LOCK}}(\&ltc\_prng\_mutex);}
\DoxyCodeLine{24    \textcolor{keywordflow}{if} (idx < 0 || idx >= \mbox{\hyperlink{tomcrypt_8h_a9ad1b4a1e4f7381611cfd2ae6620a727}{TAB\_SIZE}} || \mbox{\hyperlink{tomcrypt__prng_8h_ac03ee9f603bf966f3afb3f6be156239b}{prng\_descriptor}}[idx].name == NULL) \{}
\DoxyCodeLine{25       \mbox{\hyperlink{tomcrypt__custom_8h_acdf267be91b178b4fafe8f992d57a7f1}{LTC\_MUTEX\_UNLOCK}}(\&ltc\_prng\_mutex);}
\DoxyCodeLine{26       \textcolor{keywordflow}{return} \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06ca6228a32cdab04099a1ef0f956312f532}{CRYPT\_INVALID\_PRNG}};}
\DoxyCodeLine{27    \}}
\DoxyCodeLine{28    \mbox{\hyperlink{tomcrypt__custom_8h_acdf267be91b178b4fafe8f992d57a7f1}{LTC\_MUTEX\_UNLOCK}}(\&ltc\_prng\_mutex);}
\DoxyCodeLine{29    \textcolor{keywordflow}{return} \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}};}
\DoxyCodeLine{30 \}}

\end{DoxyCode}


References C\+R\+Y\+P\+T\+\_\+\+I\+N\+V\+A\+L\+I\+D\+\_\+\+P\+R\+NG, C\+R\+Y\+P\+T\+\_\+\+OK, L\+T\+C\+\_\+\+M\+U\+T\+E\+X\+\_\+\+L\+O\+CK, L\+T\+C\+\_\+\+M\+U\+T\+E\+X\+\_\+\+U\+N\+L\+O\+CK, ltc\+\_\+prng\+\_\+descriptor\+::name, prng\+\_\+descriptor, and T\+A\+B\+\_\+\+S\+I\+ZE.



Referenced by dh\+\_\+generate\+\_\+key(), dsa\+\_\+encrypt\+\_\+key(), dsa\+\_\+sign\+\_\+hash\+\_\+raw(), pkcs\+\_\+1\+\_\+oaep\+\_\+encode(), pkcs\+\_\+1\+\_\+pss\+\_\+encode(), pkcs\+\_\+1\+\_\+v1\+\_\+5\+\_\+encode(), rand\+\_\+bn\+\_\+bits(), rand\+\_\+prime(), rng\+\_\+make\+\_\+prng(), rsa\+\_\+encrypt\+\_\+key\+\_\+ex(), rsa\+\_\+make\+\_\+key(), and rsa\+\_\+sign\+\_\+hash\+\_\+ex().

Here is the caller graph for this function\+:
% FIG 2
\mbox{\Hypertarget{tomcrypt__prng_8h_add92eee71e65b8a649c5ff9817c5ad95}\label{tomcrypt__prng_8h_add92eee71e65b8a649c5ff9817c5ad95}} 
\index{tomcrypt\_prng.h@{tomcrypt\_prng.h}!register\_all\_prngs@{register\_all\_prngs}}
\index{register\_all\_prngs@{register\_all\_prngs}!tomcrypt\_prng.h@{tomcrypt\_prng.h}}
\subsubsection{\texorpdfstring{register\_all\_prngs()}{register\_all\_prngs()}}
{\footnotesize\ttfamily int register\+\_\+all\+\_\+prngs (\begin{DoxyParamCaption}\item[{void}]{ }\end{DoxyParamCaption})}



Definition at line 22 of file crypt\+\_\+register\+\_\+all\+\_\+prngs.\+c.


\begin{DoxyCode}{0}
\DoxyCodeLine{23 \{}
\DoxyCodeLine{24 \textcolor{preprocessor}{\#ifdef LTC\_YARROW}}
\DoxyCodeLine{25    \mbox{\hyperlink{crypt__register__all__prngs_8c_a4bbbe9f0557235896b121872e1a7d0e8}{REGISTER\_PRNG}}(\&\mbox{\hyperlink{yarrow_8c_a565c22c2b2e0b2fbbbbfeccedabc7bfc}{yarrow\_desc}});}
\DoxyCodeLine{26 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{27 \textcolor{preprocessor}{\#ifdef LTC\_FORTUNA}}
\DoxyCodeLine{28    \mbox{\hyperlink{crypt__register__all__prngs_8c_a4bbbe9f0557235896b121872e1a7d0e8}{REGISTER\_PRNG}}(\&\mbox{\hyperlink{fortuna_8c_a58d667818369213be05a67ff635ebb78}{fortuna\_desc}});}
\DoxyCodeLine{29 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{30 \textcolor{preprocessor}{\#ifdef LTC\_RC4}}
\DoxyCodeLine{31    \mbox{\hyperlink{crypt__register__all__prngs_8c_a4bbbe9f0557235896b121872e1a7d0e8}{REGISTER\_PRNG}}(\&\mbox{\hyperlink{rc4_8c_af600b7283289a2db35dd33c40ca97552}{rc4\_desc}});}
\DoxyCodeLine{32 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{33 \textcolor{preprocessor}{\#ifdef LTC\_CHACHA20\_PRNG}}
\DoxyCodeLine{34    \mbox{\hyperlink{crypt__register__all__prngs_8c_a4bbbe9f0557235896b121872e1a7d0e8}{REGISTER\_PRNG}}(\&\mbox{\hyperlink{chacha20_8c_a379b46b2ee8c713bed1a63d68bf0086c}{chacha20\_prng\_desc}});}
\DoxyCodeLine{35 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{36 \textcolor{preprocessor}{\#ifdef LTC\_SOBER128}}
\DoxyCodeLine{37    \mbox{\hyperlink{crypt__register__all__prngs_8c_a4bbbe9f0557235896b121872e1a7d0e8}{REGISTER\_PRNG}}(\&\mbox{\hyperlink{sober128_8c_acf82d6da430aca8ad53806c4a90a8fff}{sober128\_desc}});}
\DoxyCodeLine{38 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{39 \textcolor{preprocessor}{\#ifdef LTC\_SPRNG}}
\DoxyCodeLine{40    \mbox{\hyperlink{crypt__register__all__prngs_8c_a4bbbe9f0557235896b121872e1a7d0e8}{REGISTER\_PRNG}}(\&\mbox{\hyperlink{sprng_8c_a77e92e9c355edf3bb0998501b23c08d5}{sprng\_desc}});}
\DoxyCodeLine{41 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{42 }
\DoxyCodeLine{43    \textcolor{keywordflow}{return} \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}};}
\DoxyCodeLine{44 \}}

\end{DoxyCode}


References chacha20\+\_\+prng\+\_\+desc, C\+R\+Y\+P\+T\+\_\+\+OK, fortuna\+\_\+desc, rc4\+\_\+desc, R\+E\+G\+I\+S\+T\+E\+R\+\_\+\+P\+R\+NG, sober128\+\_\+desc, sprng\+\_\+desc, and yarrow\+\_\+desc.

\mbox{\Hypertarget{tomcrypt__prng_8h_a075b0025b7c09b69bb5cb1b9ff32dfee}\label{tomcrypt__prng_8h_a075b0025b7c09b69bb5cb1b9ff32dfee}} 
\index{tomcrypt\_prng.h@{tomcrypt\_prng.h}!register\_prng@{register\_prng}}
\index{register\_prng@{register\_prng}!tomcrypt\_prng.h@{tomcrypt\_prng.h}}
\subsubsection{\texorpdfstring{register\_prng()}{register\_prng()}}
{\footnotesize\ttfamily int register\+\_\+prng (\begin{DoxyParamCaption}\item[{const struct \mbox{\hyperlink{structltc__prng__descriptor}{ltc\+\_\+prng\+\_\+descriptor}} $\ast$}]{prng }\end{DoxyParamCaption})}



Register a P\+R\+NG with the descriptor table. 


\begin{DoxyParams}{Parameters}
{\em prng} & The P\+R\+NG you wish to register \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
value $>$= 0 if successfully added (or already present), -\/1 if unsuccessful 
\end{DoxyReturn}


Definition at line 21 of file crypt\+\_\+register\+\_\+prng.\+c.


\begin{DoxyCode}{0}
\DoxyCodeLine{22 \{}
\DoxyCodeLine{23    \textcolor{keywordtype}{int} x;}
\DoxyCodeLine{24 }
\DoxyCodeLine{25    \mbox{\hyperlink{tomcrypt__argchk_8h_a683da3e041e49f196318b6ea951414ba}{LTC\_ARGCHK}}(prng != NULL);}
\DoxyCodeLine{26 }
\DoxyCodeLine{27    \textcolor{comment}{/* is it already registered? */}}
\DoxyCodeLine{28    \mbox{\hyperlink{tomcrypt__custom_8h_a427a107414e4d775fbf23f4a499f4a31}{LTC\_MUTEX\_LOCK}}(\&ltc\_prng\_mutex);}
\DoxyCodeLine{29    \textcolor{keywordflow}{for} (x = 0; x < \mbox{\hyperlink{tomcrypt_8h_a9ad1b4a1e4f7381611cfd2ae6620a727}{TAB\_SIZE}}; x++) \{}
\DoxyCodeLine{30        \textcolor{keywordflow}{if} (\mbox{\hyperlink{tomcrypt__cfg_8h_a372b974ec0ac07abcd55297554fe540f}{XMEMCMP}}(\&\mbox{\hyperlink{tomcrypt__prng_8h_ac03ee9f603bf966f3afb3f6be156239b}{prng\_descriptor}}[x], prng, \textcolor{keyword}{sizeof}(\textcolor{keyword}{struct} \mbox{\hyperlink{structltc__prng__descriptor}{ltc\_prng\_descriptor}})) == 0) \{}
\DoxyCodeLine{31           \mbox{\hyperlink{tomcrypt__custom_8h_acdf267be91b178b4fafe8f992d57a7f1}{LTC\_MUTEX\_UNLOCK}}(\&ltc\_prng\_mutex);}
\DoxyCodeLine{32           \textcolor{keywordflow}{return} x;}
\DoxyCodeLine{33        \}}
\DoxyCodeLine{34    \}}
\DoxyCodeLine{35 }
\DoxyCodeLine{36    \textcolor{comment}{/* find a blank spot */}}
\DoxyCodeLine{37    \textcolor{keywordflow}{for} (x = 0; x < \mbox{\hyperlink{tomcrypt_8h_a9ad1b4a1e4f7381611cfd2ae6620a727}{TAB\_SIZE}}; x++) \{}
\DoxyCodeLine{38        \textcolor{keywordflow}{if} (\mbox{\hyperlink{tomcrypt__prng_8h_ac03ee9f603bf966f3afb3f6be156239b}{prng\_descriptor}}[x].name == NULL) \{}
\DoxyCodeLine{39           \mbox{\hyperlink{tomcrypt__cfg_8h_a7691dd48d60d5fc6daf2fa7ec4c55e12}{XMEMCPY}}(\&\mbox{\hyperlink{tomcrypt__prng_8h_ac03ee9f603bf966f3afb3f6be156239b}{prng\_descriptor}}[x], prng, \textcolor{keyword}{sizeof}(\textcolor{keyword}{struct} \mbox{\hyperlink{structltc__prng__descriptor}{ltc\_prng\_descriptor}}));}
\DoxyCodeLine{40           \mbox{\hyperlink{tomcrypt__custom_8h_acdf267be91b178b4fafe8f992d57a7f1}{LTC\_MUTEX\_UNLOCK}}(\&ltc\_prng\_mutex);}
\DoxyCodeLine{41           \textcolor{keywordflow}{return} x;}
\DoxyCodeLine{42        \}}
\DoxyCodeLine{43    \}}
\DoxyCodeLine{44 }
\DoxyCodeLine{45    \textcolor{comment}{/* no spot */}}
\DoxyCodeLine{46    \mbox{\hyperlink{tomcrypt__custom_8h_acdf267be91b178b4fafe8f992d57a7f1}{LTC\_MUTEX\_UNLOCK}}(\&ltc\_prng\_mutex);}
\DoxyCodeLine{47    \textcolor{keywordflow}{return} -1;}
\DoxyCodeLine{48 \}}

\end{DoxyCode}


References L\+T\+C\+\_\+\+A\+R\+G\+C\+HK, L\+T\+C\+\_\+\+M\+U\+T\+E\+X\+\_\+\+L\+O\+CK, L\+T\+C\+\_\+\+M\+U\+T\+E\+X\+\_\+\+U\+N\+L\+O\+CK, ltc\+\_\+prng\+\_\+descriptor\+::name, prng\+\_\+descriptor, T\+A\+B\+\_\+\+S\+I\+ZE, X\+M\+E\+M\+C\+M\+P(), and X\+M\+E\+M\+C\+P\+Y().



Referenced by crypt\+\_\+fsa().

Here is the call graph for this function\+:
% FIG 3
Here is the caller graph for this function\+:
% FIG 4
\mbox{\Hypertarget{tomcrypt__prng_8h_ace80a0f11a76e7ebd59c2188b2ec2520}\label{tomcrypt__prng_8h_ace80a0f11a76e7ebd59c2188b2ec2520}} 
\index{tomcrypt\_prng.h@{tomcrypt\_prng.h}!rng\_get\_bytes@{rng\_get\_bytes}}
\index{rng\_get\_bytes@{rng\_get\_bytes}!tomcrypt\_prng.h@{tomcrypt\_prng.h}}
\subsubsection{\texorpdfstring{rng\_get\_bytes()}{rng\_get\_bytes()}}
{\footnotesize\ttfamily unsigned long rng\+\_\+get\+\_\+bytes (\begin{DoxyParamCaption}\item[{unsigned char $\ast$}]{out,  }\item[{unsigned long}]{outlen,  }\item[{void($\ast$)(void)}]{callback }\end{DoxyParamCaption})}



Read the system R\+NG. 


\begin{DoxyParams}{Parameters}
{\em out} & Destination \\
\hline
{\em outlen} & Length desired (octets) \\
\hline
{\em callback} & Pointer to void function to act as \char`\"{}callback\char`\"{} when R\+NG is slow. This can be N\+U\+LL \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Number of octets read 
\end{DoxyReturn}


Definition at line 132 of file rng\+\_\+get\+\_\+bytes.\+c.


\begin{DoxyCode}{0}
\DoxyCodeLine{134 \{}
\DoxyCodeLine{135    \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} x;}
\DoxyCodeLine{136 }
\DoxyCodeLine{137    \mbox{\hyperlink{tomcrypt__argchk_8h_a683da3e041e49f196318b6ea951414ba}{LTC\_ARGCHK}}(out != NULL);}
\DoxyCodeLine{138 }
\DoxyCodeLine{139 \textcolor{preprocessor}{\#ifdef LTC\_PRNG\_ENABLE\_LTC\_RNG}}
\DoxyCodeLine{140    \textcolor{keywordflow}{if} (ltc\_rng) \{}
\DoxyCodeLine{141       x = ltc\_rng(out, outlen, callback);}
\DoxyCodeLine{142       \textcolor{keywordflow}{if} (x != 0) \{}
\DoxyCodeLine{143          \textcolor{keywordflow}{return} x;}
\DoxyCodeLine{144       \}}
\DoxyCodeLine{145    \}}
\DoxyCodeLine{146 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{147 }
\DoxyCodeLine{148 \textcolor{preprocessor}{\#if defined(\_WIN32) || defined(\_WIN32\_WCE)}}
\DoxyCodeLine{149    x = \_rng\_win32(out, outlen, callback); \textcolor{keywordflow}{if} (x != 0) \{ \textcolor{keywordflow}{return} x; \}}
\DoxyCodeLine{150 \textcolor{preprocessor}{\#elif defined(LTC\_DEVRANDOM)}}
\DoxyCodeLine{151    x = \mbox{\hyperlink{rng__get__bytes_8c_a1384ad1a46527e2b6f22c85bdcc7f2fa}{\_rng\_nix}}(out, outlen, callback);   \textcolor{keywordflow}{if} (x != 0) \{ \textcolor{keywordflow}{return} x; \}}
\DoxyCodeLine{152 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{153 \textcolor{preprocessor}{\#ifdef ANSI\_RNG}}
\DoxyCodeLine{154    x = \mbox{\hyperlink{rng__get__bytes_8c_af779fc65e3d8cffba45aa4ca3e6e1ace}{\_rng\_ansic}}(out, outlen, callback); \textcolor{keywordflow}{if} (x != 0) \{ \textcolor{keywordflow}{return} x; \}}
\DoxyCodeLine{155 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{156    \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{157 \}}

\end{DoxyCode}


References \+\_\+rng\+\_\+ansic(), \+\_\+rng\+\_\+nix(), and L\+T\+C\+\_\+\+A\+R\+G\+C\+HK.



Referenced by \+\_\+padding\+\_\+padded\+\_\+length(), padding\+\_\+pad(), rng\+\_\+make\+\_\+prng(), and sprng\+\_\+read().

Here is the call graph for this function\+:
% FIG 5
Here is the caller graph for this function\+:
% FIG 6
\mbox{\Hypertarget{tomcrypt__prng_8h_a97e605483ea5f5f9ea4067dafae5801b}\label{tomcrypt__prng_8h_a97e605483ea5f5f9ea4067dafae5801b}} 
\index{tomcrypt\_prng.h@{tomcrypt\_prng.h}!rng\_make\_prng@{rng\_make\_prng}}
\index{rng\_make\_prng@{rng\_make\_prng}!tomcrypt\_prng.h@{tomcrypt\_prng.h}}
\subsubsection{\texorpdfstring{rng\_make\_prng()}{rng\_make\_prng()}}
{\footnotesize\ttfamily int rng\+\_\+make\+\_\+prng (\begin{DoxyParamCaption}\item[{int}]{bits,  }\item[{int}]{wprng,  }\item[{\mbox{\hyperlink{structprng__state}{prng\+\_\+state}} $\ast$}]{prng,  }\item[{void($\ast$)(void)}]{callback }\end{DoxyParamCaption})}



Create a P\+R\+NG from a R\+NG. 

In case you pass bits as \textquotesingle{}-\/1\textquotesingle{} the P\+R\+NG will be setup as if the export/import functionality has been used, but the imported data comes directly from the R\+NG.


\begin{DoxyParams}{Parameters}
{\em bits} & Number of bits of entropy desired (-\/1 or 64 ... 1024) \\
\hline
{\em wprng} & Index of which P\+R\+NG to setup \\
\hline
{\em prng} & \mbox{[}out\mbox{]} P\+R\+NG state to initialize \\
\hline
{\em callback} & A pointer to a void function for when the R\+NG is slow, this can be N\+U\+LL \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
C\+R\+Y\+P\+T\+\_\+\+OK if successful 
\end{DoxyReturn}


Definition at line 30 of file rng\+\_\+make\+\_\+prng.\+c.


\begin{DoxyCode}{0}
\DoxyCodeLine{32 \{}
\DoxyCodeLine{33    \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char}* buf;}
\DoxyCodeLine{34    \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} bytes;}
\DoxyCodeLine{35    \textcolor{keywordtype}{int} err;}
\DoxyCodeLine{36 }
\DoxyCodeLine{37    \mbox{\hyperlink{tomcrypt__argchk_8h_a683da3e041e49f196318b6ea951414ba}{LTC\_ARGCHK}}(prng != NULL);}
\DoxyCodeLine{38 }
\DoxyCodeLine{39    \textcolor{comment}{/* check parameter */}}
\DoxyCodeLine{40    \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{tomcrypt__prng_8h_a7e4a212c1a29a3b8bb4f8d5a34676a1e}{prng\_is\_valid}}(wprng)) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}}) \{}
\DoxyCodeLine{41       \textcolor{keywordflow}{return} err;}
\DoxyCodeLine{42    \}}
\DoxyCodeLine{43 }
\DoxyCodeLine{44    \textcolor{keywordflow}{if} (bits == -1) \{}
\DoxyCodeLine{45       bytes = \mbox{\hyperlink{tomcrypt__prng_8h_ac03ee9f603bf966f3afb3f6be156239b}{prng\_descriptor}}[wprng].\mbox{\hyperlink{structltc__prng__descriptor_a41ef184ab75b213366392faabcde420c}{export\_size}};}
\DoxyCodeLine{46    \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (bits < 64 || bits > 1024) \{}
\DoxyCodeLine{47       \textcolor{keywordflow}{return} \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cac0b40f0b62c40baa800489c75940b0a1}{CRYPT\_INVALID\_PRNGSIZE}};}
\DoxyCodeLine{48    \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{49       bytes = (\textcolor{keywordtype}{unsigned} long)((bits+7)/8) * 2;}
\DoxyCodeLine{50    \}}
\DoxyCodeLine{51 }
\DoxyCodeLine{52    \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{tomcrypt__prng_8h_ac03ee9f603bf966f3afb3f6be156239b}{prng\_descriptor}}[wprng].start(prng)) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}}) \{}
\DoxyCodeLine{53       \textcolor{keywordflow}{return} err;}
\DoxyCodeLine{54    \}}
\DoxyCodeLine{55 }
\DoxyCodeLine{56    buf = \mbox{\hyperlink{tomcrypt__cfg_8h_af363355f38fbaacdefacf270436ae1c9}{XMALLOC}}(bytes);}
\DoxyCodeLine{57    \textcolor{keywordflow}{if} (buf == NULL) \{}
\DoxyCodeLine{58       \textcolor{keywordflow}{return} \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06ca0ce0d27adc7ea10b74b7ea904b8bfa82}{CRYPT\_MEM}};}
\DoxyCodeLine{59    \}}
\DoxyCodeLine{60 }
\DoxyCodeLine{61    \textcolor{keywordflow}{if} (\mbox{\hyperlink{tomcrypt__prng_8h_ace80a0f11a76e7ebd59c2188b2ec2520}{rng\_get\_bytes}}(buf, bytes, callback) != bytes) \{}
\DoxyCodeLine{62       err = \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06ca68eea82b3b71f23031cd94b10c920bf3}{CRYPT\_ERROR\_READPRNG}};}
\DoxyCodeLine{63       \textcolor{keywordflow}{goto} LBL\_ERR;}
\DoxyCodeLine{64    \}}
\DoxyCodeLine{65 }
\DoxyCodeLine{66    \textcolor{keywordflow}{if} (bits == -1) \{}
\DoxyCodeLine{67       \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{tomcrypt__prng_8h_ac03ee9f603bf966f3afb3f6be156239b}{prng\_descriptor}}[wprng].pimport(buf, bytes, prng)) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}}) \{}
\DoxyCodeLine{68          \textcolor{keywordflow}{goto} LBL\_ERR;}
\DoxyCodeLine{69       \}}
\DoxyCodeLine{70    \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{71       \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{tomcrypt__prng_8h_ac03ee9f603bf966f3afb3f6be156239b}{prng\_descriptor}}[wprng].add\_entropy(buf, bytes, prng)) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}}) \{}
\DoxyCodeLine{72          \textcolor{keywordflow}{goto} LBL\_ERR;}
\DoxyCodeLine{73       \}}
\DoxyCodeLine{74    \}}
\DoxyCodeLine{75    \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{tomcrypt__prng_8h_ac03ee9f603bf966f3afb3f6be156239b}{prng\_descriptor}}[wprng].ready(prng)) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}}) \{}
\DoxyCodeLine{76       \textcolor{keywordflow}{goto} LBL\_ERR;}
\DoxyCodeLine{77    \}}
\DoxyCodeLine{78 }
\DoxyCodeLine{79 LBL\_ERR:}
\DoxyCodeLine{80 \textcolor{preprocessor}{   \#ifdef LTC\_CLEAN\_STACK}}
\DoxyCodeLine{81    \mbox{\hyperlink{tomcrypt__misc_8h_a63b6e188713790263bfd3612fe8b398f}{zeromem}}(buf, bytes);}
\DoxyCodeLine{82 \textcolor{preprocessor}{   \#endif}}
\DoxyCodeLine{83    \mbox{\hyperlink{tomcrypt__cfg_8h_a260d66fc0690e0502cf3bfe7b5244b75}{XFREE}}(buf);}
\DoxyCodeLine{84    \textcolor{keywordflow}{return} err;}
\DoxyCodeLine{85 \}}

\end{DoxyCode}


References ltc\+\_\+prng\+\_\+descriptor\+::add\+\_\+entropy, C\+R\+Y\+P\+T\+\_\+\+E\+R\+R\+O\+R\+\_\+\+R\+E\+A\+D\+P\+R\+NG, C\+R\+Y\+P\+T\+\_\+\+I\+N\+V\+A\+L\+I\+D\+\_\+\+P\+R\+N\+G\+S\+I\+ZE, C\+R\+Y\+P\+T\+\_\+\+M\+EM, C\+R\+Y\+P\+T\+\_\+\+OK, ltc\+\_\+prng\+\_\+descriptor\+::export\+\_\+size, L\+T\+C\+\_\+\+A\+R\+G\+C\+HK, ltc\+\_\+prng\+\_\+descriptor\+::pimport, prng\+\_\+descriptor, prng\+\_\+is\+\_\+valid(), ltc\+\_\+prng\+\_\+descriptor\+::ready, rng\+\_\+get\+\_\+bytes(), ltc\+\_\+prng\+\_\+descriptor\+::start, X\+F\+R\+E\+E(), X\+M\+A\+L\+L\+O\+C(), and zeromem().

Here is the call graph for this function\+:
% FIG 7
\mbox{\Hypertarget{tomcrypt__prng_8h_ab51832cb0a438973a7033a80085b329d}\label{tomcrypt__prng_8h_ab51832cb0a438973a7033a80085b329d}} 
\index{tomcrypt\_prng.h@{tomcrypt\_prng.h}!unregister\_prng@{unregister\_prng}}
\index{unregister\_prng@{unregister\_prng}!tomcrypt\_prng.h@{tomcrypt\_prng.h}}
\subsubsection{\texorpdfstring{unregister\_prng()}{unregister\_prng()}}
{\footnotesize\ttfamily int unregister\+\_\+prng (\begin{DoxyParamCaption}\item[{const struct \mbox{\hyperlink{structltc__prng__descriptor}{ltc\+\_\+prng\+\_\+descriptor}} $\ast$}]{prng }\end{DoxyParamCaption})}



Unregister a P\+R\+NG from the descriptor table. 


\begin{DoxyParams}{Parameters}
{\em prng} & The P\+R\+NG descriptor to remove \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
C\+R\+Y\+P\+T\+\_\+\+OK on success 
\end{DoxyReturn}


Definition at line 21 of file crypt\+\_\+unregister\+\_\+prng.\+c.


\begin{DoxyCode}{0}
\DoxyCodeLine{22 \{}
\DoxyCodeLine{23    \textcolor{keywordtype}{int} x;}
\DoxyCodeLine{24 }
\DoxyCodeLine{25    \mbox{\hyperlink{tomcrypt__argchk_8h_a683da3e041e49f196318b6ea951414ba}{LTC\_ARGCHK}}(prng != NULL);}
\DoxyCodeLine{26 }
\DoxyCodeLine{27    \textcolor{comment}{/* is it already registered? */}}
\DoxyCodeLine{28    \mbox{\hyperlink{tomcrypt__custom_8h_a427a107414e4d775fbf23f4a499f4a31}{LTC\_MUTEX\_LOCK}}(\&ltc\_prng\_mutex);}
\DoxyCodeLine{29    \textcolor{keywordflow}{for} (x = 0; x < \mbox{\hyperlink{tomcrypt_8h_a9ad1b4a1e4f7381611cfd2ae6620a727}{TAB\_SIZE}}; x++) \{}
\DoxyCodeLine{30        \textcolor{keywordflow}{if} (\mbox{\hyperlink{tomcrypt__cfg_8h_a372b974ec0ac07abcd55297554fe540f}{XMEMCMP}}(\&\mbox{\hyperlink{tomcrypt__prng_8h_ac03ee9f603bf966f3afb3f6be156239b}{prng\_descriptor}}[x], prng, \textcolor{keyword}{sizeof}(\textcolor{keyword}{struct} \mbox{\hyperlink{structltc__prng__descriptor}{ltc\_prng\_descriptor}})) == 0) \{}
\DoxyCodeLine{31           \mbox{\hyperlink{tomcrypt__prng_8h_ac03ee9f603bf966f3afb3f6be156239b}{prng\_descriptor}}[x].\mbox{\hyperlink{structltc__prng__descriptor_a56124a50c35eebe647ae285e14c0d147}{name}} = NULL;}
\DoxyCodeLine{32           \mbox{\hyperlink{tomcrypt__custom_8h_acdf267be91b178b4fafe8f992d57a7f1}{LTC\_MUTEX\_UNLOCK}}(\&ltc\_prng\_mutex);}
\DoxyCodeLine{33           \textcolor{keywordflow}{return} \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}};}
\DoxyCodeLine{34        \}}
\DoxyCodeLine{35    \}}
\DoxyCodeLine{36    \mbox{\hyperlink{tomcrypt__custom_8h_acdf267be91b178b4fafe8f992d57a7f1}{LTC\_MUTEX\_UNLOCK}}(\&ltc\_prng\_mutex);}
\DoxyCodeLine{37    \textcolor{keywordflow}{return} \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06ca03c22220d7538be04455cd2aa6ddf9da}{CRYPT\_ERROR}};}
\DoxyCodeLine{38 \}}

\end{DoxyCode}


References C\+R\+Y\+P\+T\+\_\+\+E\+R\+R\+OR, C\+R\+Y\+P\+T\+\_\+\+OK, L\+T\+C\+\_\+\+A\+R\+G\+C\+HK, L\+T\+C\+\_\+\+M\+U\+T\+E\+X\+\_\+\+L\+O\+CK, L\+T\+C\+\_\+\+M\+U\+T\+E\+X\+\_\+\+U\+N\+L\+O\+CK, ltc\+\_\+prng\+\_\+descriptor\+::name, prng\+\_\+descriptor, T\+A\+B\+\_\+\+S\+I\+ZE, and X\+M\+E\+M\+C\+M\+P().

Here is the call graph for this function\+:
% FIG 8


\subsection{Variable Documentation}
\mbox{\Hypertarget{tomcrypt__prng_8h_ac03ee9f603bf966f3afb3f6be156239b}\label{tomcrypt__prng_8h_ac03ee9f603bf966f3afb3f6be156239b}} 
\index{tomcrypt\_prng.h@{tomcrypt\_prng.h}!prng\_descriptor@{prng\_descriptor}}
\index{prng\_descriptor@{prng\_descriptor}!tomcrypt\_prng.h@{tomcrypt\_prng.h}}
\subsubsection{\texorpdfstring{prng\_descriptor}{prng\_descriptor}}
{\footnotesize\ttfamily struct \mbox{\hyperlink{structltc__prng__descriptor}{ltc\+\_\+prng\+\_\+descriptor}}  prng\+\_\+descriptor\mbox{[}$\,$\mbox{]}}



Referenced by \+\_\+dsa\+\_\+make\+\_\+params(), dh\+\_\+generate\+\_\+key(), find\+\_\+prng(), pkcs\+\_\+1\+\_\+oaep\+\_\+encode(), pkcs\+\_\+1\+\_\+pss\+\_\+encode(), pkcs\+\_\+1\+\_\+v1\+\_\+5\+\_\+encode(), prng\+\_\+is\+\_\+valid(), rand\+\_\+bn\+\_\+bits(), rand\+\_\+prime(), register\+\_\+prng(), rng\+\_\+make\+\_\+prng(), and unregister\+\_\+prng().

