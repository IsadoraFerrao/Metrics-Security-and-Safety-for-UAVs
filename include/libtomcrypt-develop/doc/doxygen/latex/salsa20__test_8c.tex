\hypertarget{salsa20__test_8c}{}\section{M\+:/\+Office/!\+Doutorado/0. Repositorio\+S\+V\+N/\+H\+A\+M\+S\+T\+E\+R\+\_\+\+Prototype/branches/\+J\+I\+N\+T2018/include/libtomcrypt-\/develop/src/stream/salsa20/salsa20\+\_\+test.c File Reference}
\label{salsa20__test_8c}\index{M:/Office/"!Doutorado/0. RepositorioSVN/HAMSTER\_Prototype/branches/JINT2018/include/libtomcrypt-\/develop/src/stream/salsa20/salsa20\_test.c@{M:/Office/"!Doutorado/0. RepositorioSVN/HAMSTER\_Prototype/branches/JINT2018/include/libtomcrypt-\/develop/src/stream/salsa20/salsa20\_test.c}}
{\ttfamily \#include \char`\"{}tomcrypt\+\_\+private.\+h\char`\"{}}\newline
Include dependency graph for salsa20\+\_\+test.\+c\+:
% FIG 0
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
int \mbox{\hyperlink{salsa20__test_8c_a502decc5b83b4208d744ea2a21aeb366}{salsa20\+\_\+test}} (void)
\end{DoxyCompactItemize}


\subsection{Function Documentation}
\mbox{\Hypertarget{salsa20__test_8c_a502decc5b83b4208d744ea2a21aeb366}\label{salsa20__test_8c_a502decc5b83b4208d744ea2a21aeb366}} 
\index{salsa20\_test.c@{salsa20\_test.c}!salsa20\_test@{salsa20\_test}}
\index{salsa20\_test@{salsa20\_test}!salsa20\_test.c@{salsa20\_test.c}}
\subsubsection{\texorpdfstring{salsa20\_test()}{salsa20\_test()}}
{\footnotesize\ttfamily int salsa20\+\_\+test (\begin{DoxyParamCaption}\item[{void}]{ }\end{DoxyParamCaption})}



Definition at line 20 of file salsa20\+\_\+test.\+c.


\begin{DoxyCode}{0}
\DoxyCodeLine{21 \{}
\DoxyCodeLine{22 \textcolor{preprocessor}{\#ifndef LTC\_TEST}}
\DoxyCodeLine{23    \textcolor{keywordflow}{return} \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cac43a7799c7fd5f515172da6cfc0f9cf5}{CRYPT\_NOP}};}
\DoxyCodeLine{24 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{25    salsa20\_state st;}
\DoxyCodeLine{26    \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char} k[]   = \{ 0x00, 0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07, 0x08, 0x09, 0x0a, 0x0b, 0x0c, 0x0d, 0x0e, 0x0f,}
\DoxyCodeLine{27                            0x10, 0x11, 0x12, 0x13, 0x14, 0x15, 0x16, 0x17, 0x18, 0x19, 0x1a, 0x1b, 0x1c, 0x1d, 0x1e, 0x1f \};}
\DoxyCodeLine{28    \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char} n[]   = \{ 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x4a \};}
\DoxyCodeLine{29    \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char} ct[]  = \{ 0x37, 0x37, 0x2e, 0x60, 0xb8, 0xae, 0x88, 0x1f, 0xf8, 0xdf, 0x00, 0x26, 0x6c, 0x30, 0x34, 0x2d,}
\DoxyCodeLine{30                            0xa1, 0xd7, 0x79, 0x60, 0x67, 0x72, 0xe0, 0x67, 0x26, 0x22, 0xad, 0x00, 0x9e, 0xd5, 0x59, 0x44,}
\DoxyCodeLine{31                            0x51, 0xd9, 0xe6, 0xaa, 0xc9, 0x59, 0x9e, 0x60, 0xff, 0x87, 0x90, 0xc1, 0xc9, 0x1e \};}
\DoxyCodeLine{32    \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char} ct2[] = \{ 0xec, 0x06, 0x32, 0xb3, 0x83, 0x5c, 0xae, 0x91, 0x01, 0x82, 0x7a, 0x71, 0xd9, 0x7d, 0x45, 0xd7,}
\DoxyCodeLine{33                            0xa6, 0x5b, 0xa0, 0x89, 0x9d, 0xd2, 0x6c, 0xaa, 0xbb, 0x2f, 0x5f, 0x30, 0x89, 0x54, 0xff, 0x3e,}
\DoxyCodeLine{34                            0x83, 0xc3, 0x34, 0x10, 0xb6, 0xe1, 0xab, 0xe7, 0xf5, 0xab, 0xab, 0xed, 0xa4, 0xff \};}
\DoxyCodeLine{35    \textcolor{keywordtype}{char} pt[]           = \textcolor{stringliteral}{"Kilroy was here, and there. ...and everywhere!"};    \textcolor{comment}{/* len = 46 bytes */}}
\DoxyCodeLine{36    \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} \mbox{\hyperlink{ocb__init_8c_afed088663f8704004425cdae2120b9b3}{len}};}
\DoxyCodeLine{37    \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char} out[1000];}
\DoxyCodeLine{38    \textcolor{keywordtype}{int} counter;}
\DoxyCodeLine{39    \textcolor{keywordtype}{int} \mbox{\hyperlink{kseed_8c_a51da46362a22c8107683876e9c12ec82}{rounds}};}
\DoxyCodeLine{40    \textcolor{keywordtype}{int} err;}
\DoxyCodeLine{41    \mbox{\hyperlink{ocb__init_8c_afed088663f8704004425cdae2120b9b3}{len}} = strlen(pt);}
\DoxyCodeLine{42 }
\DoxyCodeLine{43    \textcolor{comment}{/* crypt piece by piece */}}
\DoxyCodeLine{44    counter = 0;}
\DoxyCodeLine{45    \mbox{\hyperlink{kseed_8c_a51da46362a22c8107683876e9c12ec82}{rounds}}  = 12;}
\DoxyCodeLine{46    \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{salsa20__setup_8c_a9e658fb807e99cde7c674b9c9861cd9c}{salsa20\_setup}}(\&st, k, \textcolor{keyword}{sizeof}(k), \mbox{\hyperlink{kseed_8c_a51da46362a22c8107683876e9c12ec82}{rounds}}))                        != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}}) \textcolor{keywordflow}{return} err;}
\DoxyCodeLine{47    \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{salsa20__ivctr64_8c_a883b02e52a18d08c077bcdde612def0a}{salsa20\_ivctr64}}(\&st, n, \textcolor{keyword}{sizeof}(n), counter))                     != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}}) \textcolor{keywordflow}{return} err;}
\DoxyCodeLine{48    \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{salsa20__crypt_8c_ac9983b8790b277b19ac0e6efcd5bc298}{salsa20\_crypt}}(\&st, (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char}*)pt,       5,       out))      != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}}) \textcolor{keywordflow}{return} err;}
\DoxyCodeLine{49    \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{salsa20__crypt_8c_ac9983b8790b277b19ac0e6efcd5bc298}{salsa20\_crypt}}(\&st, (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char}*)pt +  5, 25,       out +  5)) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}}) \textcolor{keywordflow}{return} err;}
\DoxyCodeLine{50    \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{salsa20__crypt_8c_ac9983b8790b277b19ac0e6efcd5bc298}{salsa20\_crypt}}(\&st, (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char}*)pt + 30, 10,       out + 30)) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}}) \textcolor{keywordflow}{return} err;}
\DoxyCodeLine{51    \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{salsa20__crypt_8c_ac9983b8790b277b19ac0e6efcd5bc298}{salsa20\_crypt}}(\&st, (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char}*)pt + 40, \mbox{\hyperlink{ocb__init_8c_afed088663f8704004425cdae2120b9b3}{len}} - 40, out + 40)) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}}) \textcolor{keywordflow}{return} err;}
\DoxyCodeLine{52    \textcolor{keywordflow}{if} (\mbox{\hyperlink{tomcrypt__misc_8h_a7764a7f27897c6182335752df00b5f8e}{compare\_testvector}}(out, \mbox{\hyperlink{ocb__init_8c_afed088663f8704004425cdae2120b9b3}{len}}, ct, \textcolor{keyword}{sizeof}(ct), \textcolor{stringliteral}{"SALSA20-TV1"}, 1))        \textcolor{keywordflow}{return} \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06caf98a132fdf93633389677f31f9bb39ca}{CRYPT\_FAIL\_TESTVECTOR}};}
\DoxyCodeLine{53 }
\DoxyCodeLine{54    \textcolor{comment}{/* crypt in one go - using salsa20\_ivctr64() */}}
\DoxyCodeLine{55    counter = 0;}
\DoxyCodeLine{56    \mbox{\hyperlink{kseed_8c_a51da46362a22c8107683876e9c12ec82}{rounds}}  = 20;}
\DoxyCodeLine{57    \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{salsa20__setup_8c_a9e658fb807e99cde7c674b9c9861cd9c}{salsa20\_setup}}(\&st, k, \textcolor{keyword}{sizeof}(k), \mbox{\hyperlink{kseed_8c_a51da46362a22c8107683876e9c12ec82}{rounds}}))         != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}})  \textcolor{keywordflow}{return} err;}
\DoxyCodeLine{58    \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{salsa20__ivctr64_8c_a883b02e52a18d08c077bcdde612def0a}{salsa20\_ivctr64}}(\&st, n, \textcolor{keyword}{sizeof}(n), counter))      != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}})  \textcolor{keywordflow}{return} err;}
\DoxyCodeLine{59    \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{salsa20__crypt_8c_ac9983b8790b277b19ac0e6efcd5bc298}{salsa20\_crypt}}(\&st, (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char}*)pt, \mbox{\hyperlink{ocb__init_8c_afed088663f8704004425cdae2120b9b3}{len}}, out)) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}})  \textcolor{keywordflow}{return} err;}
\DoxyCodeLine{60    \textcolor{keywordflow}{if} (\mbox{\hyperlink{tomcrypt__misc_8h_a7764a7f27897c6182335752df00b5f8e}{compare\_testvector}}(out, \mbox{\hyperlink{ocb__init_8c_afed088663f8704004425cdae2120b9b3}{len}}, ct2, \textcolor{keyword}{sizeof}(ct2), \textcolor{stringliteral}{"SALSA20-TV2"}, 1))      \textcolor{keywordflow}{return} \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06caf98a132fdf93633389677f31f9bb39ca}{CRYPT\_FAIL\_TESTVECTOR}};}
\DoxyCodeLine{61 }
\DoxyCodeLine{62    \textcolor{comment}{/* crypt in a single call */}}
\DoxyCodeLine{63    \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{salsa20__memory_8c_a5f1eb225450c6f7ccd042dbce38db56a}{salsa20\_memory}}(k, \textcolor{keyword}{sizeof}(k), \mbox{\hyperlink{kseed_8c_a51da46362a22c8107683876e9c12ec82}{rounds}}, n, \textcolor{keyword}{sizeof}(n), counter,}
\DoxyCodeLine{64                                  (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char}*)pt, \mbox{\hyperlink{ocb__init_8c_afed088663f8704004425cdae2120b9b3}{len}}, out)) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}})  \textcolor{keywordflow}{return} err;}
\DoxyCodeLine{65    \textcolor{keywordflow}{if} (\mbox{\hyperlink{tomcrypt__misc_8h_a7764a7f27897c6182335752df00b5f8e}{compare\_testvector}}(out, \mbox{\hyperlink{ocb__init_8c_afed088663f8704004425cdae2120b9b3}{len}}, ct2, \textcolor{keyword}{sizeof}(ct2), \textcolor{stringliteral}{"SALSA20-TV3"}, 1))      \textcolor{keywordflow}{return} \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06caf98a132fdf93633389677f31f9bb39ca}{CRYPT\_FAIL\_TESTVECTOR}};}
\DoxyCodeLine{66 }
\DoxyCodeLine{67    \{}
\DoxyCodeLine{68        \textcolor{comment}{/* keystream}}
\DoxyCodeLine{69 \textcolor{comment}{        * http://www.ecrypt.eu.org/stream/svn/viewcvs.cgi/ecrypt/trunk/submissions/salsa20/full/verified.test-vectors?rev=161\&view=markup}}
\DoxyCodeLine{70 \textcolor{comment}{        * Set 6, vector 0}}
\DoxyCodeLine{71 \textcolor{comment}{        */}}
\DoxyCodeLine{72        \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char} k3[]  = \{ 0x00, 0x53, 0xA6, 0xF9, 0x4C, 0x9F, 0xF2, 0x45, 0x98, 0xEB, 0x3E, 0x91, 0xE4, 0x37, 0x8A, 0xDD,}
\DoxyCodeLine{73                                0x30, 0x83, 0xD6, 0x29, 0x7C, 0xCF, 0x22, 0x75, 0xC8, 0x1B, 0x6E, 0xC1, 0x14, 0x67, 0xBA, 0x0D \};}
\DoxyCodeLine{74        \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char} n3[]  = \{ 0x0D, 0x74, 0xDB, 0x42, 0xA9, 0x10, 0x77, 0xDE \};}
\DoxyCodeLine{75        \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char} ct3[] = \{ 0xF5, 0xFA, 0xD5, 0x3F, 0x79, 0xF9, 0xDF, 0x58, 0xC4, 0xAE, 0xA0, 0xD0, 0xED, 0x9A, 0x96, 0x01,}
\DoxyCodeLine{76                                0xF2, 0x78, 0x11, 0x2C, 0xA7, 0x18, 0x0D, 0x56, 0x5B, 0x42, 0x0A, 0x48, 0x01, 0x96, 0x70, 0xEA,}
\DoxyCodeLine{77                                0xF2, 0x4C, 0xE4, 0x93, 0xA8, 0x62, 0x63, 0xF6, 0x77, 0xB4, 0x6A, 0xCE, 0x19, 0x24, 0x77, 0x3D,}
\DoxyCodeLine{78                                0x2B, 0xB2, 0x55, 0x71, 0xE1, 0xAA, 0x85, 0x93, 0x75, 0x8F, 0xC3, 0x82, 0xB1, 0x28, 0x0B, 0x71 \};}
\DoxyCodeLine{79        \textcolor{keywordtype}{int} counter3 = 0;}
\DoxyCodeLine{80        \textcolor{keywordtype}{int} rounds3  = 20;}
\DoxyCodeLine{81        \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{salsa20__setup_8c_a9e658fb807e99cde7c674b9c9861cd9c}{salsa20\_setup}}(\&st, k3, \textcolor{keyword}{sizeof}(k3), rounds3))    != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}})     \textcolor{keywordflow}{return} err;}
\DoxyCodeLine{82        \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{salsa20__ivctr64_8c_a883b02e52a18d08c077bcdde612def0a}{salsa20\_ivctr64}}(\&st, n3, \textcolor{keyword}{sizeof}(n3), counter3)) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}})     \textcolor{keywordflow}{return} err;}
\DoxyCodeLine{83        \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{salsa20__keystream_8c_a748ea714271d7ecbdc75ff94eae0c15d}{salsa20\_keystream}}(\&st, out, 64))                != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}})     \textcolor{keywordflow}{return} err;}
\DoxyCodeLine{84        \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{salsa20__done_8c_a465c34bbeed87ae78733565f8c2c698c}{salsa20\_done}}(\&st))                              != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}})     \textcolor{keywordflow}{return} err;}
\DoxyCodeLine{85        \textcolor{keywordflow}{if} (\mbox{\hyperlink{tomcrypt__misc_8h_a7764a7f27897c6182335752df00b5f8e}{compare\_testvector}}(out, 64, ct3, \textcolor{keyword}{sizeof}(ct3), \textcolor{stringliteral}{"SALSA20-TV4"}, 1))        \textcolor{keywordflow}{return} \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06caf98a132fdf93633389677f31f9bb39ca}{CRYPT\_FAIL\_TESTVECTOR}};}
\DoxyCodeLine{86    \}}
\DoxyCodeLine{87 }
\DoxyCodeLine{88    \textcolor{keywordflow}{return} \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}};}
\DoxyCodeLine{89 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{90 \}}

\end{DoxyCode}


References compare\+\_\+testvector(), C\+R\+Y\+P\+T\+\_\+\+F\+A\+I\+L\+\_\+\+T\+E\+S\+T\+V\+E\+C\+T\+OR, C\+R\+Y\+P\+T\+\_\+\+N\+OP, C\+R\+Y\+P\+T\+\_\+\+OK, len, rounds(), salsa20\+\_\+crypt(), salsa20\+\_\+done(), salsa20\+\_\+ivctr64(), salsa20\+\_\+keystream(), salsa20\+\_\+memory(), and salsa20\+\_\+setup().

Here is the call graph for this function\+:
% FIG 1
