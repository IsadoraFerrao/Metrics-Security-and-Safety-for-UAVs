\hypertarget{der__decode__custom__type_8c}{}\section{M\+:/\+Office/!\+Doutorado/0. Repositorio\+S\+V\+N/\+H\+A\+M\+S\+T\+E\+R\+\_\+\+Prototype/branches/\+J\+I\+N\+T2018/include/libtomcrypt-\/develop/src/pk/asn1/der/custom\+\_\+type/der\+\_\+decode\+\_\+custom\+\_\+type.c File Reference}
\label{der__decode__custom__type_8c}\index{M:/Office/"!Doutorado/0. RepositorioSVN/HAMSTER\_Prototype/branches/JINT2018/include/libtomcrypt-\/develop/src/pk/asn1/der/custom\_type/der\_decode\_custom\_type.c@{M:/Office/"!Doutorado/0. RepositorioSVN/HAMSTER\_Prototype/branches/JINT2018/include/libtomcrypt-\/develop/src/pk/asn1/der/custom\_type/der\_decode\_custom\_type.c}}


A\+S\+N.\+1 D\+ER, decode a Custom type, Steffen Jaeckel.  


{\ttfamily \#include \char`\"{}tomcrypt\+\_\+private.\+h\char`\"{}}\newline
Include dependency graph for der\+\_\+decode\+\_\+custom\+\_\+type.\+c\+:
% FIG 0
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
int \mbox{\hyperlink{der__decode__custom__type_8c_a698f6c64586707819ebd6f90a14264e8}{der\+\_\+decode\+\_\+custom\+\_\+type}} (const unsigned char $\ast$in, unsigned long inlen, ltc\+\_\+asn1\+\_\+list $\ast$root)
\begin{DoxyCompactList}\small\item\em Decode a Custom type. \end{DoxyCompactList}\item 
int \mbox{\hyperlink{der__decode__custom__type_8c_aaa3acc13042e5d9244ac279a354775fe}{der\+\_\+decode\+\_\+custom\+\_\+type\+\_\+ex}} (const unsigned char $\ast$in, unsigned long inlen, ltc\+\_\+asn1\+\_\+list $\ast$root, ltc\+\_\+asn1\+\_\+list $\ast$list, unsigned long outlen, unsigned int flags)
\begin{DoxyCompactList}\small\item\em Extended-\/decode a Custom type. \end{DoxyCompactList}\end{DoxyCompactItemize}


\subsection{Detailed Description}
A\+S\+N.\+1 D\+ER, decode a Custom type, Steffen Jaeckel. 



\subsection{Function Documentation}
\mbox{\Hypertarget{der__decode__custom__type_8c_a698f6c64586707819ebd6f90a14264e8}\label{der__decode__custom__type_8c_a698f6c64586707819ebd6f90a14264e8}} 
\index{der\_decode\_custom\_type.c@{der\_decode\_custom\_type.c}!der\_decode\_custom\_type@{der\_decode\_custom\_type}}
\index{der\_decode\_custom\_type@{der\_decode\_custom\_type}!der\_decode\_custom\_type.c@{der\_decode\_custom\_type.c}}
\subsubsection{\texorpdfstring{der\_decode\_custom\_type()}{der\_decode\_custom\_type()}}
{\footnotesize\ttfamily int der\+\_\+decode\+\_\+custom\+\_\+type (\begin{DoxyParamCaption}\item[{const unsigned char $\ast$}]{in,  }\item[{unsigned long}]{inlen,  }\item[{ltc\+\_\+asn1\+\_\+list $\ast$}]{root }\end{DoxyParamCaption})}



Decode a Custom type. 


\begin{DoxyParams}{Parameters}
{\em in} & The D\+ER encoded input \\
\hline
{\em inlen} & The size of the input \\
\hline
{\em root} & The item that defines the custom type to decode \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
C\+R\+Y\+P\+T\+\_\+\+OK on success 
\end{DoxyReturn}


Definition at line 26 of file der\+\_\+decode\+\_\+custom\+\_\+type.\+c.


\begin{DoxyCode}{0}
\DoxyCodeLine{28 \{}
\DoxyCodeLine{29    \mbox{\hyperlink{tomcrypt__argchk_8h_a683da3e041e49f196318b6ea951414ba}{LTC\_ARGCHK}}(root != NULL);}
\DoxyCodeLine{30    \textcolor{keywordflow}{return} \mbox{\hyperlink{der__decode__custom__type_8c_aaa3acc13042e5d9244ac279a354775fe}{der\_decode\_custom\_type\_ex}}(in, inlen, root, NULL, 0, LTC\_DER\_SEQ\_ORDERED | LTC\_DER\_SEQ\_RELAXED);}
\DoxyCodeLine{31 \}}

\end{DoxyCode}


References der\+\_\+decode\+\_\+custom\+\_\+type\+\_\+ex(), and L\+T\+C\+\_\+\+A\+R\+G\+C\+HK.



Referenced by der\+\_\+decode\+\_\+choice(), and der\+\_\+decode\+\_\+custom\+\_\+type\+\_\+ex().

Here is the call graph for this function\+:
% FIG 1
Here is the caller graph for this function\+:
% FIG 2
\mbox{\Hypertarget{der__decode__custom__type_8c_aaa3acc13042e5d9244ac279a354775fe}\label{der__decode__custom__type_8c_aaa3acc13042e5d9244ac279a354775fe}} 
\index{der\_decode\_custom\_type.c@{der\_decode\_custom\_type.c}!der\_decode\_custom\_type\_ex@{der\_decode\_custom\_type\_ex}}
\index{der\_decode\_custom\_type\_ex@{der\_decode\_custom\_type\_ex}!der\_decode\_custom\_type.c@{der\_decode\_custom\_type.c}}
\subsubsection{\texorpdfstring{der\_decode\_custom\_type\_ex()}{der\_decode\_custom\_type\_ex()}}
{\footnotesize\ttfamily int der\+\_\+decode\+\_\+custom\+\_\+type\+\_\+ex (\begin{DoxyParamCaption}\item[{const unsigned char $\ast$}]{in,  }\item[{unsigned long}]{inlen,  }\item[{ltc\+\_\+asn1\+\_\+list $\ast$}]{root,  }\item[{ltc\+\_\+asn1\+\_\+list $\ast$}]{list,  }\item[{unsigned long}]{outlen,  }\item[{unsigned int}]{flags }\end{DoxyParamCaption})}



Extended-\/decode a Custom type. 

This function is used to decode custom types and sequences/sets For custom types root is used For sequences/sets list and outlen are used


\begin{DoxyParams}{Parameters}
{\em in} & The D\+ER encoded input \\
\hline
{\em inlen} & The size of the input \\
\hline
{\em root} & The item that defines the custom type to decode \\
\hline
{\em list} & The list of items to decode \\
\hline
{\em outlen} & The number of items in the list \\
\hline
{\em flags} & c.\+f. enum ltc\+\_\+der\+\_\+seq \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
C\+R\+Y\+P\+T\+\_\+\+OK on success 
\end{DoxyReturn}


Definition at line 48 of file der\+\_\+decode\+\_\+custom\+\_\+type.\+c.


\begin{DoxyCode}{0}
\DoxyCodeLine{52 \{}
\DoxyCodeLine{53    \textcolor{keywordtype}{int}           err, seq\_err, i, ordered;}
\DoxyCodeLine{54    ltc\_asn1\_type type;}
\DoxyCodeLine{55    ltc\_asn1\_list ident;}
\DoxyCodeLine{56    \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} size, x, y, z, blksize;}
\DoxyCodeLine{57    \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char}* in\_new = NULL;}
\DoxyCodeLine{58    \textcolor{keywordtype}{void}          *data;}
\DoxyCodeLine{59 }
\DoxyCodeLine{60    \mbox{\hyperlink{tomcrypt__argchk_8h_a683da3e041e49f196318b6ea951414ba}{LTC\_ARGCHK}}(in   != NULL);}
\DoxyCodeLine{61 }
\DoxyCodeLine{62    \textcolor{comment}{/* get blk size */}}
\DoxyCodeLine{63    \textcolor{keywordflow}{if} (inlen < 2) \{}
\DoxyCodeLine{64       \textcolor{keywordflow}{return} \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06ca980088f10ffe9009aec286038a9e79da}{CRYPT\_INVALID\_PACKET}};}
\DoxyCodeLine{65    \}}
\DoxyCodeLine{66    x = 0;}
\DoxyCodeLine{67 }
\DoxyCodeLine{68    \textcolor{keywordflow}{if} (root == NULL) \{}
\DoxyCodeLine{69       \mbox{\hyperlink{tomcrypt__argchk_8h_a683da3e041e49f196318b6ea951414ba}{LTC\_ARGCHK}}(list != NULL);}
\DoxyCodeLine{70 }
\DoxyCodeLine{71       \textcolor{comment}{/* sequence type? We allow 0x30 SEQUENCE and 0x31 SET since fundamentally they're the same structure */}}
\DoxyCodeLine{72       \textcolor{keywordflow}{if} (in[x] != 0x30 \&\& in[x] != 0x31) \{}
\DoxyCodeLine{73          \textcolor{keywordflow}{return} \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06ca980088f10ffe9009aec286038a9e79da}{CRYPT\_INVALID\_PACKET}};}
\DoxyCodeLine{74       \}}
\DoxyCodeLine{75       ++x;}
\DoxyCodeLine{76    \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{77       \textcolor{keywordflow}{if} (root->type != LTC\_ASN1\_CUSTOM\_TYPE) \{}
\DoxyCodeLine{78          \textcolor{keywordflow}{return} \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06ca980088f10ffe9009aec286038a9e79da}{CRYPT\_INVALID\_PACKET}};}
\DoxyCodeLine{79       \}}
\DoxyCodeLine{80 }
\DoxyCodeLine{81       \textcolor{comment}{/* Alloc a copy of the data for primitive handling. */}}
\DoxyCodeLine{82       \textcolor{keywordflow}{if} (root->pc == LTC\_ASN1\_PC\_PRIMITIVE) \{}
\DoxyCodeLine{83          in\_new = \mbox{\hyperlink{tomcrypt__cfg_8h_af363355f38fbaacdefacf270436ae1c9}{XMALLOC}}(inlen);}
\DoxyCodeLine{84          \textcolor{keywordflow}{if} (in\_new == NULL) \{}
\DoxyCodeLine{85             \textcolor{keywordflow}{return} \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06ca0ce0d27adc7ea10b74b7ea904b8bfa82}{CRYPT\_MEM}};}
\DoxyCodeLine{86          \}}
\DoxyCodeLine{87          \mbox{\hyperlink{tomcrypt__cfg_8h_a7691dd48d60d5fc6daf2fa7ec4c55e12}{XMEMCPY}}(in\_new, in, inlen);}
\DoxyCodeLine{88          in = in\_new;}
\DoxyCodeLine{89       \}}
\DoxyCodeLine{90 }
\DoxyCodeLine{91       y = inlen;}
\DoxyCodeLine{92       \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{tomcrypt__private_8h_a651ad7c1f5a930476bb10b9d61555346}{der\_decode\_asn1\_identifier}}(in, \&y, \&ident)) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}}) \{}
\DoxyCodeLine{93          \textcolor{keywordflow}{goto} LBL\_ERR;}
\DoxyCodeLine{94       \}}
\DoxyCodeLine{95       \textcolor{keywordflow}{if} ((ident.type != root->type) ||}
\DoxyCodeLine{96             (ident.klass != root->klass) ||}
\DoxyCodeLine{97             (ident.pc != root->pc) ||}
\DoxyCodeLine{98             (ident.tag != root->tag)) \{}
\DoxyCodeLine{99          err = \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06ca980088f10ffe9009aec286038a9e79da}{CRYPT\_INVALID\_PACKET}};}
\DoxyCodeLine{100          \textcolor{keywordflow}{goto} LBL\_ERR;}
\DoxyCodeLine{101       \}}
\DoxyCodeLine{102       x += y;}
\DoxyCodeLine{103 }
\DoxyCodeLine{104       list = root->data;}
\DoxyCodeLine{105       outlen = root->size;}
\DoxyCodeLine{106    \}}
\DoxyCodeLine{107 }
\DoxyCodeLine{108    \textcolor{keywordflow}{if} (root != NULL \&\& root->pc == LTC\_ASN1\_PC\_PRIMITIVE) \{}
\DoxyCodeLine{109       \textcolor{keywordflow}{if} (((\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long})root->used >= \mbox{\hyperlink{tomcrypt__private_8h_ae8d2a220c8f5b51d2db97b0382a9f206}{der\_asn1\_type\_to\_identifier\_map\_sz}}) ||}
\DoxyCodeLine{110             (\mbox{\hyperlink{tomcrypt__private_8h_a6306ca88074facac89ee0f6c04cbf2f2}{der\_asn1\_type\_to\_identifier\_map}}[root->used] == -1)) \{}
\DoxyCodeLine{111          err = \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06ca980088f10ffe9009aec286038a9e79da}{CRYPT\_INVALID\_PACKET}};}
\DoxyCodeLine{112          \textcolor{keywordflow}{goto} LBL\_ERR;}
\DoxyCodeLine{113       \}}
\DoxyCodeLine{114 }
\DoxyCodeLine{115       root->type = (ltc\_asn1\_type)root->used;}
\DoxyCodeLine{116       list = root;}
\DoxyCodeLine{117       outlen = 1;}
\DoxyCodeLine{118 }
\DoxyCodeLine{119       x -= 1;}
\DoxyCodeLine{120       in\_new[x] = (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char})\mbox{\hyperlink{tomcrypt__private_8h_a6306ca88074facac89ee0f6c04cbf2f2}{der\_asn1\_type\_to\_identifier\_map}}[list[0].type];}
\DoxyCodeLine{121       blksize = inlen - x;}
\DoxyCodeLine{122    \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{123 }
\DoxyCodeLine{124       y = inlen - x;}
\DoxyCodeLine{125       \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{tomcrypt__private_8h_af90423764098b8876368d0984d96053a}{der\_decode\_asn1\_length}}(\&in[x], \&y, \&blksize)) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}}) \{}
\DoxyCodeLine{126          \textcolor{keywordflow}{goto} LBL\_ERR;}
\DoxyCodeLine{127       \}}
\DoxyCodeLine{128       x += y;}
\DoxyCodeLine{129    \}}
\DoxyCodeLine{130 }
\DoxyCodeLine{131    \textcolor{comment}{/* would this blksize overflow? */}}
\DoxyCodeLine{132    \textcolor{keywordflow}{if} (blksize > (inlen - x)) \{}
\DoxyCodeLine{133       err = \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06ca980088f10ffe9009aec286038a9e79da}{CRYPT\_INVALID\_PACKET}};}
\DoxyCodeLine{134       \textcolor{keywordflow}{goto} LBL\_ERR;}
\DoxyCodeLine{135    \}}
\DoxyCodeLine{136 }
\DoxyCodeLine{137    \textcolor{comment}{/* mark all as unused */}}
\DoxyCodeLine{138    \textcolor{keywordflow}{for} (i = 0; i < (int)outlen; i++) \{}
\DoxyCodeLine{139        list[i].used = 0;}
\DoxyCodeLine{140    \}}
\DoxyCodeLine{141    ordered = flags \& LTC\_DER\_SEQ\_ORDERED;}
\DoxyCodeLine{142 }
\DoxyCodeLine{143    \textcolor{comment}{/* ok read data */}}
\DoxyCodeLine{144    seq\_err  = \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}};}
\DoxyCodeLine{145    blksize += x;}
\DoxyCodeLine{146    inlen   -= x;}
\DoxyCodeLine{147    \textcolor{keywordflow}{for} (i = 0; i < (int)outlen; i++) \{}
\DoxyCodeLine{148        z    = 0;}
\DoxyCodeLine{149        type = list[i].type;}
\DoxyCodeLine{150        size = list[i].size;}
\DoxyCodeLine{151        data = list[i].data;}
\DoxyCodeLine{152        \textcolor{keywordflow}{if} (!ordered \&\& list[i].used == 1) \{ \textcolor{keywordflow}{continue}; \}}
\DoxyCodeLine{153 }
\DoxyCodeLine{154        \textcolor{keywordflow}{if} (type == LTC\_ASN1\_EOL) \{}
\DoxyCodeLine{155           \textcolor{keywordflow}{break};}
\DoxyCodeLine{156        \}}
\DoxyCodeLine{157 }
\DoxyCodeLine{158        \textcolor{keywordflow}{if} (root != NULL \&\& root->pc == LTC\_ASN1\_PC\_PRIMITIVE \&\& i != 0) \{}
\DoxyCodeLine{159           err = \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06ca001cb5383cce7c4581790abe472e816f}{CRYPT\_PK\_ASN1\_ERROR}};}
\DoxyCodeLine{160           \textcolor{keywordflow}{goto} LBL\_ERR;}
\DoxyCodeLine{161        \}}
\DoxyCodeLine{162 }
\DoxyCodeLine{163        \textcolor{keywordflow}{switch} (type) \{}
\DoxyCodeLine{164            \textcolor{keywordflow}{case} LTC\_ASN1\_BOOLEAN:}
\DoxyCodeLine{165                z = inlen;}
\DoxyCodeLine{166                \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{der__decode__boolean_8c_a5c72faaf0b34b18bd92db4d95e211a9d}{der\_decode\_boolean}}(in + x, z, ((\textcolor{keywordtype}{int} *)data))) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}}) \{}
\DoxyCodeLine{167                   \textcolor{keywordflow}{if} (!ordered || list[i].optional) \{ \textcolor{keywordflow}{continue}; \}}
\DoxyCodeLine{168                   \textcolor{keywordflow}{goto} LBL\_ERR;}
\DoxyCodeLine{169                \}}
\DoxyCodeLine{170                \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{der__length__boolean_8c_aa90c23682da0279cbe55ea64b2c3e381}{der\_length\_boolean}}(\&z)) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}}) \{}
\DoxyCodeLine{171                   \textcolor{keywordflow}{goto} LBL\_ERR;}
\DoxyCodeLine{172                \}}
\DoxyCodeLine{173                \textcolor{keywordflow}{break};}
\DoxyCodeLine{174 }
\DoxyCodeLine{175            \textcolor{keywordflow}{case} LTC\_ASN1\_INTEGER:}
\DoxyCodeLine{176                z = inlen;}
\DoxyCodeLine{177                \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{der__decode__integer_8c_ac5b0a7020165ada29ba6278fe128599d}{der\_decode\_integer}}(in + x, z, data)) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}}) \{}
\DoxyCodeLine{178                   \textcolor{keywordflow}{if} (!ordered || list[i].optional) \{ \textcolor{keywordflow}{continue}; \}}
\DoxyCodeLine{179                   \textcolor{keywordflow}{goto} LBL\_ERR;}
\DoxyCodeLine{180                \}}
\DoxyCodeLine{181                \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{der__length__integer_8c_af27dfc46ec4a482af05a2265a9d31ca3}{der\_length\_integer}}(data, \&z)) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}}) \{}
\DoxyCodeLine{182                   \textcolor{keywordflow}{goto} LBL\_ERR;}
\DoxyCodeLine{183                \}}
\DoxyCodeLine{184                \textcolor{keywordflow}{break};}
\DoxyCodeLine{185 }
\DoxyCodeLine{186            \textcolor{keywordflow}{case} LTC\_ASN1\_SHORT\_INTEGER:}
\DoxyCodeLine{187                z = inlen;}
\DoxyCodeLine{188                \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{der__decode__short__integer_8c_a1f8c5c4ead2ebe96a1a852329c62154c}{der\_decode\_short\_integer}}(in + x, z, data)) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}}) \{}
\DoxyCodeLine{189                   \textcolor{keywordflow}{if} (!ordered || list[i].optional) \{ \textcolor{keywordflow}{continue}; \}}
\DoxyCodeLine{190                   \textcolor{keywordflow}{goto} LBL\_ERR;}
\DoxyCodeLine{191                \}}
\DoxyCodeLine{192                \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{der__length__short__integer_8c_aa3bac08094cc8142ac313d818cf73fb0}{der\_length\_short\_integer}}(((\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long}*)data)[0], \&z)) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}}) \{}
\DoxyCodeLine{193                   \textcolor{keywordflow}{goto} LBL\_ERR;}
\DoxyCodeLine{194                \}}
\DoxyCodeLine{195 }
\DoxyCodeLine{196                \textcolor{keywordflow}{break};}
\DoxyCodeLine{197 }
\DoxyCodeLine{198            \textcolor{keywordflow}{case} LTC\_ASN1\_BIT\_STRING:}
\DoxyCodeLine{199                z = inlen;}
\DoxyCodeLine{200                \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{der__decode__bit__string_8c_a0a0c371e559e6b455cc4a052d962226f}{der\_decode\_bit\_string}}(in + x, z, data, \&size)) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}}) \{}
\DoxyCodeLine{201                   \textcolor{keywordflow}{if} (!ordered || list[i].optional) \{ \textcolor{keywordflow}{continue}; \}}
\DoxyCodeLine{202                   \textcolor{keywordflow}{goto} LBL\_ERR;}
\DoxyCodeLine{203                \}}
\DoxyCodeLine{204                list[i].size = size;}
\DoxyCodeLine{205                \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{der__length__bit__string_8c_a73416248e2f93535d54603567acc9cfd}{der\_length\_bit\_string}}(size, \&z)) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}}) \{}
\DoxyCodeLine{206                   \textcolor{keywordflow}{goto} LBL\_ERR;}
\DoxyCodeLine{207                \}}
\DoxyCodeLine{208                \textcolor{keywordflow}{break};}
\DoxyCodeLine{209 }
\DoxyCodeLine{210            \textcolor{keywordflow}{case} LTC\_ASN1\_RAW\_BIT\_STRING:}
\DoxyCodeLine{211                z = inlen;}
\DoxyCodeLine{212                \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{der__decode__raw__bit__string_8c_a4e8241401c8f49b3b2dbadd1b8e0eee0}{der\_decode\_raw\_bit\_string}}(in + x, z, data, \&size)) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}}) \{}
\DoxyCodeLine{213                   \textcolor{keywordflow}{if} (!ordered || list[i].optional) \{ \textcolor{keywordflow}{continue}; \}}
\DoxyCodeLine{214                   \textcolor{keywordflow}{goto} LBL\_ERR;}
\DoxyCodeLine{215                \}}
\DoxyCodeLine{216                list[i].size = size;}
\DoxyCodeLine{217                \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{der__length__bit__string_8c_a73416248e2f93535d54603567acc9cfd}{der\_length\_bit\_string}}(size, \&z)) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}}) \{}
\DoxyCodeLine{218                   \textcolor{keywordflow}{goto} LBL\_ERR;}
\DoxyCodeLine{219                \}}
\DoxyCodeLine{220                \textcolor{keywordflow}{break};}
\DoxyCodeLine{221 }
\DoxyCodeLine{222            \textcolor{keywordflow}{case} LTC\_ASN1\_OCTET\_STRING:}
\DoxyCodeLine{223                z = inlen;}
\DoxyCodeLine{224                \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{der__decode__octet__string_8c_af315ce6a951697ede7ec4c9716b5b20b}{der\_decode\_octet\_string}}(in + x, z, data, \&size)) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}}) \{}
\DoxyCodeLine{225                   \textcolor{keywordflow}{if} (!ordered || list[i].optional) \{ \textcolor{keywordflow}{continue}; \}}
\DoxyCodeLine{226                   \textcolor{keywordflow}{goto} LBL\_ERR;}
\DoxyCodeLine{227                \}}
\DoxyCodeLine{228                list[i].size = size;}
\DoxyCodeLine{229                \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{der__length__octet__string_8c_a65b2f3065d3f51608a1dfa3b284a74df}{der\_length\_octet\_string}}(size, \&z)) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}}) \{}
\DoxyCodeLine{230                   \textcolor{keywordflow}{goto} LBL\_ERR;}
\DoxyCodeLine{231                \}}
\DoxyCodeLine{232                \textcolor{keywordflow}{break};}
\DoxyCodeLine{233 }
\DoxyCodeLine{234            \textcolor{keywordflow}{case} LTC\_ASN1\_NULL:}
\DoxyCodeLine{235                \textcolor{keywordflow}{if} (inlen < 2 || in[x] != 0x05 || in[x+1] != 0x00) \{}
\DoxyCodeLine{236                   \textcolor{keywordflow}{if} (!ordered || list[i].optional) \{ \textcolor{keywordflow}{continue}; \}}
\DoxyCodeLine{237                   err = \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06ca980088f10ffe9009aec286038a9e79da}{CRYPT\_INVALID\_PACKET}};}
\DoxyCodeLine{238                   \textcolor{keywordflow}{goto} LBL\_ERR;}
\DoxyCodeLine{239                \}}
\DoxyCodeLine{240                z = 2;}
\DoxyCodeLine{241                \textcolor{keywordflow}{break};}
\DoxyCodeLine{242 }
\DoxyCodeLine{243            \textcolor{keywordflow}{case} LTC\_ASN1\_OBJECT\_IDENTIFIER:}
\DoxyCodeLine{244                z = inlen;}
\DoxyCodeLine{245                \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{der__decode__object__identifier_8c_aee91111fe2b92dca6c83e6c7de36be8f}{der\_decode\_object\_identifier}}(in + x, z, data, \&size)) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}}) \{}
\DoxyCodeLine{246                   \textcolor{keywordflow}{if} (!ordered || list[i].optional) \{ \textcolor{keywordflow}{continue}; \}}
\DoxyCodeLine{247                   \textcolor{keywordflow}{goto} LBL\_ERR;}
\DoxyCodeLine{248                \}}
\DoxyCodeLine{249                list[i].size = size;}
\DoxyCodeLine{250                \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{der__length__object__identifier_8c_ae1fe5b2cd3f20a693cc571a2a8fc9af0}{der\_length\_object\_identifier}}(data, size, \&z)) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}}) \{}
\DoxyCodeLine{251                   \textcolor{keywordflow}{goto} LBL\_ERR;}
\DoxyCodeLine{252                \}}
\DoxyCodeLine{253                \textcolor{keywordflow}{break};}
\DoxyCodeLine{254 }
\DoxyCodeLine{255            \textcolor{keywordflow}{case} LTC\_ASN1\_TELETEX\_STRING:}
\DoxyCodeLine{256                z = inlen;}
\DoxyCodeLine{257                \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{der__decode__teletex__string_8c_a926dc4d05a1a0243569ea85ff85901b6}{der\_decode\_teletex\_string}}(in + x, z, data, \&size)) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}}) \{}
\DoxyCodeLine{258                   \textcolor{keywordflow}{if} (!ordered || list[i].optional) \{ \textcolor{keywordflow}{continue}; \}}
\DoxyCodeLine{259                   \textcolor{keywordflow}{goto} LBL\_ERR;}
\DoxyCodeLine{260                \}}
\DoxyCodeLine{261                list[i].size = size;}
\DoxyCodeLine{262                \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{der__length__teletex__string_8c_a2b3c8aa9d2c26839f9100fdc0286cd93}{der\_length\_teletex\_string}}(data, size, \&z)) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}}) \{}
\DoxyCodeLine{263                   \textcolor{keywordflow}{goto} LBL\_ERR;}
\DoxyCodeLine{264                \}}
\DoxyCodeLine{265                \textcolor{keywordflow}{break};}
\DoxyCodeLine{266 }
\DoxyCodeLine{267            \textcolor{keywordflow}{case} LTC\_ASN1\_IA5\_STRING:}
\DoxyCodeLine{268                z = inlen;}
\DoxyCodeLine{269                \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{der__decode__ia5__string_8c_ac2868573a2a8857a8463337d8411fe79}{der\_decode\_ia5\_string}}(in + x, z, data, \&size)) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}}) \{}
\DoxyCodeLine{270                   \textcolor{keywordflow}{if} (!ordered || list[i].optional) \{ \textcolor{keywordflow}{continue}; \}}
\DoxyCodeLine{271                   \textcolor{keywordflow}{goto} LBL\_ERR;}
\DoxyCodeLine{272                \}}
\DoxyCodeLine{273                list[i].size = size;}
\DoxyCodeLine{274                \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{der__length__ia5__string_8c_a37e6cf2c534040fe726a760956eade04}{der\_length\_ia5\_string}}(data, size, \&z)) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}}) \{}
\DoxyCodeLine{275                   \textcolor{keywordflow}{goto} LBL\_ERR;}
\DoxyCodeLine{276                \}}
\DoxyCodeLine{277                \textcolor{keywordflow}{break};}
\DoxyCodeLine{278 }
\DoxyCodeLine{279            \textcolor{keywordflow}{case} LTC\_ASN1\_PRINTABLE\_STRING:}
\DoxyCodeLine{280                z = inlen;}
\DoxyCodeLine{281                \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{der__decode__printable__string_8c_a0967e5db58c3ce6b0971b5c5097c0d9f}{der\_decode\_printable\_string}}(in + x, z, data, \&size)) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}}) \{}
\DoxyCodeLine{282                   \textcolor{keywordflow}{if} (!ordered || list[i].optional) \{ \textcolor{keywordflow}{continue}; \}}
\DoxyCodeLine{283                   \textcolor{keywordflow}{goto} LBL\_ERR;}
\DoxyCodeLine{284                \}}
\DoxyCodeLine{285                list[i].size = size;}
\DoxyCodeLine{286                \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{der__length__printable__string_8c_ac206210b58e1bac2342a80d26bd802db}{der\_length\_printable\_string}}(data, size, \&z)) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}}) \{}
\DoxyCodeLine{287                   \textcolor{keywordflow}{goto} LBL\_ERR;}
\DoxyCodeLine{288                \}}
\DoxyCodeLine{289                \textcolor{keywordflow}{break};}
\DoxyCodeLine{290 }
\DoxyCodeLine{291            \textcolor{keywordflow}{case} LTC\_ASN1\_UTF8\_STRING:}
\DoxyCodeLine{292                z = inlen;}
\DoxyCodeLine{293                \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{der__decode__utf8__string_8c_afc867f0f02273fac931669abded4cbb3}{der\_decode\_utf8\_string}}(in + x, z, data, \&size)) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}}) \{}
\DoxyCodeLine{294                   \textcolor{keywordflow}{if} (!ordered || list[i].optional) \{ \textcolor{keywordflow}{continue}; \}}
\DoxyCodeLine{295                   \textcolor{keywordflow}{goto} LBL\_ERR;}
\DoxyCodeLine{296                \}}
\DoxyCodeLine{297                list[i].size = size;}
\DoxyCodeLine{298                \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{der__length__utf8__string_8c_aa8b54979c2261c4d703c9464e0bb14c1}{der\_length\_utf8\_string}}(data, size, \&z)) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}}) \{}
\DoxyCodeLine{299                   \textcolor{keywordflow}{goto} LBL\_ERR;}
\DoxyCodeLine{300                \}}
\DoxyCodeLine{301                \textcolor{keywordflow}{break};}
\DoxyCodeLine{302 }
\DoxyCodeLine{303            \textcolor{keywordflow}{case} LTC\_ASN1\_UTCTIME:}
\DoxyCodeLine{304                z = inlen;}
\DoxyCodeLine{305                \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{der__decode__utctime_8c_a228dad2e418af24965b9b16188d61aac}{der\_decode\_utctime}}(in + x, \&z, data)) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}}) \{}
\DoxyCodeLine{306                   \textcolor{keywordflow}{if} (!ordered || list[i].optional) \{ \textcolor{keywordflow}{continue}; \}}
\DoxyCodeLine{307                   \textcolor{keywordflow}{goto} LBL\_ERR;}
\DoxyCodeLine{308                \}}
\DoxyCodeLine{309                \textcolor{keywordflow}{break};}
\DoxyCodeLine{310 }
\DoxyCodeLine{311            \textcolor{keywordflow}{case} LTC\_ASN1\_GENERALIZEDTIME:}
\DoxyCodeLine{312                z = inlen;}
\DoxyCodeLine{313                \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{der__decode__generalizedtime_8c_acca5d83c0dcc2bc67d724318132f66e1}{der\_decode\_generalizedtime}}(in + x, \&z, data)) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}}) \{}
\DoxyCodeLine{314                   \textcolor{keywordflow}{if} (!ordered || list[i].optional) \{ \textcolor{keywordflow}{continue}; \}}
\DoxyCodeLine{315                   \textcolor{keywordflow}{goto} LBL\_ERR;}
\DoxyCodeLine{316                \}}
\DoxyCodeLine{317                \textcolor{keywordflow}{break};}
\DoxyCodeLine{318 }
\DoxyCodeLine{319            \textcolor{keywordflow}{case} LTC\_ASN1\_SET:}
\DoxyCodeLine{320                z = inlen;}
\DoxyCodeLine{321                \textcolor{keywordflow}{if} ((err = der\_decode\_set(in + x, z, data, size)) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}}) \{}
\DoxyCodeLine{322                   \textcolor{keywordflow}{if} (!ordered || list[i].optional) \{ \textcolor{keywordflow}{continue}; \}}
\DoxyCodeLine{323                   \textcolor{keywordflow}{goto} LBL\_ERR;}
\DoxyCodeLine{324                \}}
\DoxyCodeLine{325                \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{der__length__sequence_8c_a46c60ff7d1e17a527913809bffe41546}{der\_length\_sequence}}(data, size, \&z)) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}}) \{}
\DoxyCodeLine{326                   \textcolor{keywordflow}{goto} LBL\_ERR;}
\DoxyCodeLine{327                \}}
\DoxyCodeLine{328                \textcolor{keywordflow}{break};}
\DoxyCodeLine{329 }
\DoxyCodeLine{330            \textcolor{keywordflow}{case} LTC\_ASN1\_SETOF:}
\DoxyCodeLine{331            \textcolor{keywordflow}{case} LTC\_ASN1\_SEQUENCE:}
\DoxyCodeLine{332                \textcolor{comment}{/* detect if we have the right type */}}
\DoxyCodeLine{333                \textcolor{keywordflow}{if} ((type == LTC\_ASN1\_SETOF \&\& (in[x] \& 0x3F) != 0x31) || (type == LTC\_ASN1\_SEQUENCE \&\& (in[x] \& 0x3F) != 0x30)) \{}
\DoxyCodeLine{334                   err = \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06ca980088f10ffe9009aec286038a9e79da}{CRYPT\_INVALID\_PACKET}};}
\DoxyCodeLine{335                   \textcolor{keywordflow}{goto} LBL\_ERR;}
\DoxyCodeLine{336                \}}
\DoxyCodeLine{337 }
\DoxyCodeLine{338                z = inlen;}
\DoxyCodeLine{339                err = \mbox{\hyperlink{der__decode__sequence__ex_8c_a388cbc3f5c404637bc51f9dfb2d4f677}{der\_decode\_sequence\_ex}}(in + x, z, data, size, flags);}
\DoxyCodeLine{340                \textcolor{keywordflow}{if} (err == \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cadf938469ecf1be83eff1b661288fae7a}{CRYPT\_INPUT\_TOO\_LONG}}) \{}
\DoxyCodeLine{341                   seq\_err = \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cadf938469ecf1be83eff1b661288fae7a}{CRYPT\_INPUT\_TOO\_LONG}};}
\DoxyCodeLine{342                   err = \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}};}
\DoxyCodeLine{343                \}}
\DoxyCodeLine{344                \textcolor{keywordflow}{if} (err != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}}) \{}
\DoxyCodeLine{345                   \textcolor{keywordflow}{if} (!ordered || list[i].optional) \{ \textcolor{keywordflow}{continue}; \}}
\DoxyCodeLine{346                   \textcolor{keywordflow}{goto} LBL\_ERR;}
\DoxyCodeLine{347                \}}
\DoxyCodeLine{348                \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{der__length__sequence_8c_a46c60ff7d1e17a527913809bffe41546}{der\_length\_sequence}}(data, size, \&z)) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}}) \{}
\DoxyCodeLine{349                   \textcolor{keywordflow}{goto} LBL\_ERR;}
\DoxyCodeLine{350                \}}
\DoxyCodeLine{351                \textcolor{keywordflow}{break};}
\DoxyCodeLine{352 }
\DoxyCodeLine{353            \textcolor{keywordflow}{case} LTC\_ASN1\_CUSTOM\_TYPE:}
\DoxyCodeLine{354                z = inlen;}
\DoxyCodeLine{355                err = \mbox{\hyperlink{der__decode__custom__type_8c_a698f6c64586707819ebd6f90a14264e8}{der\_decode\_custom\_type}}(in + x, z, \&list[i]);}
\DoxyCodeLine{356                \textcolor{keywordflow}{if} (err == \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cadf938469ecf1be83eff1b661288fae7a}{CRYPT\_INPUT\_TOO\_LONG}}) \{}
\DoxyCodeLine{357                   seq\_err = \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cadf938469ecf1be83eff1b661288fae7a}{CRYPT\_INPUT\_TOO\_LONG}};}
\DoxyCodeLine{358                   err = \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}};}
\DoxyCodeLine{359                \}}
\DoxyCodeLine{360                \textcolor{keywordflow}{if} (err != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}}) \{}
\DoxyCodeLine{361                   \textcolor{keywordflow}{if} (!ordered || list[i].optional) \{ \textcolor{keywordflow}{continue}; \}}
\DoxyCodeLine{362                   \textcolor{keywordflow}{goto} LBL\_ERR;}
\DoxyCodeLine{363                \}}
\DoxyCodeLine{364                \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{der__length__custom__type_8c_aff691792e4f0be46252fad3b9aa4955c}{der\_length\_custom\_type}}(\&list[i], \&z, NULL)) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}}) \{}
\DoxyCodeLine{365                   \textcolor{keywordflow}{goto} LBL\_ERR;}
\DoxyCodeLine{366                \}}
\DoxyCodeLine{367                \textcolor{keywordflow}{break};}
\DoxyCodeLine{368 }
\DoxyCodeLine{369            \textcolor{keywordflow}{case} LTC\_ASN1\_CHOICE:}
\DoxyCodeLine{370                z = inlen;}
\DoxyCodeLine{371                \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{der__decode__choice_8c_abbc3f8406cbf0c2d75b1c801192dcad4}{der\_decode\_choice}}(in + x, \&z, data, size)) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}}) \{}
\DoxyCodeLine{372                   \textcolor{keywordflow}{if} (!ordered || list[i].optional) \{ \textcolor{keywordflow}{continue}; \}}
\DoxyCodeLine{373                   \textcolor{keywordflow}{goto} LBL\_ERR;}
\DoxyCodeLine{374                \}}
\DoxyCodeLine{375                \textcolor{keywordflow}{break};}
\DoxyCodeLine{376 }
\DoxyCodeLine{377            \textcolor{keywordflow}{case} LTC\_ASN1\_EOL:}
\DoxyCodeLine{378                err = \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06ca92aa8bad3930f08d5a188bf72094b066}{CRYPT\_INVALID\_ARG}};}
\DoxyCodeLine{379                \textcolor{keywordflow}{goto} LBL\_ERR;}
\DoxyCodeLine{380        \}}
\DoxyCodeLine{381        x           += z;}
\DoxyCodeLine{382        inlen       -= z;}
\DoxyCodeLine{383        list[i].used = 1;}
\DoxyCodeLine{384        \textcolor{keywordflow}{if} (!ordered) \{}
\DoxyCodeLine{385           \textcolor{comment}{/* restart the decoder */}}
\DoxyCodeLine{386           i = -1;}
\DoxyCodeLine{387        \}}
\DoxyCodeLine{388    \}}
\DoxyCodeLine{389 }
\DoxyCodeLine{390    \textcolor{keywordflow}{for} (i = 0; i < (int)outlen; i++) \{}
\DoxyCodeLine{391       \textcolor{keywordflow}{if} (list[i].used == 0 \&\& list[i].optional == 0) \{}
\DoxyCodeLine{392           err = \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06ca980088f10ffe9009aec286038a9e79da}{CRYPT\_INVALID\_PACKET}};}
\DoxyCodeLine{393           \textcolor{keywordflow}{goto} LBL\_ERR;}
\DoxyCodeLine{394       \}}
\DoxyCodeLine{395    \}}
\DoxyCodeLine{396 }
\DoxyCodeLine{397    \textcolor{keywordflow}{if} (blksize == x \&\& seq\_err == \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}} \&\& inlen == 0) \{}
\DoxyCodeLine{398       \textcolor{comment}{/* everything decoded and no errors in nested sequences */}}
\DoxyCodeLine{399       err = \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}};}
\DoxyCodeLine{400    \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (blksize == x \&\& seq\_err == \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cadf938469ecf1be83eff1b661288fae7a}{CRYPT\_INPUT\_TOO\_LONG}} \&\& inlen == 0) \{}
\DoxyCodeLine{401       \textcolor{comment}{/* a sequence reported too-long input, but now we've decoded everything */}}
\DoxyCodeLine{402       err = \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}};}
\DoxyCodeLine{403    \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (blksize != x \&\& ((flags \& LTC\_DER\_SEQ\_STRICT) == LTC\_DER\_SEQ\_STRICT)) \{}
\DoxyCodeLine{404       err = \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06ca980088f10ffe9009aec286038a9e79da}{CRYPT\_INVALID\_PACKET}};}
\DoxyCodeLine{405    \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{406       err = \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cadf938469ecf1be83eff1b661288fae7a}{CRYPT\_INPUT\_TOO\_LONG}};}
\DoxyCodeLine{407    \}}
\DoxyCodeLine{408 }
\DoxyCodeLine{409 LBL\_ERR:}
\DoxyCodeLine{410    \textcolor{keywordflow}{if} (in\_new != NULL) \{}
\DoxyCodeLine{411       \mbox{\hyperlink{tomcrypt__cfg_8h_a260d66fc0690e0502cf3bfe7b5244b75}{XFREE}}(in\_new);}
\DoxyCodeLine{412    \}}
\DoxyCodeLine{413    \textcolor{keywordflow}{return} err;}
\DoxyCodeLine{414 \}}

\end{DoxyCode}


References C\+R\+Y\+P\+T\+\_\+\+I\+N\+P\+U\+T\+\_\+\+T\+O\+O\+\_\+\+L\+O\+NG, C\+R\+Y\+P\+T\+\_\+\+I\+N\+V\+A\+L\+I\+D\+\_\+\+A\+RG, C\+R\+Y\+P\+T\+\_\+\+I\+N\+V\+A\+L\+I\+D\+\_\+\+P\+A\+C\+K\+ET, C\+R\+Y\+P\+T\+\_\+\+M\+EM, C\+R\+Y\+P\+T\+\_\+\+OK, C\+R\+Y\+P\+T\+\_\+\+P\+K\+\_\+\+A\+S\+N1\+\_\+\+E\+R\+R\+OR, der\+\_\+asn1\+\_\+type\+\_\+to\+\_\+identifier\+\_\+map, der\+\_\+asn1\+\_\+type\+\_\+to\+\_\+identifier\+\_\+map\+\_\+sz, der\+\_\+decode\+\_\+asn1\+\_\+identifier(), der\+\_\+decode\+\_\+asn1\+\_\+length(), der\+\_\+decode\+\_\+bit\+\_\+string(), der\+\_\+decode\+\_\+boolean(), der\+\_\+decode\+\_\+choice(), der\+\_\+decode\+\_\+custom\+\_\+type(), der\+\_\+decode\+\_\+generalizedtime(), der\+\_\+decode\+\_\+ia5\+\_\+string(), der\+\_\+decode\+\_\+integer(), der\+\_\+decode\+\_\+object\+\_\+identifier(), der\+\_\+decode\+\_\+octet\+\_\+string(), der\+\_\+decode\+\_\+printable\+\_\+string(), der\+\_\+decode\+\_\+raw\+\_\+bit\+\_\+string(), der\+\_\+decode\+\_\+sequence\+\_\+ex(), der\+\_\+decode\+\_\+short\+\_\+integer(), der\+\_\+decode\+\_\+teletex\+\_\+string(), der\+\_\+decode\+\_\+utctime(), der\+\_\+decode\+\_\+utf8\+\_\+string(), der\+\_\+length\+\_\+bit\+\_\+string(), der\+\_\+length\+\_\+boolean(), der\+\_\+length\+\_\+custom\+\_\+type(), der\+\_\+length\+\_\+ia5\+\_\+string(), der\+\_\+length\+\_\+integer(), der\+\_\+length\+\_\+object\+\_\+identifier(), der\+\_\+length\+\_\+octet\+\_\+string(), der\+\_\+length\+\_\+printable\+\_\+string(), der\+\_\+length\+\_\+sequence(), der\+\_\+length\+\_\+short\+\_\+integer(), der\+\_\+length\+\_\+teletex\+\_\+string(), der\+\_\+length\+\_\+utf8\+\_\+string(), L\+T\+C\+\_\+\+A\+R\+G\+C\+HK, X\+F\+R\+E\+E(), X\+M\+A\+L\+L\+O\+C(), and X\+M\+E\+M\+C\+P\+Y().



Referenced by der\+\_\+decode\+\_\+custom\+\_\+type(), and der\+\_\+decode\+\_\+sequence\+\_\+ex().

Here is the call graph for this function\+:
% FIG 3
Here is the caller graph for this function\+:
% FIG 4
