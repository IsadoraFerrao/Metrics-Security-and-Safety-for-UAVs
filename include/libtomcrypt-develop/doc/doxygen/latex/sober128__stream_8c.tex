\hypertarget{sober128__stream_8c}{}\section{M\+:/\+Office/!\+Doutorado/0. Repositorio\+S\+V\+N/\+H\+A\+M\+S\+T\+E\+R\+\_\+\+Prototype/branches/\+J\+I\+N\+T2018/include/libtomcrypt-\/develop/src/stream/sober128/sober128\+\_\+stream.c File Reference}
\label{sober128__stream_8c}\index{M:/Office/"!Doutorado/0. RepositorioSVN/HAMSTER\_Prototype/branches/JINT2018/include/libtomcrypt-\/develop/src/stream/sober128/sober128\_stream.c@{M:/Office/"!Doutorado/0. RepositorioSVN/HAMSTER\_Prototype/branches/JINT2018/include/libtomcrypt-\/develop/src/stream/sober128/sober128\_stream.c}}


Implementation of S\+O\+B\+E\+R-\/128 by Tom St Denis.  


{\ttfamily \#include \char`\"{}tomcrypt\+\_\+private.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}sober128tab.\+c\char`\"{}}\newline
Include dependency graph for sober128\+\_\+stream.\+c\+:
% FIG 0
\subsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\#define \mbox{\hyperlink{sober128__stream_8c_a681d8c4c214fd1ab4359d8b6e2010389}{\+\_\+\+\_\+\+L\+T\+C\+\_\+\+S\+O\+B\+E\+R128\+T\+A\+B\+\_\+\+C\+\_\+\+\_\+}}
\item 
\#define \mbox{\hyperlink{sober128__stream_8c_a0240ac851181b84ac374872dc5434ee4}{N}}~17
\item 
\#define \mbox{\hyperlink{sober128__stream_8c_a5a2c87c756ba2c17a5661050cbce0d4b}{I\+N\+I\+T\+K\+O\+N\+ST}}~0x6996c53a /$\ast$ value of K\+O\+N\+S\+T to use during key loading $\ast$/
\item 
\#define \mbox{\hyperlink{sober128__stream_8c_a46ce3fbf3c71e090922bd0994e1f9a76}{K\+E\+YP}}~15 /$\ast$ where to insert key words $\ast$/
\item 
\#define \mbox{\hyperlink{sober128__stream_8c_aedca565d3dcf476fd6462998b6f3a40c}{F\+O\+L\+DP}}~4 /$\ast$ where to insert non-\/linear feedback $\ast$/
\item 
\#define \mbox{\hyperlink{sober128__stream_8c_a8a518c5522fa2db78fc172efdf95315f}{O\+FF}}(zero,  i)~(((zero)+(i)) \% \mbox{\hyperlink{sober128__stream_8c_a0240ac851181b84ac374872dc5434ee4}{N}})
\item 
\#define \mbox{\hyperlink{sober128__stream_8c_ab34523a5ce2c65f006ae4dfd3724ce1e}{S\+T\+EP}}(\mbox{\hyperlink{sha512_8c_a8fb1dfc3ad6dd07bc99c1962e6583087}{R}},  z)~\mbox{\hyperlink{sha512_8c_a8fb1dfc3ad6dd07bc99c1962e6583087}{R}}\mbox{[}\mbox{\hyperlink{sober128__stream_8c_a8a518c5522fa2db78fc172efdf95315f}{O\+FF}}(z,0)\mbox{]} = \mbox{\hyperlink{sha512_8c_a8fb1dfc3ad6dd07bc99c1962e6583087}{R}}\mbox{[}\mbox{\hyperlink{sober128__stream_8c_a8a518c5522fa2db78fc172efdf95315f}{O\+FF}}(z,15)\mbox{]} $^\wedge$ \mbox{\hyperlink{sha512_8c_a8fb1dfc3ad6dd07bc99c1962e6583087}{R}}\mbox{[}\mbox{\hyperlink{sober128__stream_8c_a8a518c5522fa2db78fc172efdf95315f}{O\+FF}}(z,4)\mbox{]} $^\wedge$ (\mbox{\hyperlink{sha512_8c_a8fb1dfc3ad6dd07bc99c1962e6583087}{R}}\mbox{[}\mbox{\hyperlink{sober128__stream_8c_a8a518c5522fa2db78fc172efdf95315f}{O\+FF}}(z,0)\mbox{]} $<$$<$ 8) $^\wedge$ Multab\mbox{[}(\mbox{\hyperlink{sha512_8c_a8fb1dfc3ad6dd07bc99c1962e6583087}{R}}\mbox{[}\mbox{\hyperlink{sober128__stream_8c_a8a518c5522fa2db78fc172efdf95315f}{O\+FF}}(z,0)\mbox{]} $>$$>$ 24) \& 0x\+F\+F\mbox{]};
\item 
\#define \mbox{\hyperlink{sober128__stream_8c_aa709100c11514f9fcfa04328f5db3542}{N\+L\+F\+U\+NC}}(st,  z)
\item 
\#define \mbox{\hyperlink{sober128__stream_8c_a67c3a492da60ba338b260e35335a62b2}{A\+D\+D\+K\+EY}}(k)~st-\/$>$\mbox{\hyperlink{sha512_8c_a8fb1dfc3ad6dd07bc99c1962e6583087}{R}}\mbox{[}\mbox{\hyperlink{sober128__stream_8c_a46ce3fbf3c71e090922bd0994e1f9a76}{K\+E\+YP}}\mbox{]} += (k);
\item 
\#define \mbox{\hyperlink{sober128__stream_8c_a1da4fb251037c5aa51b01005fea7e978}{X\+O\+R\+NL}}(nl)~st-\/$>$\mbox{\hyperlink{sha512_8c_a8fb1dfc3ad6dd07bc99c1962e6583087}{R}}\mbox{[}\mbox{\hyperlink{sober128__stream_8c_aedca565d3dcf476fd6462998b6f3a40c}{F\+O\+L\+DP}}\mbox{]} $^\wedge$= (nl);
\item 
\#define \mbox{\hyperlink{sober128__stream_8c_a6123cbc72dbb66dcee5646b56446c399}{D\+R\+O\+U\+ND}}(z)~\mbox{\hyperlink{sosemanuk_8c_a88db4597248911aff1db830d19e9270c}{S\+T\+EP}}(st-\/$>$\mbox{\hyperlink{sha512_8c_a8fb1dfc3ad6dd07bc99c1962e6583087}{R}},z); \mbox{\hyperlink{sober128__stream_8c_aa709100c11514f9fcfa04328f5db3542}{N\+L\+F\+U\+NC}}(st,(z+1)); st-\/$>$\mbox{\hyperlink{sha512_8c_a8fb1dfc3ad6dd07bc99c1962e6583087}{R}}\mbox{[}\mbox{\hyperlink{sober128__stream_8c_a8a518c5522fa2db78fc172efdf95315f}{O\+FF}}((z+1),\mbox{\hyperlink{sober128__stream_8c_aedca565d3dcf476fd6462998b6f3a40c}{F\+O\+L\+DP}})\mbox{]} $^\wedge$= t;
\item 
\#define \mbox{\hyperlink{sober128__stream_8c_af3730ea06ef3ea8ffff53d4b13dad3ea}{S\+R\+O\+U\+ND}}(z)~\mbox{\hyperlink{sosemanuk_8c_a88db4597248911aff1db830d19e9270c}{S\+T\+EP}}(st-\/$>$\mbox{\hyperlink{sha512_8c_a8fb1dfc3ad6dd07bc99c1962e6583087}{R}},z); \mbox{\hyperlink{sober128__stream_8c_aa709100c11514f9fcfa04328f5db3542}{N\+L\+F\+U\+NC}}(st,(z+1)); \mbox{\hyperlink{sober128__stream_8c_a272d26d71ca3e6dd2b4282302c91e5bd}{X\+O\+R\+W\+O\+RD}}(t, in+(z$\ast$4), out+(z$\ast$4));
\end{DoxyCompactItemize}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
static \mbox{\hyperlink{tomcrypt__cfg_8h_a1f20274bb048d3c8a916b261dfff9567}{ulong32}} \mbox{\hyperlink{sober128__stream_8c_ae7acc8746ffb536a618b77f0e2042807}{B\+Y\+T\+E2\+W\+O\+RD}} (const unsigned char $\ast$b)
\item 
static void \mbox{\hyperlink{sober128__stream_8c_a272d26d71ca3e6dd2b4282302c91e5bd}{X\+O\+R\+W\+O\+RD}} (\mbox{\hyperlink{tomcrypt__cfg_8h_a1f20274bb048d3c8a916b261dfff9567}{ulong32}} w, const unsigned char $\ast$in, unsigned char $\ast$out)
\item 
static void \mbox{\hyperlink{sober128__stream_8c_a5ee309e1f2da8afec6f25f826763f55d}{cycle}} (\mbox{\hyperlink{tomcrypt__cfg_8h_a1f20274bb048d3c8a916b261dfff9567}{ulong32}} $\ast$\mbox{\hyperlink{sha512_8c_a8fb1dfc3ad6dd07bc99c1962e6583087}{R}})
\item 
static \mbox{\hyperlink{tomcrypt__cfg_8h_a1f20274bb048d3c8a916b261dfff9567}{ulong32}} \mbox{\hyperlink{sober128__stream_8c_aa40918d0bb77cd616f54d859fe3ceb34}{nltap}} (const sober128\+\_\+state $\ast$st)
\item 
static void \mbox{\hyperlink{sober128__stream_8c_a884ca93789ee73dea18768f55567bc67}{s128\+\_\+savestate}} (sober128\+\_\+state $\ast$st)
\item 
static void \mbox{\hyperlink{sober128__stream_8c_a658f8c5cee73aa58ecf24133861c084d}{s128\+\_\+reloadstate}} (sober128\+\_\+state $\ast$st)
\item 
static void \mbox{\hyperlink{sober128__stream_8c_afeb3cc1b4facd7436b991dc552ffb038}{s128\+\_\+genkonst}} (sober128\+\_\+state $\ast$st)
\item 
static void \mbox{\hyperlink{sober128__stream_8c_a90d35fdc987c8472cc4390a3dc4c7777}{s128\+\_\+diffuse}} (sober128\+\_\+state $\ast$st)
\item 
int \mbox{\hyperlink{sober128__stream_8c_a0a1e7b2ff7cfbba83eee53e875ef8d6e}{sober128\+\_\+stream\+\_\+setup}} (sober128\+\_\+state $\ast$st, const unsigned char $\ast$key, unsigned long keylen)
\begin{DoxyCompactList}\small\item\em Initialize an Sober128 context (only the key) \end{DoxyCompactList}\item 
int \mbox{\hyperlink{sober128__stream_8c_aad93d7243d0b6e8bb46f8637c1dab891}{sober128\+\_\+stream\+\_\+setiv}} (sober128\+\_\+state $\ast$st, const unsigned char $\ast$iv, unsigned long ivlen)
\begin{DoxyCompactList}\small\item\em Set IV to the Sober128 state. \end{DoxyCompactList}\item 
int \mbox{\hyperlink{sober128__stream_8c_ae518d65a1bd918959e0d52e3f7d963de}{sober128\+\_\+stream\+\_\+crypt}} (sober128\+\_\+state $\ast$st, const unsigned char $\ast$in, unsigned long inlen, unsigned char $\ast$out)
\begin{DoxyCompactList}\small\item\em Encrypt (or decrypt) bytes of ciphertext (or plaintext) with Sober128. \end{DoxyCompactList}\item 
int \mbox{\hyperlink{sober128__stream_8c_a8f44e316ae3d51801843156a64966a34}{sober128\+\_\+stream\+\_\+keystream}} (sober128\+\_\+state $\ast$st, unsigned char $\ast$out, unsigned long outlen)
\item 
int \mbox{\hyperlink{sober128__stream_8c_a37c4a04830801bac9f4b432b4b45fb2d}{sober128\+\_\+stream\+\_\+done}} (sober128\+\_\+state $\ast$st)
\begin{DoxyCompactList}\small\item\em Terminate and clear Sober128 state. \end{DoxyCompactList}\end{DoxyCompactItemize}


\subsection{Detailed Description}
Implementation of S\+O\+B\+E\+R-\/128 by Tom St Denis. 

Based on s128fast.\+c reference code supplied by Greg Rose of Q\+U\+A\+L\+C\+O\+MM. 

\subsection{Macro Definition Documentation}
\mbox{\Hypertarget{sober128__stream_8c_a681d8c4c214fd1ab4359d8b6e2010389}\label{sober128__stream_8c_a681d8c4c214fd1ab4359d8b6e2010389}} 
\index{sober128\_stream.c@{sober128\_stream.c}!\_\_LTC\_SOBER128TAB\_C\_\_@{\_\_LTC\_SOBER128TAB\_C\_\_}}
\index{\_\_LTC\_SOBER128TAB\_C\_\_@{\_\_LTC\_SOBER128TAB\_C\_\_}!sober128\_stream.c@{sober128\_stream.c}}
\subsubsection{\texorpdfstring{\_\_LTC\_SOBER128TAB\_C\_\_}{\_\_LTC\_SOBER128TAB\_C\_\_}}
{\footnotesize\ttfamily \#define \+\_\+\+\_\+\+L\+T\+C\+\_\+\+S\+O\+B\+E\+R128\+T\+A\+B\+\_\+\+C\+\_\+\+\_\+}



Definition at line 19 of file sober128\+\_\+stream.\+c.

\mbox{\Hypertarget{sober128__stream_8c_a67c3a492da60ba338b260e35335a62b2}\label{sober128__stream_8c_a67c3a492da60ba338b260e35335a62b2}} 
\index{sober128\_stream.c@{sober128\_stream.c}!ADDKEY@{ADDKEY}}
\index{ADDKEY@{ADDKEY}!sober128\_stream.c@{sober128\_stream.c}}
\subsubsection{\texorpdfstring{ADDKEY}{ADDKEY}}
{\footnotesize\ttfamily \#define A\+D\+D\+K\+EY(\begin{DoxyParamCaption}\item[{}]{k }\end{DoxyParamCaption})~st-\/$>$\mbox{\hyperlink{sha512_8c_a8fb1dfc3ad6dd07bc99c1962e6583087}{R}}\mbox{[}\mbox{\hyperlink{sober128__stream_8c_a46ce3fbf3c71e090922bd0994e1f9a76}{K\+E\+YP}}\mbox{]} += (k);}



Definition at line 121 of file sober128\+\_\+stream.\+c.

\mbox{\Hypertarget{sober128__stream_8c_a6123cbc72dbb66dcee5646b56446c399}\label{sober128__stream_8c_a6123cbc72dbb66dcee5646b56446c399}} 
\index{sober128\_stream.c@{sober128\_stream.c}!DROUND@{DROUND}}
\index{DROUND@{DROUND}!sober128\_stream.c@{sober128\_stream.c}}
\subsubsection{\texorpdfstring{DROUND}{DROUND}}
{\footnotesize\ttfamily \#define D\+R\+O\+U\+ND(\begin{DoxyParamCaption}\item[{}]{z }\end{DoxyParamCaption})~\mbox{\hyperlink{sosemanuk_8c_a88db4597248911aff1db830d19e9270c}{S\+T\+EP}}(st-\/$>$\mbox{\hyperlink{sha512_8c_a8fb1dfc3ad6dd07bc99c1962e6583087}{R}},z); \mbox{\hyperlink{sober128__stream_8c_aa709100c11514f9fcfa04328f5db3542}{N\+L\+F\+U\+NC}}(st,(z+1)); st-\/$>$\mbox{\hyperlink{sha512_8c_a8fb1dfc3ad6dd07bc99c1962e6583087}{R}}\mbox{[}\mbox{\hyperlink{sober128__stream_8c_a8a518c5522fa2db78fc172efdf95315f}{O\+FF}}((z+1),\mbox{\hyperlink{sober128__stream_8c_aedca565d3dcf476fd6462998b6f3a40c}{F\+O\+L\+DP}})\mbox{]} $^\wedge$= t;}



Definition at line 128 of file sober128\+\_\+stream.\+c.

\mbox{\Hypertarget{sober128__stream_8c_aedca565d3dcf476fd6462998b6f3a40c}\label{sober128__stream_8c_aedca565d3dcf476fd6462998b6f3a40c}} 
\index{sober128\_stream.c@{sober128\_stream.c}!FOLDP@{FOLDP}}
\index{FOLDP@{FOLDP}!sober128\_stream.c@{sober128\_stream.c}}
\subsubsection{\texorpdfstring{FOLDP}{FOLDP}}
{\footnotesize\ttfamily \#define F\+O\+L\+DP~4 /$\ast$ where to insert non-\/linear feedback $\ast$/}



Definition at line 26 of file sober128\+\_\+stream.\+c.

\mbox{\Hypertarget{sober128__stream_8c_a5a2c87c756ba2c17a5661050cbce0d4b}\label{sober128__stream_8c_a5a2c87c756ba2c17a5661050cbce0d4b}} 
\index{sober128\_stream.c@{sober128\_stream.c}!INITKONST@{INITKONST}}
\index{INITKONST@{INITKONST}!sober128\_stream.c@{sober128\_stream.c}}
\subsubsection{\texorpdfstring{INITKONST}{INITKONST}}
{\footnotesize\ttfamily \#define I\+N\+I\+T\+K\+O\+N\+ST~0x6996c53a /$\ast$ value of K\+O\+N\+S\+T to use during key loading $\ast$/}



Definition at line 24 of file sober128\+\_\+stream.\+c.

\mbox{\Hypertarget{sober128__stream_8c_a46ce3fbf3c71e090922bd0994e1f9a76}\label{sober128__stream_8c_a46ce3fbf3c71e090922bd0994e1f9a76}} 
\index{sober128\_stream.c@{sober128\_stream.c}!KEYP@{KEYP}}
\index{KEYP@{KEYP}!sober128\_stream.c@{sober128\_stream.c}}
\subsubsection{\texorpdfstring{KEYP}{KEYP}}
{\footnotesize\ttfamily \#define K\+E\+YP~15 /$\ast$ where to insert key words $\ast$/}



Definition at line 25 of file sober128\+\_\+stream.\+c.

\mbox{\Hypertarget{sober128__stream_8c_a0240ac851181b84ac374872dc5434ee4}\label{sober128__stream_8c_a0240ac851181b84ac374872dc5434ee4}} 
\index{sober128\_stream.c@{sober128\_stream.c}!N@{N}}
\index{N@{N}!sober128\_stream.c@{sober128\_stream.c}}
\subsubsection{\texorpdfstring{N}{N}}
{\footnotesize\ttfamily \#define N~17}



Definition at line 23 of file sober128\+\_\+stream.\+c.

\mbox{\Hypertarget{sober128__stream_8c_aa709100c11514f9fcfa04328f5db3542}\label{sober128__stream_8c_aa709100c11514f9fcfa04328f5db3542}} 
\index{sober128\_stream.c@{sober128\_stream.c}!NLFUNC@{NLFUNC}}
\index{NLFUNC@{NLFUNC}!sober128\_stream.c@{sober128\_stream.c}}
\subsubsection{\texorpdfstring{NLFUNC}{NLFUNC}}
{\footnotesize\ttfamily \#define N\+L\+F\+U\+NC(\begin{DoxyParamCaption}\item[{}]{st,  }\item[{}]{z }\end{DoxyParamCaption})}

{\bfseries Value\+:}
\begin{DoxyCode}{0}
\DoxyCodeLine{\{ \(\backslash\)}
\DoxyCodeLine{    t = st->R[\mbox{\hyperlink{sober128__stream_8c_a8a518c5522fa2db78fc172efdf95315f}{OFF}}(z,0)] + st->R[\mbox{\hyperlink{sober128__stream_8c_a8a518c5522fa2db78fc172efdf95315f}{OFF}}(z,16)]; \(\backslash\)}
\DoxyCodeLine{    t \string^= Sbox[(t >> 24) \& 0xFF]; \(\backslash\)}
\DoxyCodeLine{    t = \mbox{\hyperlink{tomcrypt__macros_8h_adb04fb3f7c1736d29125ad0f179b1068}{RORc}}(t, 8); \(\backslash\)}
\DoxyCodeLine{    t = ((t + st->R[\mbox{\hyperlink{sober128__stream_8c_a8a518c5522fa2db78fc172efdf95315f}{OFF}}(z,1)]) \string^ st->konst) + st->R[\mbox{\hyperlink{sober128__stream_8c_a8a518c5522fa2db78fc172efdf95315f}{OFF}}(z,6)]; \(\backslash\)}
\DoxyCodeLine{    t \string^= Sbox[(t >> 24) \& 0xFF]; \(\backslash\)}
\DoxyCodeLine{    t = t + st->R[\mbox{\hyperlink{sober128__stream_8c_a8a518c5522fa2db78fc172efdf95315f}{OFF}}(z,13)]; \(\backslash\)}
\DoxyCodeLine{\}}

\end{DoxyCode}


Definition at line 68 of file sober128\+\_\+stream.\+c.

\mbox{\Hypertarget{sober128__stream_8c_a8a518c5522fa2db78fc172efdf95315f}\label{sober128__stream_8c_a8a518c5522fa2db78fc172efdf95315f}} 
\index{sober128\_stream.c@{sober128\_stream.c}!OFF@{OFF}}
\index{OFF@{OFF}!sober128\_stream.c@{sober128\_stream.c}}
\subsubsection{\texorpdfstring{OFF}{OFF}}
{\footnotesize\ttfamily \#define O\+FF(\begin{DoxyParamCaption}\item[{}]{zero,  }\item[{}]{i }\end{DoxyParamCaption})~(((zero)+(i)) \% \mbox{\hyperlink{sober128__stream_8c_a0240ac851181b84ac374872dc5434ee4}{N}})}



Definition at line 46 of file sober128\+\_\+stream.\+c.

\mbox{\Hypertarget{sober128__stream_8c_af3730ea06ef3ea8ffff53d4b13dad3ea}\label{sober128__stream_8c_af3730ea06ef3ea8ffff53d4b13dad3ea}} 
\index{sober128\_stream.c@{sober128\_stream.c}!SROUND@{SROUND}}
\index{SROUND@{SROUND}!sober128\_stream.c@{sober128\_stream.c}}
\subsubsection{\texorpdfstring{SROUND}{SROUND}}
{\footnotesize\ttfamily \#define S\+R\+O\+U\+ND(\begin{DoxyParamCaption}\item[{}]{z }\end{DoxyParamCaption})~\mbox{\hyperlink{sosemanuk_8c_a88db4597248911aff1db830d19e9270c}{S\+T\+EP}}(st-\/$>$\mbox{\hyperlink{sha512_8c_a8fb1dfc3ad6dd07bc99c1962e6583087}{R}},z); \mbox{\hyperlink{sober128__stream_8c_aa709100c11514f9fcfa04328f5db3542}{N\+L\+F\+U\+NC}}(st,(z+1)); \mbox{\hyperlink{sober128__stream_8c_a272d26d71ca3e6dd2b4282302c91e5bd}{X\+O\+R\+W\+O\+RD}}(t, in+(z$\ast$4), out+(z$\ast$4));}



Definition at line 241 of file sober128\+\_\+stream.\+c.

\mbox{\Hypertarget{sober128__stream_8c_ab34523a5ce2c65f006ae4dfd3724ce1e}\label{sober128__stream_8c_ab34523a5ce2c65f006ae4dfd3724ce1e}} 
\index{sober128\_stream.c@{sober128\_stream.c}!STEP@{STEP}}
\index{STEP@{STEP}!sober128\_stream.c@{sober128\_stream.c}}
\subsubsection{\texorpdfstring{STEP}{STEP}}
{\footnotesize\ttfamily \#define S\+T\+EP(\begin{DoxyParamCaption}\item[{}]{\mbox{\hyperlink{sha512_8c_a8fb1dfc3ad6dd07bc99c1962e6583087}{R}},  }\item[{}]{z }\end{DoxyParamCaption})~\mbox{\hyperlink{sha512_8c_a8fb1dfc3ad6dd07bc99c1962e6583087}{R}}\mbox{[}\mbox{\hyperlink{sober128__stream_8c_a8a518c5522fa2db78fc172efdf95315f}{O\+FF}}(z,0)\mbox{]} = \mbox{\hyperlink{sha512_8c_a8fb1dfc3ad6dd07bc99c1962e6583087}{R}}\mbox{[}\mbox{\hyperlink{sober128__stream_8c_a8a518c5522fa2db78fc172efdf95315f}{O\+FF}}(z,15)\mbox{]} $^\wedge$ \mbox{\hyperlink{sha512_8c_a8fb1dfc3ad6dd07bc99c1962e6583087}{R}}\mbox{[}\mbox{\hyperlink{sober128__stream_8c_a8a518c5522fa2db78fc172efdf95315f}{O\+FF}}(z,4)\mbox{]} $^\wedge$ (\mbox{\hyperlink{sha512_8c_a8fb1dfc3ad6dd07bc99c1962e6583087}{R}}\mbox{[}\mbox{\hyperlink{sober128__stream_8c_a8a518c5522fa2db78fc172efdf95315f}{O\+FF}}(z,0)\mbox{]} $<$$<$ 8) $^\wedge$ Multab\mbox{[}(\mbox{\hyperlink{sha512_8c_a8fb1dfc3ad6dd07bc99c1962e6583087}{R}}\mbox{[}\mbox{\hyperlink{sober128__stream_8c_a8a518c5522fa2db78fc172efdf95315f}{O\+FF}}(z,0)\mbox{]} $>$$>$ 24) \& 0x\+F\+F\mbox{]};}



Definition at line 50 of file sober128\+\_\+stream.\+c.

\mbox{\Hypertarget{sober128__stream_8c_a1da4fb251037c5aa51b01005fea7e978}\label{sober128__stream_8c_a1da4fb251037c5aa51b01005fea7e978}} 
\index{sober128\_stream.c@{sober128\_stream.c}!XORNL@{XORNL}}
\index{XORNL@{XORNL}!sober128\_stream.c@{sober128\_stream.c}}
\subsubsection{\texorpdfstring{XORNL}{XORNL}}
{\footnotesize\ttfamily \#define X\+O\+R\+NL(\begin{DoxyParamCaption}\item[{}]{nl }\end{DoxyParamCaption})~st-\/$>$\mbox{\hyperlink{sha512_8c_a8fb1dfc3ad6dd07bc99c1962e6583087}{R}}\mbox{[}\mbox{\hyperlink{sober128__stream_8c_aedca565d3dcf476fd6462998b6f3a40c}{F\+O\+L\+DP}}\mbox{]} $^\wedge$= (nl);}



Definition at line 124 of file sober128\+\_\+stream.\+c.



\subsection{Function Documentation}
\mbox{\Hypertarget{sober128__stream_8c_ae7acc8746ffb536a618b77f0e2042807}\label{sober128__stream_8c_ae7acc8746ffb536a618b77f0e2042807}} 
\index{sober128\_stream.c@{sober128\_stream.c}!BYTE2WORD@{BYTE2WORD}}
\index{BYTE2WORD@{BYTE2WORD}!sober128\_stream.c@{sober128\_stream.c}}
\subsubsection{\texorpdfstring{BYTE2WORD()}{BYTE2WORD()}}
{\footnotesize\ttfamily static \mbox{\hyperlink{tomcrypt__cfg_8h_a1f20274bb048d3c8a916b261dfff9567}{ulong32}} B\+Y\+T\+E2\+W\+O\+RD (\begin{DoxyParamCaption}\item[{const unsigned char $\ast$}]{b }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}



Definition at line 28 of file sober128\+\_\+stream.\+c.


\begin{DoxyCode}{0}
\DoxyCodeLine{29 \{}
\DoxyCodeLine{30    \mbox{\hyperlink{tomcrypt__cfg_8h_a1f20274bb048d3c8a916b261dfff9567}{ulong32}} t;}
\DoxyCodeLine{31    LOAD32L(t, b);}
\DoxyCodeLine{32    \textcolor{keywordflow}{return} t;}
\DoxyCodeLine{33 \}}

\end{DoxyCode}


Referenced by sober128\+\_\+stream\+\_\+setiv(), and sober128\+\_\+stream\+\_\+setup().

Here is the caller graph for this function\+:
% FIG 1
\mbox{\Hypertarget{sober128__stream_8c_a5ee309e1f2da8afec6f25f826763f55d}\label{sober128__stream_8c_a5ee309e1f2da8afec6f25f826763f55d}} 
\index{sober128\_stream.c@{sober128\_stream.c}!cycle@{cycle}}
\index{cycle@{cycle}!sober128\_stream.c@{sober128\_stream.c}}
\subsubsection{\texorpdfstring{cycle()}{cycle()}}
{\footnotesize\ttfamily static void cycle (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{tomcrypt__cfg_8h_a1f20274bb048d3c8a916b261dfff9567}{ulong32}} $\ast$}]{R }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}



Definition at line 53 of file sober128\+\_\+stream.\+c.


\begin{DoxyCode}{0}
\DoxyCodeLine{54 \{}
\DoxyCodeLine{55     \mbox{\hyperlink{tomcrypt__cfg_8h_a1f20274bb048d3c8a916b261dfff9567}{ulong32}} t;}
\DoxyCodeLine{56     \textcolor{keywordtype}{int}     i;}
\DoxyCodeLine{57 }
\DoxyCodeLine{58     \mbox{\hyperlink{sober128__stream_8c_ab34523a5ce2c65f006ae4dfd3724ce1e}{STEP}}(\mbox{\hyperlink{khazad_8c_a5c71a5e59a53413cd6c270266d63b031}{R}},0);}
\DoxyCodeLine{59     t = \mbox{\hyperlink{khazad_8c_a5c71a5e59a53413cd6c270266d63b031}{R}}[0];}
\DoxyCodeLine{60     \textcolor{keywordflow}{for} (i = 1; i < \mbox{\hyperlink{sober128__stream_8c_a0240ac851181b84ac374872dc5434ee4}{N}}; ++i) \{}
\DoxyCodeLine{61         \mbox{\hyperlink{khazad_8c_a5c71a5e59a53413cd6c270266d63b031}{R}}[i-1] = \mbox{\hyperlink{khazad_8c_a5c71a5e59a53413cd6c270266d63b031}{R}}[i];}
\DoxyCodeLine{62     \}}
\DoxyCodeLine{63     \mbox{\hyperlink{khazad_8c_a5c71a5e59a53413cd6c270266d63b031}{R}}[\mbox{\hyperlink{sober128__stream_8c_a0240ac851181b84ac374872dc5434ee4}{N}}-1] = t;}
\DoxyCodeLine{64 \}}

\end{DoxyCode}


References N, R, and S\+T\+EP.



Referenced by s128\+\_\+genkonst(), sober128\+\_\+stream\+\_\+crypt(), sober128\+\_\+stream\+\_\+setiv(), and sober128\+\_\+stream\+\_\+setup().

Here is the caller graph for this function\+:
% FIG 2
\mbox{\Hypertarget{sober128__stream_8c_aa40918d0bb77cd616f54d859fe3ceb34}\label{sober128__stream_8c_aa40918d0bb77cd616f54d859fe3ceb34}} 
\index{sober128\_stream.c@{sober128\_stream.c}!nltap@{nltap}}
\index{nltap@{nltap}!sober128\_stream.c@{sober128\_stream.c}}
\subsubsection{\texorpdfstring{nltap()}{nltap()}}
{\footnotesize\ttfamily static \mbox{\hyperlink{tomcrypt__cfg_8h_a1f20274bb048d3c8a916b261dfff9567}{ulong32}} nltap (\begin{DoxyParamCaption}\item[{const sober128\+\_\+state $\ast$}]{st }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}



Definition at line 78 of file sober128\+\_\+stream.\+c.


\begin{DoxyCode}{0}
\DoxyCodeLine{79 \{}
\DoxyCodeLine{80     \mbox{\hyperlink{tomcrypt__cfg_8h_a1f20274bb048d3c8a916b261dfff9567}{ulong32}} t;}
\DoxyCodeLine{81     \mbox{\hyperlink{sober128__stream_8c_aa709100c11514f9fcfa04328f5db3542}{NLFUNC}}(st, 0);}
\DoxyCodeLine{82     \textcolor{keywordflow}{return} t;}
\DoxyCodeLine{83 \}}

\end{DoxyCode}


References N\+L\+F\+U\+NC.



Referenced by s128\+\_\+genkonst(), sober128\+\_\+stream\+\_\+crypt(), sober128\+\_\+stream\+\_\+setiv(), and sober128\+\_\+stream\+\_\+setup().

Here is the caller graph for this function\+:
% FIG 3
\mbox{\Hypertarget{sober128__stream_8c_a90d35fdc987c8472cc4390a3dc4c7777}\label{sober128__stream_8c_a90d35fdc987c8472cc4390a3dc4c7777}} 
\index{sober128\_stream.c@{sober128\_stream.c}!s128\_diffuse@{s128\_diffuse}}
\index{s128\_diffuse@{s128\_diffuse}!sober128\_stream.c@{sober128\_stream.c}}
\subsubsection{\texorpdfstring{s128\_diffuse()}{s128\_diffuse()}}
{\footnotesize\ttfamily static void s128\+\_\+diffuse (\begin{DoxyParamCaption}\item[{sober128\+\_\+state $\ast$}]{st }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}



Definition at line 129 of file sober128\+\_\+stream.\+c.


\begin{DoxyCode}{0}
\DoxyCodeLine{130 \{}
\DoxyCodeLine{131     \mbox{\hyperlink{tomcrypt__cfg_8h_a1f20274bb048d3c8a916b261dfff9567}{ulong32}} t;}
\DoxyCodeLine{132     \textcolor{comment}{/* relies on FOLD == N == 17! */}}
\DoxyCodeLine{133     \mbox{\hyperlink{sober128__stream_8c_a6123cbc72dbb66dcee5646b56446c399}{DROUND}}(0);}
\DoxyCodeLine{134     \mbox{\hyperlink{sober128__stream_8c_a6123cbc72dbb66dcee5646b56446c399}{DROUND}}(1);}
\DoxyCodeLine{135     \mbox{\hyperlink{sober128__stream_8c_a6123cbc72dbb66dcee5646b56446c399}{DROUND}}(2);}
\DoxyCodeLine{136     \mbox{\hyperlink{sober128__stream_8c_a6123cbc72dbb66dcee5646b56446c399}{DROUND}}(3);}
\DoxyCodeLine{137     \mbox{\hyperlink{sober128__stream_8c_a6123cbc72dbb66dcee5646b56446c399}{DROUND}}(4);}
\DoxyCodeLine{138     \mbox{\hyperlink{sober128__stream_8c_a6123cbc72dbb66dcee5646b56446c399}{DROUND}}(5);}
\DoxyCodeLine{139     \mbox{\hyperlink{sober128__stream_8c_a6123cbc72dbb66dcee5646b56446c399}{DROUND}}(6);}
\DoxyCodeLine{140     \mbox{\hyperlink{sober128__stream_8c_a6123cbc72dbb66dcee5646b56446c399}{DROUND}}(7);}
\DoxyCodeLine{141     \mbox{\hyperlink{sober128__stream_8c_a6123cbc72dbb66dcee5646b56446c399}{DROUND}}(8);}
\DoxyCodeLine{142     \mbox{\hyperlink{sober128__stream_8c_a6123cbc72dbb66dcee5646b56446c399}{DROUND}}(9);}
\DoxyCodeLine{143     \mbox{\hyperlink{sober128__stream_8c_a6123cbc72dbb66dcee5646b56446c399}{DROUND}}(10);}
\DoxyCodeLine{144     \mbox{\hyperlink{sober128__stream_8c_a6123cbc72dbb66dcee5646b56446c399}{DROUND}}(11);}
\DoxyCodeLine{145     \mbox{\hyperlink{sober128__stream_8c_a6123cbc72dbb66dcee5646b56446c399}{DROUND}}(12);}
\DoxyCodeLine{146     \mbox{\hyperlink{sober128__stream_8c_a6123cbc72dbb66dcee5646b56446c399}{DROUND}}(13);}
\DoxyCodeLine{147     \mbox{\hyperlink{sober128__stream_8c_a6123cbc72dbb66dcee5646b56446c399}{DROUND}}(14);}
\DoxyCodeLine{148     \mbox{\hyperlink{sober128__stream_8c_a6123cbc72dbb66dcee5646b56446c399}{DROUND}}(15);}
\DoxyCodeLine{149     \mbox{\hyperlink{sober128__stream_8c_a6123cbc72dbb66dcee5646b56446c399}{DROUND}}(16);}
\DoxyCodeLine{150 \}}

\end{DoxyCode}


References D\+R\+O\+U\+ND.



Referenced by sober128\+\_\+stream\+\_\+setiv(), and sober128\+\_\+stream\+\_\+setup().

Here is the caller graph for this function\+:
% FIG 4
\mbox{\Hypertarget{sober128__stream_8c_afeb3cc1b4facd7436b991dc552ffb038}\label{sober128__stream_8c_afeb3cc1b4facd7436b991dc552ffb038}} 
\index{sober128\_stream.c@{sober128\_stream.c}!s128\_genkonst@{s128\_genkonst}}
\index{s128\_genkonst@{s128\_genkonst}!sober128\_stream.c@{sober128\_stream.c}}
\subsubsection{\texorpdfstring{s128\_genkonst()}{s128\_genkonst()}}
{\footnotesize\ttfamily static void s128\+\_\+genkonst (\begin{DoxyParamCaption}\item[{sober128\+\_\+state $\ast$}]{st }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}



Definition at line 108 of file sober128\+\_\+stream.\+c.


\begin{DoxyCode}{0}
\DoxyCodeLine{109 \{}
\DoxyCodeLine{110     \mbox{\hyperlink{tomcrypt__cfg_8h_a1f20274bb048d3c8a916b261dfff9567}{ulong32}} newkonst;}
\DoxyCodeLine{111 }
\DoxyCodeLine{112     \textcolor{keywordflow}{do} \{}
\DoxyCodeLine{113        \mbox{\hyperlink{sober128__stream_8c_a5ee309e1f2da8afec6f25f826763f55d}{cycle}}(st->R);}
\DoxyCodeLine{114        newkonst = \mbox{\hyperlink{sober128__stream_8c_aa40918d0bb77cd616f54d859fe3ceb34}{nltap}}(st);}
\DoxyCodeLine{115     \} \textcolor{keywordflow}{while} ((newkonst \& 0xFF000000) == 0);}
\DoxyCodeLine{116     st->konst = newkonst;}
\DoxyCodeLine{117 \}}

\end{DoxyCode}


References cycle(), and nltap().



Referenced by sober128\+\_\+stream\+\_\+setup().

Here is the call graph for this function\+:
% FIG 5
Here is the caller graph for this function\+:
% FIG 6
\mbox{\Hypertarget{sober128__stream_8c_a658f8c5cee73aa58ecf24133861c084d}\label{sober128__stream_8c_a658f8c5cee73aa58ecf24133861c084d}} 
\index{sober128\_stream.c@{sober128\_stream.c}!s128\_reloadstate@{s128\_reloadstate}}
\index{s128\_reloadstate@{s128\_reloadstate}!sober128\_stream.c@{sober128\_stream.c}}
\subsubsection{\texorpdfstring{s128\_reloadstate()}{s128\_reloadstate()}}
{\footnotesize\ttfamily static void s128\+\_\+reloadstate (\begin{DoxyParamCaption}\item[{sober128\+\_\+state $\ast$}]{st }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}



Definition at line 97 of file sober128\+\_\+stream.\+c.


\begin{DoxyCode}{0}
\DoxyCodeLine{98 \{}
\DoxyCodeLine{99     \textcolor{keywordtype}{int} i;}
\DoxyCodeLine{100 }
\DoxyCodeLine{101     \textcolor{keywordflow}{for} (i = 0; i < \mbox{\hyperlink{sober128__stream_8c_a0240ac851181b84ac374872dc5434ee4}{N}}; ++i) \{}
\DoxyCodeLine{102         st->R[i] = st->initR[i];}
\DoxyCodeLine{103     \}}
\DoxyCodeLine{104 \}}

\end{DoxyCode}


References N.



Referenced by sober128\+\_\+stream\+\_\+setiv().

Here is the caller graph for this function\+:
% FIG 7
\mbox{\Hypertarget{sober128__stream_8c_a884ca93789ee73dea18768f55567bc67}\label{sober128__stream_8c_a884ca93789ee73dea18768f55567bc67}} 
\index{sober128\_stream.c@{sober128\_stream.c}!s128\_savestate@{s128\_savestate}}
\index{s128\_savestate@{s128\_savestate}!sober128\_stream.c@{sober128\_stream.c}}
\subsubsection{\texorpdfstring{s128\_savestate()}{s128\_savestate()}}
{\footnotesize\ttfamily static void s128\+\_\+savestate (\begin{DoxyParamCaption}\item[{sober128\+\_\+state $\ast$}]{st }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}



Definition at line 87 of file sober128\+\_\+stream.\+c.


\begin{DoxyCode}{0}
\DoxyCodeLine{88 \{}
\DoxyCodeLine{89     \textcolor{keywordtype}{int} i;}
\DoxyCodeLine{90     \textcolor{keywordflow}{for} (i = 0; i < \mbox{\hyperlink{sober128__stream_8c_a0240ac851181b84ac374872dc5434ee4}{N}}; ++i) \{}
\DoxyCodeLine{91         st->initR[i] = st->R[i];}
\DoxyCodeLine{92     \}}
\DoxyCodeLine{93 \}}

\end{DoxyCode}


References N.



Referenced by sober128\+\_\+stream\+\_\+setup().

Here is the caller graph for this function\+:
% FIG 8
\mbox{\Hypertarget{sober128__stream_8c_ae518d65a1bd918959e0d52e3f7d963de}\label{sober128__stream_8c_ae518d65a1bd918959e0d52e3f7d963de}} 
\index{sober128\_stream.c@{sober128\_stream.c}!sober128\_stream\_crypt@{sober128\_stream\_crypt}}
\index{sober128\_stream\_crypt@{sober128\_stream\_crypt}!sober128\_stream.c@{sober128\_stream.c}}
\subsubsection{\texorpdfstring{sober128\_stream\_crypt()}{sober128\_stream\_crypt()}}
{\footnotesize\ttfamily int sober128\+\_\+stream\+\_\+crypt (\begin{DoxyParamCaption}\item[{sober128\+\_\+state $\ast$}]{st,  }\item[{const unsigned char $\ast$}]{in,  }\item[{unsigned long}]{inlen,  }\item[{unsigned char $\ast$}]{out }\end{DoxyParamCaption})}



Encrypt (or decrypt) bytes of ciphertext (or plaintext) with Sober128. 


\begin{DoxyParams}{Parameters}
{\em st} & The Sober128 state \\
\hline
{\em in} & The plaintext (or ciphertext) \\
\hline
{\em inlen} & The length of the input (octets) \\
\hline
{\em out} & \mbox{[}out\mbox{]} The ciphertext (or plaintext), length inlen \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
C\+R\+Y\+P\+T\+\_\+\+OK if successful 
\end{DoxyReturn}


Definition at line 251 of file sober128\+\_\+stream.\+c.


\begin{DoxyCode}{0}
\DoxyCodeLine{252 \{}
\DoxyCodeLine{253    \mbox{\hyperlink{tomcrypt__cfg_8h_a1f20274bb048d3c8a916b261dfff9567}{ulong32}} t;}
\DoxyCodeLine{254 }
\DoxyCodeLine{255    \textcolor{keywordflow}{if} (inlen == 0) \textcolor{keywordflow}{return} \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}}; \textcolor{comment}{/* nothing to do */}}
\DoxyCodeLine{256    \mbox{\hyperlink{tomcrypt__argchk_8h_a683da3e041e49f196318b6ea951414ba}{LTC\_ARGCHK}}(out != NULL);}
\DoxyCodeLine{257    \mbox{\hyperlink{tomcrypt__argchk_8h_a683da3e041e49f196318b6ea951414ba}{LTC\_ARGCHK}}(st  != NULL);}
\DoxyCodeLine{258 }
\DoxyCodeLine{259    \textcolor{comment}{/* handle any previously buffered bytes */}}
\DoxyCodeLine{260    \textcolor{keywordflow}{while} (st->nbuf != 0 \&\& inlen != 0) \{}
\DoxyCodeLine{261       *out++ = *in++ \string^ (\textcolor{keywordtype}{unsigned} char)(st->sbuf \& 0xFF);}
\DoxyCodeLine{262       st->sbuf >>= 8;}
\DoxyCodeLine{263       st->nbuf -= 8;}
\DoxyCodeLine{264       --inlen;}
\DoxyCodeLine{265    \}}
\DoxyCodeLine{266 }
\DoxyCodeLine{267 \textcolor{preprocessor}{\#ifndef LTC\_SMALL\_CODE}}
\DoxyCodeLine{268    \textcolor{comment}{/* do lots at a time, if there's enough to do */}}
\DoxyCodeLine{269    \textcolor{keywordflow}{while} (inlen >= \mbox{\hyperlink{sober128__stream_8c_a0240ac851181b84ac374872dc5434ee4}{N}}*4) \{}
\DoxyCodeLine{270       \mbox{\hyperlink{sober128__stream_8c_af3730ea06ef3ea8ffff53d4b13dad3ea}{SROUND}}(0);}
\DoxyCodeLine{271       \mbox{\hyperlink{sober128__stream_8c_af3730ea06ef3ea8ffff53d4b13dad3ea}{SROUND}}(1);}
\DoxyCodeLine{272       \mbox{\hyperlink{sober128__stream_8c_af3730ea06ef3ea8ffff53d4b13dad3ea}{SROUND}}(2);}
\DoxyCodeLine{273       \mbox{\hyperlink{sober128__stream_8c_af3730ea06ef3ea8ffff53d4b13dad3ea}{SROUND}}(3);}
\DoxyCodeLine{274       \mbox{\hyperlink{sober128__stream_8c_af3730ea06ef3ea8ffff53d4b13dad3ea}{SROUND}}(4);}
\DoxyCodeLine{275       \mbox{\hyperlink{sober128__stream_8c_af3730ea06ef3ea8ffff53d4b13dad3ea}{SROUND}}(5);}
\DoxyCodeLine{276       \mbox{\hyperlink{sober128__stream_8c_af3730ea06ef3ea8ffff53d4b13dad3ea}{SROUND}}(6);}
\DoxyCodeLine{277       \mbox{\hyperlink{sober128__stream_8c_af3730ea06ef3ea8ffff53d4b13dad3ea}{SROUND}}(7);}
\DoxyCodeLine{278       \mbox{\hyperlink{sober128__stream_8c_af3730ea06ef3ea8ffff53d4b13dad3ea}{SROUND}}(8);}
\DoxyCodeLine{279       \mbox{\hyperlink{sober128__stream_8c_af3730ea06ef3ea8ffff53d4b13dad3ea}{SROUND}}(9);}
\DoxyCodeLine{280       \mbox{\hyperlink{sober128__stream_8c_af3730ea06ef3ea8ffff53d4b13dad3ea}{SROUND}}(10);}
\DoxyCodeLine{281       \mbox{\hyperlink{sober128__stream_8c_af3730ea06ef3ea8ffff53d4b13dad3ea}{SROUND}}(11);}
\DoxyCodeLine{282       \mbox{\hyperlink{sober128__stream_8c_af3730ea06ef3ea8ffff53d4b13dad3ea}{SROUND}}(12);}
\DoxyCodeLine{283       \mbox{\hyperlink{sober128__stream_8c_af3730ea06ef3ea8ffff53d4b13dad3ea}{SROUND}}(13);}
\DoxyCodeLine{284       \mbox{\hyperlink{sober128__stream_8c_af3730ea06ef3ea8ffff53d4b13dad3ea}{SROUND}}(14);}
\DoxyCodeLine{285       \mbox{\hyperlink{sober128__stream_8c_af3730ea06ef3ea8ffff53d4b13dad3ea}{SROUND}}(15);}
\DoxyCodeLine{286       \mbox{\hyperlink{sober128__stream_8c_af3730ea06ef3ea8ffff53d4b13dad3ea}{SROUND}}(16);}
\DoxyCodeLine{287       out    += 4*\mbox{\hyperlink{sober128__stream_8c_a0240ac851181b84ac374872dc5434ee4}{N}};}
\DoxyCodeLine{288       in     += 4*\mbox{\hyperlink{sober128__stream_8c_a0240ac851181b84ac374872dc5434ee4}{N}};}
\DoxyCodeLine{289       inlen  -= 4*\mbox{\hyperlink{sober128__stream_8c_a0240ac851181b84ac374872dc5434ee4}{N}};}
\DoxyCodeLine{290    \}}
\DoxyCodeLine{291 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{292 }
\DoxyCodeLine{293    \textcolor{comment}{/* do small or odd size buffers the slow way */}}
\DoxyCodeLine{294    \textcolor{keywordflow}{while} (4 <= inlen) \{}
\DoxyCodeLine{295       \mbox{\hyperlink{sober128__stream_8c_a5ee309e1f2da8afec6f25f826763f55d}{cycle}}(st->R);}
\DoxyCodeLine{296       t = \mbox{\hyperlink{sober128__stream_8c_aa40918d0bb77cd616f54d859fe3ceb34}{nltap}}(st);}
\DoxyCodeLine{297       \mbox{\hyperlink{sober128__stream_8c_a272d26d71ca3e6dd2b4282302c91e5bd}{XORWORD}}(t, in, out);}
\DoxyCodeLine{298       out    += 4;}
\DoxyCodeLine{299       in     += 4;}
\DoxyCodeLine{300       inlen  -= 4;}
\DoxyCodeLine{301    \}}
\DoxyCodeLine{302 }
\DoxyCodeLine{303    \textcolor{comment}{/* handle any trailing bytes */}}
\DoxyCodeLine{304    \textcolor{keywordflow}{if} (inlen != 0) \{}
\DoxyCodeLine{305       \mbox{\hyperlink{sober128__stream_8c_a5ee309e1f2da8afec6f25f826763f55d}{cycle}}(st->R);}
\DoxyCodeLine{306       st->sbuf = \mbox{\hyperlink{sober128__stream_8c_aa40918d0bb77cd616f54d859fe3ceb34}{nltap}}(st);}
\DoxyCodeLine{307       st->nbuf = 32;}
\DoxyCodeLine{308       \textcolor{keywordflow}{while} (st->nbuf != 0 \&\& inlen != 0) \{}
\DoxyCodeLine{309           *out++ = *in++ \string^ (\textcolor{keywordtype}{unsigned} char)(st->sbuf \& 0xFF);}
\DoxyCodeLine{310           st->sbuf >>= 8;}
\DoxyCodeLine{311           st->nbuf -= 8;}
\DoxyCodeLine{312           --inlen;}
\DoxyCodeLine{313       \}}
\DoxyCodeLine{314    \}}
\DoxyCodeLine{315 }
\DoxyCodeLine{316    \textcolor{keywordflow}{return} \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}};}
\DoxyCodeLine{317 \}}

\end{DoxyCode}


References C\+R\+Y\+P\+T\+\_\+\+OK, cycle(), L\+T\+C\+\_\+\+A\+R\+G\+C\+HK, N, nltap(), S\+R\+O\+U\+ND, and X\+O\+R\+W\+O\+R\+D().



Referenced by sober128\+\_\+stream\+\_\+keystream(), sober128\+\_\+stream\+\_\+memory(), and sober128\+\_\+stream\+\_\+test().

Here is the call graph for this function\+:
% FIG 9
Here is the caller graph for this function\+:
% FIG 10
\mbox{\Hypertarget{sober128__stream_8c_a37c4a04830801bac9f4b432b4b45fb2d}\label{sober128__stream_8c_a37c4a04830801bac9f4b432b4b45fb2d}} 
\index{sober128\_stream.c@{sober128\_stream.c}!sober128\_stream\_done@{sober128\_stream\_done}}
\index{sober128\_stream\_done@{sober128\_stream\_done}!sober128\_stream.c@{sober128\_stream.c}}
\subsubsection{\texorpdfstring{sober128\_stream\_done()}{sober128\_stream\_done()}}
{\footnotesize\ttfamily int sober128\+\_\+stream\+\_\+done (\begin{DoxyParamCaption}\item[{sober128\+\_\+state $\ast$}]{st }\end{DoxyParamCaption})}



Terminate and clear Sober128 state. 


\begin{DoxyParams}{Parameters}
{\em st} & The Sober128 state \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
C\+R\+Y\+P\+T\+\_\+\+OK on success 
\end{DoxyReturn}


Definition at line 332 of file sober128\+\_\+stream.\+c.


\begin{DoxyCode}{0}
\DoxyCodeLine{333 \{}
\DoxyCodeLine{334    \mbox{\hyperlink{tomcrypt__argchk_8h_a683da3e041e49f196318b6ea951414ba}{LTC\_ARGCHK}}(st != NULL);}
\DoxyCodeLine{335    \mbox{\hyperlink{tomcrypt__cfg_8h_aa3c34a6f6c61de7da9258b5a30e32c2f}{XMEMSET}}(st, 0, \textcolor{keyword}{sizeof}(sober128\_state));}
\DoxyCodeLine{336    \textcolor{keywordflow}{return} \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}};}
\DoxyCodeLine{337 \}}

\end{DoxyCode}


References C\+R\+Y\+P\+T\+\_\+\+OK, L\+T\+C\+\_\+\+A\+R\+G\+C\+HK, and X\+M\+E\+M\+S\+E\+T().



Referenced by sober128\+\_\+done(), sober128\+\_\+stream\+\_\+memory(), and sober128\+\_\+stream\+\_\+test().

Here is the call graph for this function\+:
% FIG 11
Here is the caller graph for this function\+:
% FIG 12
\mbox{\Hypertarget{sober128__stream_8c_a8f44e316ae3d51801843156a64966a34}\label{sober128__stream_8c_a8f44e316ae3d51801843156a64966a34}} 
\index{sober128\_stream.c@{sober128\_stream.c}!sober128\_stream\_keystream@{sober128\_stream\_keystream}}
\index{sober128\_stream\_keystream@{sober128\_stream\_keystream}!sober128\_stream.c@{sober128\_stream.c}}
\subsubsection{\texorpdfstring{sober128\_stream\_keystream()}{sober128\_stream\_keystream()}}
{\footnotesize\ttfamily int sober128\+\_\+stream\+\_\+keystream (\begin{DoxyParamCaption}\item[{sober128\+\_\+state $\ast$}]{st,  }\item[{unsigned char $\ast$}]{out,  }\item[{unsigned long}]{outlen }\end{DoxyParamCaption})}



Definition at line 319 of file sober128\+\_\+stream.\+c.


\begin{DoxyCode}{0}
\DoxyCodeLine{320 \{}
\DoxyCodeLine{321    \textcolor{keywordflow}{if} (outlen == 0) \textcolor{keywordflow}{return} \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}}; \textcolor{comment}{/* nothing to do */}}
\DoxyCodeLine{322    \mbox{\hyperlink{tomcrypt__argchk_8h_a683da3e041e49f196318b6ea951414ba}{LTC\_ARGCHK}}(out != NULL);}
\DoxyCodeLine{323    \mbox{\hyperlink{tomcrypt__cfg_8h_aa3c34a6f6c61de7da9258b5a30e32c2f}{XMEMSET}}(out, 0, outlen);}
\DoxyCodeLine{324    \textcolor{keywordflow}{return} \mbox{\hyperlink{sober128__stream_8c_ae518d65a1bd918959e0d52e3f7d963de}{sober128\_stream\_crypt}}(st, out, outlen, out);}
\DoxyCodeLine{325 \}}

\end{DoxyCode}


References C\+R\+Y\+P\+T\+\_\+\+OK, L\+T\+C\+\_\+\+A\+R\+G\+C\+HK, sober128\+\_\+stream\+\_\+crypt(), and X\+M\+E\+M\+S\+E\+T().



Referenced by sober128\+\_\+add\+\_\+entropy(), and sober128\+\_\+read().

Here is the call graph for this function\+:
% FIG 13
Here is the caller graph for this function\+:
% FIG 14
\mbox{\Hypertarget{sober128__stream_8c_aad93d7243d0b6e8bb46f8637c1dab891}\label{sober128__stream_8c_aad93d7243d0b6e8bb46f8637c1dab891}} 
\index{sober128\_stream.c@{sober128\_stream.c}!sober128\_stream\_setiv@{sober128\_stream\_setiv}}
\index{sober128\_stream\_setiv@{sober128\_stream\_setiv}!sober128\_stream.c@{sober128\_stream.c}}
\subsubsection{\texorpdfstring{sober128\_stream\_setiv()}{sober128\_stream\_setiv()}}
{\footnotesize\ttfamily int sober128\+\_\+stream\+\_\+setiv (\begin{DoxyParamCaption}\item[{sober128\+\_\+state $\ast$}]{st,  }\item[{const unsigned char $\ast$}]{iv,  }\item[{unsigned long}]{ivlen }\end{DoxyParamCaption})}



Set IV to the Sober128 state. 


\begin{DoxyParams}{Parameters}
{\em st} & The Sober12820 state \\
\hline
{\em iv} & The IV data to add \\
\hline
{\em ivlen} & The length of the IV (must be 12) \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
C\+R\+Y\+P\+T\+\_\+\+OK on success 
\end{DoxyReturn}


Definition at line 206 of file sober128\+\_\+stream.\+c.


\begin{DoxyCode}{0}
\DoxyCodeLine{207 \{}
\DoxyCodeLine{208    \mbox{\hyperlink{tomcrypt__cfg_8h_a1f20274bb048d3c8a916b261dfff9567}{ulong32}} i, k;}
\DoxyCodeLine{209 }
\DoxyCodeLine{210    \mbox{\hyperlink{tomcrypt__argchk_8h_a683da3e041e49f196318b6ea951414ba}{LTC\_ARGCHK}}(st != NULL);}
\DoxyCodeLine{211    \mbox{\hyperlink{tomcrypt__argchk_8h_a683da3e041e49f196318b6ea951414ba}{LTC\_ARGCHK}}(iv != NULL);}
\DoxyCodeLine{212    \mbox{\hyperlink{tomcrypt__argchk_8h_a683da3e041e49f196318b6ea951414ba}{LTC\_ARGCHK}}(ivlen > 0);}
\DoxyCodeLine{213 }
\DoxyCodeLine{214    \textcolor{comment}{/* ok we are adding an IV then... */}}
\DoxyCodeLine{215    \mbox{\hyperlink{sober128__stream_8c_a658f8c5cee73aa58ecf24133861c084d}{s128\_reloadstate}}(st);}
\DoxyCodeLine{216 }
\DoxyCodeLine{217    \textcolor{comment}{/* ivlen must be multiple of 4 bytes */}}
\DoxyCodeLine{218    \textcolor{keywordflow}{if} ((ivlen \& 3) != 0) \{}
\DoxyCodeLine{219       \textcolor{keywordflow}{return} \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06caafed43f3b625e72191e08e65b4bb5e02}{CRYPT\_INVALID\_KEYSIZE}};}
\DoxyCodeLine{220    \}}
\DoxyCodeLine{221 }
\DoxyCodeLine{222    \textcolor{keywordflow}{for} (i = 0; i < ivlen; i += 4) \{}
\DoxyCodeLine{223       k = \mbox{\hyperlink{sober128__stream_8c_ae7acc8746ffb536a618b77f0e2042807}{BYTE2WORD}}((\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char} *)\&iv[i]);}
\DoxyCodeLine{224       \mbox{\hyperlink{sober128__stream_8c_a67c3a492da60ba338b260e35335a62b2}{ADDKEY}}(k);}
\DoxyCodeLine{225       \mbox{\hyperlink{sober128__stream_8c_a5ee309e1f2da8afec6f25f826763f55d}{cycle}}(st->R);}
\DoxyCodeLine{226       \mbox{\hyperlink{sober128__stream_8c_a1da4fb251037c5aa51b01005fea7e978}{XORNL}}(\mbox{\hyperlink{sober128__stream_8c_aa40918d0bb77cd616f54d859fe3ceb34}{nltap}}(st));}
\DoxyCodeLine{227    \}}
\DoxyCodeLine{228 }
\DoxyCodeLine{229    \textcolor{comment}{/* also fold in the length of the key */}}
\DoxyCodeLine{230    \mbox{\hyperlink{sober128__stream_8c_a67c3a492da60ba338b260e35335a62b2}{ADDKEY}}(ivlen);}
\DoxyCodeLine{231 }
\DoxyCodeLine{232    \textcolor{comment}{/* now diffuse */}}
\DoxyCodeLine{233    \mbox{\hyperlink{sober128__stream_8c_a90d35fdc987c8472cc4390a3dc4c7777}{s128\_diffuse}}(st);}
\DoxyCodeLine{234    st->nbuf = 0;}
\DoxyCodeLine{235 }
\DoxyCodeLine{236    \textcolor{keywordflow}{return} \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}};}
\DoxyCodeLine{237 \}}

\end{DoxyCode}


References A\+D\+D\+K\+EY, B\+Y\+T\+E2\+W\+O\+R\+D(), C\+R\+Y\+P\+T\+\_\+\+I\+N\+V\+A\+L\+I\+D\+\_\+\+K\+E\+Y\+S\+I\+ZE, C\+R\+Y\+P\+T\+\_\+\+OK, cycle(), L\+T\+C\+\_\+\+A\+R\+G\+C\+HK, nltap(), s128\+\_\+diffuse(), s128\+\_\+reloadstate(), and X\+O\+R\+NL.



Referenced by sober128\+\_\+add\+\_\+entropy(), sober128\+\_\+ready(), sober128\+\_\+stream\+\_\+memory(), and sober128\+\_\+stream\+\_\+test().

Here is the call graph for this function\+:
% FIG 15
Here is the caller graph for this function\+:
% FIG 16
\mbox{\Hypertarget{sober128__stream_8c_a0a1e7b2ff7cfbba83eee53e875ef8d6e}\label{sober128__stream_8c_a0a1e7b2ff7cfbba83eee53e875ef8d6e}} 
\index{sober128\_stream.c@{sober128\_stream.c}!sober128\_stream\_setup@{sober128\_stream\_setup}}
\index{sober128\_stream\_setup@{sober128\_stream\_setup}!sober128\_stream.c@{sober128\_stream.c}}
\subsubsection{\texorpdfstring{sober128\_stream\_setup()}{sober128\_stream\_setup()}}
{\footnotesize\ttfamily int sober128\+\_\+stream\+\_\+setup (\begin{DoxyParamCaption}\item[{sober128\+\_\+state $\ast$}]{st,  }\item[{const unsigned char $\ast$}]{key,  }\item[{unsigned long}]{keylen }\end{DoxyParamCaption})}



Initialize an Sober128 context (only the key) 


\begin{DoxyParams}{Parameters}
{\em st} & \mbox{[}out\mbox{]} The destination of the Sober128 state \\
\hline
{\em key} & The secret key \\
\hline
{\em keylen} & The length of the secret key (octets) \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
C\+R\+Y\+P\+T\+\_\+\+OK if successful 
\end{DoxyReturn}


Definition at line 159 of file sober128\+\_\+stream.\+c.


\begin{DoxyCode}{0}
\DoxyCodeLine{160 \{}
\DoxyCodeLine{161    \mbox{\hyperlink{tomcrypt__cfg_8h_a1f20274bb048d3c8a916b261dfff9567}{ulong32}} i, k;}
\DoxyCodeLine{162 }
\DoxyCodeLine{163    \mbox{\hyperlink{tomcrypt__argchk_8h_a683da3e041e49f196318b6ea951414ba}{LTC\_ARGCHK}}(st  != NULL);}
\DoxyCodeLine{164    \mbox{\hyperlink{tomcrypt__argchk_8h_a683da3e041e49f196318b6ea951414ba}{LTC\_ARGCHK}}(key != NULL);}
\DoxyCodeLine{165    \mbox{\hyperlink{tomcrypt__argchk_8h_a683da3e041e49f196318b6ea951414ba}{LTC\_ARGCHK}}(keylen > 0);}
\DoxyCodeLine{166 }
\DoxyCodeLine{167    \textcolor{comment}{/* keylen must be multiple of 4 bytes */}}
\DoxyCodeLine{168    \textcolor{keywordflow}{if} ((keylen \& 3) != 0) \{}
\DoxyCodeLine{169       \textcolor{keywordflow}{return} \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06caafed43f3b625e72191e08e65b4bb5e02}{CRYPT\_INVALID\_KEYSIZE}};}
\DoxyCodeLine{170    \}}
\DoxyCodeLine{171 }
\DoxyCodeLine{172    \textcolor{comment}{/* Register initialised to Fibonacci numbers */}}
\DoxyCodeLine{173    st->R[0] = 1;}
\DoxyCodeLine{174    st->R[1] = 1;}
\DoxyCodeLine{175    \textcolor{keywordflow}{for} (i = 2; i < \mbox{\hyperlink{sober128__stream_8c_a0240ac851181b84ac374872dc5434ee4}{N}}; ++i) \{}
\DoxyCodeLine{176       st->R[i] = st->R[i-1] + st->R[i-2];}
\DoxyCodeLine{177    \}}
\DoxyCodeLine{178    st->konst = \mbox{\hyperlink{sober128__stream_8c_a5a2c87c756ba2c17a5661050cbce0d4b}{INITKONST}};}
\DoxyCodeLine{179 }
\DoxyCodeLine{180    \textcolor{keywordflow}{for} (i = 0; i < keylen; i += 4) \{}
\DoxyCodeLine{181       k = \mbox{\hyperlink{sober128__stream_8c_ae7acc8746ffb536a618b77f0e2042807}{BYTE2WORD}}((\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char} *)\&key[i]);}
\DoxyCodeLine{182       \mbox{\hyperlink{sober128__stream_8c_a67c3a492da60ba338b260e35335a62b2}{ADDKEY}}(k);}
\DoxyCodeLine{183       \mbox{\hyperlink{sober128__stream_8c_a5ee309e1f2da8afec6f25f826763f55d}{cycle}}(st->R);}
\DoxyCodeLine{184       \mbox{\hyperlink{sober128__stream_8c_a1da4fb251037c5aa51b01005fea7e978}{XORNL}}(\mbox{\hyperlink{sober128__stream_8c_aa40918d0bb77cd616f54d859fe3ceb34}{nltap}}(st));}
\DoxyCodeLine{185    \}}
\DoxyCodeLine{186 }
\DoxyCodeLine{187    \textcolor{comment}{/* also fold in the length of the key */}}
\DoxyCodeLine{188    \mbox{\hyperlink{sober128__stream_8c_a67c3a492da60ba338b260e35335a62b2}{ADDKEY}}(keylen);}
\DoxyCodeLine{189 }
\DoxyCodeLine{190    \textcolor{comment}{/* now diffuse */}}
\DoxyCodeLine{191    \mbox{\hyperlink{sober128__stream_8c_a90d35fdc987c8472cc4390a3dc4c7777}{s128\_diffuse}}(st);}
\DoxyCodeLine{192    \mbox{\hyperlink{sober128__stream_8c_afeb3cc1b4facd7436b991dc552ffb038}{s128\_genkonst}}(st);}
\DoxyCodeLine{193    \mbox{\hyperlink{sober128__stream_8c_a884ca93789ee73dea18768f55567bc67}{s128\_savestate}}(st);}
\DoxyCodeLine{194    st->nbuf = 0;}
\DoxyCodeLine{195 }
\DoxyCodeLine{196    \textcolor{keywordflow}{return} \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}};}
\DoxyCodeLine{197 \}}

\end{DoxyCode}


References A\+D\+D\+K\+EY, B\+Y\+T\+E2\+W\+O\+R\+D(), C\+R\+Y\+P\+T\+\_\+\+I\+N\+V\+A\+L\+I\+D\+\_\+\+K\+E\+Y\+S\+I\+ZE, C\+R\+Y\+P\+T\+\_\+\+OK, cycle(), I\+N\+I\+T\+K\+O\+N\+ST, L\+T\+C\+\_\+\+A\+R\+G\+C\+HK, N, nltap(), s128\+\_\+diffuse(), s128\+\_\+genkonst(), s128\+\_\+savestate(), and X\+O\+R\+NL.



Referenced by sober128\+\_\+add\+\_\+entropy(), sober128\+\_\+ready(), sober128\+\_\+stream\+\_\+memory(), and sober128\+\_\+stream\+\_\+test().

Here is the call graph for this function\+:
% FIG 17
Here is the caller graph for this function\+:
% FIG 18
\mbox{\Hypertarget{sober128__stream_8c_a272d26d71ca3e6dd2b4282302c91e5bd}\label{sober128__stream_8c_a272d26d71ca3e6dd2b4282302c91e5bd}} 
\index{sober128\_stream.c@{sober128\_stream.c}!XORWORD@{XORWORD}}
\index{XORWORD@{XORWORD}!sober128\_stream.c@{sober128\_stream.c}}
\subsubsection{\texorpdfstring{XORWORD()}{XORWORD()}}
{\footnotesize\ttfamily static void X\+O\+R\+W\+O\+RD (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{tomcrypt__cfg_8h_a1f20274bb048d3c8a916b261dfff9567}{ulong32}}}]{w,  }\item[{const unsigned char $\ast$}]{in,  }\item[{unsigned char $\ast$}]{out }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}



Definition at line 35 of file sober128\+\_\+stream.\+c.


\begin{DoxyCode}{0}
\DoxyCodeLine{36 \{}
\DoxyCodeLine{37    \mbox{\hyperlink{tomcrypt__cfg_8h_a1f20274bb048d3c8a916b261dfff9567}{ulong32}} t;}
\DoxyCodeLine{38    LOAD32L(t, in);}
\DoxyCodeLine{39    t \string^= w;}
\DoxyCodeLine{40    STORE32L(t, out);}
\DoxyCodeLine{41 \}}

\end{DoxyCode}


Referenced by sober128\+\_\+stream\+\_\+crypt().

Here is the caller graph for this function\+:
% FIG 19
