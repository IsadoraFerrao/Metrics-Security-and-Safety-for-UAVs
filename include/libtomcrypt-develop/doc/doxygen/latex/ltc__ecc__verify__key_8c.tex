\hypertarget{ltc__ecc__verify__key_8c}{}\section{M\+:/\+Office/!\+Doutorado/0. Repositorio\+S\+V\+N/\+H\+A\+M\+S\+T\+E\+R\+\_\+\+Prototype/branches/\+J\+I\+N\+T2018/include/libtomcrypt-\/develop/src/pk/ecc/ltc\+\_\+ecc\+\_\+verify\+\_\+key.c File Reference}
\label{ltc__ecc__verify__key_8c}\index{M:/Office/"!Doutorado/0. RepositorioSVN/HAMSTER\_Prototype/branches/JINT2018/include/libtomcrypt-\/develop/src/pk/ecc/ltc\_ecc\_verify\_key.c@{M:/Office/"!Doutorado/0. RepositorioSVN/HAMSTER\_Prototype/branches/JINT2018/include/libtomcrypt-\/develop/src/pk/ecc/ltc\_ecc\_verify\_key.c}}
{\ttfamily \#include \char`\"{}tomcrypt\+\_\+private.\+h\char`\"{}}\newline
Include dependency graph for ltc\+\_\+ecc\+\_\+verify\+\_\+key.\+c\+:
% FIG 0
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
int \mbox{\hyperlink{ltc__ecc__verify__key_8c_ac0dfaf009d9b0101291727341a20bb40}{ltc\+\_\+ecc\+\_\+verify\+\_\+key}} (const ecc\+\_\+key $\ast$key)
\begin{DoxyCompactList}\small\item\em Verify a key according to A\+N\+SI spec. \end{DoxyCompactList}\end{DoxyCompactItemize}


\subsection{Function Documentation}
\mbox{\Hypertarget{ltc__ecc__verify__key_8c_ac0dfaf009d9b0101291727341a20bb40}\label{ltc__ecc__verify__key_8c_ac0dfaf009d9b0101291727341a20bb40}} 
\index{ltc\_ecc\_verify\_key.c@{ltc\_ecc\_verify\_key.c}!ltc\_ecc\_verify\_key@{ltc\_ecc\_verify\_key}}
\index{ltc\_ecc\_verify\_key@{ltc\_ecc\_verify\_key}!ltc\_ecc\_verify\_key.c@{ltc\_ecc\_verify\_key.c}}
\subsubsection{\texorpdfstring{ltc\_ecc\_verify\_key()}{ltc\_ecc\_verify\_key()}}
{\footnotesize\ttfamily int ltc\+\_\+ecc\+\_\+verify\+\_\+key (\begin{DoxyParamCaption}\item[{const ecc\+\_\+key $\ast$}]{key }\end{DoxyParamCaption})}



Verify a key according to A\+N\+SI spec. 


\begin{DoxyParams}{Parameters}
{\em key} & The key to validate \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
C\+R\+Y\+P\+T\+\_\+\+OK if successful 
\end{DoxyReturn}


Definition at line 22 of file ltc\+\_\+ecc\+\_\+verify\+\_\+key.\+c.


\begin{DoxyCode}{0}
\DoxyCodeLine{23 \{}
\DoxyCodeLine{24    \textcolor{keywordtype}{int} err, inf;}
\DoxyCodeLine{25    \mbox{\hyperlink{tomcrypt__math_8h_a2a6efaeaa795aa54274d7c4fd66b018a}{ecc\_point}} *point;}
\DoxyCodeLine{26    \textcolor{keywordtype}{void} *prime = key->dp.prime;}
\DoxyCodeLine{27    \textcolor{keywordtype}{void} *order = key->dp.order;}
\DoxyCodeLine{28    \textcolor{keywordtype}{void} *a     = key->dp.A;}
\DoxyCodeLine{29 }
\DoxyCodeLine{30    \textcolor{comment}{/* Test 1: Are the x and y points of the public key in the field? */}}
\DoxyCodeLine{31    \textcolor{keywordflow}{if} (\mbox{\hyperlink{tomcrypt__math_8h_a3d38c44518c63b7a8abd0938f3d41c65}{ltc\_mp}}.\mbox{\hyperlink{structltc__math__descriptor_a5b3038e00644c477282802863619323b}{compare\_d}}(key->pubkey.z, 1) == \mbox{\hyperlink{tomcrypt__math_8h_a035a31bde4f31419eb259e36e5776607}{LTC\_MP\_EQ}}) \{}
\DoxyCodeLine{32       \textcolor{keywordflow}{if} ((\mbox{\hyperlink{tomcrypt__math_8h_a3d38c44518c63b7a8abd0938f3d41c65}{ltc\_mp}}.\mbox{\hyperlink{structltc__math__descriptor_afa00530838786ca9b52a21a2c00f0f57}{compare}}(key->pubkey.x, prime) != \mbox{\hyperlink{tomcrypt__math_8h_a42d0c7d4c09793df79660774d3436db2}{LTC\_MP\_LT}}) ||}
\DoxyCodeLine{33           (\mbox{\hyperlink{tomcrypt__math_8h_a3d38c44518c63b7a8abd0938f3d41c65}{ltc\_mp}}.\mbox{\hyperlink{structltc__math__descriptor_afa00530838786ca9b52a21a2c00f0f57}{compare}}(key->pubkey.y, prime) != \mbox{\hyperlink{tomcrypt__math_8h_a42d0c7d4c09793df79660774d3436db2}{LTC\_MP\_LT}}) ||}
\DoxyCodeLine{34           (\mbox{\hyperlink{tomcrypt__math_8h_a3d38c44518c63b7a8abd0938f3d41c65}{ltc\_mp}}.\mbox{\hyperlink{structltc__math__descriptor_a5b3038e00644c477282802863619323b}{compare\_d}}(key->pubkey.x, 0) == \mbox{\hyperlink{tomcrypt__math_8h_a42d0c7d4c09793df79660774d3436db2}{LTC\_MP\_LT}}) ||}
\DoxyCodeLine{35           (\mbox{\hyperlink{tomcrypt__math_8h_a3d38c44518c63b7a8abd0938f3d41c65}{ltc\_mp}}.\mbox{\hyperlink{structltc__math__descriptor_a5b3038e00644c477282802863619323b}{compare\_d}}(key->pubkey.y, 0) == \mbox{\hyperlink{tomcrypt__math_8h_a42d0c7d4c09793df79660774d3436db2}{LTC\_MP\_LT}}) ||}
\DoxyCodeLine{36           (\mbox{\hyperlink{tomcrypt__private_8h_a910040068490f9f6e5185c970ab869c9}{mp\_iszero}}(key->pubkey.x) \&\& \mbox{\hyperlink{tomcrypt__private_8h_a910040068490f9f6e5185c970ab869c9}{mp\_iszero}}(key->pubkey.y))}
\DoxyCodeLine{37          )}
\DoxyCodeLine{38       \{}
\DoxyCodeLine{39          err = \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06ca980088f10ffe9009aec286038a9e79da}{CRYPT\_INVALID\_PACKET}};}
\DoxyCodeLine{40          \textcolor{keywordflow}{goto} done2;}
\DoxyCodeLine{41       \}}
\DoxyCodeLine{42    \}}
\DoxyCodeLine{43 }
\DoxyCodeLine{44    \textcolor{comment}{/* Test 2: is the public key on the curve? */}}
\DoxyCodeLine{45    \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{tomcrypt__private_8h_affd37f56571ffc28d2c2687a76014b11}{ltc\_ecc\_is\_point}}(\&key->dp, key->pubkey.x, key->pubkey.y)) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}})      \{ \textcolor{keywordflow}{goto} done2; \}}
\DoxyCodeLine{46 }
\DoxyCodeLine{47    \textcolor{comment}{/* Test 3: does nG = O? (n = order, O = point at infinity, G = public key) */}}
\DoxyCodeLine{48    point = \mbox{\hyperlink{tomcrypt__private_8h_a532af6ef2d0f6d1d8cd79e5f81e87cf8}{ltc\_ecc\_new\_point}}();}
\DoxyCodeLine{49    \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{tomcrypt__private_8h_a818e5e4135d8aa58cf09e502e98ccc90}{ltc\_ecc\_mulmod}}(order, \&(key->pubkey), point, a, prime, 1)) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}})     \{ \textcolor{keywordflow}{goto} done1; \}}
\DoxyCodeLine{50 }
\DoxyCodeLine{51    err = \mbox{\hyperlink{tomcrypt__private_8h_a54a2d7d30af25ef341a8aca09269177d}{ltc\_ecc\_is\_point\_at\_infinity}}(point, prime, \&inf);}
\DoxyCodeLine{52    \textcolor{keywordflow}{if} (err != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}} || inf) \{}
\DoxyCodeLine{53       err = \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06ca03c22220d7538be04455cd2aa6ddf9da}{CRYPT\_ERROR}};}
\DoxyCodeLine{54    \}}
\DoxyCodeLine{55    \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{56       err = \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}};}
\DoxyCodeLine{57    \}}
\DoxyCodeLine{58 }
\DoxyCodeLine{59 done1:}
\DoxyCodeLine{60    \mbox{\hyperlink{tomcrypt__private_8h_a4cef83a7c070c94ff78d4df10a7b624f}{ltc\_ecc\_del\_point}}(point);}
\DoxyCodeLine{61 done2:}
\DoxyCodeLine{62    \textcolor{keywordflow}{return} err;}
\DoxyCodeLine{63 \}}

\end{DoxyCode}


References ltc\+\_\+math\+\_\+descriptor\+::compare, ltc\+\_\+math\+\_\+descriptor\+::compare\+\_\+d, C\+R\+Y\+P\+T\+\_\+\+E\+R\+R\+OR, C\+R\+Y\+P\+T\+\_\+\+I\+N\+V\+A\+L\+I\+D\+\_\+\+P\+A\+C\+K\+ET, C\+R\+Y\+P\+T\+\_\+\+OK, ltc\+\_\+ecc\+\_\+del\+\_\+point(), ltc\+\_\+ecc\+\_\+is\+\_\+point(), ltc\+\_\+ecc\+\_\+is\+\_\+point\+\_\+at\+\_\+infinity(), ltc\+\_\+ecc\+\_\+mulmod(), ltc\+\_\+ecc\+\_\+new\+\_\+point(), ltc\+\_\+mp, L\+T\+C\+\_\+\+M\+P\+\_\+\+EQ, L\+T\+C\+\_\+\+M\+P\+\_\+\+LT, and mp\+\_\+iszero.



Referenced by ecc\+\_\+import\+\_\+ex(), ecc\+\_\+recover\+\_\+key(), and ecc\+\_\+set\+\_\+key().

Here is the call graph for this function\+:
% FIG 1
Here is the caller graph for this function\+:
% FIG 2
