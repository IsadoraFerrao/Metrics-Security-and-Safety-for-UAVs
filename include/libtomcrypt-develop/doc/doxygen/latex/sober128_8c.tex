\hypertarget{sober128_8c}{}\section{M\+:/\+Office/!\+Doutorado/0. Repositorio\+S\+V\+N/\+H\+A\+M\+S\+T\+E\+R\+\_\+\+Prototype/branches/\+J\+I\+N\+T2018/include/libtomcrypt-\/develop/src/prngs/sober128.c File Reference}
\label{sober128_8c}\index{M:/Office/"!Doutorado/0. RepositorioSVN/HAMSTER\_Prototype/branches/JINT2018/include/libtomcrypt-\/develop/src/prngs/sober128.c@{M:/Office/"!Doutorado/0. RepositorioSVN/HAMSTER\_Prototype/branches/JINT2018/include/libtomcrypt-\/develop/src/prngs/sober128.c}}


Implementation of S\+O\+B\+E\+R-\/128 by Tom St Denis.  


{\ttfamily \#include \char`\"{}tomcrypt\+\_\+private.\+h\char`\"{}}\newline
Include dependency graph for sober128.\+c\+:
% FIG 0
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
int \mbox{\hyperlink{sober128_8c_a2e4935bebf15395ce088dd74a6d03114}{sober128\+\_\+start}} (\mbox{\hyperlink{structprng__state}{prng\+\_\+state}} $\ast$prng)
\begin{DoxyCompactList}\small\item\em Start the P\+R\+NG. \end{DoxyCompactList}\item 
int \mbox{\hyperlink{sober128_8c_a477d801a7eb2e66db6c4c3d7f2db3827}{sober128\+\_\+add\+\_\+entropy}} (const unsigned char $\ast$in, unsigned long inlen, \mbox{\hyperlink{structprng__state}{prng\+\_\+state}} $\ast$prng)
\begin{DoxyCompactList}\small\item\em Add entropy to the P\+R\+NG state. \end{DoxyCompactList}\item 
int \mbox{\hyperlink{sober128_8c_a61687a8a822a53f6bc48a79b40f48e04}{sober128\+\_\+ready}} (\mbox{\hyperlink{structprng__state}{prng\+\_\+state}} $\ast$prng)
\begin{DoxyCompactList}\small\item\em Make the P\+R\+NG ready to read from. \end{DoxyCompactList}\item 
unsigned long \mbox{\hyperlink{sober128_8c_a8e7604858301441d7c791a5e86b03025}{sober128\+\_\+read}} (unsigned char $\ast$out, unsigned long outlen, \mbox{\hyperlink{structprng__state}{prng\+\_\+state}} $\ast$prng)
\begin{DoxyCompactList}\small\item\em Read from the P\+R\+NG. \end{DoxyCompactList}\item 
int \mbox{\hyperlink{sober128_8c_a3cfcf62a0dfb3a105430d3a0c753605f}{sober128\+\_\+done}} (\mbox{\hyperlink{structprng__state}{prng\+\_\+state}} $\ast$prng)
\begin{DoxyCompactList}\small\item\em Terminate the P\+R\+NG. \end{DoxyCompactList}\item 
int \mbox{\hyperlink{sober128_8c_a0b6df9499cc20809546e86dc659e033a}{sober128\+\_\+export}} (unsigned char $\ast$out, unsigned long $\ast$outlen, \mbox{\hyperlink{structprng__state}{prng\+\_\+state}} $\ast$prng)
\begin{DoxyCompactList}\small\item\em Export the P\+R\+NG state. \end{DoxyCompactList}\item 
int \mbox{\hyperlink{sober128_8c_abd0bdcc3d2a0436f74ab10b0c68fcbca}{sober128\+\_\+import}} (const unsigned char $\ast$in, unsigned long inlen, \mbox{\hyperlink{structprng__state}{prng\+\_\+state}} $\ast$prng)
\begin{DoxyCompactList}\small\item\em Import a P\+R\+NG state. \end{DoxyCompactList}\item 
int \mbox{\hyperlink{sober128_8c_ae89334392b56e0cb75d493a5bdba60b7}{sober128\+\_\+test}} (void)
\begin{DoxyCompactList}\small\item\em P\+R\+NG self-\/test. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Variables}
\begin{DoxyCompactItemize}
\item 
const struct \mbox{\hyperlink{structltc__prng__descriptor}{ltc\+\_\+prng\+\_\+descriptor}} \mbox{\hyperlink{sober128_8c_acf82d6da430aca8ad53806c4a90a8fff}{sober128\+\_\+desc}}
\end{DoxyCompactItemize}


\subsection{Detailed Description}
Implementation of S\+O\+B\+E\+R-\/128 by Tom St Denis. 

Based on s128fast.\+c reference code supplied by Greg Rose of Q\+U\+A\+L\+C\+O\+MM. 

\subsection{Function Documentation}
\mbox{\Hypertarget{sober128_8c_a477d801a7eb2e66db6c4c3d7f2db3827}\label{sober128_8c_a477d801a7eb2e66db6c4c3d7f2db3827}} 
\index{sober128.c@{sober128.c}!sober128\_add\_entropy@{sober128\_add\_entropy}}
\index{sober128\_add\_entropy@{sober128\_add\_entropy}!sober128.c@{sober128.c}}
\subsubsection{\texorpdfstring{sober128\_add\_entropy()}{sober128\_add\_entropy()}}
{\footnotesize\ttfamily int sober128\+\_\+add\+\_\+entropy (\begin{DoxyParamCaption}\item[{const unsigned char $\ast$}]{in,  }\item[{unsigned long}]{inlen,  }\item[{\mbox{\hyperlink{structprng__state}{prng\+\_\+state}} $\ast$}]{prng }\end{DoxyParamCaption})}



Add entropy to the P\+R\+NG state. 


\begin{DoxyParams}{Parameters}
{\em in} & The data to add \\
\hline
{\em inlen} & Length of the data to add \\
\hline
{\em prng} & P\+R\+NG state to update \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
C\+R\+Y\+P\+T\+\_\+\+OK if successful 
\end{DoxyReturn}


Definition at line 56 of file sober128.\+c.


\begin{DoxyCode}{0}
\DoxyCodeLine{57 \{}
\DoxyCodeLine{58    \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char} buf[40];}
\DoxyCodeLine{59    \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} i;}
\DoxyCodeLine{60    \textcolor{keywordtype}{int} err;}
\DoxyCodeLine{61 }
\DoxyCodeLine{62    \mbox{\hyperlink{tomcrypt__argchk_8h_a683da3e041e49f196318b6ea951414ba}{LTC\_ARGCHK}}(prng != NULL);}
\DoxyCodeLine{63    \mbox{\hyperlink{tomcrypt__argchk_8h_a683da3e041e49f196318b6ea951414ba}{LTC\_ARGCHK}}(in != NULL);}
\DoxyCodeLine{64    \mbox{\hyperlink{tomcrypt__argchk_8h_a683da3e041e49f196318b6ea951414ba}{LTC\_ARGCHK}}(inlen > 0);}
\DoxyCodeLine{65 }
\DoxyCodeLine{66    \mbox{\hyperlink{tomcrypt__custom_8h_a427a107414e4d775fbf23f4a499f4a31}{LTC\_MUTEX\_LOCK}}(\&prng->lock);}
\DoxyCodeLine{67    \textcolor{keywordflow}{if} (prng->\mbox{\hyperlink{structprng__state_ad5b2704260668ba49701ba0169286837}{ready}}) \{}
\DoxyCodeLine{68       \textcolor{comment}{/* sober128\_ready() was already called, do "rekey" operation */}}
\DoxyCodeLine{69       \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{sober128__stream_8c_a8f44e316ae3d51801843156a64966a34}{sober128\_stream\_keystream}}(\&prng->\mbox{\hyperlink{structprng__state_a73ffeba26752871bc883f035a89f0991}{u}}.sober128.s, buf, \textcolor{keyword}{sizeof}(buf))) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}}) \textcolor{keywordflow}{goto} LBL\_UNLOCK;}
\DoxyCodeLine{70       \textcolor{keywordflow}{for}(i = 0; i < inlen; i++) buf[i \% \textcolor{keyword}{sizeof}(buf)] \string^= in[i];}
\DoxyCodeLine{71       \textcolor{comment}{/* key 32 bytes, 20 rounds */}}
\DoxyCodeLine{72       \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{sober128__stream_8c_a0a1e7b2ff7cfbba83eee53e875ef8d6e}{sober128\_stream\_setup}}(\&prng->\mbox{\hyperlink{structprng__state_a73ffeba26752871bc883f035a89f0991}{u}}.sober128.s, buf, 32)) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}})     \textcolor{keywordflow}{goto} LBL\_UNLOCK;}
\DoxyCodeLine{73       \textcolor{comment}{/* iv 8 bytes */}}
\DoxyCodeLine{74       \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{sober128__stream_8c_aad93d7243d0b6e8bb46f8637c1dab891}{sober128\_stream\_setiv}}(\&prng->\mbox{\hyperlink{structprng__state_a73ffeba26752871bc883f035a89f0991}{u}}.sober128.s, buf + 32, 8)) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}}) \textcolor{keywordflow}{goto} LBL\_UNLOCK;}
\DoxyCodeLine{75       \textcolor{comment}{/* clear KEY + IV */}}
\DoxyCodeLine{76       \mbox{\hyperlink{tomcrypt__misc_8h_a63b6e188713790263bfd3612fe8b398f}{zeromem}}(buf, \textcolor{keyword}{sizeof}(buf));}
\DoxyCodeLine{77    \}}
\DoxyCodeLine{78    \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{79       \textcolor{comment}{/* sober128\_ready() was not called yet, add entropy to ent buffer */}}
\DoxyCodeLine{80       \textcolor{keywordflow}{while} (inlen--) prng->\mbox{\hyperlink{structprng__state_a73ffeba26752871bc883f035a89f0991}{u}}.sober128.ent[prng->\mbox{\hyperlink{structprng__state_a73ffeba26752871bc883f035a89f0991}{u}}.sober128.idx++ \% \textcolor{keyword}{sizeof}(prng->\mbox{\hyperlink{structprng__state_a73ffeba26752871bc883f035a89f0991}{u}}.sober128.ent)] \string^= *in++;}
\DoxyCodeLine{81    \}}
\DoxyCodeLine{82    err = \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}};}
\DoxyCodeLine{83 LBL\_UNLOCK:}
\DoxyCodeLine{84    \mbox{\hyperlink{tomcrypt__custom_8h_acdf267be91b178b4fafe8f992d57a7f1}{LTC\_MUTEX\_UNLOCK}}(\&prng->lock);}
\DoxyCodeLine{85    \textcolor{keywordflow}{return} err;}
\DoxyCodeLine{86 \}}

\end{DoxyCode}


References C\+R\+Y\+P\+T\+\_\+\+OK, L\+T\+C\+\_\+\+A\+R\+G\+C\+HK, L\+T\+C\+\_\+\+M\+U\+T\+E\+X\+\_\+\+L\+O\+CK, L\+T\+C\+\_\+\+M\+U\+T\+E\+X\+\_\+\+U\+N\+L\+O\+CK, prng\+\_\+state\+::ready, sober128\+\_\+stream\+\_\+keystream(), sober128\+\_\+stream\+\_\+setiv(), sober128\+\_\+stream\+\_\+setup(), prng\+\_\+state\+::u, and zeromem().



Referenced by sober128\+\_\+import(), and sober128\+\_\+test().

Here is the call graph for this function\+:
% FIG 1
Here is the caller graph for this function\+:
% FIG 2
\mbox{\Hypertarget{sober128_8c_a3cfcf62a0dfb3a105430d3a0c753605f}\label{sober128_8c_a3cfcf62a0dfb3a105430d3a0c753605f}} 
\index{sober128.c@{sober128.c}!sober128\_done@{sober128\_done}}
\index{sober128\_done@{sober128\_done}!sober128.c@{sober128.c}}
\subsubsection{\texorpdfstring{sober128\_done()}{sober128\_done()}}
{\footnotesize\ttfamily int sober128\+\_\+done (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structprng__state}{prng\+\_\+state}} $\ast$}]{prng }\end{DoxyParamCaption})}



Terminate the P\+R\+NG. 


\begin{DoxyParams}{Parameters}
{\em prng} & The P\+R\+NG to terminate \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
C\+R\+Y\+P\+T\+\_\+\+OK if successful 
\end{DoxyReturn}


Definition at line 136 of file sober128.\+c.


\begin{DoxyCode}{0}
\DoxyCodeLine{137 \{}
\DoxyCodeLine{138    \textcolor{keywordtype}{int} err;}
\DoxyCodeLine{139    \mbox{\hyperlink{tomcrypt__argchk_8h_a683da3e041e49f196318b6ea951414ba}{LTC\_ARGCHK}}(prng != NULL);}
\DoxyCodeLine{140    \mbox{\hyperlink{tomcrypt__custom_8h_a427a107414e4d775fbf23f4a499f4a31}{LTC\_MUTEX\_LOCK}}(\&prng->lock);}
\DoxyCodeLine{141    prng->\mbox{\hyperlink{structprng__state_ad5b2704260668ba49701ba0169286837}{ready}} = 0;}
\DoxyCodeLine{142    err = \mbox{\hyperlink{sober128__stream_8c_a37c4a04830801bac9f4b432b4b45fb2d}{sober128\_stream\_done}}(\&prng->\mbox{\hyperlink{structprng__state_a73ffeba26752871bc883f035a89f0991}{u}}.sober128.s);}
\DoxyCodeLine{143    \mbox{\hyperlink{tomcrypt__custom_8h_acdf267be91b178b4fafe8f992d57a7f1}{LTC\_MUTEX\_UNLOCK}}(\&prng->lock);}
\DoxyCodeLine{144    \mbox{\hyperlink{tomcrypt__custom_8h_ae3979e1469d64fe3e864c9effca73724}{LTC\_MUTEX\_DESTROY}}(\&prng->lock);}
\DoxyCodeLine{145    \textcolor{keywordflow}{return} err;}
\DoxyCodeLine{146 \}}

\end{DoxyCode}


References L\+T\+C\+\_\+\+A\+R\+G\+C\+HK, L\+T\+C\+\_\+\+M\+U\+T\+E\+X\+\_\+\+D\+E\+S\+T\+R\+OY, L\+T\+C\+\_\+\+M\+U\+T\+E\+X\+\_\+\+L\+O\+CK, L\+T\+C\+\_\+\+M\+U\+T\+E\+X\+\_\+\+U\+N\+L\+O\+CK, prng\+\_\+state\+::ready, sober128\+\_\+stream\+\_\+done(), and prng\+\_\+state\+::u.



Referenced by sober128\+\_\+test().

Here is the call graph for this function\+:
% FIG 3
Here is the caller graph for this function\+:
% FIG 4
\mbox{\Hypertarget{sober128_8c_a0b6df9499cc20809546e86dc659e033a}\label{sober128_8c_a0b6df9499cc20809546e86dc659e033a}} 
\index{sober128.c@{sober128.c}!sober128\_export@{sober128\_export}}
\index{sober128\_export@{sober128\_export}!sober128.c@{sober128.c}}
\subsubsection{\texorpdfstring{sober128\_export()}{sober128\_export()}}
{\footnotesize\ttfamily int sober128\+\_\+export (\begin{DoxyParamCaption}\item[{unsigned char $\ast$}]{out,  }\item[{unsigned long $\ast$}]{outlen,  }\item[{\mbox{\hyperlink{structprng__state}{prng\+\_\+state}} $\ast$}]{prng }\end{DoxyParamCaption})}



Export the P\+R\+NG state. 


\begin{DoxyParams}{Parameters}
{\em out} & \mbox{[}out\mbox{]} Destination \\
\hline
{\em outlen} & \mbox{[}in/out\mbox{]} Max size and resulting size of the state \\
\hline
{\em prng} & The P\+R\+NG to export \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
C\+R\+Y\+P\+T\+\_\+\+OK if successful 
\end{DoxyReturn}


Definition at line 155 of file sober128.\+c.


\begin{DoxyCode}{0}
\DoxyCodeLine{165 \{}

\end{DoxyCode}


Referenced by sober128\+\_\+test().

Here is the caller graph for this function\+:
% FIG 5
\mbox{\Hypertarget{sober128_8c_abd0bdcc3d2a0436f74ab10b0c68fcbca}\label{sober128_8c_abd0bdcc3d2a0436f74ab10b0c68fcbca}} 
\index{sober128.c@{sober128.c}!sober128\_import@{sober128\_import}}
\index{sober128\_import@{sober128\_import}!sober128.c@{sober128.c}}
\subsubsection{\texorpdfstring{sober128\_import()}{sober128\_import()}}
{\footnotesize\ttfamily int sober128\+\_\+import (\begin{DoxyParamCaption}\item[{const unsigned char $\ast$}]{in,  }\item[{unsigned long}]{inlen,  }\item[{\mbox{\hyperlink{structprng__state}{prng\+\_\+state}} $\ast$}]{prng }\end{DoxyParamCaption})}



Import a P\+R\+NG state. 


\begin{DoxyParams}{Parameters}
{\em in} & The P\+R\+NG state \\
\hline
{\em inlen} & Size of the state \\
\hline
{\em prng} & The P\+R\+NG to import \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
C\+R\+Y\+P\+T\+\_\+\+OK if successful 
\end{DoxyReturn}


Definition at line 164 of file sober128.\+c.


\begin{DoxyCode}{0}
\DoxyCodeLine{165 \{}
\DoxyCodeLine{166    \textcolor{keywordtype}{int} err;}
\DoxyCodeLine{167 }
\DoxyCodeLine{168    \mbox{\hyperlink{tomcrypt__argchk_8h_a683da3e041e49f196318b6ea951414ba}{LTC\_ARGCHK}}(prng != NULL);}
\DoxyCodeLine{169    \mbox{\hyperlink{tomcrypt__argchk_8h_a683da3e041e49f196318b6ea951414ba}{LTC\_ARGCHK}}(in   != NULL);}
\DoxyCodeLine{170    \textcolor{keywordflow}{if} (inlen < (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long})\mbox{\hyperlink{sober128_8c_acf82d6da430aca8ad53806c4a90a8fff}{sober128\_desc}}.\mbox{\hyperlink{structltc__prng__descriptor_a41ef184ab75b213366392faabcde420c}{export\_size}}) \textcolor{keywordflow}{return} \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06ca92aa8bad3930f08d5a188bf72094b066}{CRYPT\_INVALID\_ARG}};}
\DoxyCodeLine{171 }
\DoxyCodeLine{172    \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{sober128_8c_a2e4935bebf15395ce088dd74a6d03114}{sober128\_start}}(prng)) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}}) \textcolor{keywordflow}{return} err;}
\DoxyCodeLine{173    \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{sober128_8c_a477d801a7eb2e66db6c4c3d7f2db3827}{sober128\_add\_entropy}}(in, inlen, prng)) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}}) \textcolor{keywordflow}{return} err;}
\DoxyCodeLine{174    \textcolor{keywordflow}{return} \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}};}
\DoxyCodeLine{175 \}}

\end{DoxyCode}


References C\+R\+Y\+P\+T\+\_\+\+I\+N\+V\+A\+L\+I\+D\+\_\+\+A\+RG, C\+R\+Y\+P\+T\+\_\+\+OK, ltc\+\_\+prng\+\_\+descriptor\+::export\+\_\+size, L\+T\+C\+\_\+\+A\+R\+G\+C\+HK, sober128\+\_\+add\+\_\+entropy(), sober128\+\_\+desc, and sober128\+\_\+start().



Referenced by sober128\+\_\+test().

Here is the call graph for this function\+:
% FIG 6
Here is the caller graph for this function\+:
% FIG 7
\mbox{\Hypertarget{sober128_8c_a8e7604858301441d7c791a5e86b03025}\label{sober128_8c_a8e7604858301441d7c791a5e86b03025}} 
\index{sober128.c@{sober128.c}!sober128\_read@{sober128\_read}}
\index{sober128\_read@{sober128\_read}!sober128.c@{sober128.c}}
\subsubsection{\texorpdfstring{sober128\_read()}{sober128\_read()}}
{\footnotesize\ttfamily unsigned long sober128\+\_\+read (\begin{DoxyParamCaption}\item[{unsigned char $\ast$}]{out,  }\item[{unsigned long}]{outlen,  }\item[{\mbox{\hyperlink{structprng__state}{prng\+\_\+state}} $\ast$}]{prng }\end{DoxyParamCaption})}



Read from the P\+R\+NG. 


\begin{DoxyParams}{Parameters}
{\em out} & Destination \\
\hline
{\em outlen} & Length of output \\
\hline
{\em prng} & The active P\+R\+NG to read from \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Number of octets read 
\end{DoxyReturn}


Definition at line 120 of file sober128.\+c.


\begin{DoxyCode}{0}
\DoxyCodeLine{121 \{}
\DoxyCodeLine{122    \textcolor{keywordflow}{if} (outlen == 0 || prng == NULL || out == NULL) \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{123    \mbox{\hyperlink{tomcrypt__custom_8h_a427a107414e4d775fbf23f4a499f4a31}{LTC\_MUTEX\_LOCK}}(\&prng->lock);}
\DoxyCodeLine{124    \textcolor{keywordflow}{if} (!prng->\mbox{\hyperlink{structprng__state_ad5b2704260668ba49701ba0169286837}{ready}}) \{ outlen = 0; \textcolor{keywordflow}{goto} LBL\_UNLOCK; \}}
\DoxyCodeLine{125    \textcolor{keywordflow}{if} (\mbox{\hyperlink{sober128__stream_8c_a8f44e316ae3d51801843156a64966a34}{sober128\_stream\_keystream}}(\&prng->\mbox{\hyperlink{structprng__state_a73ffeba26752871bc883f035a89f0991}{u}}.sober128.s, out, outlen) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}}) outlen = 0;}
\DoxyCodeLine{126 LBL\_UNLOCK:}
\DoxyCodeLine{127    \mbox{\hyperlink{tomcrypt__custom_8h_acdf267be91b178b4fafe8f992d57a7f1}{LTC\_MUTEX\_UNLOCK}}(\&prng->lock);}
\DoxyCodeLine{128    \textcolor{keywordflow}{return} outlen;}
\DoxyCodeLine{129 \}}

\end{DoxyCode}


References C\+R\+Y\+P\+T\+\_\+\+OK, L\+T\+C\+\_\+\+M\+U\+T\+E\+X\+\_\+\+L\+O\+CK, L\+T\+C\+\_\+\+M\+U\+T\+E\+X\+\_\+\+U\+N\+L\+O\+CK, prng\+\_\+state\+::ready, sober128\+\_\+stream\+\_\+keystream(), and prng\+\_\+state\+::u.



Referenced by sober128\+\_\+test().

Here is the call graph for this function\+:
% FIG 8
Here is the caller graph for this function\+:
% FIG 9
\mbox{\Hypertarget{sober128_8c_a61687a8a822a53f6bc48a79b40f48e04}\label{sober128_8c_a61687a8a822a53f6bc48a79b40f48e04}} 
\index{sober128.c@{sober128.c}!sober128\_ready@{sober128\_ready}}
\index{sober128\_ready@{sober128\_ready}!sober128.c@{sober128.c}}
\subsubsection{\texorpdfstring{sober128\_ready()}{sober128\_ready()}}
{\footnotesize\ttfamily int sober128\+\_\+ready (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structprng__state}{prng\+\_\+state}} $\ast$}]{prng }\end{DoxyParamCaption})}



Make the P\+R\+NG ready to read from. 


\begin{DoxyParams}{Parameters}
{\em prng} & The P\+R\+NG to make active \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
C\+R\+Y\+P\+T\+\_\+\+OK if successful 
\end{DoxyReturn}


Definition at line 93 of file sober128.\+c.


\begin{DoxyCode}{0}
\DoxyCodeLine{94 \{}
\DoxyCodeLine{95    \textcolor{keywordtype}{int} err;}
\DoxyCodeLine{96 }
\DoxyCodeLine{97    \mbox{\hyperlink{tomcrypt__argchk_8h_a683da3e041e49f196318b6ea951414ba}{LTC\_ARGCHK}}(prng != NULL);}
\DoxyCodeLine{98 }
\DoxyCodeLine{99    \mbox{\hyperlink{tomcrypt__custom_8h_a427a107414e4d775fbf23f4a499f4a31}{LTC\_MUTEX\_LOCK}}(\&prng->lock);}
\DoxyCodeLine{100    \textcolor{keywordflow}{if} (prng->\mbox{\hyperlink{structprng__state_ad5b2704260668ba49701ba0169286837}{ready}})                                                            \{ err = \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}}; \textcolor{keywordflow}{goto} LBL\_UNLOCK; \}}
\DoxyCodeLine{101    \textcolor{comment}{/* key 32 bytes, 20 rounds */}}
\DoxyCodeLine{102    \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{sober128__stream_8c_a0a1e7b2ff7cfbba83eee53e875ef8d6e}{sober128\_stream\_setup}}(\&prng->\mbox{\hyperlink{structprng__state_a73ffeba26752871bc883f035a89f0991}{u}}.sober128.s, prng->\mbox{\hyperlink{structprng__state_a73ffeba26752871bc883f035a89f0991}{u}}.sober128.ent, 32)) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}})     \textcolor{keywordflow}{goto} LBL\_UNLOCK;}
\DoxyCodeLine{103    \textcolor{comment}{/* iv 8 bytes */}}
\DoxyCodeLine{104    \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{sober128__stream_8c_aad93d7243d0b6e8bb46f8637c1dab891}{sober128\_stream\_setiv}}(\&prng->\mbox{\hyperlink{structprng__state_a73ffeba26752871bc883f035a89f0991}{u}}.sober128.s, prng->\mbox{\hyperlink{structprng__state_a73ffeba26752871bc883f035a89f0991}{u}}.sober128.ent + 32, 8)) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}}) \textcolor{keywordflow}{goto} LBL\_UNLOCK;}
\DoxyCodeLine{105    \mbox{\hyperlink{tomcrypt__cfg_8h_aa3c34a6f6c61de7da9258b5a30e32c2f}{XMEMSET}}(\&prng->\mbox{\hyperlink{structprng__state_a73ffeba26752871bc883f035a89f0991}{u}}.sober128.ent, 0, \textcolor{keyword}{sizeof}(prng->\mbox{\hyperlink{structprng__state_a73ffeba26752871bc883f035a89f0991}{u}}.sober128.ent));}
\DoxyCodeLine{106    prng->\mbox{\hyperlink{structprng__state_a73ffeba26752871bc883f035a89f0991}{u}}.sober128.idx = 0;}
\DoxyCodeLine{107    prng->\mbox{\hyperlink{structprng__state_ad5b2704260668ba49701ba0169286837}{ready}} = 1;}
\DoxyCodeLine{108 LBL\_UNLOCK:}
\DoxyCodeLine{109    \mbox{\hyperlink{tomcrypt__custom_8h_acdf267be91b178b4fafe8f992d57a7f1}{LTC\_MUTEX\_UNLOCK}}(\&prng->lock);}
\DoxyCodeLine{110    \textcolor{keywordflow}{return} err;}
\DoxyCodeLine{111 \}}

\end{DoxyCode}


References C\+R\+Y\+P\+T\+\_\+\+OK, L\+T\+C\+\_\+\+A\+R\+G\+C\+HK, L\+T\+C\+\_\+\+M\+U\+T\+E\+X\+\_\+\+L\+O\+CK, L\+T\+C\+\_\+\+M\+U\+T\+E\+X\+\_\+\+U\+N\+L\+O\+CK, prng\+\_\+state\+::ready, sober128\+\_\+stream\+\_\+setiv(), sober128\+\_\+stream\+\_\+setup(), prng\+\_\+state\+::u, and X\+M\+E\+M\+S\+E\+T().



Referenced by sober128\+\_\+test().

Here is the call graph for this function\+:
% FIG 10
Here is the caller graph for this function\+:
% FIG 11
\mbox{\Hypertarget{sober128_8c_a2e4935bebf15395ce088dd74a6d03114}\label{sober128_8c_a2e4935bebf15395ce088dd74a6d03114}} 
\index{sober128.c@{sober128.c}!sober128\_start@{sober128\_start}}
\index{sober128\_start@{sober128\_start}!sober128.c@{sober128.c}}
\subsubsection{\texorpdfstring{sober128\_start()}{sober128\_start()}}
{\footnotesize\ttfamily int sober128\+\_\+start (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structprng__state}{prng\+\_\+state}} $\ast$}]{prng }\end{DoxyParamCaption})}



Start the P\+R\+NG. 


\begin{DoxyParams}{Parameters}
{\em prng} & \mbox{[}out\mbox{]} The P\+R\+NG state to initialize \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
C\+R\+Y\+P\+T\+\_\+\+OK if successful 
\end{DoxyReturn}


Definition at line 39 of file sober128.\+c.


\begin{DoxyCode}{0}
\DoxyCodeLine{40 \{}
\DoxyCodeLine{41    \mbox{\hyperlink{tomcrypt__argchk_8h_a683da3e041e49f196318b6ea951414ba}{LTC\_ARGCHK}}(prng != NULL);}
\DoxyCodeLine{42    prng->\mbox{\hyperlink{structprng__state_ad5b2704260668ba49701ba0169286837}{ready}} = 0;}
\DoxyCodeLine{43    \mbox{\hyperlink{tomcrypt__cfg_8h_aa3c34a6f6c61de7da9258b5a30e32c2f}{XMEMSET}}(\&prng->\mbox{\hyperlink{structprng__state_a73ffeba26752871bc883f035a89f0991}{u}}.sober128.ent, 0, \textcolor{keyword}{sizeof}(prng->\mbox{\hyperlink{structprng__state_a73ffeba26752871bc883f035a89f0991}{u}}.sober128.ent));}
\DoxyCodeLine{44    prng->\mbox{\hyperlink{structprng__state_a73ffeba26752871bc883f035a89f0991}{u}}.sober128.idx = 0;}
\DoxyCodeLine{45    \mbox{\hyperlink{tomcrypt__custom_8h_a450b04a6e1d004908791edaa0901d284}{LTC\_MUTEX\_INIT}}(\&prng->lock)}
\DoxyCodeLine{46    return \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}};}
\DoxyCodeLine{47 \}}

\end{DoxyCode}


References C\+R\+Y\+P\+T\+\_\+\+OK, L\+T\+C\+\_\+\+A\+R\+G\+C\+HK, L\+T\+C\+\_\+\+M\+U\+T\+E\+X\+\_\+\+I\+N\+IT, prng\+\_\+state\+::ready, prng\+\_\+state\+::u, and X\+M\+E\+M\+S\+E\+T().



Referenced by sober128\+\_\+import(), and sober128\+\_\+test().

Here is the call graph for this function\+:
% FIG 12
Here is the caller graph for this function\+:
% FIG 13
\mbox{\Hypertarget{sober128_8c_ae89334392b56e0cb75d493a5bdba60b7}\label{sober128_8c_ae89334392b56e0cb75d493a5bdba60b7}} 
\index{sober128.c@{sober128.c}!sober128\_test@{sober128\_test}}
\index{sober128\_test@{sober128\_test}!sober128.c@{sober128.c}}
\subsubsection{\texorpdfstring{sober128\_test()}{sober128\_test()}}
{\footnotesize\ttfamily int sober128\+\_\+test (\begin{DoxyParamCaption}\item[{void}]{ }\end{DoxyParamCaption})}



P\+R\+NG self-\/test. 

\begin{DoxyReturn}{Returns}
C\+R\+Y\+P\+T\+\_\+\+OK if successful, C\+R\+Y\+P\+T\+\_\+\+N\+OP if self-\/testing has been disabled 
\end{DoxyReturn}


Definition at line 181 of file sober128.\+c.


\begin{DoxyCode}{0}
\DoxyCodeLine{182 \{}
\DoxyCodeLine{183 \textcolor{preprocessor}{\#ifndef LTC\_TEST}}
\DoxyCodeLine{184    \textcolor{keywordflow}{return} \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cac43a7799c7fd5f515172da6cfc0f9cf5}{CRYPT\_NOP}};}
\DoxyCodeLine{185 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{186    \mbox{\hyperlink{structprng__state}{prng\_state}} st;}
\DoxyCodeLine{187    \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char} en[] = \{ 0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07, 0x08, 0x09, 0x0a,}
\DoxyCodeLine{188                           0x0b, 0x0c, 0x0d, 0x0e, 0x0f, 0x10, 0x11, 0x12, 0x13, 0x14,}
\DoxyCodeLine{189                           0x15, 0x16, 0x17, 0x18, 0x19, 0x1a, 0x1b, 0x1c, 0x1d, 0x1e,}
\DoxyCodeLine{190                           0x1f, 0x20, 0x21, 0x22, 0x23, 0x24, 0x25, 0x26, 0x27, 0x28,}
\DoxyCodeLine{191                           0x29, 0x2a, 0x2b, 0x2c, 0x2d, 0x2e, 0x2f, 0x30, 0x31, 0x32 \};}
\DoxyCodeLine{192    \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char} dmp[300];}
\DoxyCodeLine{193    \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} dmplen = \textcolor{keyword}{sizeof}(dmp);}
\DoxyCodeLine{194    \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char} out[500];}
\DoxyCodeLine{195    \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char} \mbox{\hyperlink{tiger_8c_a65f7891fccbfcf7d08964555630773b3}{t1}}[] = \{ 0x31, 0x82, 0xA7, 0xA5, 0x8B, 0xD7, 0xCB, 0x39, 0x86, 0x1A \};}
\DoxyCodeLine{196    \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char} \mbox{\hyperlink{tiger_8c_aa4652e2d6053d420dcbea07a113db5fe}{t2}}[] = \{ 0x6B, 0x43, 0x9E, 0xBC, 0xE7, 0x62, 0x9B, 0xE6, 0x9B, 0x83 \};}
\DoxyCodeLine{197    \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char} \mbox{\hyperlink{tiger_8c_a71a491fa5f35065b954a3001ebed0f28}{t3}}[] = \{ 0x4A, 0x0E, 0x6C, 0xC1, 0xCF, 0xB4, 0x73, 0x49, 0x99, 0x05 \};}
\DoxyCodeLine{198    \textcolor{keywordtype}{int} err;}
\DoxyCodeLine{199 }
\DoxyCodeLine{200    \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{sober128_8c_a2e4935bebf15395ce088dd74a6d03114}{sober128\_start}}(\&st)) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}})                         \textcolor{keywordflow}{return} err;}
\DoxyCodeLine{201    \textcolor{comment}{/* add entropy to uninitialized prng */}}
\DoxyCodeLine{202    \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{sober128_8c_a477d801a7eb2e66db6c4c3d7f2db3827}{sober128\_add\_entropy}}(en, \textcolor{keyword}{sizeof}(en), \&st)) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}})   \textcolor{keywordflow}{return} err;}
\DoxyCodeLine{203    \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{sober128_8c_a61687a8a822a53f6bc48a79b40f48e04}{sober128\_ready}}(\&st)) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}})                         \textcolor{keywordflow}{return} err;}
\DoxyCodeLine{204    \textcolor{keywordflow}{if} (\mbox{\hyperlink{sober128_8c_a8e7604858301441d7c791a5e86b03025}{sober128\_read}}(out, 10, \&st) != 10)                               \textcolor{keywordflow}{return} \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06ca68eea82b3b71f23031cd94b10c920bf3}{CRYPT\_ERROR\_READPRNG}}; \textcolor{comment}{/* 10 bytes for testing */}}
\DoxyCodeLine{205    \textcolor{keywordflow}{if} (\mbox{\hyperlink{tomcrypt__misc_8h_a7764a7f27897c6182335752df00b5f8e}{compare\_testvector}}(out, 10, \mbox{\hyperlink{tiger_8c_a65f7891fccbfcf7d08964555630773b3}{t1}}, \textcolor{keyword}{sizeof}(\mbox{\hyperlink{tiger_8c_a65f7891fccbfcf7d08964555630773b3}{t1}}), \textcolor{stringliteral}{"SOBER128-PRNG"}, 1)) \textcolor{keywordflow}{return} \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06caf98a132fdf93633389677f31f9bb39ca}{CRYPT\_FAIL\_TESTVECTOR}};}
\DoxyCodeLine{206    \textcolor{keywordflow}{if} (\mbox{\hyperlink{sober128_8c_a8e7604858301441d7c791a5e86b03025}{sober128\_read}}(out, 500, \&st) != 500)                             \textcolor{keywordflow}{return} \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06ca68eea82b3b71f23031cd94b10c920bf3}{CRYPT\_ERROR\_READPRNG}}; \textcolor{comment}{/* skip 500 bytes */}}
\DoxyCodeLine{207    \textcolor{comment}{/* add entropy to already initialized prng */}}
\DoxyCodeLine{208    \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{sober128_8c_a477d801a7eb2e66db6c4c3d7f2db3827}{sober128\_add\_entropy}}(en, \textcolor{keyword}{sizeof}(en), \&st)) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}})   \textcolor{keywordflow}{return} err;}
\DoxyCodeLine{209    \textcolor{keywordflow}{if} (\mbox{\hyperlink{sober128_8c_a8e7604858301441d7c791a5e86b03025}{sober128\_read}}(out, 500, \&st) != 500)                             \textcolor{keywordflow}{return} \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06ca68eea82b3b71f23031cd94b10c920bf3}{CRYPT\_ERROR\_READPRNG}}; \textcolor{comment}{/* skip 500 bytes */}}
\DoxyCodeLine{210    \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{sober128_8c_a0b6df9499cc20809546e86dc659e033a}{sober128\_export}}(dmp, \&dmplen, \&st)) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}})          \textcolor{keywordflow}{return} err;}
\DoxyCodeLine{211    \textcolor{keywordflow}{if} (\mbox{\hyperlink{sober128_8c_a8e7604858301441d7c791a5e86b03025}{sober128\_read}}(out, 500, \&st) != 500)                             \textcolor{keywordflow}{return} \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06ca68eea82b3b71f23031cd94b10c920bf3}{CRYPT\_ERROR\_READPRNG}}; \textcolor{comment}{/* skip 500 bytes */}}
\DoxyCodeLine{212    \textcolor{keywordflow}{if} (\mbox{\hyperlink{sober128_8c_a8e7604858301441d7c791a5e86b03025}{sober128\_read}}(out, 10, \&st) != 10)                               \textcolor{keywordflow}{return} \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06ca68eea82b3b71f23031cd94b10c920bf3}{CRYPT\_ERROR\_READPRNG}}; \textcolor{comment}{/* 10 bytes for testing */}}
\DoxyCodeLine{213    \textcolor{keywordflow}{if} (\mbox{\hyperlink{tomcrypt__misc_8h_a7764a7f27897c6182335752df00b5f8e}{compare\_testvector}}(out, 10, \mbox{\hyperlink{tiger_8c_aa4652e2d6053d420dcbea07a113db5fe}{t2}}, \textcolor{keyword}{sizeof}(\mbox{\hyperlink{tiger_8c_aa4652e2d6053d420dcbea07a113db5fe}{t2}}), \textcolor{stringliteral}{"SOBER128-PRNG"}, 2)) \textcolor{keywordflow}{return} \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06caf98a132fdf93633389677f31f9bb39ca}{CRYPT\_FAIL\_TESTVECTOR}};}
\DoxyCodeLine{214    \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{sober128_8c_a3cfcf62a0dfb3a105430d3a0c753605f}{sober128\_done}}(\&st)) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}})                          \textcolor{keywordflow}{return} err;}
\DoxyCodeLine{215    \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{sober128_8c_abd0bdcc3d2a0436f74ab10b0c68fcbca}{sober128\_import}}(dmp, dmplen, \&st)) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}})           \textcolor{keywordflow}{return} err;}
\DoxyCodeLine{216    \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{sober128_8c_a61687a8a822a53f6bc48a79b40f48e04}{sober128\_ready}}(\&st)) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}})                         \textcolor{keywordflow}{return} err;}
\DoxyCodeLine{217    \textcolor{keywordflow}{if} (\mbox{\hyperlink{sober128_8c_a8e7604858301441d7c791a5e86b03025}{sober128\_read}}(out, 500, \&st) != 500)                             \textcolor{keywordflow}{return} \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06ca68eea82b3b71f23031cd94b10c920bf3}{CRYPT\_ERROR\_READPRNG}}; \textcolor{comment}{/* skip 500 bytes */}}
\DoxyCodeLine{218    \textcolor{keywordflow}{if} (\mbox{\hyperlink{sober128_8c_a8e7604858301441d7c791a5e86b03025}{sober128\_read}}(out, 10, \&st) != 10)                               \textcolor{keywordflow}{return} \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06ca68eea82b3b71f23031cd94b10c920bf3}{CRYPT\_ERROR\_READPRNG}}; \textcolor{comment}{/* 10 bytes for testing */}}
\DoxyCodeLine{219    \textcolor{keywordflow}{if} (\mbox{\hyperlink{tomcrypt__misc_8h_a7764a7f27897c6182335752df00b5f8e}{compare\_testvector}}(out, 10, \mbox{\hyperlink{tiger_8c_a71a491fa5f35065b954a3001ebed0f28}{t3}}, \textcolor{keyword}{sizeof}(\mbox{\hyperlink{tiger_8c_a71a491fa5f35065b954a3001ebed0f28}{t3}}), \textcolor{stringliteral}{"SOBER128-PRNG"}, 3)) \textcolor{keywordflow}{return} \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06caf98a132fdf93633389677f31f9bb39ca}{CRYPT\_FAIL\_TESTVECTOR}};}
\DoxyCodeLine{220    \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{sober128_8c_a3cfcf62a0dfb3a105430d3a0c753605f}{sober128\_done}}(\&st)) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}})                          \textcolor{keywordflow}{return} err;}
\DoxyCodeLine{221 }
\DoxyCodeLine{222    \textcolor{keywordflow}{return} \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}};}
\DoxyCodeLine{223 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{224 \}}

\end{DoxyCode}


References compare\+\_\+testvector(), C\+R\+Y\+P\+T\+\_\+\+E\+R\+R\+O\+R\+\_\+\+R\+E\+A\+D\+P\+R\+NG, C\+R\+Y\+P\+T\+\_\+\+F\+A\+I\+L\+\_\+\+T\+E\+S\+T\+V\+E\+C\+T\+OR, C\+R\+Y\+P\+T\+\_\+\+N\+OP, C\+R\+Y\+P\+T\+\_\+\+OK, sober128\+\_\+add\+\_\+entropy(), sober128\+\_\+done(), sober128\+\_\+export(), sober128\+\_\+import(), sober128\+\_\+read(), sober128\+\_\+ready(), sober128\+\_\+start(), t1, t2, and t3.

Here is the call graph for this function\+:
% FIG 14


\subsection{Variable Documentation}
\mbox{\Hypertarget{sober128_8c_acf82d6da430aca8ad53806c4a90a8fff}\label{sober128_8c_acf82d6da430aca8ad53806c4a90a8fff}} 
\index{sober128.c@{sober128.c}!sober128\_desc@{sober128\_desc}}
\index{sober128\_desc@{sober128\_desc}!sober128.c@{sober128.c}}
\subsubsection{\texorpdfstring{sober128\_desc}{sober128\_desc}}
{\footnotesize\ttfamily const struct \mbox{\hyperlink{structltc__prng__descriptor}{ltc\+\_\+prng\+\_\+descriptor}} sober128\+\_\+desc}

{\bfseries Initial value\+:}
\begin{DoxyCode}{0}
\DoxyCodeLine{=}
\DoxyCodeLine{\{}
\DoxyCodeLine{   \textcolor{stringliteral}{"sober128"},}
\DoxyCodeLine{   40,}
\DoxyCodeLine{   \&\mbox{\hyperlink{sober128_8c_a2e4935bebf15395ce088dd74a6d03114}{sober128\_start}},}
\DoxyCodeLine{   \&\mbox{\hyperlink{sober128_8c_a477d801a7eb2e66db6c4c3d7f2db3827}{sober128\_add\_entropy}},}
\DoxyCodeLine{   \&\mbox{\hyperlink{sober128_8c_a61687a8a822a53f6bc48a79b40f48e04}{sober128\_ready}},}
\DoxyCodeLine{   \&\mbox{\hyperlink{sober128_8c_a8e7604858301441d7c791a5e86b03025}{sober128\_read}},}
\DoxyCodeLine{   \&\mbox{\hyperlink{sober128_8c_a3cfcf62a0dfb3a105430d3a0c753605f}{sober128\_done}},}
\DoxyCodeLine{   \&\mbox{\hyperlink{sober128_8c_a0b6df9499cc20809546e86dc659e033a}{sober128\_export}},}
\DoxyCodeLine{   \&\mbox{\hyperlink{sober128_8c_abd0bdcc3d2a0436f74ab10b0c68fcbca}{sober128\_import}},}
\DoxyCodeLine{   \&\mbox{\hyperlink{sober128_8c_ae89334392b56e0cb75d493a5bdba60b7}{sober128\_test}}}
\DoxyCodeLine{\}}

\end{DoxyCode}


Definition at line 20 of file sober128.\+c.



Referenced by register\+\_\+all\+\_\+prngs(), and sober128\+\_\+import().

