\hypertarget{ecc__set__curve__internal_8c}{}\section{M\+:/\+Office/!\+Doutorado/0. Repositorio\+S\+V\+N/\+H\+A\+M\+S\+T\+E\+R\+\_\+\+Prototype/branches/\+J\+I\+N\+T2018/include/libtomcrypt-\/develop/src/pk/ecc/ecc\+\_\+set\+\_\+curve\+\_\+internal.c File Reference}
\label{ecc__set__curve__internal_8c}\index{M:/Office/"!Doutorado/0. RepositorioSVN/HAMSTER\_Prototype/branches/JINT2018/include/libtomcrypt-\/develop/src/pk/ecc/ecc\_set\_curve\_internal.c@{M:/Office/"!Doutorado/0. RepositorioSVN/HAMSTER\_Prototype/branches/JINT2018/include/libtomcrypt-\/develop/src/pk/ecc/ecc\_set\_curve\_internal.c}}
{\ttfamily \#include \char`\"{}tomcrypt\+\_\+private.\+h\char`\"{}}\newline
Include dependency graph for ecc\+\_\+set\+\_\+curve\+\_\+internal.\+c\+:
% FIG 0
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
static int \mbox{\hyperlink{ecc__set__curve__internal_8c_a40d2c68ba7bf62f5ad1b7395b21979df}{\+\_\+ecc\+\_\+cmp\+\_\+hex\+\_\+bn}} (const char $\ast$left\+\_\+hex, void $\ast$right\+\_\+bn, void $\ast$tmp\+\_\+bn)
\item 
static void \mbox{\hyperlink{ecc__set__curve__internal_8c_a3d657756a1e38d4f275973a9a0f98fd1}{\+\_\+ecc\+\_\+oid\+\_\+lookup}} (ecc\+\_\+key $\ast$key)
\item 
int \mbox{\hyperlink{ecc__set__curve__internal_8c_aa65ad9426232274db6f50ae2ba05a600}{ecc\+\_\+copy\+\_\+curve}} (const ecc\+\_\+key $\ast$srckey, ecc\+\_\+key $\ast$key)
\item 
int \mbox{\hyperlink{ecc__set__curve__internal_8c_a5058c67d67d65a00c30b08ee3c0149f1}{ecc\+\_\+set\+\_\+curve\+\_\+from\+\_\+mpis}} (void $\ast$a, void $\ast$b, void $\ast$prime, void $\ast$order, void $\ast$gx, void $\ast$gy, unsigned long cofactor, ecc\+\_\+key $\ast$key)
\end{DoxyCompactItemize}


\subsection{Function Documentation}
\mbox{\Hypertarget{ecc__set__curve__internal_8c_a40d2c68ba7bf62f5ad1b7395b21979df}\label{ecc__set__curve__internal_8c_a40d2c68ba7bf62f5ad1b7395b21979df}} 
\index{ecc\_set\_curve\_internal.c@{ecc\_set\_curve\_internal.c}!\_ecc\_cmp\_hex\_bn@{\_ecc\_cmp\_hex\_bn}}
\index{\_ecc\_cmp\_hex\_bn@{\_ecc\_cmp\_hex\_bn}!ecc\_set\_curve\_internal.c@{ecc\_set\_curve\_internal.c}}
\subsubsection{\texorpdfstring{\_ecc\_cmp\_hex\_bn()}{\_ecc\_cmp\_hex\_bn()}}
{\footnotesize\ttfamily static int \+\_\+ecc\+\_\+cmp\+\_\+hex\+\_\+bn (\begin{DoxyParamCaption}\item[{const char $\ast$}]{left\+\_\+hex,  }\item[{void $\ast$}]{right\+\_\+bn,  }\item[{void $\ast$}]{tmp\+\_\+bn }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}



Definition at line 14 of file ecc\+\_\+set\+\_\+curve\+\_\+internal.\+c.


\begin{DoxyCode}{0}
\DoxyCodeLine{15 \{}
\DoxyCodeLine{16    \textcolor{keywordflow}{if} (\mbox{\hyperlink{tomcrypt__private_8h_a12263d4d7da068c2a630d2ffc0c8bc1b}{mp\_read\_radix}}(tmp\_bn, left\_hex, 16) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}}) \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{17    \textcolor{keywordflow}{if} (\mbox{\hyperlink{tomcrypt__private_8h_a62ea02fbe7dd2d456e49520264d775ee}{mp\_cmp}}(tmp\_bn, right\_bn) != \mbox{\hyperlink{tomcrypt__math_8h_a035a31bde4f31419eb259e36e5776607}{LTC\_MP\_EQ}})           \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{18    \textcolor{keywordflow}{return} 1;}
\DoxyCodeLine{19 \}}

\end{DoxyCode}


References C\+R\+Y\+P\+T\+\_\+\+OK, L\+T\+C\+\_\+\+M\+P\+\_\+\+EQ, mp\+\_\+cmp, and mp\+\_\+read\+\_\+radix.



Referenced by \+\_\+ecc\+\_\+oid\+\_\+lookup().

Here is the caller graph for this function\+:
% FIG 1
\mbox{\Hypertarget{ecc__set__curve__internal_8c_a3d657756a1e38d4f275973a9a0f98fd1}\label{ecc__set__curve__internal_8c_a3d657756a1e38d4f275973a9a0f98fd1}} 
\index{ecc\_set\_curve\_internal.c@{ecc\_set\_curve\_internal.c}!\_ecc\_oid\_lookup@{\_ecc\_oid\_lookup}}
\index{\_ecc\_oid\_lookup@{\_ecc\_oid\_lookup}!ecc\_set\_curve\_internal.c@{ecc\_set\_curve\_internal.c}}
\subsubsection{\texorpdfstring{\_ecc\_oid\_lookup()}{\_ecc\_oid\_lookup()}}
{\footnotesize\ttfamily static void \+\_\+ecc\+\_\+oid\+\_\+lookup (\begin{DoxyParamCaption}\item[{ecc\+\_\+key $\ast$}]{key }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}



Definition at line 21 of file ecc\+\_\+set\+\_\+curve\+\_\+internal.\+c.


\begin{DoxyCode}{0}
\DoxyCodeLine{22 \{}
\DoxyCodeLine{23    \textcolor{keywordtype}{void} *bn;}
\DoxyCodeLine{24    \textcolor{keyword}{const} ltc\_ecc\_curve *curve;}
\DoxyCodeLine{25 }
\DoxyCodeLine{26    key->dp.oidlen = 0;}
\DoxyCodeLine{27    \textcolor{keywordflow}{if} (\mbox{\hyperlink{tomcrypt__private_8h_aff03c4f22c68d651747055048c509cf3}{mp\_init}}(\&bn) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}}) \textcolor{keywordflow}{return};}
\DoxyCodeLine{28    \textcolor{keywordflow}{for} (curve = \mbox{\hyperlink{ecc_8c_a1cbb8387a24ed5042ad1e00db59082cb}{ltc\_ecc\_curves}}; curve->prime != NULL; curve++) \{}
\DoxyCodeLine{29       \textcolor{keywordflow}{if} (\mbox{\hyperlink{ecc__set__curve__internal_8c_a40d2c68ba7bf62f5ad1b7395b21979df}{\_ecc\_cmp\_hex\_bn}}(curve->prime, key->dp.prime,  bn) != 1) \textcolor{keywordflow}{continue};}
\DoxyCodeLine{30       \textcolor{keywordflow}{if} (\mbox{\hyperlink{ecc__set__curve__internal_8c_a40d2c68ba7bf62f5ad1b7395b21979df}{\_ecc\_cmp\_hex\_bn}}(curve->order, key->dp.order,  bn) != 1) \textcolor{keywordflow}{continue};}
\DoxyCodeLine{31       \textcolor{keywordflow}{if} (\mbox{\hyperlink{ecc__set__curve__internal_8c_a40d2c68ba7bf62f5ad1b7395b21979df}{\_ecc\_cmp\_hex\_bn}}(curve->A,     key->dp.A,      bn) != 1) \textcolor{keywordflow}{continue};}
\DoxyCodeLine{32       \textcolor{keywordflow}{if} (\mbox{\hyperlink{ecc__set__curve__internal_8c_a40d2c68ba7bf62f5ad1b7395b21979df}{\_ecc\_cmp\_hex\_bn}}(curve->B,     key->dp.B,      bn) != 1) \textcolor{keywordflow}{continue};}
\DoxyCodeLine{33       \textcolor{keywordflow}{if} (\mbox{\hyperlink{ecc__set__curve__internal_8c_a40d2c68ba7bf62f5ad1b7395b21979df}{\_ecc\_cmp\_hex\_bn}}(curve->Gx,    key->dp.base.x, bn) != 1) \textcolor{keywordflow}{continue};}
\DoxyCodeLine{34       \textcolor{keywordflow}{if} (\mbox{\hyperlink{ecc__set__curve__internal_8c_a40d2c68ba7bf62f5ad1b7395b21979df}{\_ecc\_cmp\_hex\_bn}}(curve->Gy,    key->dp.base.y, bn) != 1) \textcolor{keywordflow}{continue};}
\DoxyCodeLine{35       \textcolor{keywordflow}{if} (key->dp.cofactor != curve->cofactor)                    \textcolor{keywordflow}{continue};}
\DoxyCodeLine{36       \textcolor{keywordflow}{break}; \textcolor{comment}{/* found */}}
\DoxyCodeLine{37    \}}
\DoxyCodeLine{38    \mbox{\hyperlink{tomcrypt__private_8h_ab05b6b59fa182b81f5f990d5621229f6}{mp\_clear}}(bn);}
\DoxyCodeLine{39    \textcolor{keywordflow}{if} (curve->prime \&\& curve->OID) \{}
\DoxyCodeLine{40       key->dp.oidlen = 16; \textcolor{comment}{/* size of key->dp.oid */}}
\DoxyCodeLine{41       \mbox{\hyperlink{tomcrypt__private_8h_ad99c87d19f50f703708d36a931fe5df6}{pk\_oid\_str\_to\_num}}(curve->OID, key->dp.oid, \&key->dp.oidlen);}
\DoxyCodeLine{42    \}}
\DoxyCodeLine{43 \}}

\end{DoxyCode}


References \+\_\+ecc\+\_\+cmp\+\_\+hex\+\_\+bn(), C\+R\+Y\+P\+T\+\_\+\+OK, ltc\+\_\+ecc\+\_\+curves, mp\+\_\+clear, mp\+\_\+init, and pk\+\_\+oid\+\_\+str\+\_\+to\+\_\+num().



Referenced by ecc\+\_\+copy\+\_\+curve(), and ecc\+\_\+set\+\_\+curve\+\_\+from\+\_\+mpis().

Here is the call graph for this function\+:
% FIG 2
Here is the caller graph for this function\+:
% FIG 3
\mbox{\Hypertarget{ecc__set__curve__internal_8c_aa65ad9426232274db6f50ae2ba05a600}\label{ecc__set__curve__internal_8c_aa65ad9426232274db6f50ae2ba05a600}} 
\index{ecc\_set\_curve\_internal.c@{ecc\_set\_curve\_internal.c}!ecc\_copy\_curve@{ecc\_copy\_curve}}
\index{ecc\_copy\_curve@{ecc\_copy\_curve}!ecc\_set\_curve\_internal.c@{ecc\_set\_curve\_internal.c}}
\subsubsection{\texorpdfstring{ecc\_copy\_curve()}{ecc\_copy\_curve()}}
{\footnotesize\ttfamily int ecc\+\_\+copy\+\_\+curve (\begin{DoxyParamCaption}\item[{const ecc\+\_\+key $\ast$}]{srckey,  }\item[{ecc\+\_\+key $\ast$}]{key }\end{DoxyParamCaption})}



Definition at line 45 of file ecc\+\_\+set\+\_\+curve\+\_\+internal.\+c.


\begin{DoxyCode}{0}
\DoxyCodeLine{46 \{}
\DoxyCodeLine{47    \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} i;}
\DoxyCodeLine{48    \textcolor{keywordtype}{int} err;}
\DoxyCodeLine{49 }
\DoxyCodeLine{50    \mbox{\hyperlink{tomcrypt__argchk_8h_a683da3e041e49f196318b6ea951414ba}{LTC\_ARGCHK}}(key != NULL);}
\DoxyCodeLine{51    \mbox{\hyperlink{tomcrypt__argchk_8h_a683da3e041e49f196318b6ea951414ba}{LTC\_ARGCHK}}(srckey != NULL);}
\DoxyCodeLine{52 }
\DoxyCodeLine{53    \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{tomcrypt__private_8h_adb6322247b1a4f0347219acab3120bd3}{mp\_init\_multi}}(\&key->dp.prime, \&key->dp.order, \&key->dp.A, \&key->dp.B,}
\DoxyCodeLine{54                             \&key->dp.base.x, \&key->dp.base.y, \&key->dp.base.z,}
\DoxyCodeLine{55                             \&key->pubkey.x, \&key->pubkey.y, \&key->pubkey.z, \&key->k,}
\DoxyCodeLine{56                             NULL)) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}}) \{}
\DoxyCodeLine{57       \textcolor{keywordflow}{return} err;}
\DoxyCodeLine{58    \}}
\DoxyCodeLine{59 }
\DoxyCodeLine{60    \textcolor{comment}{/* A, B, order, prime, Gx, Gy */}}
\DoxyCodeLine{61    \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{tomcrypt__private_8h_afbb35bc8f920448d169ddc83a4308840}{mp\_copy}}(srckey->dp.prime,  key->dp.prime )) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}}) \{ \textcolor{keywordflow}{goto} error; \}}
\DoxyCodeLine{62    \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{tomcrypt__private_8h_afbb35bc8f920448d169ddc83a4308840}{mp\_copy}}(srckey->dp.order,  key->dp.order )) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}}) \{ \textcolor{keywordflow}{goto} error; \}}
\DoxyCodeLine{63    \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{tomcrypt__private_8h_afbb35bc8f920448d169ddc83a4308840}{mp\_copy}}(srckey->dp.A,      key->dp.A     )) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}}) \{ \textcolor{keywordflow}{goto} error; \}}
\DoxyCodeLine{64    \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{tomcrypt__private_8h_afbb35bc8f920448d169ddc83a4308840}{mp\_copy}}(srckey->dp.B,      key->dp.B     )) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}}) \{ \textcolor{keywordflow}{goto} error; \}}
\DoxyCodeLine{65    \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{tomcrypt__private_8h_a4b36b54e30a0a87aff57a936b386df7f}{ltc\_ecc\_copy\_point}}(\&srckey->dp.base, \&key->dp.base)) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}}) \{ \textcolor{keywordflow}{goto} error; \}}
\DoxyCodeLine{66    \textcolor{comment}{/* cofactor \& size */}}
\DoxyCodeLine{67    key->dp.cofactor = srckey->dp.cofactor;}
\DoxyCodeLine{68    key->dp.size     = srckey->dp.size;}
\DoxyCodeLine{69    \textcolor{comment}{/* OID */}}
\DoxyCodeLine{70    \textcolor{keywordflow}{if} (srckey->dp.oidlen > 0) \{}
\DoxyCodeLine{71      key->dp.oidlen = srckey->dp.oidlen;}
\DoxyCodeLine{72      \textcolor{keywordflow}{for} (i = 0; i < key->dp.oidlen; i++) key->dp.oid[i] = srckey->dp.oid[i];}
\DoxyCodeLine{73    \}}
\DoxyCodeLine{74    \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{75      \mbox{\hyperlink{ecc__set__curve__internal_8c_a3d657756a1e38d4f275973a9a0f98fd1}{\_ecc\_oid\_lookup}}(key); \textcolor{comment}{/* try to find OID in ltc\_ecc\_curves */}}
\DoxyCodeLine{76    \}}
\DoxyCodeLine{77    \textcolor{comment}{/* success */}}
\DoxyCodeLine{78    \textcolor{keywordflow}{return} \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}};}
\DoxyCodeLine{79 }
\DoxyCodeLine{80 error:}
\DoxyCodeLine{81    \mbox{\hyperlink{ecc__free_8c_a73cd81ea7d3b24f2d9ef309c4b22e3b7}{ecc\_free}}(key);}
\DoxyCodeLine{82    \textcolor{keywordflow}{return} err;}
\DoxyCodeLine{83 \}}

\end{DoxyCode}


References \+\_\+ecc\+\_\+oid\+\_\+lookup(), C\+R\+Y\+P\+T\+\_\+\+OK, ecc\+\_\+free(), L\+T\+C\+\_\+\+A\+R\+G\+C\+HK, ltc\+\_\+ecc\+\_\+copy\+\_\+point(), mp\+\_\+copy, and mp\+\_\+init\+\_\+multi.



Referenced by ecc\+\_\+decrypt\+\_\+key(), ecc\+\_\+encrypt\+\_\+key(), and ecc\+\_\+sign\+\_\+hash\+\_\+ex().

Here is the call graph for this function\+:
% FIG 4
Here is the caller graph for this function\+:
% FIG 5
\mbox{\Hypertarget{ecc__set__curve__internal_8c_a5058c67d67d65a00c30b08ee3c0149f1}\label{ecc__set__curve__internal_8c_a5058c67d67d65a00c30b08ee3c0149f1}} 
\index{ecc\_set\_curve\_internal.c@{ecc\_set\_curve\_internal.c}!ecc\_set\_curve\_from\_mpis@{ecc\_set\_curve\_from\_mpis}}
\index{ecc\_set\_curve\_from\_mpis@{ecc\_set\_curve\_from\_mpis}!ecc\_set\_curve\_internal.c@{ecc\_set\_curve\_internal.c}}
\subsubsection{\texorpdfstring{ecc\_set\_curve\_from\_mpis()}{ecc\_set\_curve\_from\_mpis()}}
{\footnotesize\ttfamily int ecc\+\_\+set\+\_\+curve\+\_\+from\+\_\+mpis (\begin{DoxyParamCaption}\item[{void $\ast$}]{a,  }\item[{void $\ast$}]{b,  }\item[{void $\ast$}]{prime,  }\item[{void $\ast$}]{order,  }\item[{void $\ast$}]{gx,  }\item[{void $\ast$}]{gy,  }\item[{unsigned long}]{cofactor,  }\item[{ecc\+\_\+key $\ast$}]{key }\end{DoxyParamCaption})}



Definition at line 85 of file ecc\+\_\+set\+\_\+curve\+\_\+internal.\+c.


\begin{DoxyCode}{0}
\DoxyCodeLine{86 \{}
\DoxyCodeLine{87    \textcolor{keywordtype}{int} err;}
\DoxyCodeLine{88 }
\DoxyCodeLine{89    \mbox{\hyperlink{tomcrypt__argchk_8h_a683da3e041e49f196318b6ea951414ba}{LTC\_ARGCHK}}(key   != NULL);}
\DoxyCodeLine{90    \mbox{\hyperlink{tomcrypt__argchk_8h_a683da3e041e49f196318b6ea951414ba}{LTC\_ARGCHK}}(a     != NULL);}
\DoxyCodeLine{91    \mbox{\hyperlink{tomcrypt__argchk_8h_a683da3e041e49f196318b6ea951414ba}{LTC\_ARGCHK}}(b     != NULL);}
\DoxyCodeLine{92    \mbox{\hyperlink{tomcrypt__argchk_8h_a683da3e041e49f196318b6ea951414ba}{LTC\_ARGCHK}}(prime != NULL);}
\DoxyCodeLine{93    \mbox{\hyperlink{tomcrypt__argchk_8h_a683da3e041e49f196318b6ea951414ba}{LTC\_ARGCHK}}(order != NULL);}
\DoxyCodeLine{94    \mbox{\hyperlink{tomcrypt__argchk_8h_a683da3e041e49f196318b6ea951414ba}{LTC\_ARGCHK}}(gx    != NULL);}
\DoxyCodeLine{95    \mbox{\hyperlink{tomcrypt__argchk_8h_a683da3e041e49f196318b6ea951414ba}{LTC\_ARGCHK}}(gy    != NULL);}
\DoxyCodeLine{96 }
\DoxyCodeLine{97    \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{tomcrypt__private_8h_adb6322247b1a4f0347219acab3120bd3}{mp\_init\_multi}}(\&key->dp.prime, \&key->dp.order, \&key->dp.A, \&key->dp.B,}
\DoxyCodeLine{98                             \&key->dp.base.x, \&key->dp.base.y, \&key->dp.base.z,}
\DoxyCodeLine{99                             \&key->pubkey.x, \&key->pubkey.y, \&key->pubkey.z, \&key->k,}
\DoxyCodeLine{100                             NULL)) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}}) \{}
\DoxyCodeLine{101       \textcolor{keywordflow}{return} err;}
\DoxyCodeLine{102    \}}
\DoxyCodeLine{103 }
\DoxyCodeLine{104    \textcolor{comment}{/* A, B, order, prime, Gx, Gy */}}
\DoxyCodeLine{105    \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{tomcrypt__private_8h_afbb35bc8f920448d169ddc83a4308840}{mp\_copy}}(prime, key->dp.prime )) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}}) \{ \textcolor{keywordflow}{goto} error; \}}
\DoxyCodeLine{106    \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{tomcrypt__private_8h_afbb35bc8f920448d169ddc83a4308840}{mp\_copy}}(order, key->dp.order )) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}}) \{ \textcolor{keywordflow}{goto} error; \}}
\DoxyCodeLine{107    \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{tomcrypt__private_8h_afbb35bc8f920448d169ddc83a4308840}{mp\_copy}}(a,     key->dp.A     )) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}}) \{ \textcolor{keywordflow}{goto} error; \}}
\DoxyCodeLine{108    \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{tomcrypt__private_8h_afbb35bc8f920448d169ddc83a4308840}{mp\_copy}}(b,     key->dp.B     )) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}}) \{ \textcolor{keywordflow}{goto} error; \}}
\DoxyCodeLine{109    \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{tomcrypt__private_8h_afbb35bc8f920448d169ddc83a4308840}{mp\_copy}}(gx,    key->dp.base.x)) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}}) \{ \textcolor{keywordflow}{goto} error; \}}
\DoxyCodeLine{110    \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{tomcrypt__private_8h_afbb35bc8f920448d169ddc83a4308840}{mp\_copy}}(gy,    key->dp.base.y)) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}}) \{ \textcolor{keywordflow}{goto} error; \}}
\DoxyCodeLine{111    \textcolor{keywordflow}{if} ((err = \mbox{\hyperlink{tomcrypt__private_8h_a000b0542ef4ecf639ff69895490fdb8f}{mp\_set}}(key->dp.base.z, 1)) != \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}})      \{ \textcolor{keywordflow}{goto} error; \}}
\DoxyCodeLine{112    \textcolor{comment}{/* cofactor \& size */}}
\DoxyCodeLine{113    key->dp.cofactor = cofactor;}
\DoxyCodeLine{114    key->dp.size = \mbox{\hyperlink{tomcrypt__private_8h_ad301148bb24f43a8c7003a6976dfaa5a}{mp\_unsigned\_bin\_size}}(prime);}
\DoxyCodeLine{115    \textcolor{comment}{/* try to find OID in ltc\_ecc\_curves */}}
\DoxyCodeLine{116    \mbox{\hyperlink{ecc__set__curve__internal_8c_a3d657756a1e38d4f275973a9a0f98fd1}{\_ecc\_oid\_lookup}}(key);}
\DoxyCodeLine{117    \textcolor{comment}{/* success */}}
\DoxyCodeLine{118    \textcolor{keywordflow}{return} \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cad0f4c9daf749fe6284266f9384b9e334}{CRYPT\_OK}};}
\DoxyCodeLine{119 }
\DoxyCodeLine{120 error:}
\DoxyCodeLine{121    \mbox{\hyperlink{ecc__free_8c_a73cd81ea7d3b24f2d9ef309c4b22e3b7}{ecc\_free}}(key);}
\DoxyCodeLine{122    \textcolor{keywordflow}{return} err;}
\DoxyCodeLine{123 \}}

\end{DoxyCode}


References \+\_\+ecc\+\_\+oid\+\_\+lookup(), C\+R\+Y\+P\+T\+\_\+\+OK, ecc\+\_\+free(), L\+T\+C\+\_\+\+A\+R\+G\+C\+HK, mp\+\_\+copy, mp\+\_\+init\+\_\+multi, mp\+\_\+set, and mp\+\_\+unsigned\+\_\+bin\+\_\+size.



Referenced by \+\_\+ecc\+\_\+import\+\_\+private\+\_\+with\+\_\+curve(), \+\_\+ecc\+\_\+import\+\_\+x509\+\_\+with\+\_\+curve(), and ecc\+\_\+import\+\_\+pkcs8().

Here is the call graph for this function\+:
% FIG 6
Here is the caller graph for this function\+:
% FIG 7
