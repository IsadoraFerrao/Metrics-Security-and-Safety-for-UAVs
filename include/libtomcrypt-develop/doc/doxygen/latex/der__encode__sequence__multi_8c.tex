\hypertarget{der__encode__sequence__multi_8c}{}\section{M\+:/\+Office/!\+Doutorado/0. Repositorio\+S\+V\+N/\+H\+A\+M\+S\+T\+E\+R\+\_\+\+Prototype/branches/\+J\+I\+N\+T2018/include/libtomcrypt-\/develop/src/pk/asn1/der/sequence/der\+\_\+encode\+\_\+sequence\+\_\+multi.c File Reference}
\label{der__encode__sequence__multi_8c}\index{M:/Office/"!Doutorado/0. RepositorioSVN/HAMSTER\_Prototype/branches/JINT2018/include/libtomcrypt-\/develop/src/pk/asn1/der/sequence/der\_encode\_sequence\_multi.c@{M:/Office/"!Doutorado/0. RepositorioSVN/HAMSTER\_Prototype/branches/JINT2018/include/libtomcrypt-\/develop/src/pk/asn1/der/sequence/der\_encode\_sequence\_multi.c}}


A\+S\+N.\+1 D\+ER, encode a S\+E\+Q\+U\+E\+N\+CE, Tom St Denis.  


{\ttfamily \#include \char`\"{}tomcrypt\+\_\+private.\+h\char`\"{}}\newline
{\ttfamily \#include $<$stdarg.\+h$>$}\newline
Include dependency graph for der\+\_\+encode\+\_\+sequence\+\_\+multi.\+c\+:
% FIG 0
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
int \mbox{\hyperlink{der__encode__sequence__multi_8c_a1a5a69543a5c89f81560b52d6f11b8c5}{der\+\_\+encode\+\_\+sequence\+\_\+multi}} (unsigned char $\ast$out, unsigned long $\ast$outlen,...)
\begin{DoxyCompactList}\small\item\em Encode a S\+E\+Q\+U\+E\+N\+CE type using a VA list. \end{DoxyCompactList}\end{DoxyCompactItemize}


\subsection{Detailed Description}
A\+S\+N.\+1 D\+ER, encode a S\+E\+Q\+U\+E\+N\+CE, Tom St Denis. 



\subsection{Function Documentation}
\mbox{\Hypertarget{der__encode__sequence__multi_8c_a1a5a69543a5c89f81560b52d6f11b8c5}\label{der__encode__sequence__multi_8c_a1a5a69543a5c89f81560b52d6f11b8c5}} 
\index{der\_encode\_sequence\_multi.c@{der\_encode\_sequence\_multi.c}!der\_encode\_sequence\_multi@{der\_encode\_sequence\_multi}}
\index{der\_encode\_sequence\_multi@{der\_encode\_sequence\_multi}!der\_encode\_sequence\_multi.c@{der\_encode\_sequence\_multi.c}}
\subsubsection{\texorpdfstring{der\_encode\_sequence\_multi()}{der\_encode\_sequence\_multi()}}
{\footnotesize\ttfamily int der\+\_\+encode\+\_\+sequence\+\_\+multi (\begin{DoxyParamCaption}\item[{unsigned char $\ast$}]{out,  }\item[{unsigned long $\ast$}]{outlen,  }\item[{}]{... }\end{DoxyParamCaption})}



Encode a S\+E\+Q\+U\+E\+N\+CE type using a VA list. 


\begin{DoxyParams}{Parameters}
{\em out} & \mbox{[}out\mbox{]} Destination for data \\
\hline
{\em outlen} & \mbox{[}in/out\mbox{]} Length of buffer and resulting length of output \\
\hline
\end{DoxyParams}
\begin{DoxyRemark}{Remarks}
$<$...$>$ is of the form $<$type, size, data$>$ (int, unsigned long, void$\ast$) 
\end{DoxyRemark}
\begin{DoxyReturn}{Returns}
C\+R\+Y\+P\+T\+\_\+\+OK on success 
\end{DoxyReturn}


Definition at line 27 of file der\+\_\+encode\+\_\+sequence\+\_\+multi.\+c.


\begin{DoxyCode}{0}
\DoxyCodeLine{28 \{}
\DoxyCodeLine{29    \textcolor{keywordtype}{int}           err;}
\DoxyCodeLine{30    ltc\_asn1\_type type;}
\DoxyCodeLine{31    \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} size, x;}
\DoxyCodeLine{32    \textcolor{keywordtype}{void}          *data;}
\DoxyCodeLine{33    va\_list       args;}
\DoxyCodeLine{34    ltc\_asn1\_list *list;}
\DoxyCodeLine{35 }
\DoxyCodeLine{36    \mbox{\hyperlink{tomcrypt__argchk_8h_a683da3e041e49f196318b6ea951414ba}{LTC\_ARGCHK}}(out    != NULL);}
\DoxyCodeLine{37    \mbox{\hyperlink{tomcrypt__argchk_8h_a683da3e041e49f196318b6ea951414ba}{LTC\_ARGCHK}}(outlen != NULL);}
\DoxyCodeLine{38 }
\DoxyCodeLine{39    \textcolor{comment}{/* get size of output that will be required */}}
\DoxyCodeLine{40    va\_start(args, outlen);}
\DoxyCodeLine{41    x = 0;}
\DoxyCodeLine{42    \textcolor{keywordflow}{for} (;;) \{}
\DoxyCodeLine{43        type = (ltc\_asn1\_type)va\_arg(args, \textcolor{keywordtype}{int});}
\DoxyCodeLine{44        size = va\_arg(args, \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long});}
\DoxyCodeLine{45        data = va\_arg(args, \textcolor{keywordtype}{void}*);}
\DoxyCodeLine{46        \mbox{\hyperlink{tomcrypt__macros_8h_accde4b007facd646a8327f8e64b2d1e0}{LTC\_UNUSED\_PARAM}}(size);}
\DoxyCodeLine{47        \mbox{\hyperlink{tomcrypt__macros_8h_accde4b007facd646a8327f8e64b2d1e0}{LTC\_UNUSED\_PARAM}}(data);}
\DoxyCodeLine{48 }
\DoxyCodeLine{49        \textcolor{keywordflow}{if} (type == LTC\_ASN1\_EOL) \{}
\DoxyCodeLine{50           \textcolor{keywordflow}{break};}
\DoxyCodeLine{51        \}}
\DoxyCodeLine{52 }
\DoxyCodeLine{53        \textcolor{keywordflow}{switch} (type) \{}
\DoxyCodeLine{54            \textcolor{keywordflow}{case} LTC\_ASN1\_BOOLEAN:}
\DoxyCodeLine{55            \textcolor{keywordflow}{case} LTC\_ASN1\_INTEGER:}
\DoxyCodeLine{56            \textcolor{keywordflow}{case} LTC\_ASN1\_SHORT\_INTEGER:}
\DoxyCodeLine{57            \textcolor{keywordflow}{case} LTC\_ASN1\_BIT\_STRING:}
\DoxyCodeLine{58            \textcolor{keywordflow}{case} LTC\_ASN1\_OCTET\_STRING:}
\DoxyCodeLine{59            \textcolor{keywordflow}{case} LTC\_ASN1\_NULL:}
\DoxyCodeLine{60            \textcolor{keywordflow}{case} LTC\_ASN1\_OBJECT\_IDENTIFIER:}
\DoxyCodeLine{61            \textcolor{keywordflow}{case} LTC\_ASN1\_IA5\_STRING:}
\DoxyCodeLine{62            \textcolor{keywordflow}{case} LTC\_ASN1\_PRINTABLE\_STRING:}
\DoxyCodeLine{63            \textcolor{keywordflow}{case} LTC\_ASN1\_UTF8\_STRING:}
\DoxyCodeLine{64            \textcolor{keywordflow}{case} LTC\_ASN1\_UTCTIME:}
\DoxyCodeLine{65            \textcolor{keywordflow}{case} LTC\_ASN1\_SEQUENCE:}
\DoxyCodeLine{66            \textcolor{keywordflow}{case} LTC\_ASN1\_SET:}
\DoxyCodeLine{67            \textcolor{keywordflow}{case} LTC\_ASN1\_SETOF:}
\DoxyCodeLine{68            \textcolor{keywordflow}{case} LTC\_ASN1\_RAW\_BIT\_STRING:}
\DoxyCodeLine{69            \textcolor{keywordflow}{case} LTC\_ASN1\_GENERALIZEDTIME:}
\DoxyCodeLine{70                 ++x;}
\DoxyCodeLine{71                 \textcolor{keywordflow}{break};}
\DoxyCodeLine{72 }
\DoxyCodeLine{73            \textcolor{keywordflow}{case} LTC\_ASN1\_CHOICE:}
\DoxyCodeLine{74            \textcolor{keywordflow}{case} LTC\_ASN1\_CUSTOM\_TYPE:}
\DoxyCodeLine{75            \textcolor{keywordflow}{case} LTC\_ASN1\_EOL:}
\DoxyCodeLine{76            \textcolor{keywordflow}{case} LTC\_ASN1\_TELETEX\_STRING:}
\DoxyCodeLine{77                va\_end(args);}
\DoxyCodeLine{78                \textcolor{keywordflow}{return} \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06ca92aa8bad3930f08d5a188bf72094b066}{CRYPT\_INVALID\_ARG}};}
\DoxyCodeLine{79        \}}
\DoxyCodeLine{80    \}}
\DoxyCodeLine{81    va\_end(args);}
\DoxyCodeLine{82 }
\DoxyCodeLine{83    \textcolor{comment}{/* allocate structure for x elements */}}
\DoxyCodeLine{84    \textcolor{keywordflow}{if} (x == 0) \{}
\DoxyCodeLine{85       \textcolor{keywordflow}{return} \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06cac43a7799c7fd5f515172da6cfc0f9cf5}{CRYPT\_NOP}};}
\DoxyCodeLine{86    \}}
\DoxyCodeLine{87 }
\DoxyCodeLine{88    list = \mbox{\hyperlink{tomcrypt__cfg_8h_a151dda14cd7acae31eaf1102b0cc0685}{XCALLOC}}(\textcolor{keyword}{sizeof}(*list), x);}
\DoxyCodeLine{89    \textcolor{keywordflow}{if} (list == NULL) \{}
\DoxyCodeLine{90       \textcolor{keywordflow}{return} \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06ca0ce0d27adc7ea10b74b7ea904b8bfa82}{CRYPT\_MEM}};}
\DoxyCodeLine{91    \}}
\DoxyCodeLine{92 }
\DoxyCodeLine{93    \textcolor{comment}{/* fill in the structure */}}
\DoxyCodeLine{94    va\_start(args, outlen);}
\DoxyCodeLine{95    x = 0;}
\DoxyCodeLine{96    \textcolor{keywordflow}{for} (;;) \{}
\DoxyCodeLine{97        type = (ltc\_asn1\_type)va\_arg(args, \textcolor{keywordtype}{int});}
\DoxyCodeLine{98        size = va\_arg(args, \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long});}
\DoxyCodeLine{99        data = va\_arg(args, \textcolor{keywordtype}{void}*);}
\DoxyCodeLine{100 }
\DoxyCodeLine{101        \textcolor{keywordflow}{if} (type == LTC\_ASN1\_EOL) \{}
\DoxyCodeLine{102           \textcolor{keywordflow}{break};}
\DoxyCodeLine{103        \}}
\DoxyCodeLine{104 }
\DoxyCodeLine{105        \textcolor{keywordflow}{switch} (type) \{}
\DoxyCodeLine{106            \textcolor{keywordflow}{case} LTC\_ASN1\_BOOLEAN:}
\DoxyCodeLine{107            \textcolor{keywordflow}{case} LTC\_ASN1\_INTEGER:}
\DoxyCodeLine{108            \textcolor{keywordflow}{case} LTC\_ASN1\_SHORT\_INTEGER:}
\DoxyCodeLine{109            \textcolor{keywordflow}{case} LTC\_ASN1\_BIT\_STRING:}
\DoxyCodeLine{110            \textcolor{keywordflow}{case} LTC\_ASN1\_OCTET\_STRING:}
\DoxyCodeLine{111            \textcolor{keywordflow}{case} LTC\_ASN1\_NULL:}
\DoxyCodeLine{112            \textcolor{keywordflow}{case} LTC\_ASN1\_OBJECT\_IDENTIFIER:}
\DoxyCodeLine{113            \textcolor{keywordflow}{case} LTC\_ASN1\_IA5\_STRING:}
\DoxyCodeLine{114            \textcolor{keywordflow}{case} LTC\_ASN1\_PRINTABLE\_STRING:}
\DoxyCodeLine{115            \textcolor{keywordflow}{case} LTC\_ASN1\_UTF8\_STRING:}
\DoxyCodeLine{116            \textcolor{keywordflow}{case} LTC\_ASN1\_UTCTIME:}
\DoxyCodeLine{117            \textcolor{keywordflow}{case} LTC\_ASN1\_SEQUENCE:}
\DoxyCodeLine{118            \textcolor{keywordflow}{case} LTC\_ASN1\_SET:}
\DoxyCodeLine{119            \textcolor{keywordflow}{case} LTC\_ASN1\_SETOF:}
\DoxyCodeLine{120            \textcolor{keywordflow}{case} LTC\_ASN1\_RAW\_BIT\_STRING:}
\DoxyCodeLine{121            \textcolor{keywordflow}{case} LTC\_ASN1\_GENERALIZEDTIME:}
\DoxyCodeLine{122                 LTC\_SET\_ASN1(list, x++, type, data, size);}
\DoxyCodeLine{123                 \textcolor{keywordflow}{break};}
\DoxyCodeLine{124 }
\DoxyCodeLine{125            \textcolor{keywordflow}{case} LTC\_ASN1\_CHOICE:}
\DoxyCodeLine{126            \textcolor{keywordflow}{case} LTC\_ASN1\_CUSTOM\_TYPE:}
\DoxyCodeLine{127            \textcolor{keywordflow}{case} LTC\_ASN1\_EOL:}
\DoxyCodeLine{128            \textcolor{keywordflow}{case} LTC\_ASN1\_TELETEX\_STRING:}
\DoxyCodeLine{129                va\_end(args);}
\DoxyCodeLine{130                err = \mbox{\hyperlink{tomcrypt_8h_adc29c2ff13d900c2f185ee95427fb06ca92aa8bad3930f08d5a188bf72094b066}{CRYPT\_INVALID\_ARG}};}
\DoxyCodeLine{131                \textcolor{keywordflow}{goto} LBL\_ERR;}
\DoxyCodeLine{132        \}}
\DoxyCodeLine{133    \}}
\DoxyCodeLine{134    va\_end(args);}
\DoxyCodeLine{135 }
\DoxyCodeLine{136    err = der\_encode\_sequence(list, x, out, outlen);}
\DoxyCodeLine{137 LBL\_ERR:}
\DoxyCodeLine{138    \mbox{\hyperlink{tomcrypt__cfg_8h_a260d66fc0690e0502cf3bfe7b5244b75}{XFREE}}(list);}
\DoxyCodeLine{139    \textcolor{keywordflow}{return} err;}
\DoxyCodeLine{140 \}}

\end{DoxyCode}


References C\+R\+Y\+P\+T\+\_\+\+I\+N\+V\+A\+L\+I\+D\+\_\+\+A\+RG, C\+R\+Y\+P\+T\+\_\+\+M\+EM, C\+R\+Y\+P\+T\+\_\+\+N\+OP, L\+T\+C\+\_\+\+A\+R\+G\+C\+HK, L\+T\+C\+\_\+\+U\+N\+U\+S\+E\+D\+\_\+\+P\+A\+R\+AM, X\+C\+A\+L\+L\+O\+C(), and X\+F\+R\+E\+E().



Referenced by dh\+\_\+export(), dsa\+\_\+encrypt\+\_\+key(), dsa\+\_\+export(), dsa\+\_\+sign\+\_\+hash(), ecc\+\_\+encrypt\+\_\+key(), ecc\+\_\+export(), ecc\+\_\+sign\+\_\+hash\+\_\+ex(), rsa\+\_\+export(), and x509\+\_\+encode\+\_\+subject\+\_\+public\+\_\+key\+\_\+info().

Here is the call graph for this function\+:
% FIG 1
Here is the caller graph for this function\+:
% FIG 2
